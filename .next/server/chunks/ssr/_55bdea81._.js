module.exports=[417755,a=>{"use strict";a.s(["MoreHorizontal",()=>b],417755);let b=(0,a.i(883706).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},393592,a=>{"use strict";a.s(["default",()=>g]);var b=a.i(187924),c=a.i(572131),d=a.i(571987),e=a.i(417755);let f="https://6jnqmj85-80.inc1.devtunnels.ms";function g({employeeId:a,authToken:g}){let h=(0,c.useRef)(null),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)({}),[q,r]=(0,c.useState)(null);(0,c.useEffect)(()=>{let b=!0;return l(!0),r(null),fetch(`${f}/employee/${a}/documents`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}).then(a=>a.json()).then(a=>{b&&j((Array.isArray(a)?a:[]).map(a=>({id:a.id,filename:a.filename,url:a.url,mimeType:a.mimeType,size:a.size,uploadedBy:a.uploadedBy,createdAt:a.createdAt})))}).catch(()=>r("Failed to load files")).finally(()=>b&&l(!1)),()=>{b=!1}},[a,g]);let s=async b=>{let c=b.target.files?.[0];if(!c)return;let d=`local-${Date.now()}`,e=c.type.startsWith("image/")?URL.createObjectURL(c):null;j(a=>[{id:d,filename:c.name,url:e,mimeType:c.type},...a]),p(a=>({...a,[d]:!0})),r(null);try{let b=new FormData;b.append("file",c);let e=await fetch(`${f}/employee/${a}/documents`,{method:"POST",body:b,headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!e.ok)throw Error("Upload failed");let g=await e.json();j(a=>a.map(a=>a.id===d?{id:g.id,filename:g.filename,url:g.url,mimeType:g.mimeType,size:g.size,uploadedBy:g.uploadedBy,createdAt:g.createdAt}:a))}catch(a){j(a=>a.filter(a=>a.id!==d)),r("Upload failed")}finally{p(a=>{let b={...a};return delete b[d],b}),h.current&&(h.current.value="")}},t=async b=>{j(a=>a.filter(a=>a.id!==b));try{await fetch(`${f}/employee/${a}/documents/${b}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}})}catch{r("Delete failed")}},u=(a,b,c)=>{if(!a)return;let d=document.createElement("a");d.href=a,d.target="_blank",b&&(d.download=c||"file"),document.body.appendChild(d),d.click(),d.remove()};return(0,b.jsxs)("div",{className:"bg-white rounded-lg border p-5",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload file"}),(0,b.jsxs)("div",{onClick:()=>h.current?.click(),className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"#bdbdbd",viewBox:"0 0 24 24",className:"mx-auto mb-2",children:(0,b.jsx)("path",{d:"M12 16a1 1 0 0 1-1-1v-4.586l-1.293 1.293a1 1 0 1 1-1.414-1.414l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.414L13 10.414V15a1 1 0 0 1-1 1Zm7-1a5 5 0 0 0-4.546-4.978A7 7 0 0 0 5.062 9.2 5 5 0 0 0 6 19h13a4 4 0 0 0 0-8Z"})}),(0,b.jsx)("div",{className:"text-sm font-medium",children:"Choose a file"})]}),(0,b.jsx)("input",{ref:h,type:"file",className:"hidden",onChange:s})]}),k&&(0,b.jsx)("p",{className:"text-sm mt-3 text-gray-500",children:"Loading…"}),q&&(0,b.jsx)("p",{className:"text-sm mt-3 text-red-500",children:q}),(0,b.jsx)("div",{className:"mt-6 grid grid-cols-6 gap-4",children:i.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"h-20 border rounded bg-gray-50 flex items-center justify-center overflow-hidden",children:a.url&&a.mimeType?.startsWith("image/")?(0,b.jsx)(d.default,{src:a.url,alt:a.filename||"file",fill:!0,className:"object-cover",unoptimized:!0}):(0,b.jsx)("span",{className:"text-xs text-gray-400",children:"File"})}),(0,b.jsx)("button",{onClick:()=>n(m===a.id?null:a.id),className:"absolute top-1 right-1 p-1 rounded hover:bg-white",children:(0,b.jsx)(e.MoreHorizontal,{size:16})}),m===a.id&&(0,b.jsxs)("div",{className:"absolute right-0 mt-7 w-36 bg-white border rounded shadow z-20",children:[(0,b.jsx)("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>u(a.url,!0,a.filename||void 0),children:"Download"}),(0,b.jsx)("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>u(a.url),children:"View"}),(0,b.jsx)("button",{className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-gray-50",onClick:()=>t(a.id),children:"Delete"})]})]}),(0,b.jsx)("div",{className:"mt-2 text-sm",children:(0,b.jsxs)("div",{className:"font-medium truncate",children:[a.filename||"Untitled",o[String(a.id)]&&(0,b.jsxs)("span",{className:"text-xs text-gray-400",children:[" ","· uploading…"]})]})})]},String(a.id)))})]})}}];

//# sourceMappingURL=_55bdea81._.js.map