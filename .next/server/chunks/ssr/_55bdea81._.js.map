{"version":3,"sources":["turbopack:///[project]/node_modules/lucide-react/src/icons/ellipsis.ts","turbopack:///[project]/src/app/(dashboard)/hr/employee/[id]/Documents/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['circle', { cx: '12', cy: '12', r: '1', key: '41hilf' }],\n  ['circle', { cx: '19', cy: '12', r: '1', key: '1wjl8i' }],\n  ['circle', { cx: '5', cy: '12', r: '1', key: '1pcz8c' }],\n];\n\n/**\n * @component @name Ellipsis\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxIiAvPgogIDxjaXJjbGUgY3g9IjE5IiBjeT0iMTIiIHI9IjEiIC8+CiAgPGNpcmNsZSBjeD0iNSIgY3k9IjEyIiByPSIxIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/ellipsis\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Ellipsis = createLucideIcon('ellipsis', __iconNode);\n\nexport default Ellipsis;\n","\n\n\"use client\";\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport Image from \"next/image\";\nimport { MoreHorizontal } from \"lucide-react\";\n\nexport type ProjectFile = {\n    id: number | string;\n    filename?: string | null;\n    url?: string | null;\n    mimeType?: string | null;\n    size?: number | null;\n    uploadedBy?: string | null;\n    createdAt?: string | null;\n};\n\nconst BASE_URL =\n    process.env.NEXT_PUBLIC_MAIN ;\n\nexport default function ProjectDocuments({\n    employeeId,\n    authToken,\n}: {\n    employeeId: number | string;\n    authToken?: string;\n}) {\n    const fileInputRef = useRef<HTMLInputElement | null>(null);\n\n    const [files, setFiles] = useState<ProjectFile[]>([]);\n    const [loading, setLoading] = useState(false);\n    const [menuOpen, setMenuOpen] = useState<number | string | null>(null);\n    const [uploading, setUploading] = useState<Record<string, boolean>>({});\n    const [error, setError] = useState<string | null>(null);\n\n    /* =========================\n        FETCH PROJECT FILES\n    ========================= */\n    useEffect(() => {\n        // if (!employeeId) return;\n\n        let mounted = true;\n        setLoading(true);\n        setError(null);\n\n        fetch(`${BASE_URL}/employee/${employeeId}/documents`, {\n            headers: {\n                Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n            },\n        })\n            .then((res) => res.json())\n            .then((data) => {\n                if (!mounted) return;\n\n                const mapped: ProjectFile[] = (Array.isArray(data) ? data : []).map(\n                    (f: any) => ({\n                        id: f.id,\n                        filename: f.filename,\n                        url: f.url,\n                        mimeType: f.mimeType,\n                        size: f.size,\n                        uploadedBy: f.uploadedBy,\n                        createdAt: f.createdAt,\n                    })\n                );\n\n                setFiles(mapped);\n            })\n            .catch(() => setError(\"Failed to load files\"))\n            .finally(() => mounted && setLoading(false));\n\n        return () => {\n            mounted = false;\n        };\n    }, [employeeId, authToken]);\n\n    /* =========================\n        UPLOAD FILE\n    ========================= */\n    const handleFileChange = async (\n        e: React.ChangeEvent<HTMLInputElement>\n    ) => {\n        const file = e.target.files?.[0];\n        if (!file) return;\n\n        const localId = `local-${Date.now()}`;\n        const previewUrl = file.type.startsWith(\"image/\")\n            ? URL.createObjectURL(file)\n            : null;\n\n        // optimistic preview\n        setFiles((prev) => [\n            {\n                id: localId,\n                filename: file.name,\n                url: previewUrl,\n                mimeType: file.type,\n            },\n            ...prev,\n        ]);\n\n        setUploading((p) => ({ ...p, [localId]: true }));\n        setError(null);\n\n        try {\n            const formData = new FormData();\n            formData.append(\"file\", file);\n\n            const res = await fetch(\n                `${BASE_URL}/employee/${employeeId}/documents`,\n                {\n                    method: \"POST\",\n                    body: formData,\n                    headers: {\n                        Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n                    },\n                }\n            );\n\n            if (!res.ok) throw new Error(\"Upload failed\");\n\n            const data = await res.json();\n\n            // ðŸ”¥ EXACT RESPONSE MAPPING\n            setFiles((prev) =>\n                prev.map((f) =>\n                    f.id === localId\n                        ? {\n                            id: data.id,\n                            filename: data.filename,\n                            url: data.url,\n                            mimeType: data.mimeType,\n                            size: data.size,\n                            uploadedBy: data.uploadedBy,\n                            createdAt: data.createdAt,\n                        }\n                        : f\n                )\n            );\n        } catch (err) {\n            setFiles((prev) => prev.filter((f) => f.id !== localId));\n            setError(\"Upload failed\");\n        } finally {\n            setUploading((p) => {\n                const c = { ...p };\n                delete c[localId];\n                return c;\n            });\n            if (fileInputRef.current) fileInputRef.current.value = \"\";\n        }\n    };\n\n    /* =========================\n        DELETE FILE\n    ========================= */\n    const handleDelete = async (id: number | string) => {\n        setFiles((prev) => prev.filter((f) => f.id !== id));\n\n        try {\n            await fetch(`${BASE_URL}/employee/${employeeId}/documents/${id}`, {\n                method: \"DELETE\",\n                headers: {\n                    Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n                },\n            });\n        } catch {\n            setError(\"Delete failed\");\n        }\n    };\n\n    const openFile = (\n        url?: string,\n        download?: boolean,\n        name?: string\n    ) => {\n        if (!url) return;\n        const a = document.createElement(\"a\");\n        a.href = url;\n        a.target = \"_blank\";\n        if (download) a.download = name || \"file\";\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n    };\n\n    /* =========================\n        UI\n    ========================= */\n    return (\n        <div className=\"bg-white rounded-lg border p-5\">\n            <h3 className=\"text-lg font-semibold mb-4\">Upload file</h3>\n\n            {/* Upload Box */}\n            <div\n                onClick={() => fileInputRef.current?.click()}\n                className=\"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500\"\n            >\n                <div className=\"text-center\">\n                    <svg\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        width=\"40\"\n                        height=\"40\"\n                        fill=\"#bdbdbd\"\n                        viewBox=\"0 0 24 24\"\n                        className=\"mx-auto mb-2\"\n                    >\n                        <path d=\"M12 16a1 1 0 0 1-1-1v-4.586l-1.293 1.293a1 1 0 1 1-1.414-1.414l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.414L13 10.414V15a1 1 0 0 1-1 1Zm7-1a5 5 0 0 0-4.546-4.978A7 7 0 0 0 5.062 9.2 5 5 0 0 0 6 19h13a4 4 0 0 0 0-8Z\" />\n                    </svg>\n                    <div className=\"text-sm font-medium\">Choose a file</div>\n                </div>\n                <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    className=\"hidden\"\n                    onChange={handleFileChange}\n                />\n            </div>\n\n            {loading && (\n                <p className=\"text-sm mt-3 text-gray-500\">Loadingâ€¦</p>\n            )}\n            {error && (\n                <p className=\"text-sm mt-3 text-red-500\">{error}</p>\n            )}\n\n            {/* Files Grid */}\n            <div className=\"mt-6 grid grid-cols-6 gap-4\">\n                {files.map((f) => (\n                    <div key={String(f.id)}>\n                        <div className=\"relative\">\n                            <div className=\"h-20 border rounded bg-gray-50 flex items-center justify-center overflow-hidden\">\n                                {f.url && f.mimeType?.startsWith(\"image/\") ? (\n                                    <Image\n                                        src={f.url}\n                                        alt={f.filename || \"file\"}\n                                        fill\n                                        className=\"object-cover\"\n                                        unoptimized\n                                    />\n                                ) : (\n                                    <span className=\"text-xs text-gray-400\">File</span>\n                                )}\n                            </div>\n\n                            <button\n                                onClick={() =>\n                                    setMenuOpen(menuOpen === f.id ? null : f.id)\n                                }\n                                className=\"absolute top-1 right-1 p-1 rounded hover:bg-white\"\n                            >\n                                <MoreHorizontal size={16} />\n                            </button>\n\n                            {menuOpen === f.id && (\n                                <div className=\"absolute right-0 mt-7 w-36 bg-white border rounded shadow z-20\">\n                                    <button\n                                        className=\"w-full text-left px-3 py-2 text-sm hover:bg-gray-50\"\n                                        onClick={() =>\n                                            openFile(f.url, true, f.filename || undefined)\n                                        }\n                                    >\n                                        Download\n                                    </button>\n                                    <button\n                                        className=\"w-full text-left px-3 py-2 text-sm hover:bg-gray-50\"\n                                        onClick={() => openFile(f.url)}\n                                    >\n                                        View\n                                    </button>\n                                    <button\n                                        className=\"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-gray-50\"\n                                        onClick={() => handleDelete(f.id)}\n                                    >\n                                        Delete\n                                    </button>\n                                </div>\n                            )}\n                        </div>\n\n                        <div className=\"mt-2 text-sm\">\n                            <div className=\"font-medium truncate\">\n                                {f.filename || \"Untitled\"}\n                                {uploading[String(f.id)] && (\n                                    <span className=\"text-xs text-gray-400\">\n                                        {\" \"}\n                                        Â· uploadingâ€¦\n                                    </span>\n                                )}\n                            </div>\n                        </div>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}