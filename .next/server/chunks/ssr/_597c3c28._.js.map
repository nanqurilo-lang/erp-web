{"version":3,"sources":["turbopack:///[project]/src/components/ui/card.tsx","turbopack:///[project]/node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.js","turbopack:///[project]/node_modules/use-sync-external-store/shim/index.js","turbopack:///[project]/src/components/ui/badge.tsx","turbopack:///[project]/src/app/(dashboard)/notifications/page.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n","/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useState = React.useState,\n  useEffect = React.useEffect,\n  useLayoutEffect = React.useLayoutEffect,\n  useDebugValue = React.useDebugValue;\nfunction useSyncExternalStore$2(subscribe, getSnapshot) {\n  var value = getSnapshot(),\n    _useState = useState({ inst: { value: value, getSnapshot: getSnapshot } }),\n    inst = _useState[0].inst,\n    forceUpdate = _useState[1];\n  useLayoutEffect(\n    function () {\n      inst.value = value;\n      inst.getSnapshot = getSnapshot;\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n    },\n    [subscribe, value, getSnapshot]\n  );\n  useEffect(\n    function () {\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      return subscribe(function () {\n        checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      });\n    },\n    [subscribe]\n  );\n  useDebugValue(value);\n  return value;\n}\nfunction checkIfSnapshotChanged(inst) {\n  var latestGetSnapshot = inst.getSnapshot;\n  inst = inst.value;\n  try {\n    var nextValue = latestGetSnapshot();\n    return !objectIs(inst, nextValue);\n  } catch (error) {\n    return !0;\n  }\n}\nfunction useSyncExternalStore$1(subscribe, getSnapshot) {\n  return getSnapshot();\n}\nvar shim =\n  \"undefined\" === typeof window ||\n  \"undefined\" === typeof window.document ||\n  \"undefined\" === typeof window.document.createElement\n    ? useSyncExternalStore$1\n    : useSyncExternalStore$2;\nexports.useSyncExternalStore =\n  void 0 !== React.useSyncExternalStore ? React.useSyncExternalStore : shim;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n","\"use client\"\n\nimport useSWR from \"swr\"\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { cn } from \"@/lib/utils\"\n\ntype NotificationType = \"CHAT_MESSAGE\" | \"APPRECIATION\" | \"LEAVE_APPLICATION\" | \"LEAVE_QUOTA\"\n\ntype Notification = {\n  id: number\n  senderEmployeeId: string | null\n  receiverEmployeeId: string\n  title: string\n  message: string\n  type: NotificationType\n  readFlag: boolean\n  createdAt: string\n  readAt: string | null\n}\n\n// Fetcher now accepts headers via SWR key tuple\nconst fetcher = async ([url, token]: [string, string | null]) => {\n  if (!token) throw new Error(\"Unauthorized: Missing access token\")\n\n  const res = await fetch(url, {\n    headers: { Authorization: `Bearer ${token}` },\n    cache: \"no-store\",\n  })\n\n  if (!res.ok) {\n    throw new Error(`Failed to load: ${res.status}`)\n  }\n\n  return res.json()\n}\n\nfunction typeToBadgeVariant(t: NotificationType): \"secondary\" | \"outline\" {\n  switch (t) {\n    case \"APPRECIATION\":\n      return \"secondary\"\n    case \"LEAVE_APPLICATION\":\n    case \"LEAVE_QUOTA\":\n      return \"outline\"\n    case \"CHAT_MESSAGE\":\n    default:\n      return \"secondary\"\n  }\n}\n\nfunction formatDate(iso: string) {\n  try {\n    return new Intl.DateTimeFormat(undefined, {\n      dateStyle: \"medium\",\n      timeStyle: \"short\",\n    }).format(new Date(iso))\n  } catch {\n    return iso\n  }\n}\n\nexport default function NotificationsPage() {\n  const [token, setToken] = useState<string | null>(null)\n\n  // ✅ Ensure localStorage is accessed only on client\n  useEffect(() => {\n    const t = localStorage.getItem(\"accessToken\")\n    setToken(t)\n  }, [])\n\n  const { data, error, isLoading } = useSWR<Notification[]>(\n    token ? [\"/api/notifications\", token] : null,\n    fetcher,\n    {\n      refreshInterval: 60_000, // auto-refresh every minute\n      revalidateOnFocus: true,\n    }\n  )\n\n  return (\n    <main className=\"mx-auto max-w-3xl p-6\">\n      <header className=\"mb-6\">\n        <h1 className=\"text-pretty text-2xl font-semibold\">Notifications</h1>\n        <p className=\"text-sm text-muted-foreground\">Your latest updates and messages</p>\n      </header>\n\n      {/* Loading skeletons */}\n      {isLoading ? (\n        <div className=\"grid gap-4\">\n          {[1, 2].map((i) => (\n            <Card key={i}>\n              <CardHeader>\n                <div className=\"h-5 w-48 rounded-md bg-muted animate-pulse\" />\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                <div className=\"h-4 w-full rounded-md bg-muted animate-pulse\" />\n                <div className=\"h-4 w-2/3 rounded-md bg-muted animate-pulse\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : error ? (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-destructive\">Unable to load notifications</CardTitle>\n          </CardHeader>\n          <CardContent className=\"text-sm text-muted-foreground\">\n            {String(error?.message ?? \"An error occurred\")}\n          </CardContent>\n        </Card>\n      ) : !data || data.length === 0 ? (\n        <Card>\n          <CardHeader>\n            <CardTitle>No notifications</CardTitle>\n          </CardHeader>\n          <CardContent className=\"text-sm text-muted-foreground\">You’re all caught up.</CardContent>\n        </Card>\n      ) : (\n        <ul className=\"grid gap-4\">\n          {data.map((n) => (\n            <li key={n.id}>\n              <Card className={cn(\"transition-colors\", !n.readFlag ? \"border-primary/40\" : \"\")}>\n                <CardHeader className=\"flex flex-row items-start justify-between space-y-0\">\n                  <div className=\"space-y-1\">\n                    <CardTitle className=\"text-base\">{n.title}</CardTitle>\n                    <div className=\"text-xs text-muted-foreground\">\n                      {formatDate(n.createdAt)}\n                      {n.senderEmployeeId ? ` • From ${n.senderEmployeeId}` : \"\"}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Badge variant={typeToBadgeVariant(n.type)}>{n.type}</Badge>\n                    {!n.readFlag && (\n                      <span\n                        aria-label=\"Unread\"\n                        title=\"Unread\"\n                        className=\"inline-block h-2 w-2 rounded-full bg-primary\"\n                      />\n                    )}\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-sm text-pretty\">{n.message}</p>\n                </CardContent>\n              </Card>\n            </li>\n          ))}\n        </ul>\n      )}\n    </main>\n  )\n}\n"],"names":[],"mappings":"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","ignoreList":[1,2]}