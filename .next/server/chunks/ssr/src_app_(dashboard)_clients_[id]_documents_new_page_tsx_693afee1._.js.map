{"version":3,"sources":["turbopack:///[project]/src/app/(dashboard)/clients/[id]/documents/new/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useParams } from 'next/navigation';\nimport Link from 'next/link';\n\ntype UploadResponse = {\n  id: string;\n  filename: string;\n  url: string;\n};\n\nexport default function ClientDocumentUploader() {\n  const { id } = useParams(); // id comes from /clients/[id]\n  const [file, setFile] = useState<File | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [response, setResponse] = useState<UploadResponse | null>(null);\n\n  const handleUpload = async () => {\n    if (!file) {\n      alert('Please select a file.');\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('file', file);\n\n    const token = localStorage.getItem('accessToken');\n    if (!token) {\n      alert('You are not logged in!');\n      return;\n    }\n\n    setUploading(true);\n\n    try {\n      const res = await fetch(`${process.env.NEXT_PUBLIC_MAIN}/clients/${id}/documents`, {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        body: formData,\n      });\n\n      if (!res.ok) {\n        const errText = await res.text();\n        throw new Error(`Upload failed: ${errText}`);\n      }\n\n      const data: UploadResponse = await res.json();\n      setResponse(data);\n    } catch (err: unknown) {\n      console.error('Upload error:', err);\n      if (err instanceof Error) {\n        alert(err.message);\n      } else {\n        alert('Error uploading file');\n      }\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  return (\n    <div className=\"p-4 border rounded-lg max-w-md mx-auto\">\n      <h2 className=\"text-lg font-semibold mb-2\">Upload Client Document</h2>\n\n      <input\n        type=\"file\"\n        accept=\"image/*,application/pdf\"\n        onChange={(e) => setFile(e.target.files?.[0] || null)}\n        className=\"mb-3\"\n      />\n\n      <button\n        onClick={handleUpload}\n        disabled={!file || uploading}\n        className=\"bg-blue-600 text-white px-4 py-2 rounded-md disabled:bg-gray-400\"\n      >\n        {uploading ? 'Uploading...' : 'Upload'}\n      </button>\n\n      {response && (\n        <div className=\"mt-4 bg-gray-50 p-3 rounded\">\n          <p>\n            <b>ID:</b> {response.id}\n          </p>\n          <p>\n            <b>Filename:</b> {response.filename}\n          </p>\n          <p>\n            <b>URL:</b>{' '}\n            <Link\n              href={response.url}\n              className=\"text-blue-600 underline break-all\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              {response.url}\n            </Link>\n          </p>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"iFAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,QAQe,SAAS,IACtB,GAAM,IAAE,CAAE,CAAE,CAAG,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,CADsB,AACrB,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,MACxC,CAAC,EAAW,CAFwC,CAE3B,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAwB,MAE1D,EAAe,UACnB,GAAI,CAAC,EAAM,YACT,MAAM,yBAIR,IAAM,EAAW,IAAI,SACrB,EAAS,MAAM,CAAC,OAAQ,GAExB,IAAM,EAAQ,aAAa,OAAO,CAAC,eACnC,GAAI,CAAC,EAAO,YACV,MAAM,0BAIR,GAAa,GAEb,GAAI,CACF,IAAM,EAAM,MAAM,MAAM,kDAA2C,GAAG,UAAU,AAAC,CAAE,CACjF,OAAQ,MAD8C,CAEtD,QAAS,AAFsD,CAG7D,cAAe,CAAC,OAAO,EAAE,EAAA,CAAO,AAClC,EACA,KAAM,CACR,GAEA,GAAI,CAAC,EAAI,EAAE,CAAE,CACX,IAAM,EAAU,MAAM,EAAI,IAAI,EAC9B,OAAM,AAAI,MAAM,CAAC,eAAe,EAAE,EAAA,CAAS,CAC7C,CAEA,IAAM,EAAuB,MAAM,EAAI,IAAI,GAC3C,EAAY,EACd,CAAE,MAAO,EAAc,CACrB,QAAQ,KAAK,CAAC,gBAAiB,GAC3B,aAAe,MACjB,CADwB,KAClB,EAAI,OAAO,EAEjB,MAAM,uBAEV,QAAU,CACR,GAAa,EACf,CACF,EAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sCAA6B,2BAE3C,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,OAAO,0BACP,SAAU,AAAC,GAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,EAAI,MAChD,UAAU,SAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,SAAU,CAAC,GAAQ,EACnB,UAAU,4EAET,EAAY,eAAiB,WAG/B,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,QAAO,IAAE,EAAS,EAAE,IAEzB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,cAAa,IAAE,EAAS,QAAQ,IAErC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,SAAS,IACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CACH,KAAM,EAAS,GAAG,CAClB,UAAU,oCACV,OAAO,SACP,IAAI,+BAEH,EAAS,GAAG,WAO3B"}