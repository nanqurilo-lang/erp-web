module.exports=[505197,401897,630083,841489,471408,802133,478615,100401,414876,172031,433990,707251,859041,a=>{"use strict";a.s(["default",()=>h],505197);var b=a.i(187924),c=a.i(587532),d=a.i(172162),e=a.i(580701),f=a.i(866718),g=a.i(699570);function h({filters:a,setFilters:h,invoices:i}){let j=["All",...new Set(i.map(a=>a.project?.projectName).filter(Boolean))],k=["All",...new Set(i.map(a=>a.client?.name).filter(Boolean))],l=["All",...new Set(i.map(a=>a.status).filter(Boolean))];return(0,b.jsxs)("div",{className:"border rounded-md bg-white px-3 py-3 mb-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex gap-2 items-center border rounded px-2 py-2 bg-white",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,b.jsx)("input",{type:"date",className:"text-xs border rounded px-2 py-1",value:a.startDate,onChange:a=>h(b=>({...b,startDate:a.target.value}))}),(0,b.jsx)("span",{className:"text-sm text-gray-400",children:"to"}),(0,b.jsx)("input",{type:"date",className:"text-xs border rounded px-2 py-1",value:a.endDate,onChange:a=>h(b=>({...b,endDate:a.target.value}))})]}),(0,b.jsxs)(e.Select,{value:a.client,onValueChange:a=>h(b=>({...b,client:a})),children:[(0,b.jsx)(e.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(e.SelectValue,{placeholder:"Client"})}),(0,b.jsx)(e.SelectContent,{children:k.map(a=>(0,b.jsx)(e.SelectItem,{value:a,children:a},a))})]}),(0,b.jsxs)(e.Select,{value:a.project,onValueChange:a=>h(b=>({...b,project:a})),children:[(0,b.jsx)(e.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(e.SelectValue,{placeholder:"Project"})}),(0,b.jsx)(e.SelectContent,{children:j.map(a=>(0,b.jsx)(e.SelectItem,{value:a,children:a},a))})]}),(0,b.jsxs)(e.Select,{value:a.status,onValueChange:a=>h(b=>({...b,status:a})),children:[(0,b.jsx)(e.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(e.SelectValue,{placeholder:"Status"})}),(0,b.jsx)(e.SelectContent,{children:l.map(a=>(0,b.jsx)(e.SelectItem,{value:a,children:a},a))})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(c.Search,{className:"w-4 h-4 absolute left-2 top-2 text-gray-400"}),(0,b.jsx)(f.Input,{placeholder:"Search invoice / project / client",className:"pl-8 w-[250px]",value:a.search,onChange:a=>h(b=>({...b,search:a.target.value}))})]})]}),(0,b.jsxs)(g.Button,{variant:"outline",className:"flex items-center gap-2",children:[(0,b.jsx)(d.SlidersHorizontal,{className:"h-4 w-4"})," Filters"]})]})}a.s(["default",()=>x],401897);var i=a.i(571987),j=a.i(206015),k=a.i(417755),l=a.i(177156),m=a.i(510448),n=a.i(773320),o=a.i(217201),p=a.i(816201),q=a.i(790166),r=a.i(104720),s=a.i(523312),t=a.i(705151),u=a.i(335732),v=a.i(786304);let w="https://6jnqmj85-80.inc1.devtunnels.ms";function x({invoices:a,loading:c,filters:d,setActiveInvoice:e,setModal:f}){let h=a.filter(a=>{if(d.search){let b=d.search.toLowerCase();if(!(a.invoiceNumber?.toLowerCase().includes(b)||a.project?.projectName?.toLowerCase().includes(b)||a.client?.name?.toLowerCase().includes(b)))return!1}if("All"!==d.project&&a.project?.projectName!==d.project||"All"!==d.client&&a.client?.name!==d.client||"All"!==d.status&&a.status!==d.status)return!1;if(d.startDate&&d.endDate){let b=new Date(a.invoiceDate),c=new Date(d.startDate),e=new Date(d.endDate);if(e.setHours(23,59,59),b<c||b>e)return!1}return!0}),x=async a=>{if(a?.id&&confirm(`Mark invoice ${a.invoiceNumber} as PAID?`))try{let b=await fetch(`${w}/api/invoices/${a.invoiceNumber}/mark-paid`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"}});if(!b.ok){let a=await b.text();throw Error(a||"Failed to mark invoice as paid")}alert("Invoice marked as PAID successfully âœ…"),window.location.reload()}catch(a){console.error(a),alert("Failed to mark invoice as paid")}},y=async a=>{if(a?.invoiceNumber&&confirm(`Send payment reminder for invoice ${a.invoiceNumber}?`))try{let b=await fetch(`${w}/api/invoices/${a.invoiceNumber}/actions/send-reminder-email`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!b.ok){let a=await b.text();throw Error(a||"Failed to send reminder")}alert("Payment reminder sent successfully ðŸ“§")}catch(a){console.error(a),alert("Failed to send payment reminder")}},z=async a=>{try{let b=await fetch(`${w}/api/invoices/${a.invoiceNumber}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!b.ok){let a=await b.text();throw Error(a||"Failed to delete invoice")}alert("Invoice deleted successfully ðŸ—‘ï¸"),window.location.reload()}catch(a){console.error("Delete invoice error:",a),alert("Failed to delete invoice")}};return c?(0,b.jsx)("p",{className:"text-center py-10",children:"Loadingâ€¦"}):(0,b.jsx)("div",{className:"border rounded-lg bg-white shadow-sm",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Invoice"}),(0,b.jsx)(j.TableHead,{children:"Project"}),(0,b.jsx)(j.TableHead,{children:"Client"}),(0,b.jsx)(j.TableHead,{children:"Total"}),(0,b.jsx)(j.TableHead,{children:"Date"}),(0,b.jsx)(j.TableHead,{children:"Status"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Action"})]})}),(0,b.jsx)(j.TableBody,{children:0===h.length?(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:8,className:"text-center py-10 text-gray-500",children:"No invoices found"})}):h.map(a=>{var c,d;return(0,b.jsxs)(j.TableRow,{className:"hover:bg-gray-50",children:[(0,b.jsx)(j.TableCell,{children:a.invoiceNumber}),(0,b.jsx)(j.TableCell,{children:a.project?.projectName}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.client?.company?.companyLogoUrl?(0,b.jsx)(i.default,{src:a.client.company.companyLogoUrl,alt:"logo",width:28,height:28,className:"rounded-full"}):(0,b.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:a.client?.name?.charAt(0)}),(0,b.jsx)("span",{children:a.client?.name})]})}),(0,b.jsxs)(j.TableCell,{children:[a.currency," ",Number(a.total).toFixed(2)]}),(0,b.jsx)(j.TableCell,{children:(c=a.invoiceDate)?new Date(c).toLocaleDateString("en-GB"):"--"}),(0,b.jsx)(j.TableCell,{children:(d=a.status,"paid"===(d=d?.toLowerCase())?(0,b.jsx)(v.Badge,{className:"bg-green-100 text-green-700",children:"Paid"}):"unpaid"===d?(0,b.jsx)(v.Badge,{className:"bg-red-100 text-red-700",children:"Unpaid"}):d?.includes("credit")?(0,b.jsx)(v.Badge,{className:"bg-yellow-100 text-yellow-700",children:"Credit"}):(0,b.jsx)(v.Badge,{children:d}))}),(0,b.jsx)(j.TableCell,{className:"text-right",children:(0,b.jsxs)(u.DropdownMenu,{children:[(0,b.jsx)(u.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(k.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(u.DropdownMenuContent,{align:"end",className:"w-52",children:[(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,view:!0}))},children:[(0,b.jsx)(l.Eye,{className:"h-4 w-4 mr-2"})," View"]}),"UNPAID"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,edit:!0}))},children:[(0,b.jsx)(m.Edit2,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{confirm("Mark invoice as paid?")&&x(a)},children:[(0,b.jsx)(p.CheckCircle,{className:"h-4 w-4 mr-2"})," Mark as Paid"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,payment:!0}))},children:[(0,b.jsx)(q.DollarSign,{className:"h-4 w-4 mr-2"})," Add Payment"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,viewPayment:!0}))},children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 mr-2"})," View Payments"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,upload:!0}))},children:[(0,b.jsx)(n.Upload,{className:"h-4 w-4 mr-2"})," Upload File"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{y(a)},children:[(0,b.jsx)(s.Bell,{className:"h-4 w-4 mr-2"})," Send Reminder"]})]}),"PAID"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,receipt:!0}))},children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 mr-2"})," Add Receipt"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,viewReceipt:!0}))},children:[(0,b.jsx)(l.Eye,{className:"h-4 w-4 mr-2"})," View Receipt"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,upload:!0}))},children:[(0,b.jsx)(n.Upload,{className:"h-4 w-4 mr-2"})," Upload File"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,viewPayment:!0}))},children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 mr-2"})," View Payments"]}),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,createCredit:!0}))},children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 mr-2"}),"Create Credit Note"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,viewCredit:!0}))},children:[(0,b.jsx)(l.Eye,{className:"h-4 w-4 mr-2"}),"View Credit Notes"]})]})]}),"CREDIT_NOTES"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,payment:!0}))},children:[(0,b.jsx)(q.DollarSign,{className:"h-4 w-4 mr-2"})," Add Payment"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,viewPayment:!0}))},children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 mr-2"})," View Payments"]})]}),(0,b.jsx)(u.DropdownMenuSeparator,{}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>{e(a),f(a=>({...a,create:!0}))},children:[(0,b.jsx)(t.Copy,{className:"h-4 w-4 mr-2"})," Create Duplicate"]}),(0,b.jsxs)(u.DropdownMenuItem,{className:"text-red-600",onClick:()=>z(a),children:[(0,b.jsx)(o.Trash,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})})]},a.id)})})]})})}a.s(["default",()=>D],630083);var y=a.i(572131),z=a.i(633508),A=a.i(368114);function B({open:a,onClose:c,title:d,children:e,className:f}){return a?(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:c}),(0,b.jsxs)("div",{className:(0,A.cn)("absolute right-0 top-0 h-full w-full bg-white shadow-xl","animate-slide-in-right",f),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:d}),(0,b.jsx)("button",{onClick:c,children:(0,b.jsx)(z.X,{className:"w-5 h-5"})})]}),(0,b.jsx)("div",{className:"p-6 overflow-auto h-[calc(100%-64px)]",children:e})]})]}):null}function C({children:a}){return(0,b.jsx)("div",{className:"border rounded-lg bg-white p-4 shadow-sm",children:a})}function D({open:a,onClose:c,invoices:d=[],refresh:e}){let[f,h]=(0,y.useState)(!1),[i,j]=(0,y.useState)({invoiceNumber:"",invoiceDate:"",currency:"USD",projectName:"",projectId:"",clientId:"",amount:0,tax:10,discount:0,amountInWords:"",notes:""}),k=(0,y.useMemo)(()=>{let a=new Set;return d.forEach(b=>b.project?.projectName&&a.add(b.project.projectName)),["Select Project",...Array.from(a)]},[d]),l=(0,y.useMemo)(()=>{let a=new Set;return d.forEach(b=>b.client?.name&&a.add(b.client.name)),["Select Client",...Array.from(a)]},[d]),m=Number(i.amount||0),n=i.discount>1?i.discount:m*Number(i.discount||0)/100,o=(m-n)*Number(i.tax||0)/100,p=m-n+o,q=async()=>{h(!0);try{let a={...i,amount:Number(i.amount||0),tax:Number(i.tax||0),discount:Number(i.discount||0)};if(!(await fetch("https://6jnqmj85-80.inc1.devtunnels.ms/api/invoices",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(a)})).ok)throw Error("Create failed");c(),e()}catch(a){alert(a.message)}finally{h(!1)}};return(0,b.jsx)(B,{open:a,title:"Create Invoice",onClose:c,children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(C,{children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-4",children:"Invoice Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Number *"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute left-0 inset-y-0 pl-3 flex items-center text-gray-400",children:"INV#"}),(0,b.jsx)("input",{className:"pl-14 border rounded w-full h-10",placeholder:"INV0001",value:i.invoiceNumber,onChange:a=>j(b=>({...b,invoiceNumber:a.target.value}))})]})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Date *"}),(0,b.jsx)("input",{type:"date",className:"border rounded w-full h-10 px-2",value:i.invoiceDate,onChange:a=>j(b=>({...b,invoiceDate:a.target.value}))})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Currency *"}),(0,b.jsxs)("select",{className:"border rounded w-full h-10 px-2",value:i.currency,onChange:a=>j(b=>({...b,currency:a.target.value})),children:[(0,b.jsx)("option",{value:"USD",children:"USD - US Dollar"}),(0,b.jsx)("option",{value:"EUR",children:"EUR - Euro"}),(0,b.jsx)("option",{value:"GBP",children:"GBP - British Pound"}),(0,b.jsx)("option",{value:"AUD",children:"AUD - Australian Dollar"}),(0,b.jsx)("option",{value:"CAD",children:"CAD - Canadian Dollar"}),(0,b.jsx)("option",{value:"JPY",children:"JPY - Japanese Yen"}),(0,b.jsx)("option",{value:"CHF",children:"CHF - Swiss Franc"}),(0,b.jsx)("option",{value:"SGD",children:"SGD - Singapore Dollar"}),(0,b.jsx)("option",{value:"NZD",children:"NZD - New Zealand Dollar"})]})]})]})]}),(0,b.jsxs)(C,{children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-4",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project *"}),(0,b.jsx)("select",{className:"border rounded w-full h-10 px-2",value:i.projectName,onChange:a=>{let b=a.target.value,c=d.find(a=>a.project?.projectName===b);j(a=>({...a,projectName:b,projectId:c?.project?.projectId||""}))},children:k.map(a=>(0,b.jsx)("option",{children:a},a))})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Client *"}),(0,b.jsx)("select",{className:"border rounded w-full h-10 px-2",value:i.clientId,onChange:a=>j(b=>({...b,clientId:a.target.value})),children:l.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project Budget *"}),(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("div",{className:"px-3 py-2 bg-gray-100 border rounded-l",children:"USD"===i.currency?"â‚¹":"$"}),(0,b.jsx)("input",{readOnly:!0,className:"border rounded-r w-full h-10 px-3",value:(a=>{let b=d.find(b=>b.project?.projectName===a);return b?.project?.budget||0})(i.projectName).toLocaleString()})]})]})]}),(0,b.jsxs)("div",{className:"mt-4 border rounded flex overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex-1 p-3",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount"}),(0,b.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,b.jsx)("div",{className:"px-3 py-2 bg-gray-50 border rounded",children:"$"}),(0,b.jsx)("input",{type:"number",className:"border rounded h-10 w-40 px-2",value:i.amount,onChange:a=>j(b=>({...b,amount:Number(a.target.value)}))})]})]}),(0,b.jsxs)("div",{className:"w-56 p-3 border-l",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Tax (%)"}),(0,b.jsx)("input",{type:"number",className:"border rounded h-10 w-full px-2",value:i.tax,onChange:a=>j(b=>({...b,tax:Number(a.target.value)}))})]}),(0,b.jsxs)("div",{className:"w-40 bg-gray-100 p-3 flex flex-col items-center justify-center",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Total"}),(0,b.jsx)("div",{className:"font-bold text-lg",children:p.toFixed(2)})]})]}),(0,b.jsx)("div",{className:"mt-4 flex justify-end",children:(0,b.jsxs)("div",{className:"w-80 border rounded",children:[(0,b.jsxs)("div",{className:"grid grid-cols-3 p-2 border-b",children:[(0,b.jsx)("div",{}),(0,b.jsx)("div",{className:"text-sm text-gray-500 text-right",children:"Subtotal"}),(0,b.jsx)("div",{className:"text-right font-medium",children:m.toFixed(2)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 p-2 border-b items-center",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Discount"}),(0,b.jsx)("div",{children:(0,b.jsx)("input",{type:"number",className:"border rounded px-2 w-full h-8",value:i.discount,onChange:a=>j(b=>({...b,discount:Number(a.target.value)}))})}),(0,b.jsx)("div",{className:"text-right",children:n.toFixed(2)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 p-2 border-b items-center",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Tax"}),(0,b.jsxs)("div",{className:"text-sm text-gray-500",children:[i.tax,"%"]}),(0,b.jsx)("div",{className:"text-right",children:o.toFixed(2)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 p-2 bg-gray-100",children:[(0,b.jsx)("div",{}),(0,b.jsx)("div",{className:"text-right font-medium",children:"Total"}),(0,b.jsx)("div",{className:"text-right font-bold",children:p.toFixed(2)})]})]})})]}),(0,b.jsx)(C,{children:(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,b.jsxs)("div",{className:"col-span-6",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount in words"}),(0,b.jsx)("input",{className:"border rounded w-full h-10 px-3",value:i.amountInWords,onChange:a=>j(b=>({...b,amountInWords:a.target.value}))})]}),(0,b.jsxs)("div",{className:"col-span-6",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Notes"}),(0,b.jsx)("textarea",{className:"border rounded w-full h-28 p-3",value:i.notes,onChange:a=>j(b=>({...b,notes:a.target.value}))})]})]})}),(0,b.jsxs)("div",{className:"flex justify-center gap-4 mt-2",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:c,children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:q,disabled:f,children:f?"Saving...":"Save"})]})]})})}function E({open:a,onClose:c,invoice:d,setModal:e,refresh:f}){if(!d)return null;let h=a=>a?new Date(a).toLocaleDateString("en-GB"):"--";return(0,b.jsx)(B,{open:a,onClose:c,title:`Invoice ${d.invoiceNumber}`,children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)(C,{children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Client Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,b.jsx)("div",{className:"text-gray-600",children:"Name"}),(0,b.jsx)("div",{children:d.client?.name}),(0,b.jsx)("div",{className:"text-gray-600",children:"Email"}),(0,b.jsx)("div",{children:d.client?.email}),(0,b.jsx)("div",{className:"text-gray-600",children:"Company"}),(0,b.jsx)("div",{children:d.client?.company?.companyName}),(0,b.jsx)("div",{className:"text-gray-600",children:"Mobile"}),(0,b.jsx)("div",{children:d.client?.mobile}),(0,b.jsx)("div",{className:"text-gray-600",children:"Address"}),(0,b.jsx)("div",{children:d.client?.address}),(0,b.jsx)("div",{className:"text-gray-600",children:"Country"}),(0,b.jsx)("div",{children:d.client?.country})]})]}),(0,b.jsxs)(C,{children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,b.jsx)("div",{className:"text-gray-600",children:"Project"}),(0,b.jsx)("div",{children:d.project?.projectName}),(0,b.jsx)("div",{className:"text-gray-600",children:"Code"}),(0,b.jsx)("div",{children:d.project?.projectCode}),(0,b.jsx)("div",{className:"text-gray-600",children:"Start"}),(0,b.jsx)("div",{children:h(d.project?.startDate)}),(0,b.jsx)("div",{className:"text-gray-600",children:"Deadline"}),(0,b.jsx)("div",{children:h(d.project?.deadline)}),(0,b.jsx)("div",{className:"text-gray-600",children:"Budget"}),(0,b.jsxs)("div",{children:[d.currency," ",d.project?.budget?.toLocaleString()]})]})]})]}),(0,b.jsxs)(C,{children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Invoice Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,b.jsxs)("div",{className:"space-y-2 text-gray-600",children:[(0,b.jsx)("div",{children:"Invoice No"}),(0,b.jsx)("div",{children:"Invoice Date"}),(0,b.jsx)("div",{children:"Currency"}),(0,b.jsx)("div",{children:"Amount"}),(0,b.jsx)("div",{children:"Tax"}),(0,b.jsx)("div",{children:"Total"}),(0,b.jsx)("div",{children:"Status"})]}),(0,b.jsxs)("div",{className:"space-y-2 md:col-span-2 font-medium",children:[(0,b.jsx)("div",{children:d.invoiceNumber}),(0,b.jsx)("div",{children:h(d.invoiceDate)}),(0,b.jsx)("div",{children:d.currency}),(0,b.jsxs)("div",{children:[d.currency," ",d.amount]}),(0,b.jsxs)("div",{children:[d.tax,"%"]}),(0,b.jsxs)("div",{children:[d.currency," ",d.total]}),(0,b.jsx)("div",{children:(a=>{let c=(a||"").toLowerCase();return"paid"===c?(0,b.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded",children:"Paid"}):"unpaid"===c?(0,b.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded",children:"Unpaid"}):(0,b.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded",children:a})})(d.status)})]})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("div",{className:"text-sm font-medium mb-2",children:"Files"}),(0,b.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[0===(d.fileUrls||[]).length&&(0,b.jsx)("span",{className:"text-gray-500 text-sm",children:"No files uploaded"}),(d.fileUrls||[]).map((a,c)=>(0,b.jsxs)("div",{className:"border rounded p-2 w-40",children:[(0,b.jsx)("div",{className:"truncate text-sm",children:a}),(0,b.jsxs)(g.Button,{className:"mt-2 w-full",size:"sm",variant:"outline",onClick:()=>window.open(a,"_blank"),children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 mr-2"})," Open"]})]},c))]})]}),(0,b.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[d.status?.toLowerCase()==="unpaid"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>e(a=>({...a,edit:!0})),children:[(0,b.jsx)(m.Edit2,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,b.jsxs)(g.Button,{onClick:()=>alert("Mark paid API pending"),children:[(0,b.jsx)(p.CheckCircle,{className:"h-4 w-4 mr-2"})," Mark As Paid"]})]}),(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>e(a=>({...a,upload:!0})),children:[(0,b.jsx)(n.Upload,{className:"h-4 w-4 mr-2"})," Upload File"]}),(0,b.jsxs)(g.Button,{onClick:()=>e(a=>({...a,payment:!0})),children:[(0,b.jsx)(r.FileText,{className:"h-4 w-4 mr-2"})," View Payments"]})]})]})]})})}function F({open:a,onClose:c,invoice:d,invoices:e=[],refresh:f}){if(!d)return null;let[h,i]=(0,y.useState)(!1),[j,k]=(0,y.useState)({invoiceNumber:"",invoiceDate:"",currency:"USD",projectName:"",projectId:"",clientId:"",amount:0,tax:0,discount:0,amountInWords:"",notes:""});(0,y.useEffect)(()=>{d&&k({invoiceNumber:d.invoiceNumber||"",invoiceDate:d.invoiceDate||"",currency:d.currency||"USD",projectName:d.project?.projectName||"",projectId:d.project?.projectId||"",clientId:d.client?.name||"",amount:Number(d.amount||0),tax:Number(d.tax||0),discount:Number(d.discount||0),amountInWords:d.amountInWords||"",notes:d.notes||""})},[d]);let l=(0,y.useMemo)(()=>{let a=new Set;return e.forEach(b=>b.project?.projectName&&a.add(b.project.projectName)),["Select Project",...Array.from(a)]},[e]),m=(0,y.useMemo)(()=>{let a=new Set;return e.forEach(b=>b.client?.name&&a.add(b.client.name)),["Select Client",...Array.from(a)]},[e]),n=Number(j.amount||0),o=j.discount>1?j.discount:n*Number(j.discount||0)/100,p=(n-o)*Number(j.tax||0)/100,q=async()=>{i(!0);try{let a={...j,amount:Number(j.amount||0),tax:Number(j.tax||0),discount:Number(j.discount||0)};if(!(await fetch(`https://6jnqmj85-80.inc1.devtunnels.ms/api/invoices/${d.invoiceNumber}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(a)})).ok)throw Error("Update failed");c(),f()}catch(a){alert(a.message)}finally{i(!1)}};return(0,b.jsx)(B,{open:a,title:`Edit Invoice â€“ ${d.invoiceNumber}`,onClose:c,children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(C,{children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-4",children:"Invoice Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Number"}),(0,b.jsx)("input",{readOnly:!0,className:"border rounded w-full h-10 px-3 bg-gray-100",value:j.invoiceNumber})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Date *"}),(0,b.jsx)("input",{type:"date",className:"border rounded w-full h-10 px-2",value:j.invoiceDate,onChange:a=>k(b=>({...b,invoiceDate:a.target.value}))})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Currency *"}),(0,b.jsxs)("select",{className:"border rounded w-full h-10 px-2",value:j.currency,onChange:a=>k(b=>({...b,currency:a.target.value})),children:[(0,b.jsx)("option",{value:"USD",children:"USD - US Dollar"}),(0,b.jsx)("option",{value:"EUR",children:"EUR - Euro"}),(0,b.jsx)("option",{value:"GBP",children:"GBP - British Pound"}),(0,b.jsx)("option",{value:"AUD",children:"AUD - Australian Dollar"}),(0,b.jsx)("option",{value:"CAD",children:"CAD - Canadian Dollar"}),(0,b.jsx)("option",{value:"JPY",children:"JPY - Japanese Yen"}),(0,b.jsx)("option",{value:"CHF",children:"CHF - Swiss Franc"}),(0,b.jsx)("option",{value:"SGD",children:"SGD - Singapore Dollar"}),(0,b.jsx)("option",{value:"NZD",children:"NZD - New Zealand Dollar"})]})]})]})]}),(0,b.jsxs)(C,{children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-4",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project *"}),(0,b.jsx)("select",{className:"border rounded w-full h-10 px-2",value:j.projectName,onChange:a=>{let b=a.target.value,c=e.find(a=>a.project?.projectName===b);k(a=>({...a,projectName:b,projectId:c?.project?.projectId||""}))},children:l.map(a=>(0,b.jsx)("option",{children:a},a))})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Client *"}),(0,b.jsx)("select",{className:"border rounded w-full h-10 px-2",value:j.clientId,onChange:a=>k(b=>({...b,clientId:a.target.value})),children:m.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project Budget"}),(0,b.jsx)("input",{readOnly:!0,className:"border rounded w-full h-10 px-3 bg-gray-100",value:(a=>{let b=e.find(b=>b.project?.projectName===a);return b?.project?.budget||0})(j.projectName).toLocaleString()})]})]}),(0,b.jsxs)("div",{className:"mt-4 border rounded flex overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex-1 p-3",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount"}),(0,b.jsx)("input",{type:"number",className:"border rounded h-10 w-40 px-2",value:j.amount,onChange:a=>k(b=>({...b,amount:Number(a.target.value)}))})]}),(0,b.jsxs)("div",{className:"w-56 p-3 border-l",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Tax (%)"}),(0,b.jsx)("input",{type:"number",className:"border rounded h-10 w-full px-2",value:j.tax,onChange:a=>k(b=>({...b,tax:Number(a.target.value)}))})]}),(0,b.jsxs)("div",{className:"w-40 bg-gray-100 p-3 flex flex-col items-center justify-center",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Total"}),(0,b.jsx)("div",{className:"font-bold text-lg",children:(n-o+p).toFixed(2)})]})]})]}),(0,b.jsx)(C,{children:(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,b.jsxs)("div",{className:"col-span-6",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount in words"}),(0,b.jsx)("input",{className:"border rounded w-full h-10 px-3",value:j.amountInWords,onChange:a=>k(b=>({...b,amountInWords:a.target.value}))})]}),(0,b.jsxs)("div",{className:"col-span-6",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Notes"}),(0,b.jsx)("textarea",{className:"border rounded w-full h-28 p-3",value:j.notes,onChange:a=>k(b=>({...b,notes:a.target.value}))})]})]})}),(0,b.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:c,children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:q,disabled:h,children:h?"Updating...":"Update"})]})]})})}function G({open:a,onClose:c,invoice:d,refresh:e}){let[f,h]=(0,y.useState)(null),[i,j]=(0,y.useState)(!1);if(!d)return null;let k=async()=>{if(!f)return alert("Choose a file");j(!0);try{let a=new FormData;a.append("file",f),await fetch(`/api/invoices/${d.invoiceNumber}/files`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:a}),c(),e()}catch(a){alert("Upload failed")}finally{j(!1)}};return(0,b.jsxs)(B,{open:a,onClose:c,title:`Upload file for ${d.invoiceNumber}`,children:[(0,b.jsx)("input",{type:"file",className:"border p-2 rounded w-full",onChange:a=>h(a.target.files?.[0]||null)}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,b.jsx)(g.Button,{variant:"ghost",onClick:c,children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:k,disabled:i,children:i?"Uploading...":"Upload"})]})]})}function H({open:a,onClose:c,invoice:d}){let[e,f]=(0,y.useState)({amount:d?.unpaidAmount||d?.total||"",currency:d?.currency||"",transactionId:"",notes:""}),[h,i]=(0,y.useState)(null);if(!d)return null;let j=async()=>{let a=new FormData;a.append("payment",JSON.stringify({...e,invoiceId:d.invoiceNumber})),h&&a.append("file",h),await fetch("https://6jnqmj85-80.inc1.devtunnels.ms/api/payments",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:a}),c()};return(0,b.jsx)(B,{open:a,onClose:c,title:`Add Payment - ${d.invoiceNumber}`,children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("input",{className:"border rounded w-full px-2 py-1",placeholder:"Amount",value:e.amount,onChange:a=>f(b=>({...b,amount:a.target.value}))}),(0,b.jsx)("input",{className:"border rounded w-full px-2 py-1",placeholder:"Transaction ID",value:e.transactionId,onChange:a=>f(b=>({...b,transactionId:a.target.value}))}),(0,b.jsx)("input",{className:"border rounded w-full px-2 py-1",placeholder:"Currency",value:e.currency,onChange:a=>f(b=>({...b,currency:a.target.value}))}),(0,b.jsx)("textarea",{className:"border rounded w-full px-2 py-1",placeholder:"Notes",value:e.notes,onChange:a=>f(b=>({...b,notes:a.target.value}))}),(0,b.jsx)("input",{type:"file",onChange:a=>i(a.target.files?.[0]||null)}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,b.jsx)(g.Button,{variant:"ghost",onClick:c,children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:j,children:"Save"})]})]})})}a.s(["default",()=>E],841489),a.s(["default",()=>F],471408),a.s(["default",()=>G],802133),a.s(["default",()=>H],478615),a.s(["default",()=>J],100401);var I=a.i(429246);function J({open:a,onClose:c,invoice:d}){if(!d)return null;let[h,i]=(0,y.useState)(!1),[j,k]=(0,y.useState)({invoiceId:d.invoiceNumber||"",issueDate:"",currency:"USD",sellerCompanyName:"",sellerCompanyAddress:"",sellerCompanyCode:"",sellerCompanyTaxNumber:"",sellerCompanyEmail:"",sellerCompanyPhoneNumber:"",sellerCompanyBankName:"",sellerCompanyBankAccountNumber:"",buyerCompanyName:"",buyerCompanyAddress:"",buyerCompanyCode:"",buyerCompanyTaxNumber:"",buyerCleintName:"",buyerCompanyEmail:"",buyerCompanyPhoneNumber:"",buyerCompanyBankName:"",buyerCompanyBankAccountNumber:"",productName:"",quantity:1,priceWithOutTax:0,tax:0,description:""});function l(a,b){k(c=>({...c,[a]:b}))}async function m(){try{i(!0);let a=await fetch("https://6jnqmj85-80.inc1.devtunnels.ms/api/invoice",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(j)});if(!a.ok)throw Error("Failed to create invoice");await a.json(),c()}catch(a){console.error(a),alert("Something went wrong while saving invoice")}finally{i(!1)}}return(0,b.jsx)(B,{open:a,onClose:c,title:"Create Receipt",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("section",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h3",{className:"font-medium mb-4",children:"Invoice Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"text-sm font-medium",children:["Invoice Number ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("div",{className:"flex mt-1",children:[(0,b.jsx)("span",{className:"px-3 flex items-center border border-r-0 rounded-l-md bg-muted text-sm",children:"INV#"}),(0,b.jsx)(f.Input,{className:"rounded-l-none",value:j.invoiceId,onChange:a=>l("invoiceId",a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"text-sm font-medium",children:["Issue Date ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(f.Input,{type:"date",className:"mt-1",value:j.issueDate,onChange:a=>l("issueDate",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"text-sm font-medium",children:["Currency ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)(e.Select,{value:j.currency,onValueChange:a=>l("currency",a),children:[(0,b.jsx)(e.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(e.SelectValue,{})}),(0,b.jsxs)(e.SelectContent,{children:[(0,b.jsx)(e.SelectItem,{value:"USD",children:"USD $"}),(0,b.jsx)(e.SelectItem,{value:"USD",children:"USD â‚¹"})]})]})]})]})]}),(0,b.jsxs)("section",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h3",{className:"font-medium mb-4",children:"Seller Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(K,{label:"Company Name",onChange:a=>l("sellerCompanyName",a)}),(0,b.jsx)(K,{label:"Email Id",onChange:a=>l("sellerCompanyEmail",a)}),(0,b.jsx)(K,{label:"Contact No.",onChange:a=>l("sellerCompanyPhoneNumber",a)}),(0,b.jsx)(K,{label:"Company Code",onChange:a=>l("sellerCompanyCode",a)}),(0,b.jsx)(K,{label:"Tax No.",onChange:a=>l("sellerCompanyTaxNumber",a)}),(0,b.jsx)(L,{label:"Company Address",onChange:a=>l("sellerCompanyAddress",a)}),(0,b.jsx)(K,{label:"Bank Account No.",onChange:a=>l("sellerCompanyBankAccountNumber",a)}),(0,b.jsx)(K,{label:"Name of the Bank",onChange:a=>l("sellerCompanyBankName",a)})]})]}),(0,b.jsxs)("section",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h3",{className:"font-medium mb-4",children:"Buyer Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsx)(K,{label:"Client Name",onChange:a=>l("buyerCleintName",a)}),(0,b.jsx)(K,{label:"Company Name",onChange:a=>l("buyerCompanyName",a)}),(0,b.jsx)(K,{label:"Email Id",onChange:a=>l("buyerCompanyEmail",a)}),(0,b.jsx)(K,{label:"Contact No.",onChange:a=>l("buyerCompanyPhoneNumber",a)}),(0,b.jsx)(K,{label:"Company Code",onChange:a=>l("buyerCompanyCode",a)}),(0,b.jsx)(K,{label:"Tax No.",onChange:a=>l("buyerCompanyTaxNumber",a)}),(0,b.jsx)(L,{label:"Company Address",colSpan:3,onChange:a=>l("buyerCompanyAddress",a)}),(0,b.jsx)(K,{label:"Bank Account No.",onChange:a=>l("buyerCompanyBankAccountNumber",a)}),(0,b.jsx)(K,{label:"Name of the Bank",onChange:a=>l("buyerCompanyBankName",a)})]})]}),(0,b.jsxs)("section",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h3",{className:"font-medium mb-4",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(K,{label:"Product Name",onChange:a=>l("productName",a)}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"font-medium mb-1",children:["Quantity",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(f.Input,{type:"number",defaultValue:1,onChange:a=>l("quantity",Number(a.target.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"font-medium mb-1",children:["Price Without Tax",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(f.Input,{type:"number",defaultValue:1,onChange:a=>l("quantity",Number(a.target.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"font-medium mb-1",children:["Tax",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(f.Input,{type:"number",onChange:a=>l("tax",Number(a.target.value))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"mt-4",children:"Note / Description for the recipient"}),(0,b.jsx)(I.Textarea,{className:"mt-4",placeholder:"Note / Description for the recipient",onChange:a=>l("description",a.target.value)})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:c,children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:m,disabled:h,children:h?"Saving...":"Save"})]})]})})}function K({label:a,onChange:c}){return(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"text-sm font-medium",children:[a," ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(f.Input,{className:"mt-1",onChange:a=>c(a.target.value)})]})}function L({label:a,onChange:c,colSpan:d=2}){return(0,b.jsxs)("div",{className:`md:col-span-${d}`,children:[(0,b.jsxs)("label",{className:"text-sm font-medium",children:[a," ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(I.Textarea,{className:"mt-1",onChange:a=>c(a.target.value)})]})}a.s(["default",()=>Q],414876);var M=a.i(879360),N=a.i(915618),O=a.i(284505);let P="https://6jnqmj85-80.inc1.devtunnels.ms";function Q({open:a,onClose:c,invoice:d}){let[e,f]=(0,y.useState)([]),[h,i]=(0,y.useState)(!1),[k,m]=(0,y.useState)(!1),[n,p]=(0,y.useState)(null);async function q(){let a=d?.invoiceNumber||d?.invoiceNo;if(!a)return void f([]);try{i(!0);let b=await fetch(`${P}/api/invoice/receipt/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),c=await b.text();if(!c)return void f([]);let d=JSON.parse(c);f(Array.isArray(d)?d:[])}catch(a){console.error("âŒ Failed to load receipts",a),f([])}finally{i(!1)}}async function r(a){confirm("Are you sure you want to delete this receipt?")&&(await fetch(`${P}/api/invoice/receipt/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),q())}async function s(a){let b=a?.createdIdUSD||a?.id;if(!b)return void alert("PDF ID not found");try{let a=await fetch(`${P}/api/invoice/${b}/pdf?disposition=attachment`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!a.ok)throw Error("Failed to download PDF");let c=await a.blob(),d=window.URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`${b}.pdf`,document.body.appendChild(e),e.click(),e.remove(),window.URL.revokeObjectURL(d)}catch(a){console.error("âŒ PDF Download Error",a),alert("Failed to download PDF")}}return((0,y.useEffect)(()=>{a&&q()},[a,d]),d)?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(B,{open:a,onClose:c,title:"Receipts",className:"max-w-6xl",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsxs)(g.Button,{onClick:()=>m(!0),children:[(0,b.jsx)(N.Plus,{className:"w-4 h-4 mr-2"}),"Add a Receipt"]})}),(0,b.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{className:"bg-blue-50",children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Invoice No."}),(0,b.jsx)(j.TableHead,{children:"Product"}),(0,b.jsx)(j.TableHead,{children:"Client"}),(0,b.jsx)(j.TableHead,{children:"Amount"}),(0,b.jsx)(j.TableHead,{children:"Issue Date"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Action"})]})}),(0,b.jsxs)(j.TableBody,{children:[h&&(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:6,className:"text-center text-sm text-gray-500",children:"Loading receipts..."})}),!h&&0===e.length&&(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:6,className:"text-center text-sm text-gray-500",children:"No receipts available"})}),!h&&e.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{children:a.invoiceId}),(0,b.jsx)(j.TableCell,{children:a.productName}),(0,b.jsx)(j.TableCell,{children:a.buyerCleintName}),(0,b.jsxs)(j.TableCell,{children:[a.currency," ",a.totalAmount]}),(0,b.jsx)(j.TableCell,{children:new Date(a.issueDate).toLocaleDateString()}),(0,b.jsx)(j.TableCell,{className:"text-right",children:(0,b.jsxs)(u.DropdownMenu,{children:[(0,b.jsx)(u.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(M.MoreVertical,{className:"w-4 h-4"})})}),(0,b.jsxs)(u.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>p(a),children:[(0,b.jsx)(l.Eye,{className:"w-4 h-4 mr-2"}),"View"]}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>s(a),children:[(0,b.jsx)(O.Download,{className:"w-4 h-4 mr-2"}),"Download as PDF"]}),(0,b.jsxs)(u.DropdownMenuItem,{className:"text-red-600",onClick:()=>r(a.id),children:[(0,b.jsx)(o.Trash,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]},a.id))]})]})})]}),n&&(0,b.jsx)(B,{open:!0,onClose:()=>p(null),title:n.invoiceId,className:"max-w-4xl",children:(0,b.jsxs)("div",{className:"border p-6 bg-white text-sm",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Proforma Invoice"}),(0,b.jsxs)("p",{children:["Invoice No.: ",n.invoiceId]}),(0,b.jsxs)("p",{children:["Issue Date: ",new Date(n.issueDate).toDateString()]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6 mt-4 border p-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-1",children:"Seller"}),(0,b.jsx)("p",{children:n.sellerCompanyName}),(0,b.jsx)("p",{children:n.sellerCompanyAddress}),(0,b.jsxs)("p",{children:["Bank: ",n.sellerCompanyBankName]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-1",children:"Buyer"}),(0,b.jsx)("p",{children:n.buyerCompanyName}),(0,b.jsx)("p",{children:n.buyerCompanyAddress}),(0,b.jsxs)("p",{children:["Client: ",n.buyerCleintName]})]})]}),(0,b.jsxs)("div",{className:"mt-4 text-right font-semibold",children:["Total: ",n.currency," ",n.totalAmount]})]})}),(0,b.jsx)(J,{open:k,invoice:d,onClose:()=>{m(!1),q()}})]}):null}a.s(["default",()=>T],172031);var R=a.i(781560);let S="https://6jnqmj85-80.inc1.devtunnels.ms";function T({open:a,onClose:c,clientId:d,onSaved:e}){let[f,g]=(0,y.useState)("pre filled"),[h,i]=(0,y.useState)(d?String(d):"pre filled"),[j,k]=(0,y.useState)("pre filled"),[l,m]=(0,y.useState)(""),[n,o]=(0,y.useState)("USD"),[p,q]=(0,y.useState)(""),[r,s]=(0,y.useState)("Net Banking"),[t,u]=(0,y.useState)(""),v=(0,y.useRef)(null),[w,x]=(0,y.useState)(null),[A,B]=(0,y.useState)(!1),[C,D]=(0,y.useState)([]),[E,F]=(0,y.useState)("");if((0,y.useEffect)(()=>{a&&i(d?String(d):"pre filled")},[a,d]),!a)return null;let G=async()=>{try{let a=localStorage.getItem("accessToken")||"",b=await fetch(`${S}/api/payment-gateways`,{headers:{Authorization:`Bearer ${a}`}}),c=await b.json();Array.isArray(c)&&D(c.map(a=>({id:a.id,name:a.name})))}catch(a){}},H=async()=>{if(!E.trim())return alert("Enter gateway name");try{let a=localStorage.getItem("accessToken")||"",b=await fetch(`${S}/api/payment-gateways`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({name:E})}),c=await b.json();D(a=>[...a,c]),s(c.name),B(!1)}catch(a){alert("Failed to save gateway")}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"fixed inset-0 z-[20000] flex items-center justify-center px-4 py-6",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:c}),(0,b.jsxs)("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Add Payment Details"}),(0,b.jsx)("button",{onClick:c,className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(z.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Payment Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsx)(U,{label:"Project *",value:f,setValue:g}),(0,b.jsx)(U,{label:"Client *",value:h,setValue:i}),(0,b.jsx)(U,{label:"Invoice *",value:j,setValue:k}),(0,b.jsx)(U,{label:"Amount *",value:l,setValue:m}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Currency *"}),(0,b.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:n,onChange:a=>o(a.target.value),children:[(0,b.jsx)("option",{value:"USD",children:"USD $"}),(0,b.jsx)("option",{value:"USD",children:"USD â‚¹"}),(0,b.jsx)("option",{value:"EUR",children:"EUR â‚¬"})]})]}),(0,b.jsx)(U,{label:"Transaction ID",value:p,setValue:q}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Payment Gateway"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("select",{className:"w-full border rounded px-3 py-2",value:r,onChange:a=>s(a.target.value),children:C.length>0?C.map(a=>(0,b.jsx)("option",{children:a.name},a.id)):["Net Banking","Credit Card","PayPal"].map(a=>(0,b.jsx)("option",{children:a},a))}),(0,b.jsx)("button",{className:"px-3 py-2 bg-gray-100 rounded",onClick:()=>{B(!0),G()},children:"Add"})]})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Receipt"}),(0,b.jsx)("div",{className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-600",onClick:()=>v.current?.click(),children:w?w.name:"Click or drag file"}),(0,b.jsx)("input",{type:"file",ref:v,className:"hidden",onChange:a=>x(a.target.files?.[0]??null)})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Remark"}),(0,b.jsx)("textarea",{rows:4,className:"border rounded w-full p-3",value:t,onChange:a=>u(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsx)("button",{className:"px-4 py-2 border rounded",onClick:c,children:"Cancel"}),(0,b.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>{e?.(),c()},children:"Save"})]})]})]})]}),A&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[30000] flex items-center justify-center px-4 py-6",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>B(!1)}),(0,b.jsxs)("div",{className:"relative bg-white w-full max-w-3xl rounded-xl shadow-xl max-h-[90vh] overflow-y-auto p-6",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Add Payment Gateway"}),(0,b.jsx)("button",{onClick:()=>B(!1),children:(0,b.jsx)(z.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"rounded border overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-blue-50 px-4 py-2 flex text-sm font-medium",children:[(0,b.jsx)("div",{className:"w-1/12",children:"#"}),(0,b.jsx)("div",{className:"w-10/12",children:"Gateway"}),(0,b.jsx)("div",{className:"w-1/12 text-center",children:"Action"})]}),(0,b.jsx)("div",{className:"px-4 py-2",children:0===C.length?(0,b.jsx)("p",{className:"text-gray-500 p-2",children:"No gateways"}):C.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center py-2 border-b last:border-none",children:[(0,b.jsx)("div",{className:"w-1/12",children:c+1}),(0,b.jsx)("div",{className:"w-10/12",children:a.name}),(0,b.jsx)("div",{className:"w-1/12 text-center",children:(0,b.jsx)(R.Trash2,{className:"text-red-600 cursor-pointer",size:16})})]},a.id))})]}),(0,b.jsx)("label",{className:"text-sm text-gray-600 block mt-4",children:"Gateway Name *"}),(0,b.jsx)("input",{value:E,onChange:a=>F(a.target.value),className:"border rounded w-full px-3 py-2 mt-1"}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,b.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>B(!1),children:"Cancel"}),(0,b.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:H,children:"Save"})]})]})]})]})}function U({label:a,value:c,setValue:d}){return(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:a}),(0,b.jsx)("input",{className:"w-full border rounded px-3 py-2",value:c,onChange:a=>d(a.target.value)})]})}function V({open:a,onClose:c,payment:d}){return a&&d?(0,b.jsxs)("div",{className:"fixed inset-0 z-[30000]",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:c}),(0,b.jsxs)("div",{className:"absolute top-0 right-0 h-full bg-white shadow-2xl",style:{width:"83vw"},onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"View Payment"}),(0,b.jsx)("button",{onClick:c,className:"p-2 hover:bg-gray-100 rounded",children:(0,b.jsx)(z.X,{})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4 text-sm",children:[(0,b.jsx)(W,{label:"Amount",value:`${d.currency} ${d.amount}`}),(0,b.jsx)(W,{label:"Transaction ID",value:d.transactionId}),(0,b.jsx)(W,{label:"Gateway",value:d.paymentGateway?.name}),(0,b.jsx)(W,{label:"Status",value:d.status}),(0,b.jsx)(W,{label:"Payment Date",value:new Date(d.paymentDate).toLocaleDateString("en-GB")}),(0,b.jsx)(W,{label:"Notes",value:d.note??"--"})]})]})]}):null}a.s(["default",()=>$],433990);let W=({label:a,value:c})=>(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-500",children:a}),(0,b.jsx)("div",{className:"font-medium",children:c??"--"})]});function X({open:a,onClose:c,payment:d,onUpdated:e}){let[f,g]=(0,y.useState)({amount:d?.amount??"",currency:d?.currency??"USD",transactionId:d?.transactionId??"",paymentGatewayId:d?.paymentGateway?.id??"",status:d?.status??"COMPLETED",notes:d?.note??""});if(!a||!d)return null;let h=async()=>{await fetch(`https://6jnqmj85-80.inc1.devtunnels.ms/api/payments/${d.id}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"},body:JSON.stringify(f)}),e(),c()};return(0,b.jsxs)("div",{className:"fixed inset-0 z-[30000]",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:c}),(0,b.jsxs)("div",{className:"absolute top-0 right-0 h-full bg-white shadow-2xl",style:{width:"83vw"},onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Edit Payment"}),(0,b.jsx)("button",{onClick:c,className:"p-2 hover:bg-gray-100 rounded",children:(0,b.jsx)(z.X,{})})]}),(0,b.jsxs)("div",{className:"p-6 grid grid-cols-2 gap-4",children:[(0,b.jsx)(Y,{label:"Amount",value:f.amount,onChange:a=>g({...f,amount:a})}),(0,b.jsx)(Y,{label:"Transaction ID",value:f.transactionId,onChange:a=>g({...f,transactionId:a})}),(0,b.jsx)(Y,{label:"Gateway ID",value:f.paymentGatewayId,onChange:a=>g({...f,paymentGatewayId:a})}),(0,b.jsxs)("select",{className:"border rounded px-3 py-2",value:f.status,onChange:a=>g({...f,status:a.target.value}),children:[(0,b.jsx)("option",{value:"COMPLETED",children:"COMPLETED"}),(0,b.jsx)("option",{value:"PENDING",children:"PENDING"})]}),(0,b.jsx)("textarea",{className:"col-span-2 border rounded px-3 py-2",placeholder:"Notes",value:f.notes,onChange:a=>g({...f,notes:a.target.value})}),(0,b.jsx)("div",{className:"col-span-2 text-right",children:(0,b.jsx)("button",{onClick:h,className:"px-6 py-2 bg-blue-600 text-white rounded",children:"Save Changes"})})]})]})]})}let Y=({label:a,value:c,onChange:d})=>(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-500",children:a}),(0,b.jsx)("input",{value:c,onChange:a=>d(a.target.value),className:"w-full border rounded px-3 py-2"})]}),Z="https://6jnqmj85-80.inc1.devtunnels.ms";function $({open:a,onClose:c,invoiceNumber:d}){let[e,f]=(0,y.useState)([]),[g,h]=(0,y.useState)(!1),[j,l]=(0,y.useState)(null),[m,n]=(0,y.useState)(null);if((0,y.useEffect)(()=>{a&&d&&(async()=>{h(!0);try{let a=await fetch(`${Z}/api/payments/invoice/${d}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),b=await a.json();f(Array.isArray(b)?b:[])}catch(a){console.error(a),f([])}finally{h(!1)}})()},[a,d]),!a)return null;let o=async()=>{h(!0);try{let a=await fetch(`${Z}/api/payments/invoice/${d}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),b=await a.json();f(Array.isArray(b)?b:[])}catch(a){console.error(a)}finally{h(!1)}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-[20000]",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:c}),(0,b.jsxs)("div",{className:" absolute top-0 right-0 h-full bg-white shadow-2xl transition-transform duration-300 translate-x-0 ",style:{width:"83vw"},onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold",children:["Payments â€” ",d]}),(0,b.jsx)("button",{onClick:c,className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(z.X,{size:20})})]}),(0,b.jsx)("div",{className:"p-6 overflow-y-auto h-[calc(100vh-64px)]",children:g?(0,b.jsx)("div",{className:"text-center py-10 text-gray-500",children:"Loading paymentsâ€¦"}):0===e.length?(0,b.jsx)("div",{className:"text-center py-10 text-gray-500",children:"No payments found"}):(0,b.jsxs)("div",{className:"rounded-lg border overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-[#e8f3ff] px-4 py-3 flex text-sm font-medium",children:[(0,b.jsx)("div",{className:"w-2/12",children:"Project"}),(0,b.jsx)("div",{className:"w-2/12",children:"Client"}),(0,b.jsx)("div",{className:"w-2/12",children:"Amount"}),(0,b.jsx)("div",{className:"w-2/12",children:"Gateway"}),(0,b.jsx)("div",{className:"w-2/12",children:"Paid On"}),(0,b.jsx)("div",{className:"w-1/12",children:"Status"}),(0,b.jsx)("div",{className:"w-10 text-center",children:"Action"})]}),e.map(a=>(0,b.jsxs)("div",{className:"flex items-center px-4 py-3 border-t text-sm",children:[(0,b.jsx)("div",{className:"w-2/12",children:a.project?.projectName??"--"}),(0,b.jsxs)("div",{className:"w-2/12 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-7 w-7 rounded-full overflow-hidden bg-gray-100 relative",children:a.client?.profilePictureUrl?(0,b.jsx)(i.default,{src:a.client.profilePictureUrl,alt:"client",fill:!0,sizes:"28px",className:"object-cover",unoptimized:!0}):(0,b.jsx)("div",{className:"flex items-center justify-center h-full text-xs",children:a.client?.name?.charAt(0)??"U"})}),(0,b.jsx)("span",{children:a.client?.name})]}),(0,b.jsxs)("div",{className:"w-2/12",children:[a.currency," ",a.amount?.toFixed(2)]}),(0,b.jsx)("div",{className:"w-2/12",children:a.paymentGateway?.name??"--"}),(0,b.jsx)("div",{className:"w-2/12",children:new Date(a.paymentDate).toLocaleDateString("en-GB")}),(0,b.jsx)("div",{className:"w-1/12",children:"COMPLETED"===a.status?(0,b.jsx)("span",{className:"text-green-600",children:"â— Paid"}):(0,b.jsx)("span",{className:"text-yellow-600",children:a.status})}),(0,b.jsx)("div",{className:"w-10 text-center",children:(0,b.jsxs)(u.DropdownMenu,{modal:!1,children:[(0,b.jsx)(u.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(k.MoreHorizontal,{size:16})})}),(0,b.jsxs)(u.DropdownMenuContent,{align:"end",sideOffset:6,className:"z-[30000]",children:[(0,b.jsx)(u.DropdownMenuItem,{onClick:()=>l(a),children:"View"}),(0,b.jsx)(u.DropdownMenuItem,{onClick:()=>n(a),children:"Edit"}),(0,b.jsxs)(u.DropdownMenuItem,{className:"text-red-600",onClick:()=>{confirm("Delete this payment?")&&fetch(`${Z}/api/payments/${a.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}).then(()=>f(b=>b.filter(b=>b.id!==a.id)))},children:[(0,b.jsx)(R.Trash2,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},a.id))]})}),(0,b.jsx)(V,{open:!!j,payment:j,onClose:()=>l(null)}),(0,b.jsx)(X,{open:!!m,payment:m,onClose:()=>n(null),onUpdated:o})]})]})}function _({open:a,onClose:c,invoiceNumber:d,onCreated:e}){let[f,g]=(0,y.useState)({creditNoteNumber:"",creditNoteDate:"",currency:"USD",adjustment:"",adjustmentPositive:!1,tax:"",amount:"",notes:""}),[h,i]=(0,y.useState)(null),[j,k]=(0,y.useState)(!1);if(!a)return null;let l=async()=>{if(!d)return;let a=new FormData;a.append("creditNote",JSON.stringify({...f,adjustment:Number(f.adjustment),tax:Number(f.tax),amount:Number(f.amount)})),h&&a.append("file",h),k(!0);try{await fetch(`https://6jnqmj85-80.inc1.devtunnels.ms/api/invoices/${d}/credit-notes`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:a}),e(),c()}catch(a){alert("Failed to create credit note")}finally{k(!1)}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-[30000]",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:c}),(0,b.jsxs)("div",{className:"absolute right-0 top-0 h-full w-[83vw] bg-white shadow-xl transition-all",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold",children:["Create Credit Note â€” ",d]}),(0,b.jsx)("button",{onClick:c,children:(0,b.jsx)(z.X,{})})]}),(0,b.jsxs)("div",{className:"p-6 grid grid-cols-3 gap-4",children:[[["Credit Note No","creditNoteNumber"],["Date","creditNoteDate","date"],["Currency","currency"],["Adjustment","adjustment"],["Tax","tax"],["Amount","amount"]].map(([a,c,d])=>(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm",children:a}),(0,b.jsx)("input",{type:d||"text",className:"w-full border px-3 py-2 rounded",value:f[c],onChange:a=>g(b=>({...b,[c]:a.target.value}))})]},c)),(0,b.jsxs)("div",{className:"col-span-3",children:[(0,b.jsx)("label",{className:"text-sm",children:"Notes"}),(0,b.jsx)("textarea",{className:"w-full border rounded p-3",rows:3,onChange:a=>g(b=>({...b,notes:a.target.value}))})]}),(0,b.jsxs)("div",{className:"col-span-3",children:[(0,b.jsx)("label",{className:"text-sm",children:"Upload File"}),(0,b.jsx)("input",{type:"file",onChange:a=>i(a.target.files?.[0]||null)})]})]}),(0,b.jsxs)("div",{className:"p-4 border-t flex justify-end gap-3",children:[(0,b.jsx)("button",{onClick:c,className:"border px-4 py-2 rounded",children:"Cancel"}),(0,b.jsx)("button",{disabled:j,onClick:l,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Create"})]})]})]})}function aa({open:a,onClose:c,invoiceNumber:d}){let[e,f]=(0,y.useState)([]),[g,h]=(0,y.useState)(!1);return((0,y.useEffect)(()=>{a&&d&&(async()=>{h(!0);let a=await fetch(`https://6jnqmj85-80.inc1.devtunnels.ms/api/invoices/${d}/credit-notes`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});f(await a.json()),h(!1)})()},[a,d]),a)?(0,b.jsxs)("div",{className:"fixed inset-0 z-[30000]",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:c}),(0,b.jsxs)("div",{className:"absolute right-0 top-0 h-full w-[83vw] bg-white shadow-xl",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold",children:["Credit Notes â€” ",d]}),(0,b.jsx)("button",{onClick:c,children:(0,b.jsx)(z.X,{})})]}),(0,b.jsx)("div",{className:"p-6",children:g?"Loading...":(0,b.jsxs)("table",{className:"w-full border",children:[(0,b.jsx)("thead",{className:"bg-gray-100",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"p-2",children:"CN No"}),(0,b.jsx)("th",{children:"Amount"}),(0,b.jsx)("th",{children:"Date"}),(0,b.jsx)("th",{children:"Notes"}),(0,b.jsx)("th",{children:"File"})]})}),(0,b.jsx)("tbody",{children:e.map(a=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"p-2",children:a.creditNoteNumber}),(0,b.jsxs)("td",{children:[a.currency," ",a.amount]}),(0,b.jsx)("td",{children:a.creditNoteDate}),(0,b.jsx)("td",{children:a.notes}),(0,b.jsx)("td",{children:a.fileUrl&&(0,b.jsx)("button",{onClick:()=>window.open(a.fileUrl),children:(0,b.jsx)(r.FileText,{size:16})})})]},a.id))})]})})]})]}):null}a.s(["default",()=>_],707251),a.s(["default",()=>aa],859041)}];

//# sourceMappingURL=src_app_%28dashboard%29_finance_invoices_components_InvoiceFilters_tsx_56105f55._.js.map