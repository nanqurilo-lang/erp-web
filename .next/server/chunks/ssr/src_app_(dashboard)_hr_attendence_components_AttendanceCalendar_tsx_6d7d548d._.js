module.exports=[715396,a=>{"use strict";a.s(["default",()=>v],715396);var b=a.i(187924),c=a.i(972596),d=a.i(362495),e=a.i(572131),f=a.i(50944);let g="https://6jnqmj85-80.inc1.devtunnels.ms";function h({open:a,onClose:c}){let[d,h]=(0,e.useState)(!1),[k,l]=(0,e.useState)("MONTH"),[m,n]=(0,e.useState)([]),[o,p]=(0,e.useState)([]),[q,r]=(0,e.useState)(!1),s=(0,f.useRouter)(),[t,u]=(0,e.useState)({employeeId:"",year:new Date().getFullYear(),month:new Date().getMonth()+1,clockInTime:"09:00",clockOutTime:"17:00",clockInLocation:"Office",clockOutLocation:"Office",clockInWorkingFrom:"Office",clockOutWorkingFrom:"Office",late:!1,halfDay:!1,overwrite:!1});if((0,e.useEffect)(()=>{a&&(async()=>{let a=localStorage.getItem("accessToken");if(!a)return;let b=await fetch(`${g}/employee/all`,{headers:{Authorization:`Bearer ${a}`}});b.ok&&p((await b.json()).filter(a=>a.active))})()},[a]),!a)return null;let v=async()=>{if(!t.employeeId)return void alert("Please select employee");if("DATE"===k&&!m.length)return void alert("Please select date");h(!0);try{let a=localStorage.getItem("accessToken");if(!a)throw Error("Unauthorized");let b={clockInTime:t.clockInTime,clockInLocation:t.clockInLocation,clockInWorkingFrom:t.clockInWorkingFrom,clockOutTime:t.clockOutTime,clockOutLocation:t.clockOutLocation,clockOutWorkingFrom:t.clockOutWorkingFrom,late:t.late,halfDay:t.halfDay},d="",e={};if("DATE"===k?(d=`${g}/employee/attendance/mark`,e={employeeIds:[t.employeeId],dates:m,payload:b,overwrite:t.overwrite,markedBy:t.employeeId}):(d=`${g}/employee/attendance/mark/month`,e={year:t.year,month:t.month,employeeIds:[t.employeeId],payload:b,overwrite:t.overwrite,markedBy:t.employeeId}),!(await fetch(d,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to mark attendance");s.push("/hr/attendence"),c()}catch(a){alert(a.message)}finally{h(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:(0,b.jsxs)("div",{className:"bg-white w-full max-w-3xl rounded-xl shadow-lg",children:[(0,b.jsxs)("div",{className:"flex justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h2",{className:"font-semibold",children:"Mark Attendance"}),(0,b.jsx)("button",{onClick:c,children:"Ã—"})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Employee *"}),(0,b.jsx)("button",{onClick:()=>r(!q),className:"w-full mt-1 border rounded-lg px-3 py-2 text-left",children:t.employeeId?o.find(a=>a.employeeId===t.employeeId)?.name:"Select employee"}),q&&(0,b.jsx)("div",{className:"absolute z-50 w-full bg-white border rounded-lg shadow mt-1 max-h-60 overflow-y-auto",children:o.map(a=>(0,b.jsxs)("div",{onClick:()=>{u({...t,employeeId:a.employeeId}),r(!1)},className:"px-3 py-2 hover:bg-gray-100 cursor-pointer flex gap-2",children:[a.profilePictureUrl?(0,b.jsx)("img",{src:a.profilePictureUrl,className:"w-6 h-6 rounded-full"}):(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs",children:a.name[0]}),(0,b.jsx)("span",{children:a.name})]},a.employeeId))})]}),(0,b.jsxs)("div",{className:"flex gap-6 text-sm",children:[(0,b.jsx)("span",{className:"font-medium",children:"Mark Attendance by"}),(0,b.jsxs)("label",{children:[(0,b.jsx)("input",{type:"radio",checked:"MONTH"===k,onChange:()=>l("MONTH")})," ","Month"]}),(0,b.jsxs)("label",{children:[(0,b.jsx)("input",{type:"radio",checked:"DATE"===k,onChange:()=>l("DATE")})," ","Date"]})]}),"MONTH"===k&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(i,{label:"Year",children:(0,b.jsx)("input",{type:"number",value:t.year,onChange:a=>u({...t,year:+a.target.value}),className:"input border rounded-xl py-2 px-4"})}),(0,b.jsx)(i,{label:"Month",children:(0,b.jsx)("select",{value:t.month,onChange:a=>u({...t,month:+a.target.value}),className:"input border rounded-xl py-2 px-4",children:Array.from({length:12}).map((a,c)=>(0,b.jsx)("option",{value:c+1,children:new Date(0,c).toLocaleString("default",{month:"long"})},c))})})]}),"DATE"===k&&(0,b.jsx)(i,{label:"Select Date",children:(0,b.jsx)("input",{type:"date",onChange:a=>n([a.target.value]),className:"input border rounded-xl py-2 px-4"})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(i,{label:"Clock In",children:(0,b.jsx)("input",{type:"time",value:t.clockInTime,onChange:a=>u({...t,clockInTime:a.target.value}),className:"input border rounded-xl py-2 px-4"})}),(0,b.jsx)(i,{label:"Clock Out",children:(0,b.jsx)("input",{type:"time",value:t.clockOutTime,onChange:a=>u({...t,clockOutTime:a.target.value}),className:"input border rounded-xl py-2 px-4"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(j,{label:"Late",value:t.late,onChange:a=>u({...t,late:a})}),(0,b.jsx)(j,{label:"Half Day",value:t.halfDay,onChange:a=>u({...t,halfDay:a})})]}),(0,b.jsxs)("label",{className:"flex gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:t.overwrite,onChange:a=>u({...t,overwrite:a.target.checked})}),"Attendance Overwrite"]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-4 px-6 py-4 border-t",children:[(0,b.jsx)("button",{onClick:c,className:"border px-4 py-2 rounded",children:"Cancel"}),(0,b.jsx)("button",{onClick:v,disabled:d,className:"bg-blue-600 text-white px-6 py-2 rounded",children:d?"Saving...":"Update"})]})]})})}let i=({label:a,children:c})=>(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("label",{className:"text-xs text-gray-600",children:a}),c]}),j=({label:a,value:c,onChange:d})=>(0,b.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,b.jsx)("span",{children:a}),(0,b.jsxs)("label",{children:[(0,b.jsx)("input",{type:"radio",checked:c,onChange:()=>d(!0)})," Yes"]}),(0,b.jsxs)("label",{children:[(0,b.jsx)("input",{type:"radio",checked:!c,onChange:()=>d(!1)})," No"]})]}),k="https://6jnqmj85-80.inc1.devtunnels.ms";function l({open:a,onClose:c,data:d,onUpdated:f}){let[g,h]=(0,e.useState)(!1),[i,j]=(0,e.useState)(!1),[l,q]=(0,e.useState)("view");if(!a||!d)return null;let r=d.employeeId,s=d.date,t=async()=>{if(confirm("Are you sure you want to delete this attendance?"))try{j(!0);let a=localStorage.getItem("accessToken");await fetch(`${k}/employee/attendance/delete?employeeId=${r}&date=${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),c(),f?.()}catch{alert("Failed to delete attendance")}finally{j(!1)}},u=a=>a?new Date(`1970-01-01T${a}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--",v=d.clockInTime&&d.clockOutTime?function(a,b){let c=new Date(`1970-01-01T${a}`),d=(new Date(`1970-01-01T${b}`).getTime()-c.getTime())/1e3,e=Math.floor(d/3600),f=Math.floor(d%3600/60);return`${e}h ${f}m`}(d.clockInTime,d.clockOutTime):"â€”";return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:(0,b.jsxs)("div",{className:"bg-white w-full max-w-4xl rounded-xl shadow-lg relative",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center px-6 py-4 border-b",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"view"===l?"Attendance Details":"Edit Attendance"}),(0,b.jsxs)("div",{className:"flex items-center gap-3 relative",children:["view"===l&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>h(a=>!a),className:"text-xl px-2 hover:bg-gray-100 rounded",children:"â‹®"}),g&&(0,b.jsxs)("div",{className:"absolute right-0 top-10 w-32 bg-white border rounded-lg shadow-md z-10",children:[(0,b.jsx)("button",{onClick:()=>{h(!1),q("edit")},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"âœ Edit"}),(0,b.jsx)("button",{onClick:t,disabled:i,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50",children:"ðŸ—‘ Delete"})]})]}),(0,b.jsx)("button",{onClick:c,className:"text-2xl",children:"Ã—"})]})]}),"view"===l?(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6 p-6",children:[(0,b.jsxs)("div",{className:"border rounded-lg p-4 space-y-4",children:[(0,b.jsxs)("h3",{className:"font-medium",children:["Date â€“ ",d.date," (",new Date(d.date).toLocaleDateString("en-US",{weekday:"long"}),")"]}),(0,b.jsx)(n,{label:"Clock In",value:u(d.clockInTime)}),(0,b.jsx)("div",{className:"flex justify-center py-6",children:(0,b.jsx)("div",{className:"w-32 h-32 rounded-full border-4 border-blue-500 flex items-center justify-center text-lg font-semibold",children:v})}),(0,b.jsx)(n,{label:"Clock Out",value:u(d.clockOutTime)})]}),(0,b.jsxs)("div",{className:"border rounded-lg p-4 space-y-6",children:[(0,b.jsx)(o,{title:"Clock In",time:u(d.clockInTime),location:d.clockInLocation,workingFrom:d.clockInWorkingFrom,late:d.late}),(0,b.jsx)(o,{title:"Clock Out",time:d.clockOutTime?u(d.clockOutTime):"Did not clock out",location:d.clockOutLocation,workingFrom:d.clockOutWorkingFrom}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2 text-sm",children:[d.holiday&&p("Holiday","â­"),d.leave&&p("Leave","â›”"),d.late&&p("Late","â°"),d.halfDay&&p("Half Day","Â½"),d.isPresent&&p("Present","âœ”")]})]})]}):(0,b.jsx)(m,{data:d,onCancel:()=>q("view"),onSaved:()=>{q("view"),f?.(),c()}})]})})}function m({data:a,onCancel:c,onSaved:d}){let[f,g]=(0,e.useState)(!1),[h,i]=(0,e.useState)({clockInTime:a.clockInTime||"",clockInLocation:a.clockInLocation||"",clockInWorkingFrom:a.clockInWorkingFrom||"",clockOutTime:a.clockOutTime||"",clockOutLocation:a.clockOutLocation||"",clockOutWorkingFrom:a.clockOutWorkingFrom||"",late:!!a.late,halfDay:!!a.halfDay}),j=async()=>{try{g(!0);let b=localStorage.getItem("accessToken");await fetch(`${k}/employee/attendance/edit?employeeId=${a.employeeId}&date=${a.date}&overwrite=true&markedBy=ADMIN`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(h)}),d()}catch{alert("Failed to update attendance")}finally{g(!1)}};return(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(q,{label:"Clock In Time",type:"time",value:h.clockInTime,onChange:a=>i({...h,clockInTime:a})}),(0,b.jsx)(q,{label:"Clock Out Time",type:"time",value:h.clockOutTime,onChange:a=>i({...h,clockOutTime:a})}),(0,b.jsx)(q,{label:"Clock In Location",value:h.clockInLocation,onChange:a=>i({...h,clockInLocation:a})}),(0,b.jsx)(q,{label:"Clock Out Location",value:h.clockOutLocation,onChange:a=>i({...h,clockOutLocation:a})}),(0,b.jsx)(q,{label:"Working From (In)",value:h.clockInWorkingFrom,onChange:a=>i({...h,clockInWorkingFrom:a})}),(0,b.jsx)(q,{label:"Working From (Out)",value:h.clockOutWorkingFrom,onChange:a=>i({...h,clockOutWorkingFrom:a})})]}),(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:h.late,onChange:a=>i({...h,late:a.target.checked})}),"Late"]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:h.halfDay,onChange:a=>i({...h,halfDay:a.target.checked})}),"Half Day"]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,b.jsx)("button",{onClick:c,className:"px-4 py-2 border rounded",children:"Cancel"}),(0,b.jsx)("button",{onClick:j,disabled:f,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Save Changes"})]})]})}let n=({label:a,value:c})=>(0,b.jsxs)("div",{className:"bg-gray-50 border rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:a}),(0,b.jsx)("div",{className:"font-medium",children:c})]}),o=({title:a,time:c,location:d,workingFrom:e,late:f})=>(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a}),(0,b.jsxs)("div",{className:"text-sm text-gray-600 flex gap-3 items-center",children:["â± ",c,d&&(0,b.jsxs)(b.Fragment,{children:["ðŸ“ ",d]}),e&&(0,b.jsxs)(b.Fragment,{children:["(",e,")"]}),f&&(0,b.jsx)("span",{className:"text-red-500",children:"âš  Late"})]})]}),p=(a,c)=>(0,b.jsxs)("span",{className:"flex items-center gap-1 px-2 py-1 border rounded text-xs",children:[c," ",a]});function q({label:a,value:c,onChange:d,type:e="text"}){return(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-500",children:a}),(0,b.jsx)("input",{type:e,value:c,onChange:a=>d(a.target.value),className:"w-full border rounded px-3 py-2"})]})}let r="https://6jnqmj85-80.inc1.devtunnels.ms",s=`${r}/employee/attendance/GetAllAttendance`,t=async a=>{let b=localStorage.getItem("accessToken");if(!b)throw Error("No token");let c=await fetch(`${r}/employee/attendance/GetAllAttendance`,{headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error("Failed to fetch attendance");return c.json()},u={PRESENT:(0,b.jsx)("span",{className:"text-green-600",children:"âœ”"}),HOLIDAY:(0,b.jsx)("span",{className:"text-yellow-500",children:"â˜…"}),LEAVE:(0,b.jsx)("span",{className:"text-red-500",children:"â›”"}),ABSENT:(0,b.jsx)("span",{className:"text-gray-400",children:"â€”"})};function v(){let a=new Date,[f,g]=(0,e.useState)(a.getMonth()+1),[i,j]=(0,e.useState)(a.getFullYear()),[k,m]=(0,e.useState)(!1),[n,o]=(0,e.useState)(null),[p,q]=(0,e.useState)(!1),{data:r,isLoading:v}=(0,c.default)(s,t,{revalidateOnFocus:!1});(0,e.useEffect)(()=>{},[k]);let w=(0,e.useMemo)(()=>{let a={};return r?.forEach(b=>{a[b.employeeId]||(a[b.employeeId]={employeeName:b.employeeName,profilePictureUrl:b.profilePictureUrl,records:{}}),a[b.employeeId].records[b.date]=b}),a},[r]),x=new Date(i,f,0).getDate();return v?(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Loading attendanceâ€¦"}):(0,b.jsxs)("div",{className:"bg-white border rounded-lg p-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded text-sm",children:"+ Mark Attendance"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("select",{value:f,onChange:a=>g(Number(a.target.value)),className:"border rounded px-4 py-2",children:Array.from({length:12}).map((a,c)=>(0,b.jsx)("option",{value:c+1,children:new Date(0,c).toLocaleString("default",{month:"long"})},c))}),(0,b.jsx)("select",{value:i,onChange:a=>j(Number(a.target.value)),className:"border rounded px-4 py-2",children:[2025,2026,2027,2028].map(a=>(0,b.jsx)("option",{children:a},a))})]})]}),(0,b.jsxs)("div",{className:"flex gap-4 text-xs text-gray-600",children:[(0,b.jsx)("span",{children:"â˜… Holiday"}),(0,b.jsx)("span",{children:"âœ” Present"}),(0,b.jsx)("span",{children:"â›” Leave"}),(0,b.jsx)("span",{children:"â° Late"}),(0,b.jsx)("span",{children:"Â½ Half Day"})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full border text-xs",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-3 py-2 text-left",children:"Employee"}),Array.from({length:x}).map((a,c)=>(0,b.jsx)("th",{className:"px-2 py-2 text-center",children:c+1},c)),(0,b.jsx)("th",{className:"px-3 py-2",children:"Total"})]})}),(0,b.jsx)("tbody",{children:Object.entries(w).map(([a,c])=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsxs)("td",{className:"px-3 py-2 font-medium flex items-center gap-2",children:[c.profilePictureUrl&&(0,b.jsx)("img",{src:c.profilePictureUrl,className:"w-6 h-6 rounded-full",alt:""}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:c.employeeName}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500",children:a})]})]}),Array.from({length:x}).map((a,d)=>{let e=String(d+1).padStart(2,"0"),g=`${i}-${String(f).padStart(2,"0")}-${e}`,h=c.records[g];return(0,b.jsx)("td",{className:"px-2 py-2 text-center",children:h?(0,b.jsxs)("button",{onClick:()=>{o(h),q(!0)},className:"flex flex-col items-center text-xs hover:scale-110 transition",children:[u[h.status],h.late&&(0,b.jsx)("span",{children:"â°"}),h.halfDay&&(0,b.jsx)("span",{children:"Â½"})]}):"--"},d)}),(0,b.jsxs)("td",{className:"px-3 py-2 text-center font-semibold",children:[Object.values(c.records).filter(a=>"PRESENT"===a.status&&a.date.startsWith(`${i}-${String(f).padStart(2,"0")}`)).length,"/",x]})]},a))})]})}),(0,b.jsx)(h,{open:k,onClose:()=>{m(!1),(0,d.mutate)(s)}}),(0,b.jsx)(l,{open:p,onClose:()=>q(!1),data:n})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_hr_attendence_components_AttendanceCalendar_tsx_6d7d548d._.js.map