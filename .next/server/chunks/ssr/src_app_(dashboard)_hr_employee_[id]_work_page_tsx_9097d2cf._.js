module.exports=[657160,a=>{"use strict";a.s(["default",()=>D],657160);var b=a.i(187924),c=a.i(572131),d=a.i(699570),e=a.i(866718),f=a.i(580701),g=a.i(206015),h=a.i(335732),i=a.i(613749),j=a.i(50522),k=a.i(879360),l=a.i(177156),m=a.i(510448),n=a.i(781560),o=a.i(369012),p=a.i(633508);let q="https://6jnqmj85-80.inc1.devtunnels.ms",r=["IN_PROGRESS","NOT_STARTED","ON_HOLD","CANCELLED","FINISHED"],s="projectProgressOverrides";function t({employeeId:a}){let[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)("all"),[F,G]=(0,c.useState)("all"),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)("all"),[P,Q]=(0,c.useState)("all"),[R,S]=(0,c.useState)("all"),[T,U]=(0,c.useState)(1),[V,W]=(0,c.useState)(1),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(""),[_,aa]=(0,c.useState)(""),[ab,ac]=(0,c.useState)(""),[ad,ae]=(0,c.useState)(""),[af,ag]=(0,c.useState)(!1),[ah,ai]=(0,c.useState)("none"),[aj,ak]=(0,c.useState)("none"),[al,am]=(0,c.useState)("none"),[an,ao]=(0,c.useState)(""),[ap,aq]=(0,c.useState)(!0),[ar,as]=(0,c.useState)(""),[at,au]=(0,c.useState)(null),[av,aw]=(0,c.useState)("USD"),[ax,ay]=(0,c.useState)(""),[az,aA]=(0,c.useState)(""),[aB,aC]=(0,c.useState)(!1),aD=(0,c.useRef)(null),[aE,aF]=(0,c.useState)("you"),[aG,aH]=(0,c.useState)(!1),[aI,aJ]=(0,c.useState)(!1),[aK,aL]=(0,c.useState)([]),[aM,aN]=(0,c.useState)(!1),[aO,aP]=(0,c.useState)(""),[aQ,aR]=(0,c.useState)(!1),[aS,aT]=(0,c.useState)([]),[aU,aV]=(0,c.useState)(!1),[aW,aX]=(0,c.useState)([]),[aY,aZ]=(0,c.useState)(!1),[a$,a_]=(0,c.useState)(!1),[a0,a1]=(0,c.useState)(null),[a2,a3]=(0,c.useState)("grid"),[a4,a5]=(0,c.useState)(!1),[a6,a7]=(0,c.useState)(!1),[a8,a9]=(0,c.useState)(!1);(0,c.useEffect)(()=>{document.body.style.overflow=L||X||aI||a$||a8?"hidden":"auto"},[L,X,aI,a$,a8]);let ba=Array.from(new Set(t.map(a=>a.name))).filter(Boolean),bb=Array.from(new Set(t.flatMap(a=>(a.assignedEmployees||[]).map(a=>a.name)))).filter(Boolean),bc=aK.map(a=>({id:String(a.id),name:a.name})),bd=aS.map(a=>({id:String(a.id),name:a.name})),be=aW.map(a=>({id:String(a.id),name:a.departmentName})),bf=()=>{try{let a=localStorage.getItem(s);if(!a)return{};return JSON.parse(a)}catch{return{}}},bg=(a,b)=>{let c=bf(),d=String(a);null==b?delete c[d]:c[d]=b;try{localStorage.setItem(s,JSON.stringify(c))}catch{}},bh=(0,c.useCallback)(async b=>{w(!0);try{let c=b||x||null;if(!c){u([]),W(1),w(!1);return}new URLSearchParams({page:String(T),limit:String(9),search:B||"",status:"all"!==D?D:"",progress:"all"!==F?F:"",project:"all"!==N?N:"",member:"all"!==P?P:"",client:"all"!==R?R:""});let d=await fetch(`${q}/api/projects/employee/${a}`,{headers:{Authorization:`Bearer ${c}`},cache:"no-store"});if(401===d.status){try{localStorage.removeItem("accessToken")}catch{}y(null),u([]),W(1),w(!1);return}if(!d.ok){let a=await d.text().catch(()=>"");throw console.error("getProjects failed",d.status,a),Error("Failed to load projects")}let e=await d.json(),f=[];Array.isArray(e)?f=e:(f=e.projects||e.items||[],W(e.totalPages||Math.max(1,Math.ceil((e.total||9)/9))));let g=bf();Object.keys(g).length>0&&(f=f.map(a=>{let b=g[String(a.id)];return null!=b?{...a,progressPercent:b}:a})),u(f)}catch(a){console.error("Error loading projects:",a),u([]),W(1)}finally{w(!1)}},[T,B,D,F,N,P,R,x]),bi=(0,c.useCallback)(async a=>{aN(!0);try{let b=a||x||null,c=await fetch(`${q}/api/projects/category`,{headers:b?{Authorization:`Bearer ${b}`}:void 0,cache:"no-store"});if(!c.ok){console.warn("Failed to load categories, status:",c.status),aL([]),aN(!1);return}let d=await c.json();Array.isArray(d)?d.length>0&&"string"==typeof d[0]?aL(d.map((a,b)=>({id:b+1,name:String(a)}))):aL(d.map(a=>({id:a.id??a.name??Math.random(),name:a.name??String(a)}))):aL([])}catch(a){console.error("Error loading categories:",a),aL([])}finally{aN(!1)}},[x]),bj=async()=>{aJ(!0),await bi()},bk=()=>{aJ(!1),aP("")},bl=async()=>{let a=aO.trim();if(!a)return alert("Category name required");aR(!0);let b=aK.slice(),c={id:`temp-${Date.now()}`,name:a};aL(a=>[...a,c]);try{let d=x||null,e=await fetch(`${q}/api/projects/category`,{method:"POST",headers:{"Content-Type":"application/json",...d?{Authorization:`Bearer ${d}`}:{}},body:JSON.stringify({name:a}),cache:"no-store"});if(!e.ok){let a=await e.text().catch(()=>"");console.error("Add category failed",e.status,a),aL(b),alert("Failed to add category");return}let f=await e.json().catch(()=>null);if(f&&(f.id||f.name))aL(b=>b.map(b=>b.id===c.id?{id:f.id??f.name??Math.random(),name:f.name??a}:b)),ai(String(f.id??f.name??a));else{await bi();let b=aK.find(b=>b.name===a);b&&ai(String(b.id))}aP("")}catch(a){console.error("Add category error:",a),aL(b),alert("Failed to add category")}finally{aR(!1)}},bm=async a=>{if(!confirm("Delete this category?"))return;let b=aK.slice();aL(b=>b.filter(b=>b.id!==a));try{let b=x||null;if(!(await fetch(`${q}/api/projects/category/${encodeURIComponent(String(a))}`,{method:"DELETE",headers:b?{Authorization:`Bearer ${b}`}:void 0,cache:"no-store"})).ok)throw Error("Delete failed")}catch(a){console.error("Delete category failed:",a),aL(b),alert("Failed to delete category")}};async function bn(a,b){if(!x)return alert("Not authenticated");u(c=>c.map(c=>c.id===a?{...c,projectStatus:b}:c));try{let c=new FormData;c.append("status",b);let d=await fetch(`${q}/api/projects/${a}/status`,{method:"PUT",body:c,headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),e=null;try{e=await d.json()}catch{e=null}e&&e.id?(u(a=>a.map(a=>a.id===e.id?{...a,...e}:a)),null!=e.progressPercent&&bg(e.id,null)):await bh(x)}catch(a){console.error("Status update failed",a),u(t),alert("Failed to update status on server")}}async function bo(a,b){if(!x)return alert("Not authenticated");let c=Math.max(0,Math.min(100,Math.round(b)));u(b=>b.map(b=>b.id===a?{...b,progressPercent:c}:b)),bg(a,c);try{let b=new FormData;b.append("percent",String(c));let d=await fetch(`${q}/api/projects/${a}/progress`,{method:"PUT",body:b,headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(401===d.status){console.error("patchProgress 401 unauthorized"),u(t),bg(a,null),localStorage.removeItem("accessToken"),y(null),alert("Session expired. Please login again.");return}if(!d.ok){let b=await d.text().catch(()=>"");console.error("patchProgress failed:",d.status,b),u(t),bg(a,null),alert("Failed to update progress on server");return}let e=null;try{e=204!==d.status?await d.json():null}catch{e=null}e&&e.id?(u(a=>a.map(a=>a.id===e.id?{...a,...e}:a)),null!=e.progressPercent&&bg(e.id,null)):await bh(x)}catch(b){console.error("Progress update failed:",b),u(t),bg(a,null),alert("Failed to update progress on server")}}(0,c.useCallback)(async a=>{aV(!0);try{let b=a||x||null,c=await fetch(`${q}/clients`,{headers:b?{Authorization:`Bearer ${b}`}:void 0,cache:"no-store"});if(!c.ok){console.warn("Failed to load clients, status:",c.status),aT([]),aV(!1);return}let d=await c.json();Array.isArray(d)?aT(d):Array.isArray(d.items)?aT(d.items):aT([])}catch(a){console.error("Error loading clients:",a),aT([])}finally{aV(!1)}},[x]),(0,c.useCallback)(async a=>{aZ(!0);try{let b=a||x||null,c=await fetch(`${q}/admin/departments`,{headers:b?{Authorization:`Bearer ${b}`}:void 0,cache:"no-store"});if(!c.ok){console.warn("Failed to load departments, status:",c.status),aX([]),aZ(!1);return}let d=await c.json();Array.isArray(d)?aX(d):Array.isArray(d.items)?aX(d.items):aX([])}catch(a){console.error("Error loading departments:",a),aX([])}finally{aZ(!1)}},[x]),(0,c.useEffect)(()=>{let a=setTimeout(()=>{C(a=>a!==z?(U(1),z):a)},500);return()=>clearTimeout(a)},[z]),(0,c.useEffect)(()=>{},[]),(0,c.useEffect)(()=>{x&&bh(x)},[bh,x,T,B,D,F,N,P,R]);let bp=async a=>{if(confirm("Delete this project?")){u(b=>b.filter(b=>b.id!==a));try{if(!(await fetch(`${q}/api/projects/${a}`,{method:"DELETE",headers:{Authorization:x?`Bearer ${x}`:""},cache:"no-store"})).ok)throw Error("Delete failed");bg(a,null)}catch(a){console.error(a),u(t),alert("Failed to delete project")}}},bq=()=>{$(""),aa(""),ac(""),ae(""),ag(!1),ai("none"),ak("none"),am("none"),ao(""),aq(!0),as(""),au(null),aw("USD"),ay(""),aA(""),aC(!1),aF("you"),aH(!1)},br=async()=>{if(!_.trim())return alert("Project Name is required");aH(!0);try{let a=Z.trim();if(!a){let b=_.toString().normalize("NFKD").replace(/[\u0300-\u036F]/g,"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"");a=b?b.toUpperCase().replace(/-/g,"").slice(0,10):`PRJ${Date.now().toString().slice(-6)}`}let b=new FormData;b.append("shortCode",a),b.append("name",_),b.append("projectName",_),b.append("startDate",ab||""),af?b.append("deadline",""):b.append("deadline",ad||""),b.append("noDeadline",String(!!af)),b.append("category","none"===ah?"":String(ah)),b.append("department","none"===aj?"":String(aj)),b.append("clientId","none"===al?"":String(al)),b.append("summary",an||""),b.append("tasksNeedAdminApproval",String(!!ap));let c=Array.isArray(ar)?ar:String(ar||"").split(",").map(a=>a.trim()).filter(Boolean);b.append("assignedEmployeeIds",JSON.stringify(c)),at&&b.append("companyFile",at),b.append("currency",av||""),b.append("budget",""!==ax?String(ax):"0"),b.append("hoursEstimate",""!==az?String(az):"0"),b.append("allowManualTimeLogs",String(!!aB)),b.append("addedBy",String(aE||""));let d=x||null,e=await fetch(`${q}/api/projects`,{method:"POST",body:b,headers:d?{Authorization:`Bearer ${d}`}:void 0});if(!e.ok){let a=await e.text().catch(()=>"");console.error("Create project failed",e.status,a);let b=`Failed to create project (status ${e.status})`;try{let c=JSON.parse(a||"{}");c&&c.message&&(b=c.message)}catch{}alert(b),aH(!1);return}try{await e.json()}catch{}await bh(d),Y(!1),bq()}catch(a){console.error("Create project error",a),alert("Failed to create project")}finally{aH(!1)}},bs=()=>M(!1),bt=async()=>{U(1),await bh(x??null),M(!1)},bu=async()=>{O("all"),Q("all"),S("all"),U(1),await bh(x??null),M(!1)},bv=(0,c.useMemo)(()=>t.filter(a=>{if("all"!==D&&(!a.projectStatus||a.projectStatus!==D))return!1;if("all"!==F){if("number"!=typeof a.progressPercent)return!1;let b=a.progressPercent;if("0-33"===F&&!(b>=0&&b<=33)||"34-66"===F&&!(b>=34&&b<=66)||"67-100"===F&&!(b>=67&&b<=100))return!1}if(H||J){let b=a.startDate?new Date(a.startDate):null,c=a.deadline?new Date(a.deadline):null;if(!b||!c||H&&b<new Date(H)||J&&c>new Date(J))return!1}return!0}),[t,D,F,H,J]);if(v)return(0,b.jsx)("p",{className:"p-8 text-center",children:"Loading projects..."});let bw=({p:a})=>{let c=a.startDate?new Date(a.startDate).toLocaleDateString():"-",e=a.noDeadline?"No Deadline":a.deadline?new Date(a.deadline).toLocaleDateString():"-",f=Math.max(0,Math.min(100,a.progressPercent??0)),i=null==f?"bg-gray-300":f<33?"bg-red-500":f<66?"bg-yellow-400":"bg-green-500";return(0,b.jsxs)(g.TableRow,{className:"bg-white hover:bg-gray-50",children:[(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top w-28",children:(0,b.jsx)("div",{className:"text-sm font-medium",children:a.shortCode||a.code||a.projectCode||`RTA-${String(a.id).padStart(2,"0")}`})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top",children:(0,b.jsx)("div",{className:"font-medium",children:a.name})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top",children:(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsxs)("div",{className:"flex -space-x-2",children:[(a.assignedEmployees||[]).slice(0,3).map(a=>(0,b.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white overflow-hidden bg-gray-100",title:a.name,children:a.profileUrl?(0,b.jsx)("img",{src:a.profileUrl,alt:a.name,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-xs text-white bg-gray-400",children:(a.name||"U").charAt(0)})},a.employeeId)),(a.assignedEmployees||[]).length>3&&(0,b.jsxs)("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-gray-200 text-xs text-gray-700 flex items-center justify-center",children:["+",(a.assignedEmployees||[]).length-3]})]})})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top text-sm",children:c}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top text-sm",children:e}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:a.client?.profilePictureUrl?(0,b.jsx)("img",{src:a.client.profilePictureUrl,alt:a.client?.name,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"text-xs text-gray-500",children:(a.client?.name||"C").charAt(0)})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:a.client?.name??"Client"}),(0,b.jsx)("div",{className:"text-xs text-gray-400",children:a.client?.company??""})]})]})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top",children:(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("div",{className:"w-44 cursor-pointer",title:"Click to filter by this progress bucket",onClick:()=>{var b;null==(b=a.progressPercent??null)?G("all"):b<=33?G("0-33"):b<=66?G("34-66"):G("67-100"),U(1)},children:(0,b.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,b.jsx)("div",{className:`h-4 rounded-full ${i}`,style:{width:`${f}%`}}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,b.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[f,"%"]})})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("button",{className:`inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs ${function(a){switch(a){case"IN_PROGRESS":return"bg-green-600 text-white";case"NOT_STARTED":default:return"bg-gray-400 text-white";case"ON_HOLD":return"bg-yellow-500 text-white";case"CANCELLED":return"bg-red-600 text-white";case"FINISHED":return"bg-blue-600 text-white"}}(a.projectStatus)}`,title:"Click to filter by this status",onClick:()=>{E(a.projectStatus??"all"),U(1)},children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full",style:{background:function(a){switch(a){case"IN_PROGRESS":return"#10B981";case"NOT_STARTED":default:return"#9CA3AF";case"ON_HOLD":return"#F59E0B";case"CANCELLED":return"#EF4444";case"FINISHED":return"#3B82F6"}}(a.projectStatus)}}),(0,b.jsx)("span",{children:a.projectStatus??"N/A"})]}),(0,b.jsx)("div",{className:"relative",children:(0,b.jsxs)(h.DropdownMenu,{children:[(0,b.jsx)(h.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)("button",{className:"inline-flex items-center gap-1 px-2 py-1 border rounded text-sm bg-white hover:bg-gray-50",children:(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"▾"})})}),(0,b.jsxs)(h.DropdownMenuContent,{align:"start",className:"w-64 p-2",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Change status"}),(0,b.jsx)("div",{className:"space-y-1",children:r.map(c=>(0,b.jsx)("button",{onClick:()=>bn(a.id,c),className:`w-full text-left px-3 py-2 rounded text-sm hover:bg-gray-50 ${c===a.projectStatus?"font-medium":""}`,children:c},c))}),(0,b.jsx)(h.DropdownMenuSeparator,{}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-2 mb-1",children:"Adjust progress"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("input",{type:"range",min:0,max:100,value:a.progressPercent??0,onChange:b=>{let c=Number(b.target.value);u(b=>b.map(b=>b.id===a.id?{...b,progressPercent:c}:b))},onMouseUp:async b=>{let c=Number(b.target.value);await bo(a.id,c)},onTouchEnd:async b=>{let c=Number(b.target.value);await bo(a.id,c)},className:"w-full"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,b.jsx)("span",{children:"0%"}),(0,b.jsxs)("span",{children:[a.progressPercent??0,"%"]}),(0,b.jsx)("span",{children:"100%"})]})]}),(0,b.jsx)("div",{className:"flex justify-end mt-2",children:(0,b.jsx)(d.Button,{size:"sm",variant:"ghost",onClick:()=>bh(x??null),children:"Refresh"})})]})]})})]})]})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top text-right",children:(0,b.jsxs)(h.DropdownMenu,{children:[(0,b.jsx)(h.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(d.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,b.jsx)(k.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(h.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,b.jsxs)(h.DropdownMenuItem,{onClick:()=>window.location.assign(`/work/project/${a.id}`),children:[(0,b.jsx)(l.Eye,{className:"h-4 w-4 mr-2"})," View"]}),(0,b.jsxs)(h.DropdownMenuItem,{onClick:()=>{a1(a.id),a_(!0)},children:[(0,b.jsx)(m.Edit2,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,b.jsx)(h.DropdownMenuSeparator,{}),(0,b.jsxs)(h.DropdownMenuItem,{onClick:()=>bp(a.id),className:"text-red-600",children:[(0,b.jsx)(n.Trash2,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})})]},a.id)};return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("main",{className:"p-2",children:(0,b.jsxs)("div",{className:" p-6  overflow-y-auto overflow-x-hidden",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg border p-3 mb-4 flex items-center gap-4 overflow-y-auto overflow-x-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,b.jsx)(e.Input,{type:"date",value:H??"",onChange:a=>{I(a.target.value||null),U(1)},className:"w-40"}),(0,b.jsx)("span",{className:"text-gray-400 text-sm",children:"to"}),(0,b.jsx)(e.Input,{type:"date",value:J??"",onChange:a=>{K(a.target.value||null),U(1)},className:"w-40"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Status"}),(0,b.jsxs)(f.Select,{value:D,onValueChange:a=>{E(a),U(1)},children:[(0,b.jsx)(f.SelectTrigger,{className:"w-40",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(f.SelectItem,{value:"IN_PROGRESS",children:"In Progress"}),(0,b.jsx)(f.SelectItem,{value:"NOT_STARTED",children:"Not Started"}),(0,b.jsx)(f.SelectItem,{value:"ON_HOLD",children:"On Hold"}),(0,b.jsx)(f.SelectItem,{value:"CANCELLED",children:"Cancelled"}),(0,b.jsx)(f.SelectItem,{value:"FINISHED",children:"Finished"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Progress"}),(0,b.jsxs)(f.Select,{value:F,onValueChange:a=>{G(a),U(1)},children:[(0,b.jsx)(f.SelectTrigger,{className:"w-40",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(f.SelectItem,{value:"0-33",children:"0 - 33%"}),(0,b.jsx)(f.SelectItem,{value:"34-66",children:"34 - 66%"}),(0,b.jsx)(f.SelectItem,{value:"67-100",children:"67 - 100%"})]})]})]})]}),(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("div",{children:(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:()=>Y(!0),children:"+ Add Project"})})}),(0,b.jsxs)("div",{className:"bg-white rounded-lg border overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-blue-50 px-6 py-3 border-b flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"font-semibold text-gray-900",children:["Projects (",bv.length,")"]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:a4?"Viewing: Archived":a6?"Viewing: Pinned":"All active"})]}),(0,b.jsx)("div",{className:"overflow-auto p-4",children:(0,b.jsx)("div",{children:(0,b.jsxs)(g.Table,{children:[(0,b.jsx)(g.TableHeader,{children:(0,b.jsxs)(g.TableRow,{className:"bg-blue-50",children:[(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Code"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Project Name"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Members"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Start Date"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Deadline"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Client"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Status"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3 text-right",children:"Action"})]})}),(0,b.jsx)(g.TableBody,{children:0===bv.length?(0,b.jsx)(g.TableRow,{children:(0,b.jsx)(g.TableCell,{colSpan:8,className:"py-8 text-center text-gray-500",children:"No projects found"})}):bv.map(a=>(0,b.jsx)(bw,{p:a},a.id))})]})})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["Result per page -",bv.length?bv.length:0]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>{U(a=>Math.max(1,a-1))},disabled:1===T,children:[(0,b.jsx)(i.ChevronLeft,{})," Prev"]}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["Page ",T," of ",V]}),(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>{U(a=>Math.min(V,a+1))},disabled:T===V,children:["Next ",(0,b.jsx)(j.ChevronRight,{})]})]})]})]})}),(0,b.jsx)("div",{"aria-hidden":!L,onClick:bs,className:`fixed inset-0 transition-opacity duration-300 z-[9990] ${L?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,style:{backgroundColor:"rgba(0,0,0,0.3)"}}),(0,b.jsxs)("aside",{"aria-hidden":!L,className:`fixed right-0 top-0 h-full w-[360px] bg-white shadow-xl transform transition-transform duration-300 z-[9999] ${L?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Filter,{className:"w-5 h-5"}),(0,b.jsx)("h3",{className:"font-semibold",children:"Filters"})]}),(0,b.jsx)("button",{onClick:bs,className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(p.X,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-4 overflow-auto h-[calc(100%-140px)]",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Project"}),(0,b.jsxs)(f.Select,{value:N,onValueChange:a=>O(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),ba.map(a=>(0,b.jsx)(f.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Project Members"}),(0,b.jsxs)(f.Select,{value:P,onValueChange:a=>Q(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),bb.map(a=>(0,b.jsx)(f.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Client"}),(0,b.jsxs)(f.Select,{value:R,onValueChange:a=>S(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),bd.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]})]}),(0,b.jsxs)("div",{className:"p-4 border-t flex items-center justify-between gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:bu,children:"Reset"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Button,{variant:"ghost",onClick:bs,children:"Close"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:bt,children:"Apply"})]})]})]}),X&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-start justify-center pt-12 px-4 overflow-y-auto",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{Y(!1),bq()}}),(0,b.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Add Project"}),(0,b.jsx)("button",{onClick:()=>{Y(!1),bq()},className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(p.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,b.jsx)(e.Input,{value:Z,onChange:a=>$(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name *"}),(0,b.jsx)(e.Input,{value:_,onChange:a=>aa(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,b.jsx)(e.Input,{type:"date",value:ab,onChange:a=>ac(a.target.value)})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,b.jsx)(e.Input,{type:"date",value:ad,onChange:a=>ae(a.target.value),disabled:af})]}),(0,b.jsx)("div",{className:"pt-6",children:(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)("input",{type:"checkbox",checked:af,onChange:a=>ag(a.target.checked)}),(0,b.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Select,{value:ah,onValueChange:a=>ai(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),bc.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)(d.Button,{variant:"outline",onClick:bj,children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,b.jsxs)(f.Select,{value:aj,onValueChange:a=>ak(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),be.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,b.jsxs)(f.Select,{value:al,onValueChange:a=>am(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),bd.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,b.jsx)("textarea",{rows:4,value:an,onChange:a=>ao(a.target.value),className:"w-full p-2 border rounded"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"approval",checked:!0===ap,onChange:()=>aq(!0)}),(0,b.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"approval",checked:!1===ap,onChange:()=>aq(!1)}),(0,b.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Add Project Members *"}),(0,b.jsx)(e.Input,{placeholder:"Comma separated names",value:Array.isArray(ar)?ar.join(","):ar,onChange:a=>as(a.target.value)})]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,b.jsxs)("div",{onClick:()=>aD.current?.click(),className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[at?(0,b.jsx)("div",{children:at.name}):(0,b.jsx)("div",{children:"Choose File"}),(0,b.jsx)("input",{ref:aD,type:"file",className:"hidden",onChange:a=>au(a.target.files?.[0]??null)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,b.jsxs)(f.Select,{value:av,onValueChange:a=>aw(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"USD"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"USD",children:"USD $"}),(0,b.jsx)(f.SelectItem,{value:"USD",children:"USD ₹"}),(0,b.jsx)(f.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,b.jsx)(e.Input,{value:ax,onChange:a=>ay(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,b.jsx)(e.Input,{value:az,onChange:a=>aA(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:aB,onChange:a=>aC(a.target.checked)}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,b.jsxs)(f.Select,{value:aE,onValueChange:a=>aF(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-44",children:(0,b.jsx)(f.SelectValue,{placeholder:"You"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"you",children:"You"}),bb.map(a=>(0,b.jsx)(f.SelectItem,{value:a,children:a},a))]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{Y(!1),bq()},children:"Cancel"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:br,disabled:aG,children:aG?"Saving...":"Save"})]})]})]})]}),aI&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[11000] flex items-center justify-center px-4",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>bk()}),(0,b.jsxs)("div",{className:"relative w-full max-w-2xl bg-white rounded-lg shadow-2xl z-20 overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Project Category"}),(0,b.jsx)("button",{onClick:()=>bk(),className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(p.X,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[(0,b.jsx)("div",{className:"rounded border overflow-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left",children:[(0,b.jsx)("thead",{className:"bg-blue-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-2 text-sm",children:"#"}),(0,b.jsx)("th",{className:"px-4 py-2 text-sm",children:"Category Name"}),(0,b.jsx)("th",{className:"px-4 py-2 text-sm",children:"Action"})]})}),(0,b.jsx)("tbody",{children:aM?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"Loading..."})}):0===aK.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"No categories"})}):aK.map((a,c)=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm",children:c+1}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm",children:a.name}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100 text-red-600",onClick:()=>bm(a.id),title:"Delete",children:(0,b.jsx)(n.Trash2,{className:"w-4 h-4"})})})]},a.id))})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Category Name *"}),(0,b.jsx)(e.Input,{placeholder:"Enter category name",value:aO,onChange:a=>aP(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>bk(),children:"Cancel"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:bl,disabled:aQ,children:aQ?"Saving...":"Save"})]})]})]})]}),a$&&null!=a0&&(0,b.jsx)(function({projectId:a,onClose:g,onSaved:h}){let[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(""),[o,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[v,w]=(0,c.useState)(""),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)("none"),[C,D]=(0,c.useState)("none"),[E,F]=(0,c.useState)("none"),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(!0),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(null),O=(0,c.useRef)(null),[P,Q]=(0,c.useState)("USD"),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)("none"),[Z,$]=(0,c.useState)(0),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)("you"),ad=()=>{n(""),r(""),t(""),w(""),z(!1),B("none"),D("none"),F("none"),H(""),J(!0),L(""),N(null),Q("USD"),S(""),U(""),W(!1),Y("none"),$(0),aa(!1),ac("you")};(0,c.useEffect)(()=>{if(!a)return;let b=!0;return(async()=>{j(!0);try{let c=x||null,d=await fetch(`${q}/api/projects/${a}`,{headers:c?{Authorization:`Bearer ${c}`}:void 0,cache:"no-store"});if(!d.ok){let a=await d.text().catch(()=>"");console.error("Failed to fetch project",d.status,a),b&&alert("Failed to load project details");return}let e=await d.json();if(!b)return;n(e.shortCode??e.code??e.projectCode??""),r(e.name??""),t(e.startDate?e.startDate.split("T")[0]:e.startDate??""),w(e.deadline?e.deadline.split("T")[0]:e.deadline??""),z(!!e.noDeadline),B(e.category?String(e.category):"none"),D(e.department??"none"),F(e.client?.clientId?String(e.client.clientId):e.client?.name??e.client??"none"),H(e.summary??""),J(!!(e.tasksNeedAdminApproval??!0)),L(Array.isArray(e.assignedEmployees)?e.assignedEmployees.map(a=>a.name).join(","):e.members??""),Q(e.currency??"USD"),S(null!=e.budget?String(e.budget):""),U(null!=e.hoursEstimate?String(e.hoursEstimate):""),W(!!e.allowManualTimeLogs),Y(e.projectStatus??"none"),$(Number(e.progressPercent??0)),aa(!!e.calculateProgressThroughTasks),ac(e.addedBy??"you")}catch(a){console.error("Error loading project:",a),b&&alert("Failed to load project details")}finally{b&&j(!1)}})(),()=>{b=!1}},[a,x]);let ae=async()=>{if(a){if(!o.trim())return alert("Project name required");l(!0);try{let b=new FormData;m&&b.append("shortCode",m),b.append("name",o),s&&b.append("startDate",s),y?b.append("deadline",""):b.append("deadline",v||""),b.append("noDeadline",String(!!y)),b.append("category","none"===A?"":A),b.append("department","none"===C?"":C),b.append("clientId","none"===E?"":E),b.append("summary",G||""),b.append("tasksNeedAdminApproval",String(!!I));let c=Array.isArray(K)?K:String(K||"").split(",").map(a=>a.trim()).filter(Boolean);b.append("assignedEmployeeIds",JSON.stringify(c)),M&&b.append("companyFile",M),b.append("currency",P||""),b.append("budget",R||"0"),b.append("hoursEstimate",T||"0"),b.append("allowManualTimeLogs",String(!!V)),X&&"none"!==X&&b.append("projectStatus",String(X)),null==Z||Number.isNaN(Number(Z))||b.append("progressPercent",String(Math.max(0,Math.min(100,Math.round(Z||0))))),b.append("calculateProgressThroughTasks",String(!!_)),b.append("addedBy",String(ab||""));let d=x||null,e=await fetch(`${q}/api/projects/${a}`,{method:"PUT",body:b,headers:d?{Authorization:`Bearer ${d}`}:void 0});if(!e.ok){let a=await e.text().catch(()=>"");console.error("Update failed",e.status,a),alert("Failed to update project");return}let f=null;try{f=await e.json()}catch{f=null}f&&f.id?u(a=>a.map(a=>a.id===f.id?{...a,...f}:a)):await bh(d),h(),g(),ad()}catch(a){console.error("Update error:",a),alert("Failed to update project")}finally{l(!1)}}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-[12000] flex items-start justify-center pt-12 px-4 overflow-y-auto; ",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{g(),ad()}}),(0,b.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Update Project"}),(0,b.jsx)("button",{onClick:()=>{g(),ad()},className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(p.X,{className:"w-5 h-5"})})]}),(0,b.jsx)("div",{className:"p-6 space-y-6",children:i?(0,b.jsx)("p",{className:"p-4 text-center",children:"Loading project..."}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,b.jsx)(e.Input,{value:m,onChange:a=>n(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name  *"}),(0,b.jsx)(e.Input,{value:o,onChange:a=>r(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,b.jsx)(e.Input,{type:"date",value:s,onChange:a=>t(a.target.value)})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,b.jsx)(e.Input,{type:"date",value:v,onChange:a=>w(a.target.value),disabled:y})]}),(0,b.jsx)("div",{className:"pt-6",children:(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)("input",{type:"checkbox",checked:y,onChange:a=>z(a.target.checked)}),(0,b.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Select,{value:A,onValueChange:a=>B(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),bc.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)(d.Button,{variant:"outline",onClick:bj,children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,b.jsxs)(f.Select,{value:C,onValueChange:a=>D(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),be.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,b.jsxs)(f.Select,{value:E,onValueChange:a=>F(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),bd.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,b.jsx)("textarea",{rows:4,value:G,onChange:a=>H(a.target.value),className:"w-full p-2 border rounded"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"ucApproval",checked:!0===I,onChange:()=>J(!0)}),(0,b.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"ucApproval",checked:!1===I,onChange:()=>J(!1)}),(0,b.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Assigned to *"}),(0,b.jsx)(e.Input,{placeholder:"Comma separated names or ids",value:Array.isArray(K)?K.join(","):K,onChange:a=>L(a.target.value)})]}),(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Status"}),(0,b.jsxs)(f.Select,{value:X,onValueChange:a=>Y(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"Select status"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),(0,b.jsx)(f.SelectItem,{value:"IN_PROGRESS",children:"In Progress"}),(0,b.jsx)(f.SelectItem,{value:"NOT_STARTED",children:"Not Started"}),(0,b.jsx)(f.SelectItem,{value:"ON_HOLD",children:"On Hold"}),(0,b.jsx)(f.SelectItem,{value:"CANCELLED",children:"Cancelled"}),(0,b.jsx)(f.SelectItem,{value:"FINISHED",children:"Finished"})]})]})]}),(0,b.jsxs)("div",{className:"w-1/2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Progress Status"}),(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,b.jsx)("div",{className:`h-4 rounded-full ${null==Z?"bg-gray-300":Z<33?"bg-red-500":Z<66?"bg-yellow-400":"bg-green-500"}`,style:{width:`${Math.max(0,Math.min(100,Z))}%`}}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,b.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[Math.round(Z),"%"]})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)("input",{type:"range",min:0,max:100,value:Z,onChange:a=>$(Number(a.target.value)),className:"flex-1"}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:_,onChange:a=>aa(a.target.checked)}),(0,b.jsx)("span",{className:"text-xs",children:"Calculate Progress through tasks"})]})]})]})]})]})})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,b.jsxs)("div",{onClick:()=>O.current?.click(),className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[M?(0,b.jsx)("div",{children:M.name}):(0,b.jsx)("div",{children:"Choose File"}),(0,b.jsx)("input",{ref:O,type:"file",className:"hidden",onChange:a=>N(a.target.files?.[0]??null)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,b.jsxs)(f.Select,{value:P,onValueChange:a=>Q(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"USD"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"USD",children:"USD $"}),(0,b.jsx)(f.SelectItem,{value:"USD",children:"USD ₹"}),(0,b.jsx)(f.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,b.jsx)(e.Input,{value:R,onChange:a=>S(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,b.jsx)(e.Input,{value:T,onChange:a=>U(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:V,onChange:a=>W(a.target.checked)}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs "})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,b.jsxs)(f.Select,{value:ab,onValueChange:a=>ac(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-44",children:(0,b.jsx)(f.SelectValue,{placeholder:"You"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"you",children:"You"}),bb.map(a=>(0,b.jsx)(f.SelectItem,{value:a,children:a},a))]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{g(),ad()},children:"Cancel"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:ae,disabled:k,children:k?"Updating...":"Update"})]})]})})]})]})},{projectId:a0,onClose:()=>{a_(!1),a1(null)},onSaved:()=>{bh(x??null)}})]})}var u=a.i(83490),v=a.i(886330),w=a.i(782066),x=a.i(6080);let y="https://6jnqmj85-80.inc1.devtunnels.ms";function z({employeeId:a}){let[d,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[t,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),G={title:"",category:"",startDate:"",dueDate:"",noDueDate:!1,taskStageId:"",assignedEmployeeIds:[],description:"",labelIds:[],milestoneId:"",priority:"LOW",isPrivate:!1,timeEstimateMinutes:"",isDependent:!1,projectId:j,taskFile:null},[H,I]=(0,c.useState)(G),J=a=>`${y}${a}`,K=async()=>{try{let a=`${y}/status`,b=localStorage.getItem("accessToken"),c=await u.default.get(a,{headers:{Authorization:b?`Bearer ${b}`:""}});Array.isArray(c.data)?m(c.data):m([])}catch(a){console.warn("Failed to fetch statuses:",a),m([])}},L=async()=>{g(!0),i(null);try{let b=localStorage.getItem("accessToken"),c=`${y}/api/projects/tasks/employee/${a}`,d=await u.default.get(c,{headers:{"Content-Type":"application/json",Authorization:b?`Bearer ${b}`:""}});e(Array.isArray(d.data)?d.data:[])}catch(a){i(a?.response?.data?.message||a?.message||"Failed to load tasks")}finally{g(!1)}};(0,c.useEffect)(()=>{K(),L()},[j]);let M=a=>I(b=>({...b,...a})),N=async a=>{a.preventDefault();try{let a=new FormData;a.append("title",H.title),a.append("category",H.category||""),a.append("startDate",H.startDate||""),a.append("dueDate",H.dueDate||""),a.append("noDueDate",String(H.noDueDate)),a.append("taskStageId",H.taskStageId||""),a.append("assignedEmployeeIds",JSON.stringify(H.assignedEmployeeIds)),a.append("description",H.description||""),a.append("labelIds",JSON.stringify(H.labelIds)),a.append("milestoneId",H.milestoneId||""),a.append("priority",H.priority||""),a.append("isPrivate",String(H.isPrivate)),a.append("timeEstimateMinutes",String(H.timeEstimateMinutes||"")),a.append("isDependent",String(H.isDependent)),a.append("projectId",String(j)),H.taskFile&&a.append("taskFile",H.taskFile),await (0,w.postAPI)(J("/api/projects/tasks"),a,{headers:{"Content-Type":"multipart/form-data"}}),o(!1),I(G),await L()}catch(a){alert("Create task failed: "+(a?.response?.data?.message||a?.message||"unknown"))}},O=async a=>{if(a.preventDefault(),r)try{let a=new FormData;a.append("title",H.title),a.append("category",H.category||""),a.append("noDueDate",String(H.noDueDate)),a.append("description",H.description||""),a.append("labelIds",JSON.stringify(H.labelIds)),a.append("priority",H.priority||""),a.append("isPrivate",String(H.isPrivate)),a.append("timeEstimateMinutes",String(H.timeEstimateMinutes||"")),a.append("isDependent",String(H.isDependent)),a.append("projectId",String(j)),a.append("assignedEmployeeIds",JSON.stringify(H.assignedEmployeeIds)),H.taskFile&&a.append("taskFile",H.taskFile),await (0,w.putAPI)(J(`/api/projects/tasks/${r.id}`),a,{headers:{"Content-Type":"multipart/form-data"}}),q(!1),s(null),I(G),await L()}catch(a){alert("Update task failed: "+(a?.response?.data?.message||a?.message||"unknown"))}},P=async a=>{if(confirm("Are you sure to delete this task?"))try{await (0,w.deleteAPI)(J(`/api/projects/${j}/tasks/${a}`)),D(null),await L()}catch(a){alert("Delete failed: "+(a?.response?.data?.message||a?.message||"unknown"))}},Q=a=>{switch(("string"==typeof a?a:a?.name??"").toLowerCase()){case"complete":case"completed":case"complete":case"complete":return"bg-green-600";case"to-do":case"to do":case"todo":return"bg-yellow-500";case"doing":return"bg-blue-600";case"incomplete":return"bg-red-600";case"waiting":case"waiting for approval":return"bg-gray-600";default:return"bg-gray-400"}},R=async(a,b)=>{e(c=>c.map(c=>c.id===a.id?{...c,taskStage:{id:b.id,name:b.name},taskStageId:b.id}:c));let c=localStorage.getItem("accessToken");try{let d=`${y}/api/projects/tasks/${a.id}/status?statusId=${b.id}`;await u.default.patch(d,{},{headers:{"Content-Type":"application/json",Authorization:c?`Bearer ${c}`:""}}),F(null)}catch(a){console.error("Failed to update status:",a),alert("Failed to update status on server. Refreshing tasks."),await L(),F(null)}},S=a=>{if(!a&&0!==a)return"--";let b=Math.floor((a||0)/60),c=(a||0)%60;return b&&c?`${b}h ${c}m`:b?`${b}h`:`${c}m`};return(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Tasks"}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsx)("button",{onClick:()=>{I({...G,projectId:j}),o(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded shadow-sm hover:bg-blue-700",children:"+ Add Task"})}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsx)("input",{type:"search",placeholder:"Search",onChange:a=>{let b=a.target.value.toLowerCase();b?e(a=>a.filter(a=>(a.title||"").toLowerCase().includes(b)||(a.projectName||"").toLowerCase().includes(b))):L()},className:"border px-3 py-2 rounded-md text-sm"})})]}),f?(0,b.jsx)("div",{className:"py-6 text-center text-gray-500",children:"Loading tasks..."}):h?(0,b.jsx)("div",{className:"py-6 text-center text-red-500",children:h}):(0,b.jsxs)("div",{className:"overflow-x-auto",children:[(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-blue-50 text-left text-gray-600",children:[(0,b.jsx)("th",{className:"px-4 py-3",children:"Code"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Task"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Completed On"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Start Date"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Due Date"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Hours Logged"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Estimated Time"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Milestones"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Assigned to"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Status"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Action"})]})}),(0,b.jsx)("tbody",{children:0===d.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:11,className:"py-6 text-center text-gray-500",children:"No tasks found"})}):d.map(a=>{let c=a.dueDate&&!a.noDueDate&&new Date(a.dueDate)<new Date,d=(a=>{if(a.taskStage&&a.taskStage.name)return a.taskStage;if(a.taskStageId){let b=l.find(b=>b.id===a.taskStageId);if(b)return b}return(a=>{if(l&&l.length)return l.find(b=>String(b.name).toLowerCase().includes(String(a).toLowerCase()))})(String(a.taskStage?.name||""))??{id:a.taskStageId??0,name:a.taskStage?.name??"Doing"}})(a),e=d?.name??"Doing";return(0,b.jsxs)("tr",{className:"border-b last:border-b-0 bg-white hover:bg-gray-50",children:[(0,b.jsxs)("td",{className:"px-4 py-4 align-top",children:["RTA-",String(a.id).padStart(2,"0")]}),(0,b.jsxs)("td",{className:"px-4 py-4 align-top",children:[(0,b.jsx)("div",{className:"font-medium",children:a.title}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:a.projectName??`Project ${a.projectId}`})]}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:"--"}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:a.startDate?new Date(a.startDate).toLocaleDateString():"--"}),(0,b.jsx)("td",{className:`px-4 py-4 align-top ${c?"text-red-600":""}`,children:a.noDueDate?"--":a.dueDate?new Date(a.dueDate).toLocaleDateString():"--"}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:S(a.hoursLoggedMinutes??null)}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:S(a.timeEstimateMinutes??null)}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:a.milestone?.title??"--"}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:(0,b.jsx)("div",{className:"flex -space-x-2",children:(a.assignedEmployees||[]).slice(0,3).map(a=>(0,b.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white overflow-hidden bg-gray-100",children:a.profileUrl?(0,b.jsx)("img",{src:a.profileUrl,alt:a.name,className:"w-full h-full object-cover"}):(0,b.jsx)(v.UserIcon,{className:"w-full h-full text-gray-400 p-1"})},a.employeeId))})}),(0,b.jsx)("td",{className:"px-4 py-4 align-top relative",children:(0,b.jsxs)("div",{className:"relative inline-block",children:[(0,b.jsxs)("button",{onClick:b=>{b.stopPropagation(),D(null),F(b=>b===a.id?null:a.id)},className:"inline-flex items-center gap-2 px-3 py-1 rounded-full border text-xs bg-white hover:bg-gray-50",title:"Change status",children:[d&&d.labelColor?(0,b.jsx)("span",{style:{width:8,height:8,borderRadius:9999,display:"inline-block",background:`#${String(d.labelColor).replace(/[^0-9a-fA-F]/g,"").slice(0,6)}`}}):(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${Q(d?.name??"Doing")}`}),(0,b.jsx)("span",{children:String(e)}),(0,b.jsx)("span",{className:"text-xs",children:"▾"})]}),E===a.id&&(0,b.jsx)("div",{onClick:a=>a.stopPropagation(),className:"absolute right-0 mt-2 z-30 w-44 bg-white border rounded-md shadow-lg text-sm",children:l.length>0?l.map(c=>(0,b.jsxs)("button",{onClick:()=>R(a,c),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-2 ${c.id===d?.id?"font-medium":""}`,children:[c.labelColor?(0,b.jsx)("span",{style:{width:8,height:8,borderRadius:9999,background:`#${String(c.labelColor).replace(/[^0-9a-fA-F]/g,"").slice(0,6)}`}}):(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${Q(c.name)}`}),(0,b.jsx)("span",{children:c.name})]},c.id)):["To Do","Doing","Completed","Incomplete","Waiting for Approval"].map(c=>(0,b.jsxs)("button",{onClick:()=>{R(a,{id:0,name:c})},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${Q(c)}`})," ",(0,b.jsx)("span",{children:c})]},c))})]})}),(0,b.jsxs)("td",{className:"px-4 py-4 align-top relative",children:[(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),F(null),D(b=>b===a.id?null:a.id)},className:"p-1 rounded hover:bg-gray-100","aria-haspopup":"true","aria-expanded":C===a.id,title:"More",children:"⋮"}),C===a.id&&(0,b.jsxs)("div",{onClick:a=>a.stopPropagation(),className:"absolute right-2 top-10 z-20 w-48 bg-white border rounded-md shadow-md",children:[(0,b.jsx)("button",{onClick:()=>{B(a),z(!0),D(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"View"}),(0,b.jsx)("button",{onClick:()=>{s(a),I({title:a.title||"",category:a.categoryId?.id?String(a.categoryId.id):"",startDate:a.startDate?a.startDate:"",dueDate:a.dueDate?a.dueDate:"",noDueDate:!!a.noDueDate,taskStageId:a.taskStageId?String(a.taskStageId):"",assignedEmployeeIds:a.assignedEmployeeIds||[],description:a.description||"",labelIds:(a.labels||[]).map(a=>String(a.id)),milestoneId:a.milestoneId?String(a.milestoneId):"",priority:a.priority||"LOW",isPrivate:!!a.isPrivate,timeEstimateMinutes:a.timeEstimateMinutes?String(a.timeEstimateMinutes):"",isDependent:!!a.isDependent,projectId:a.projectId,taskFile:null}),q(!0),D(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"Edit"}),(0,b.jsx)("button",{onClick:()=>{D(null),P(a.id)},className:"w-full text-left px-4 py-2 text-red-600 hover:bg-gray-50",children:"Delete"})]})]})]},a.id)})})]}),(0,b.jsxs)("div",{className:"px-4 py-3 border-t bg-gray-50 flex items-center justify-between text-sm text-gray-600 rounded-b-md mt-4",children:[(0,b.jsxs)("div",{children:["Result per page - ",d.length?d.length:0]}),(0,b.jsx)("div",{children:"Page 1 of 1"})]})]}),n&&(0,b.jsx)("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 p-4",children:(0,b.jsxs)("form",{onSubmit:N,className:"bg-white w-full max-w-3xl rounded-lg p-6 shadow-lg overflow-auto max-h-[90vh]",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Add Task"}),(0,b.jsx)("button",{type:"button",onClick:()=>o(!1),className:"text-gray-500",children:"Close"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Title"}),(0,b.jsx)("input",{required:!0,value:H.title,onChange:a=>M({title:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Category (id)"}),(0,b.jsx)("input",{value:H.category,onChange:a=>M({category:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Start Date"}),(0,b.jsx)("input",{type:"date",value:H.startDate,onChange:a=>M({startDate:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Due Date"}),(0,b.jsx)("input",{type:"date",value:H.dueDate,onChange:a=>M({dueDate:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:H.noDueDate,onChange:a=>M({noDueDate:a.target.checked})}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"No Due Date"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Task Stage ID"}),(0,b.jsx)("input",{value:H.taskStageId,onChange:a=>M({taskStageId:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Description"}),(0,b.jsx)("textarea",{value:H.description,onChange:a=>M({description:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Assigned Employee IDs (comma separated)"}),(0,b.jsx)("input",{value:H.assignedEmployeeIds.join(","),onChange:a=>M({assignedEmployeeIds:a.target.value.split(",").map(a=>a.trim()).filter(Boolean)}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Label IDs (comma separated)"}),(0,b.jsx)("input",{value:H.labelIds.join(","),onChange:a=>M({labelIds:a.target.value.split(",").map(a=>a.trim()).filter(Boolean)}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Milestone ID"}),(0,b.jsx)("input",{value:H.milestoneId,onChange:a=>M({milestoneId:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Priority"}),(0,b.jsxs)("select",{value:H.priority,onChange:a=>M({priority:a.target.value}),className:"border px-3 py-2 rounded",children:[(0,b.jsx)("option",{value:"LOW",children:"LOW"}),(0,b.jsx)("option",{value:"MEDIUM",children:"MEDIUM"}),(0,b.jsx)("option",{value:"HIGH",children:"HIGH"}),(0,b.jsx)("option",{value:"URGENT",children:"URGENT"})]})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Time Estimate (minutes)"}),(0,b.jsx)("input",{type:"number",value:H.timeEstimateMinutes,onChange:a=>M({timeEstimateMinutes:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:H.isPrivate,onChange:a=>M({isPrivate:a.target.checked})}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Private"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:H.isDependent,onChange:a=>M({isDependent:a.target.checked})}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Is Dependent"})]}),(0,b.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Attach file (optional)"}),(0,b.jsx)("input",{type:"file",onChange:a=>M({taskFile:a.target.files?.[0]||null})})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 rounded border",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 rounded bg-blue-600 text-white",children:"Save"})]})]})}),p&&r&&(0,b.jsx)("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 p-4",children:(0,b.jsxs)("form",{onSubmit:O,className:"bg-white w-full max-w-3xl rounded-lg p-6 shadow-lg overflow-auto max-h-[90vh]",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Task"}),(0,b.jsx)("button",{type:"button",onClick:()=>{q(!1),s(null)},className:"text-gray-500",children:"Close"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Title"}),(0,b.jsx)("input",{required:!0,value:H.title,onChange:a=>M({title:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Category (id)"}),(0,b.jsx)("input",{value:H.category,onChange:a=>M({category:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Description"}),(0,b.jsx)("textarea",{value:H.description,onChange:a=>M({description:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Assigned Employee IDs (comma separated)"}),(0,b.jsx)("input",{value:H.assignedEmployeeIds.join(","),onChange:a=>M({assignedEmployeeIds:a.target.value.split(",").map(a=>a.trim()).filter(Boolean)}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Label IDs (comma separated)"}),(0,b.jsx)("input",{value:H.labelIds.join(","),onChange:a=>M({labelIds:a.target.value.split(",").map(a=>a.trim()).filter(Boolean)}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Priority"}),(0,b.jsxs)("select",{value:H.priority,onChange:a=>M({priority:a.target.value}),className:"border px-3 py-2 rounded",children:[(0,b.jsx)("option",{value:"LOW",children:"LOW"}),(0,b.jsx)("option",{value:"MEDIUM",children:"MEDIUM"}),(0,b.jsx)("option",{value:"HIGH",children:"HIGH"}),(0,b.jsx)("option",{value:"URGENT",children:"URGENT"})]})]}),(0,b.jsxs)("label",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Time Estimate (minutes)"}),(0,b.jsx)("input",{type:"number",value:H.timeEstimateMinutes,onChange:a=>M({timeEstimateMinutes:a.target.value}),className:"border px-3 py-2 rounded"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:H.isPrivate,onChange:a=>M({isPrivate:a.target.checked})}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Private"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:H.isDependent,onChange:a=>M({isDependent:a.target.checked})}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Is Dependent"})]}),(0,b.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"Attach file (optional)"}),(0,b.jsx)("input",{type:"file",onChange:a=>M({taskFile:a.target.files?.[0]||null})})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{q(!1),s(null)},className:"px-4 py-2 rounded border",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 rounded bg-blue-600 text-white",children:"Update"})]})]})}),(0,b.jsx)(x.default,{open:t,task:A,onClose:()=>{z(!1),B(null)}})]})}var A=a.i(89329);let B="https://6jnqmj85-80.inc1.devtunnels.ms";function C({gatewayPath:a,mainBase:d,employeeId:e,authToken:f=null}){let g=(d||B).replace(/\/$/,""),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(0),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)("All"),[t,u]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""}),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1),O=a=>{let b=String(a||"");return b.startsWith("http://")||b.startsWith("https://")?b:b.startsWith("/")?`${g}${b}`:`${g}/${b}`},P=(a={})=>{let b={...a};return f&&(b.Authorization=`Bearer ${f}`),b},Q=async(a,b={},c=15e3)=>{let d=new AbortController,e=setTimeout(()=>d.abort(),c);try{let c={...b,signal:d.signal},f=await fetch(a,c);clearTimeout(e);let g=f.headers.get("content-type")||"",h=await f.text().catch(()=>"");if(!f.ok){if(g.includes("application/json"))try{let a=JSON.parse(h||"{}"),b=a?.message||JSON.stringify(a);throw Error(`HTTP ${f.status} ${f.statusText} — ${b}`)}catch{throw Error(`HTTP ${f.status} ${f.statusText} — ${h.slice(0,300)}`)}if(g.includes("text/html")||h.trim().startsWith("<!DOCTYPE html"))throw Error(`HTTP ${f.status} ${f.statusText} — server returned HTML (likely auth).`);throw Error(`HTTP ${f.status} ${f.statusText} ${h?"- "+h.slice(0,300):""}`)}if(g.includes("application/json"))return JSON.parse(h||"[]");return h}catch(a){if("AbortError"===a.name)throw Error("Request timed out");if("Failed to fetch"===a.message)throw Error("Network Error - check CORS / server availability");throw a}finally{clearTimeout(e)}},R=async()=>{k(!0),m(null);try{let a=O(`${B}/timesheets/employee/${e}`),b=await Q(a,{method:"GET",headers:P({"Content-Type":"application/json"}),credentials:"same-origin"});Array.isArray(b)?i(b):b?.data&&Array.isArray(b.data)?i(b.data):(console.warn("Unexpected timesheets response:",b),i([]),m("Unexpected response shape from server. See console."))}catch(a){console.error("fetchTimesheets error:",a),i([]),m(a?.message||"Failed to load timesheets")}finally{k(!1)}};(0,c.useEffect)(()=>{R()},[n]);let S=(0,c.useMemo)(()=>{let a=new Map;return h.forEach(b=>{let c=b.employees&&b.employees[0];c&&c.employeeId?a.set(c.employeeId,c):b.employeeId&&a.set(b.employeeId,{employeeId:b.employeeId})}),Array.from(a.values())},[h]),T=h.filter(a=>{if("All"!==r&&a.employeeId!==r)return!1;if(!p)return!0;let b=p.toLowerCase(),c=a.employees&&a.employees[0];return String(a.employeeId||"").toLowerCase().includes(b)||String(a.projectId||"").toLowerCase().includes(b)||String(a.taskId||"").toLowerCase().includes(b)||String(a.memo||"").toLowerCase().includes(b)||String(c?.name||"").toLowerCase().includes(b)}),U=a=>a<10?`0${a}`:`${a}`,V=(a,b)=>((a,b)=>{if(!a)return"-";try{let[c,d,e]=a.split("-").map(Number),f=0,g=0;if(b){let a=b.split(":").map(Number);f=a[0]??0,g=a[1]??0}let h=new Date(c,d-1,e,f,g),i=U(h.getDate()),j=U(h.getMonth()+1),k=h.getFullYear(),l=h.getHours(),m=U(h.getMinutes()),n=l>=12?"PM":"AM";l=l%12||12;let o=U(l);return`${i}/${j}/${k} ${o}:${m} ${n}`}catch{return a+(b?` ${b}`:"")}})(a,b),W=(a,b,c,d)=>{if(!a||!c)return 0;try{let e=a.split("-").map(Number),f=c.split("-").map(Number),g=0,h=0,i=0,j=0;b&&([g,h]=b.split(":").map(a=>Number(a))),d&&([i,j]=d.split(":").map(a=>Number(a)));let k=new Date(e[0],e[1]-1,e[2],g,h),l=new Date(f[0],f[1]-1,f[2],i,j).getTime()-k.getTime();if(isNaN(l)||l<=0)return 0;return Math.round(l/36e5)}catch{return 0}},X=W(E.startDate,E.startTime,E.endDate,E.endTime),Y=a=>{a?(D(a.id),F({projectId:String(a.projectId??""),taskId:String(a.taskId??""),employeeId:a.employeeId??"",startDate:a.startDate??"",startTime:a.startTime??"",endDate:a.endDate??"",endTime:a.endTime??"",memo:a.memo??""})):(D(null),F({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""})),z(null),u(!0)},Z=async()=>{if(K){x(!0),z(null);try{let b=O(`${a}/${K.id}`);await Q(b,{method:"DELETE",headers:P({"Content-Type":"application/json"}),credentials:"same-origin"}),N(!1),L(null),o(a=>a+1)}catch(a){console.error("deleteTimesheet error:",a),z(a?.message||"Failed to delete timesheet")}finally{x(!1)}}},$=async()=>{x(!0),z(null);try{if(!E.projectId||!E.taskId||!E.employeeId||!E.startDate||!E.startTime||!E.endDate||!E.endTime||!E.memo){z("Please fill all required fields."),x(!1);return}let b={projectId:Number(E.projectId),taskId:Number(E.taskId),employeeId:E.employeeId,startDate:E.startDate,startTime:E.startTime,endDate:E.endDate,endTime:E.endTime,memo:E.memo,durationHours:W(E.startDate,E.startTime,E.endDate,E.endTime)},c=O(a)+(C?`/${C}`:"");await Q(c,{method:C?"PUT":"POST",headers:P({"Content-Type":"application/json"}),credentials:"same-origin",body:JSON.stringify(b)}),u(!1),o(a=>a+1)}catch(a){console.error("saveEntry error:",a),z(a?.message||"Failed to save entry")}finally{x(!1)}};return(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Timesheet"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("label",{className:"text-sm",children:"Employee"}),(0,b.jsxs)("select",{value:r,onChange:a=>s(a.target.value),className:"border rounded px-3 py-2 text-sm",children:[(0,b.jsx)("option",{value:"All",children:"All"}),S.map(a=>(0,b.jsx)("option",{value:a.employeeId,children:a.name?`${a.name} (${a.employeeId})`:a.employeeId},a.employeeId))]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("div",{children:(0,b.jsx)("button",{onClick:()=>Y(),className:"bg-blue-600 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-700",children:"+ Log Time"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("button",{onClick:()=>o(a=>a+1),className:"bg-gray-100 px-3 py-2 rounded text-sm border hover:bg-gray-200",children:"Refresh"}),(0,b.jsx)("input",{type:"search",placeholder:"Search employee, memo, project...",value:p,onChange:a=>q(a.target.value),className:"border px-3 py-2 rounded-md text-sm"})]})]}),j?(0,b.jsx)("div",{className:"py-6 text-center text-gray-500",children:"Loading timesheets..."}):(0,b.jsxs)(b.Fragment,{children:[l&&(0,b.jsxs)("div",{className:"mb-4 p-3 rounded bg-red-50 text-red-700",children:[(0,b.jsx)("strong",{children:"Error:"})," ",l]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-blue-50 text-left text-gray-600",children:[(0,b.jsx)("th",{className:"px-4 py-3",children:"Code"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Task"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Employee"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Start Time"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"End Time"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Total Hours"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"Action"})]})}),(0,b.jsx)("tbody",{children:0===T.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,className:"py-6 text-center text-gray-500",children:"No timesheets found"})}):T.map(a=>{let c=a.employees&&a.employees[0],d=`RTA-${String(a.id).padStart(2,"0")}`,e=`Task ${a.taskId??"-"} \xb7 Project ${a.projectId??"-"}`;return(0,b.jsxs)("tr",{className:"border-b last:border-b-0 bg-white hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:d}),(0,b.jsxs)("td",{className:"px-4 py-4 align-top",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:e}),(0,b.jsx)("div",{className:"text-xs text-gray-400",children:a.memo??""})]}),(0,b.jsxs)("td",{className:"px-4 py-4 align-top flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:c?.profileUrl?(0,b.jsx)("img",{src:c.profileUrl,alt:c?.name??"",className:"w-full h-full object-cover"}):(0,b.jsx)(v.UserIcon,{className:"w-6 h-6 text-gray-400 p-1"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:c?.name||a.employeeId}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:c?.designation||c?.department||a.employeeId})]})]}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:V(a.startDate,a.startTime)}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:V(a.endDate,a.endTime)}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:"number"==typeof a.durationHours?`${a.durationHours}h`:"-"}),(0,b.jsx)("td",{className:"px-4 py-4 align-top",children:(0,b.jsxs)("div",{className:"relative inline-block text-left",children:[(0,b.jsx)("button",{onClick:()=>H(G===a.id?null:a.id),className:"px-2 py-1 border rounded text-sm","aria-haspopup":"true","aria-expanded":G===a.id,title:"More",children:"⋮"}),G===a.id&&(0,b.jsxs)("div",{className:"absolute right-0 mt-2 z-30 w-40 bg-white border rounded-md shadow-lg text-sm",children:[(0,b.jsx)("button",{onClick:()=>{L(a),J(!0),H(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"View"}),(0,b.jsx)("button",{onClick:()=>{Y(a),H(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"Edit"}),(0,b.jsx)("button",{onClick:()=>{L(a),N(!0),H(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 text-red-600",children:"Delete"})]})]})})]},a.id)})})]})})]}),t&&(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12 px-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>u(!1)}),(0,b.jsxs)("div",{className:"relative bg-white w-full max-w-4xl rounded-xl shadow-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:C?"Edit TimeLog":"Log Time"}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>u(!1),"aria-label":"Close",children:(0,b.jsx)(A.XMarkIcon,{className:"w-6 h-6 text-gray-500"})})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-md border p-6",children:[(0,b.jsx)("h4",{className:"text-md font-medium mb-4",children:"TimeLog Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Project *"}),(0,b.jsx)("input",{value:E.projectId,onChange:a=>F(b=>({...b,projectId:a.target.value})),className:"w-full border rounded px-3 py-2",placeholder:"Project ID",type:"text"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Task *"}),(0,b.jsx)("input",{value:E.taskId,onChange:a=>F(b=>({...b,taskId:a.target.value})),className:"w-full border rounded px-3 py-2",placeholder:"Task ID",type:"text"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Employee *"}),(0,b.jsxs)("select",{value:E.employeeId,onChange:a=>F(b=>({...b,employeeId:a.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,b.jsx)("option",{value:"",children:"--"}),S.map(a=>(0,b.jsx)("option",{value:a.employeeId,children:a.name?`${a.name} (${a.employeeId})`:a.employeeId},a.employeeId))]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Date *"}),(0,b.jsx)("input",{type:"date",value:E.startDate,onChange:a=>F(b=>({...b,startDate:a.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Time *"}),(0,b.jsx)("input",{type:"time",value:E.startTime,onChange:a=>F(b=>({...b,startTime:a.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Date *"}),(0,b.jsx)("input",{type:"date",value:E.endDate,onChange:a=>F(b=>({...b,endDate:a.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Time *"}),(0,b.jsx)("input",{type:"time",value:E.endTime,onChange:a=>F(b=>({...b,endTime:a.target.value})),className:"w-full border rounded px-3 py-2"})]})]}),(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Memo *"}),(0,b.jsx)("input",{type:"text",value:E.memo,onChange:a=>F(b=>({...b,memo:a.target.value})),className:"w-full border rounded px-3 py-2",placeholder:"Memo"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Total Hours"}),(0,b.jsxs)("div",{className:"text-2xl font-semibold text-blue-600",children:[X,"h"]})]})]}),y&&(0,b.jsx)("div",{className:"mt-4 text-sm text-red-600",children:y})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,b.jsx)("button",{onClick:()=>u(!1),className:"px-6 py-2 rounded-md border text-blue-600",disabled:w,children:"Cancel"}),(0,b.jsx)("button",{onClick:$,className:"px-6 py-2 rounded-md bg-blue-600 text-white shadow",disabled:w,children:w?"Saving...":C?"Update":"Save"})]})]})]})]}),I&&K&&(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-8 px-6",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>J(!1)}),(0,b.jsxs)("div",{className:"relative bg-white w-full max-w-6xl rounded-xl shadow-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold",children:"Timesheet"}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>J(!1),"aria-label":"Close",children:(0,b.jsx)(A.XMarkIcon,{className:"w-6 h-6 text-gray-500"})})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 relative bg-white rounded-xl border p-6",children:[(0,b.jsx)("div",{className:"absolute top-4 right-4 text-gray-500",children:"⋮"}),(0,b.jsx)("h4",{className:"text-lg font-medium mb-4",children:"TimeLog Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-y-4 gap-x-6 items-center text-sm",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,b.jsx)("div",{className:"col-span-2",children:V(K.startDate,K.startTime)}),(0,b.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,b.jsx)("div",{className:"col-span-2",children:V(K.endDate,K.endTime)}),(0,b.jsx)("div",{className:"text-gray-500",children:"Total Hours"}),(0,b.jsx)("div",{className:"col-span-2",children:"number"==typeof K.durationHours?`${K.durationHours}h`:"-"}),(0,b.jsx)("div",{className:"text-gray-500",children:"Memo"}),(0,b.jsx)("div",{className:"col-span-2",children:K.memo??"-"}),(0,b.jsx)("div",{className:"text-gray-500",children:"Project"}),(0,b.jsxs)("div",{className:"col-span-2",children:["Project ",K.projectId??"-"]}),(0,b.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,b.jsxs)("div",{className:"col-span-2",children:["Task ",K.taskId??"-"]}),(0,b.jsx)("div",{className:"text-gray-500",children:"Employee"}),(0,b.jsxs)("div",{className:"col-span-2 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:K.employees&&K.employees[0]?.profileUrl?(0,b.jsx)("img",{src:K.employees[0].profileUrl,alt:K.employees[0].name??"",className:"w-full h-full object-cover"}):(0,b.jsx)(v.UserIcon,{className:"w-6 h-6 text-gray-400 p-1"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:K.employees&&K.employees[0]?.name?K.employees[0].name:K.employeeId}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:K.employees&&K.employees[0]?.designation?K.employees[0].designation:""})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border p-5",children:[(0,b.jsx)("h5",{className:"font-medium mb-3",children:"History"}),(0,b.jsxs)("div",{className:"space-y-4 text-sm text-gray-700",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,b.jsx)("div",{children:V(K.startDate,K.startTime)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,b.jsxs)("div",{children:["Task ",K.taskId??"-"]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,b.jsx)("div",{children:V(K.endDate,K.endTime)})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,b.jsx)("button",{onClick:()=>J(!1),className:"px-6 py-2 rounded-md border text-blue-600",children:"Close"}),(0,b.jsx)("button",{onClick:()=>{Y(K),J(!1)},className:"px-6 py-2 rounded-md bg-blue-600 text-white",children:"Edit"})]})]})]})]}),M&&K&&(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12 px-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>N(!1)}),(0,b.jsx)("div",{className:"relative bg-white w-full max-w-md rounded-lg shadow-xl overflow-hidden",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Delete TimeLog"}),(0,b.jsxs)("p",{className:"text-sm text-gray-700",children:["Are you sure you want to delete timesheet ",(0,b.jsxs)("strong",{children:["RTA-",String(K.id).padStart(2,"0")]}),"? This action cannot be undone."]}),y&&(0,b.jsx)("div",{className:"mt-4 text-sm text-red-600",children:y}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-4 mt-6",children:[(0,b.jsx)("button",{className:"px-4 py-2 rounded border",onClick:()=>N(!1),disabled:w,children:"Cancel"}),(0,b.jsx)("button",{className:"px-4 py-2 rounded bg-red-600 text-white",onClick:Z,disabled:w,children:w?"Deleting...":"Delete"})]})]})})]})]})}function D({employeeId:a}){return(0,b.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,b.jsx)("h2",{className:"font-semibold mb-4",children:"Assigned Tasks"}),(0,b.jsx)(z,{employeeId:a}),(0,b.jsx)(C,{employeeId:a}),(0,b.jsx)(t,{employeeId:a})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_hr_employee_%5Bid%5D_work_page_tsx_9097d2cf._.js.map