module.exports=[34256,a=>{"use strict";a.s(["AddLeadModal",()=>o,"default",()=>m]);var b=a.i(187924),c=a.i(972596),d=a.i(572131),e=a.i(238246),f=a.i(50944),g=a.i(591119),h=a.i(699570),i=a.i(206015);let j="https://6jnqmj85-80.inc1.devtunnels.ms",k=async a=>{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token found. Please login.");let c=await fetch(a,{headers:{Authorization:`Bearer ${b}`,Accept:"application/json"},cache:"no-store"});if(!c.ok)throw Error(await c.text().catch(()=>"")||"Failed to fetch");return c.json()};function l({lead:a,onClose:c,onSaved:e}){let[f,g]=(0,d.useState)({name:a?.name??"",email:a?.email??"",clientCategory:a?.clientCategory??"",leadSource:a?.leadSource??"",leadOwner:a?.leadOwner??"",addedBy:a?.addedBy??"",autoConvertToClient:!!a?.autoConvertToClient,companyName:a?.companyName??"",officialWebsite:a?.officialWebsite??"",mobileNumber:String(a?.mobileNumber??""),officePhone:a?.officePhone??"",city:a?.city??"",state:a?.state??"",postalCode:a?.postalCode??"",country:a?.country??"",companyAddress:a?.companyAddress??""}),[i,k]=(0,d.useState)(!1),[l,m]=(0,d.useState)(null);(0,d.useEffect)(()=>{let a=a=>{"Escape"===a.key&&c()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[c]),(0,d.useEffect)(()=>{g({name:a?.name??"",email:a?.email??"",clientCategory:a?.clientCategory??"",leadSource:a?.leadSource??"",leadOwner:a?.leadOwner??"",addedBy:a?.addedBy??"",autoConvertToClient:!!a?.autoConvertToClient,companyName:a?.companyName??"",officialWebsite:a?.officialWebsite??"",mobileNumber:String(a?.mobileNumber??""),officePhone:a?.officePhone??"",city:a?.city??"",state:a?.state??"",postalCode:a?.postalCode??"",country:a?.country??"",companyAddress:a?.companyAddress??""})},[a]);let n=(a,b)=>g(c=>({...c,[a]:b})),o=async b=>{b?.preventDefault();let c=f.name.trim()&&f.email.trim()?null:"Name and Email are required.";if(c)return void m(c);m(null),k(!0);try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let c={name:f.name,email:f.email,clientCategory:f.clientCategory||void 0,leadSource:f.leadSource||void 0,leadOwner:f.leadOwner||void 0,addedBy:f.addedBy||void 0,autoConvertToClient:!!f.autoConvertToClient,companyName:f.companyName||void 0,officialWebsite:f.officialWebsite||void 0,mobileNumber:f.mobileNumber?Number(f.mobileNumber):void 0,officePhone:f.officePhone||void 0,city:f.city||void 0,state:f.state||void 0,postalCode:f.postalCode||void 0,country:f.country||void 0,companyAddress:f.companyAddress||void 0},d=await fetch(`${j}/leads/${a.id}`,{method:"PUT",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok){let a=await d.text().catch(()=>"");throw Error(a||"Update failed")}alert("Lead updated successfully."),await e()}catch(a){m(a?.message??"Failed to update lead.")}finally{k(!1)}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:c}),(0,b.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-12",children:(0,b.jsxs)("div",{className:"max-w-4xl w-full bg-white rounded-lg shadow-lg border overflow-auto",style:{maxHeight:"92vh"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Update Lead Contact"}),(0,b.jsx)("button",{onClick:c,className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("form",{onSubmit:o,className:"p-6 space-y-6",children:[l&&(0,b.jsx)("div",{className:"text-destructive text-sm",children:l}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Contact Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Name *"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.name,onChange:a=>n("name",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Email *"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.email,onChange:a=>n("email",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Lead Source"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.leadSource,onChange:a=>n("leadSource",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Lead Owner"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.leadOwner,onChange:a=>n("leadOwner",a.target.value)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 md:col-span-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"autoConvert",checked:!!f.autoConvertToClient,onChange:a=>n("autoConvertToClient",a.target.checked)}),(0,b.jsx)("label",{htmlFor:"autoConvert",className:"text-sm",children:'Auto Convert lead to client when the deal stage is set to "WIN".'})]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg  border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 text-left gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Company Name"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.companyName,onChange:a=>n("companyName",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Official Website"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.officialWebsite,onChange:a=>n("officialWebsite",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground ",children:"Mobile Number"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.mobileNumber,onChange:a=>n("mobileNumber",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Office Phone No."}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.officePhone,onChange:a=>n("officePhone",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"City"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.city,onChange:a=>n("city",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"State"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.state,onChange:a=>n("state",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Postal Code"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.postalCode,onChange:a=>n("postalCode",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Country"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.country,onChange:a=>n("country",a.target.value)})]}),(0,b.jsxs)("div",{className:"md:col-span-3",children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Company Address"}),(0,b.jsx)("textarea",{className:"w-full border rounded-md p-2 h-28",value:f.companyAddress,onChange:a=>n("companyAddress",a.target.value)})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:c,disabled:i,children:"Cancel"}),(0,b.jsx)(h.Button,{type:"submit",onClick:o,disabled:i,children:i?"Updating...":"Update"})]})]})]})})]})}function m(){(0,f.useRouter)();let{data:a,error:e,isLoading:h,mutate:m}=(0,c.default)(`${j}/leads`,k,{refreshInterval:3e4,revalidateOnFocus:!0}),[p,q]=(0,d.useState)(null),{data:r}=(0,c.default)(`${j}/employee/all?page=0&size=20`,k,{revalidateOnFocus:!1}),s=r&&r.content?r.content:r||[],[t,u]=(0,d.useState)(""),[v,w]=(0,d.useState)(!1),x=(0,d.useMemo)(()=>{let b=t.trim().toLowerCase();return a?b?a.filter(a=>[a.name,a.email,a.companyName,a.mobileNumber,a.clientCategory,a.leadSource,a.city,a.country,a.leadOwner,a.addedBy].filter(Boolean).some(a=>a.toLowerCase().includes(b))):a:[]},[a,t]);return(0,b.jsxs)("main",{className:"container mx-auto max-w-6xl px-4 py-8",children:[(0,b.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Duration"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground underline",children:"Start Date to End Date"})]}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsx)("div",{className:"w-9 h-9 rounded-full bg-gray-200"})})]})}),(0,b.jsxs)("div",{className:"mb-4 flex items-start md:items-center justify-between gap-3",children:[(0,b.jsx)("div",{children:(0,b.jsx)("button",{onClick:()=>w(!0),className:"inline-flex items-center gap-2 rounded-md bg-sky-600 px-4 py-2 text-white text-sm font-medium shadow-sm hover:bg-sky-700",children:"+ Add Lead"})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"rounded-md border bg-white px-3 py-2",children:(0,b.jsx)("input",{value:t,onChange:a=>u(a.target.value),placeholder:"Search",className:"border-0 p-0 outline-none text-sm"})}),(0,b.jsx)("button",{onClick:()=>m(),className:"inline-flex items-center rounded-md border px-3 py-2 text-sm",children:"Refresh"})]})]}),(0,b.jsx)(g.Card,{className:"p-0",children:h?(0,b.jsx)("div",{className:"p-6 text-center text-muted-foreground",children:"Loadingâ€¦"}):e?(0,b.jsx)("div",{className:"p-6 text-center text-destructive",children:e.message}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"w-16",children:"S.No."}),(0,b.jsx)(i.TableHead,{className:"min-w-[220px]",children:"Lead Name"}),(0,b.jsx)(i.TableHead,{children:"Contact Details"}),(0,b.jsx)(i.TableHead,{children:"Lead Owner"}),(0,b.jsx)(i.TableHead,{children:"Added By"}),(0,b.jsx)(i.TableHead,{children:"Created On"}),(0,b.jsx)(i.TableHead,{className:"text-right",children:"Action"})]})}),(0,b.jsx)(i.TableBody,{children:x.map((a,c)=>(0,b.jsx)(n,{lead:a,idx:c,mutate:m,onEdit:a=>q(a)},a.id))})]})})}),p&&(0,b.jsx)(l,{lead:p,onClose:()=>q(null),onSaved:async()=>{q(null),await m()}}),(0,b.jsxs)("div",{className:"mt-6 flex items-center justify-between text-sm text-muted-foreground",children:[(0,b.jsx)("div",{children:"Result per page - 8"}),(0,b.jsx)("div",{children:"Page 1 of 1 "}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("button",{className:"p-2 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]})]}),v&&(0,b.jsx)(o,{onClose:()=>w(!1),onCreated:()=>{w(!1),m()},employees:s})]})}function n({lead:a,idx:c,mutate:g,onEdit:h}){let[k,l]=(0,d.useState)(!1);(0,d.useEffect)(()=>{if(!k)return;let b=b=>{b.target.closest(`[data-lead-row="${a.id}"]`)||l(!1)};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[k,a.id]),(0,f.useRouter)();let m=async()=>{if(confirm("Convert this lead to client?"))try{let b=localStorage.getItem("accessToken"),c=await fetch(`${j}/leads/${a.id}/convert`,{method:"POST",headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error(await c.text());alert("Converted to client"),await g()}catch(a){alert("Error: "+(a.message||a))}finally{l(!1)}},n=async()=>{if(confirm("Delete this lead?"))try{let b=localStorage.getItem("accessToken"),c=await fetch(`${j}/leads/${a.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error(await c.text());alert("Deleted"),await g()}catch(a){alert("Error: "+(a.message||a))}finally{l(!1)}};return(0,b.jsxs)(i.TableRow,{"data-lead-row":`${a.id}`,children:[(0,b.jsx)(i.TableCell,{children:c+1}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(e.default,{href:`/leads/${a.id}`,children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium",children:a.name}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:a.companyName||"â€”"})]})})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-sm",children:a.email}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:a.mobileNumber||"â€”"})]})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-100"}),(0,b.jsx)("div",{className:"flex flex-col",children:(0,b.jsx)("span",{className:"text-sm",children:a.leadOwnerMeta?.name||a.leadOwner||"â€”"})})]})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-100"}),(0,b.jsx)("div",{className:"flex flex-col",children:(0,b.jsx)("span",{className:"text-sm",children:a.addedByMeta?.name||a.addedBy||"â€”"})})]})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)("span",{className:"text-sm",children:a.createdAt?new Date(a.createdAt).toLocaleDateString():"â€”"})}),(0,b.jsxs)(i.TableCell,{className:"relative text-right",children:[(0,b.jsx)("button",{onClick:()=>l(a=>!a),className:"inline-flex items-center rounded-full p-2 hover:bg-slate-100",children:(0,b.jsxs)("svg",{className:"w-5 h-5 text-muted-foreground",viewBox:"0 0 24 24",fill:"currentColor",children:[(0,b.jsx)("circle",{cx:"5",cy:"12",r:"1.5"}),(0,b.jsx)("circle",{cx:"12",cy:"12",r:"1.5"}),(0,b.jsx)("circle",{cx:"19",cy:"12",r:"1.5"})]})}),k&&(0,b.jsx)("div",{className:"absolute right-0 z-30 mt-2 w-56 rounded-md bg-white shadow-lg border",children:(0,b.jsxs)("ul",{className:"py-1",children:[(0,b.jsx)("li",{children:(0,b.jsxs)("button",{onClick:()=>{l(!1),window.location.href=`/leads/admin/get/${a.id}`},className:"w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-slate-50",children:[(0,b.jsxs)("svg",{className:"w-5 h-5 text-muted-foreground",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M2 12s4-7 10-7 10 7 10 7-4 7-10 7S2 12 2 12z"}),(0,b.jsx)("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.5"})]}),"View"]})}),(0,b.jsx)("li",{children:(0,b.jsxs)("button",{onClick:()=>{l(!1),h(a)},className:"w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-slate-50",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-muted-foreground",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536M9 11l6-6L20 10M3 21h6l11-11a2 2 0 00-2-2L7 19v2z"})}),"Edit"]})}),(0,b.jsx)("li",{children:(0,b.jsxs)("button",{onClick:m,className:"w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-slate-50",children:[(0,b.jsxs)("svg",{className:"w-5 h-5 text-muted-foreground",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M12 11c2.21 0 4-1.79 4-4S14.21 3 12 3 8 4.79 8 7s1.79 4 4 4z"}),(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 20v-1a4 4 0 014-4h4a4 4 0 014 4v1"})]}),"Change to Client"]})}),(0,b.jsx)("li",{children:(0,b.jsxs)("button",{onClick:n,className:"w-full flex items-center gap-3 px-4 py-3 text-sm text-destructive hover:bg-slate-50",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-destructive",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M3 6h18M8 6v12a2 2 0 002 2h4a2 2 0 002-2V6M10 6V4a2 2 0 012-2h0a2 2 0 012 2v2"})}),"Delete"]})})]})})]})]})}function o({onClose:a,onCreated:c,employees:e}){let f=["Default Pipeline","Sales Pipeline","Enterprise Pipeline"],g=["Generated","Qualification","Proposal","Win","Lost"],[h,i]=(0,d.useState)([]),[k,l]=(0,d.useState)([]),[m,n]=(0,d.useState)([]);(0,d.useEffect)(()=>{let a=localStorage.getItem("accessToken");a&&(async()=>{try{let b=await fetch(`${j}/deals/dealCategory`,{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();Array.isArray(a)&&(i(a),n(a))}let c=await fetch(`${j}/deals/dealCategory/LeadSource`,{headers:{Authorization:`Bearer ${a}`}});if(c.ok){let a=await c.json();Array.isArray(a)&&l(a)}}catch{}})()},[]);let o={title:"",pipeline:f[0],dealStage:g[0],dealCategory:"",value:"",expectedCloseDate:"",dealAgent:"",dealWatchers:[]},[p,q]=(0,d.useState)({name:"",email:"",mobileNumber:"",clientCategory:"",leadSource:"",addedBy:"",leadOwner:"",createDeal:!0,autoConvertToClient:!0,deal:o,companyName:"",officialWebsite:"",officePhone:"",city:"",state:"",postalCode:"",country:"",companyAddress:""}),[r,s]=(0,d.useState)(null),[t,u]=(0,d.useState)(""),[v,w]=(0,d.useState)(!1),[x,y]=(0,d.useState)([]),[z,A]=(0,d.useState)(null),[B,C]=(0,d.useState)(!1),[D,E]=(0,d.useState)(!1),[F,G]=(0,d.useState)(""),H=(0,d.useRef)(null);(0,d.useEffect)(()=>{let a=a=>{let b=a.target;D&&H.current&&!H.current.contains(b)&&E(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[D]);let[I,J]=(0,d.useState)(!1),K=(0,d.useRef)(null);(0,d.useEffect)(()=>{requestAnimationFrame(()=>J(!0));let b=setTimeout(()=>K.current?.focus(),120),c=document.body.style.overflow;document.body.style.overflow="hidden";let d=b=>{"Escape"===b.key&&a()};return document.addEventListener("keydown",d),()=>{clearTimeout(b),document.body.style.overflow=c,document.removeEventListener("keydown",d)}},[a]);let L=(a,b)=>q(c=>({...c,[a]:b})),M=(a,b)=>q(c=>({...c,deal:{...c.deal,[a]:b}})),N=async a=>{a?.preventDefault();let b=(()=>{if(!p.name?.trim()||!p.email?.trim()||!p.companyName?.trim())return"Name, Email and Company Name are required.";if(p.createDeal||p.autoConvertToClient){let a=p.deal;if(!a.title?.trim()||!a.value||!a.expectedCloseDate||!a.dealAgent)return"Deal title, value, expected close date and deal agent are required when creating a deal."}return null})();if(b)return void A(b);A(null),C(!0);try{let a=localStorage.getItem("accessToken");if(!a)throw Error("No access token found.");let b={name:p.name,email:p.email,mobileNumber:p.mobileNumber||void 0,clientCategory:p.clientCategory||void 0,leadSource:p.leadSource||void 0,addedBy:p.addedBy||void 0,leadOwner:p.leadOwner||void 0,createDeal:!!p.createDeal,autoConvertToClient:!!p.autoConvertToClient,deal:p.createDeal||p.autoConvertToClient?{title:p.deal.title,pipeline:p.deal.pipeline,dealStage:p.deal.dealStage,dealCategory:p.deal.dealCategory,value:Number(p.deal.value),expectedCloseDate:p.deal.expectedCloseDate,dealAgent:p.deal.dealAgent,dealWatchers:p.deal.dealWatchers||[]}:void 0,companyName:p.companyName,officialWebsite:p.officialWebsite||void 0,officePhone:p.officePhone||void 0,city:p.city||void 0,state:p.state||void 0,postalCode:p.postalCode||void 0,country:p.country||void 0,companyAddress:p.companyAddress||void 0},d=await fetch(`${j}/leads`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(b)});if(!d.ok){let a=await d.text().catch(()=>"");throw Error(a||"Failed to create lead")}c(),alert("Lead created successfully.")}catch(a){A(a?.message||"Failed to create lead.")}finally{C(!1)}},O=async a=>{s(a),u(""),w(!0),y([]);try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No token");if("leadSource"===a){let a=await fetch(`${j}/deals/dealCategory/LeadSource`,{headers:{Authorization:`Bearer ${b}`}});if(a.ok){let b=await a.json();Array.isArray(b)&&y(b)}}else{let a=await fetch(`${j}/deals/dealCategory`,{headers:{Authorization:`Bearer ${b}`}});if(a.ok){let b=await a.json();Array.isArray(b)&&y(b)}}}catch{}finally{w(!1)}},P=async a=>{if(!t.trim())return alert("Please enter a name.");w(!0);try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No token");let c="",d={};"leadSource"===a?(c=`${j}/deals/dealCategory/LeadSource`,d={name:t.trim()}):(c=`${j}/deals/dealCategory`,d={categoryName:t.trim()});let e=await fetch(c,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify(d)});if(!e.ok){let a=await e.text().catch(()=>"");throw Error(a||"Failed to add")}let f=await e.json();"leadSource"===a?(l(a=>[{id:f.id,name:f.name||t.trim()},...a]),q(a=>({...a,leadSource:f.name||t.trim()}))):(i(a=>[{id:f.id,categoryName:f.categoryName||t.trim()},...a]),n(a=>[{id:f.id,categoryName:f.categoryName||t.trim()},...a]),q(a=>({...a,deal:{...a.deal,dealCategory:f.categoryName||t.trim()},clientCategory:f.categoryName||t.trim()}))),u(""),s(null),alert("Added successfully.")}catch(a){alert("Error: "+(a?.message||a))}finally{w(!1)}},Q=async(a,b)=>{if(confirm("Are you sure you want to delete this item?"))try{let c=localStorage.getItem("accessToken");if(!c)throw Error("No token");let d="";d="leadSource"===a?`${j}/deals/dealCategory/LeadSource/${b}`:`${j}/deals/dealCategory/${b}`;let e=await fetch(d,{method:"DELETE",headers:{Authorization:`Bearer ${c}`}});if(!e.ok){let a=await e.text().catch(()=>"");throw Error(a||"Delete failed")}"leadSource"===a?l(a=>a.filter(a=>a.id!==b)):(i(a=>a.filter(a=>a.id!==b)),n(a=>a.filter(a=>a.id!==b))),alert("Deleted successfully.")}catch(a){alert("Error deleting: "+(a?.message||a))}},R=(0,b.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[z&&(0,b.jsx)("div",{className:"text-destructive text-sm",children:z}),(0,b.jsxs)("div",{className:"bg-white rounded-lg border p-6 shadow-sm flex flex-col",children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-4 text-left order-first",children:"Lead Contact Detail"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Name *"}),(0,b.jsx)("input",{ref:K,className:"w-full border rounded-md px-3 py-2 text-sm",value:p.name,onChange:a=>L("name",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Email *"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.email,type:"email",onChange:a=>L("email",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Client Category"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("select",{className:"flex-1 border rounded-md px-3 py-2 text-sm",value:p.clientCategory,onChange:a=>L("clientCategory",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),m.map(a=>(0,b.jsx)("option",{value:a.categoryName,children:a.categoryName},a.id))]}),(0,b.jsx)("button",{type:"button",onClick:()=>O("clientCategory"),className:"px-3 py-2 rounded border text-sm",children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Lead Source"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("select",{className:"flex-1 border  rounded-md px-3 py-2 text-sm",value:p.leadSource,onChange:a=>L("leadSource",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),k.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]}),(0,b.jsx)("button",{type:"button",onClick:()=>O("leadSource"),className:"px-3 py-2 rounded border text-sm",children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Added By"}),(0,b.jsxs)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.addedBy,onChange:a=>L("addedBy",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),e.map(a=>(0,b.jsxs)("option",{value:a.employeeId,children:[a.name," (",a.employeeId,")"]},a.employeeId))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Lead Owner"}),(0,b.jsxs)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.leadOwner,onChange:a=>L("leadOwner",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),e.map(a=>(0,b.jsxs)("option",{value:a.employeeId,children:[a.name," (",a.employeeId,")"]},a.employeeId))]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("input",{id:"createDeal",type:"checkbox",checked:!!p.createDeal,onChange:a=>L("createDeal",a.target.checked)}),(0,b.jsx)("label",{htmlFor:"createDeal",className:"text-sm",children:"Create Deal"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("input",{id:"autoConvert",type:"checkbox",checked:!!p.autoConvertToClient,onChange:a=>L("autoConvertToClient",a.target.checked)}),(0,b.jsx)("label",{htmlFor:"autoConvert",className:"text-sm",children:"Auto convert on WIN"})]})]})]}),(p.createDeal||p.autoConvertToClient)&&(0,b.jsxs)("div",{className:"bg-white rounded-lg border p-5 shadow-sm flex flex-col",children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-4 text-left order-first",children:"Deal Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Name *"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.deal.title,onChange:a=>M("title",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Pipeline *"}),(0,b.jsx)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.deal.pipeline,onChange:a=>M("pipeline",a.target.value),children:f.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Stage *"}),(0,b.jsx)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.deal.dealStage,onChange:a=>M("dealStage",a.target.value),children:g.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Value *"}),(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("div",{className:"px-3 py-2 bg-gray-100 rounded-l text-sm",children:"USD $"}),(0,b.jsx)("input",{className:"flex-1 border rounded-r px-3 py-2 text-sm",type:"number",value:p.deal.value,onChange:a=>M("value",a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Close Date *"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",type:"date",value:p.deal.expectedCloseDate,onChange:a=>M("expectedCloseDate",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Category"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("select",{className:"flex-1 border rounded-md px-3 py-2 text-sm",value:p.deal.dealCategory,onChange:a=>M("dealCategory",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),h.map(a=>(0,b.jsx)("option",{value:a.categoryName,children:a.categoryName},a.id))]}),(0,b.jsx)("button",{type:"button",onClick:()=>O("dealCategory"),className:"px-3 py-2 rounded border text-sm",children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Agent *"}),(0,b.jsxs)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.deal.dealAgent,onChange:a=>M("dealAgent",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),e.map(a=>(0,b.jsxs)("option",{value:a.employeeId,children:[a.name," (",a.employeeId,")"]},a.employeeId))]})]}),(0,b.jsxs)("div",{className:"md:col-span-3",children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Watcher(s)"}),(0,b.jsxs)("div",{ref:H,className:"relative",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>E(a=>!a),className:"w-full flex items-center justify-between border rounded-md px-3 py-2 text-sm bg-white",children:[(0,b.jsx)("div",{className:"truncate",children:0===p.deal.dealWatchers.length?"-- select --":p.deal.dealWatchers.map(a=>e.find(b=>b.employeeId===a)?.name??a).join(", ")}),(0,b.jsx)("div",{className:"ml-2",children:p.deal.dealWatchers.length>0&&(0,b.jsx)("button",{type:"button",onClick:a=>{a.stopPropagation(),q(a=>({...a,deal:{...a.deal,dealWatchers:[]}}))},className:"text-xs px-2 py-1 rounded hover:bg-slate-100",children:"Clear"})})]}),D&&(0,b.jsxs)("div",{className:"absolute left-0 right-0 mt-2 z-40 rounded-md bg-white border shadow-lg max-h-60 overflow-auto",children:[(0,b.jsx)("div",{className:"p-2 border-b",children:(0,b.jsx)("input",{className:"w-full border rounded-md p-2 text-sm",placeholder:"Search employees...",value:F,onChange:a=>G(a.target.value)})}),(0,b.jsxs)("ul",{className:"p-2 space-y-1",children:[e.filter(a=>a.name.toLowerCase().includes(F.trim().toLowerCase())||a.employeeId.toLowerCase().includes(F.trim().toLowerCase())).map(a=>{let c=p.deal.dealWatchers.includes(a.employeeId);return(0,b.jsx)("li",{children:(0,b.jsxs)("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-slate-50 cursor-pointer text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:c,onChange:()=>{var b;return b=a.employeeId,void q(a=>{let c=new Set(a.deal.dealWatchers||[]);return c.has(b)?c.delete(b):c.add(b),{...a,deal:{...a.deal,dealWatchers:Array.from(c)}}})}}),(0,b.jsxs)("span",{children:[a.name," ",(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",a.employeeId,")"]})]})]})},a.employeeId)}),0===e.length&&(0,b.jsx)("li",{className:"p-2 text-sm text-muted-foreground",children:"No employees"})]}),(0,b.jsx)("div",{className:"p-2 border-t flex justify-end gap-2",children:(0,b.jsx)("button",{type:"button",onClick:()=>E(!1),className:"rounded-md px-3 py-1 border text-sm",children:"Done"})})]})]}),(0,b.jsxs)("div",{className:"mt-2 text-sm text-muted-foreground",children:["Selected: ",0===p.deal.dealWatchers.length?"â€”":p.deal.dealWatchers.map(a=>e.find(b=>b.employeeId===a)?.name??a).join(", ")]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg border p-5 shadow-sm flex flex-col",children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-4 text-left order-first",children:"Company Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Company Name *"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.companyName,onChange:a=>L("companyName",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Official Website"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.officialWebsite,onChange:a=>L("officialWebsite",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Mobile Number"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.mobileNumber,onChange:a=>L("mobileNumber",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Office Phone No."}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.officePhone,onChange:a=>L("officePhone",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"City"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.city,onChange:a=>L("city",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"State"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.state,onChange:a=>L("state",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Postal Code"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.postalCode,onChange:a=>L("postalCode",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Country"}),(0,b.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:p.country,onChange:a=>L("country",a.target.value)})]}),(0,b.jsxs)("div",{className:"md:col-span-3",children:[(0,b.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Company Address"}),(0,b.jsx)("textarea",{className:"w-full border rounded-md p-3 text-sm h-28",value:p.companyAddress,onChange:a=>L("companyAddress",a.target.value)})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-2",children:[(0,b.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 rounded-md border text-sm",disabled:B,children:"Cancel"}),(0,b.jsx)("button",{type:"button",onClick:N,className:"px-4 py-2 rounded-md bg-sky-600 text-white text-sm",disabled:B,children:B?"Saving...":"Save"})]})]}),S=r?(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-yellow/20",onClick:()=>s(null)}),(0,b.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-20",children:(0,b.jsxs)("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-lg border overflow-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"clientCategory"===r?"Client Category":"leadSource"===r?"Lead Source":"Deal Category"}),(0,b.jsx)("button",{onClick:()=>s(null),className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:"âœ•"})]}),(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-blue-50",children:[(0,b.jsx)("th",{className:"p-2 text-left",children:"#"}),(0,b.jsx)("th",{className:"p-2 text-left",children:"Name"}),(0,b.jsx)("th",{className:"p-2 text-left",children:"Action"})]})}),(0,b.jsxs)("tbody",{children:[(x.length?x:"clientCategory"===r?m:"leadSource"===r?k:h).map((a,c)=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"p-2",children:c+1}),(0,b.jsx)("td",{className:"p-2",children:a.categoryName||a.name}),(0,b.jsx)("td",{className:"p-2",children:(0,b.jsx)("button",{onClick:()=>Q("leadSource"===r?"leadSource":"clientCategory"===r?"clientCategory":"dealCategory",a.id),className:"text-destructive",children:"ðŸ—‘"})})]},c)),!x.length&&!("clientCategory"===r?m.length:"leadSource"===r?k.length:h.length)&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:3,className:"p-4 text-sm text-muted-foreground",children:"No items found."})})]})]})})}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Name *"}),(0,b.jsx)("input",{value:t,onChange:a=>u(a.target.value),className:"w-full border rounded-md p-2",placeholder:"Enter name"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>s(null),className:"rounded-md px-4 py-2 border",children:"Cancel"}),(0,b.jsx)("button",{onClick:()=>P(r),disabled:v,className:"rounded-md bg-sky-600 text-white px-4 py-2",children:v?"Saving...":"Save"})]})]})]})})]}):null;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"fixed inset-0 z-50","aria-modal":"true",role:"dialog",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-yellow/50 transition-opacity",onClick:a}),(0,b.jsxs)("aside",{className:["absolute right-0 top-0 h-full bg-gray-50 flex flex-col w-full sm:w-[80vw] max-w-full transform transition-transform duration-300 ease-out",I?"translate-x-0":"translate-x-full"].join(" "),style:{willChange:"transform"},children:[(0,b.jsxs)("div",{className:"flex items-start justify-between p-4 border-b bg-white sticky top-0 z-10",children:[(0,b.jsx)("div",{children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-left",children:"Add Lead Contact Information "})}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)("button",{onClick:a,className:"p-2 rounded hover:bg-slate-100",children:"âœ•"})})]}),(0,b.jsx)("div",{className:"p-6 overflow-auto flex-1",children:R})]})]}),S]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_leads_admin_create_page_tsx_5c372269._.js.map