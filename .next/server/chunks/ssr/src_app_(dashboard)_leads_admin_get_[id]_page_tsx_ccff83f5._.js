module.exports=[902463,a=>{"use strict";a.s(["default",()=>z]);var b=a.i(187924),c=a.i(50944),d=a.i(972596),e=a.i(572131),f=a.i(591119),g=a.i(699570),h=a.i(786304),i=a.i(400210),j=a.i(238246);let k="https://6jnqmj85-80.inc1.devtunnels.ms",l=`${k}/deals`,m=`${k}/employee/all?page=0&size=20`,n=`${k}/deals/dealCategory`,o=async a=>{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token found. Please log in.");let c=await fetch(a,{cache:"no-store",headers:{Authorization:`Bearer ${b}`,Accept:"application/json"}});if(!c.ok){let a="Failed to load data.";try{let b=await c.json();a=b?.message||b?.error||a}catch{a=await c.text()||a}throw Error(a)}return c.json()};function p(a){return a&&"null"!==a?a:"--"}function q(a){return a?new Date(a).toLocaleString():"--"}function r(a){return a?new Date(a).toLocaleDateString():"--"}function s(a){return null==a||isNaN(Number(a))?"--":new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",maximumFractionDigits:0}).format(a)}function t({deal:a,lead:c,onClose:d}){let[f,g]=(0,e.useState)([]),[h,i]=(0,e.useState)(!1),[j,l]=(0,e.useState)(null),[m,n]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{try{let b=localStorage.getItem("accessToken");if(!b)return;let c=await fetch(`${k}/deals/${a.id}/files`,{headers:{Authorization:`Bearer ${b}`,Accept:"application/json"}});if(!c.ok)return;let d=await c.json();Array.isArray(d)&&g(d)}catch(a){}})()},[a.id]);let o=async()=>{if(!j)return void n("Select a file first.");n(null),i(!0);try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let c=new FormData;c.append("file",j);let d=await fetch(`${k}/deals/${a.id}/files`,{method:"POST",headers:{Authorization:`Bearer ${b}`},body:c});if(!d.ok)throw Error(await d.text());let e=await d.json(),f=e&&(e.name||e.url)?{name:e.name||j.name,url:e.url}:{name:j.name};g(a=>[f,...a]),l(null),document.getElementById("deal-file-input")?.value&&(document.getElementById("deal-file-input").value="")}catch(a){n(a?.message??"Upload failed.")}finally{i(!1)}},p=c?.companyName??"",q=c?.email??"",t=c?.mobileNumber??a.leadMobile??"";return(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:d}),(0,b.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-8",children:(0,b.jsxs)("div",{className:"max-w-5xl w-full bg-white rounded-lg shadow-lg border overflow-auto",style:{maxHeight:"92vh"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold",children:["Deal ",a.id??""]}),(0,b.jsx)("button",{onClick:d,className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("div",{className:"p-6 grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Deal Information"}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mb-4",children:[a.pipeline??"Default Pipeline"," â†’ ",a.dealStage??"--"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Deal Name"}),(0,b.jsx)("div",{className:"font-medium",children:a.title??`Deal ${a.id}`})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Lead Contact"}),(0,b.jsx)("div",{children:a.leadName??"--"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Email"}),(0,b.jsx)("div",{children:q?(0,b.jsx)("a",{className:"text-sky-600 underline",href:`mailto:${q}`,children:q}):"--"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Company Name"}),(0,b.jsx)("div",{children:p??"--"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Deal Category"}),(0,b.jsx)("div",{children:a.dealCategory??"--"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Deal Agent"}),(0,b.jsx)("div",{children:a.dealAgentMeta?.name??a.dealAgent??"--"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Deal Watcher"}),(0,b.jsx)("div",{children:a.dealWatchersMeta&&a.dealWatchersMeta.length?a.dealWatchersMeta[0].name:"--"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Close Date"}),(0,b.jsx)("div",{children:a.expectedCloseDate?r(a.expectedCloseDate):"--"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Deal Value"}),(0,b.jsx)("div",{children:s(a.value??0)})]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Lead Contact Details"}),(0,b.jsxs)("div",{className:"text-sm grid gap-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Name"}),(0,b.jsx)("div",{children:a.leadName??"--"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Email"}),(0,b.jsx)("div",{children:q?(0,b.jsx)("a",{className:"text-sky-600 underline",href:`mailto:${q}`,target:"_blank",rel:"noreferrer",children:q}):"--"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Mobile"}),(0,b.jsx)("div",{children:t?(0,b.jsx)("a",{className:"text-sky-600 underline",href:`tel:${t}`,children:t}):"--"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Company Name"}),(0,b.jsx)("div",{children:p??"--"})]}),(0,b.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,b.jsxs)("a",{href:q?`mailto:${q}`:"#",className:"px-3 py-2 border rounded text-sm inline-flex items-center gap-2",target:"_blank",rel:"noreferrer",children:[(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8l7.89 5.26a3 3 0 003.22 0L21 8"})}),"Email"]}),(0,b.jsxs)("a",{href:t?`tel:${t}`:"#",className:"px-3 py-2 border rounded text-sm inline-flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M22 16.92V21a1 1 0 01-1.11 1A19.86 19.86 0 013 5.11 1 1 0 014 4h4.09a1 1 0 01.95.68 12.05 12.05 0 00.7 2.28 1 1 0 01-.24 1.02L8.91 10.9"})}),"Call"]})]})]})]}),(0,b.jsxs)("div",{className:"lg:col-span-3 mt-4 rounded-lg border p-4",children:[(0,b.jsxs)("div",{className:"flex gap-6 border-b pb-3 text-sm",children:[(0,b.jsx)("button",{className:"pb-2 border-b-2 border-sky-600 text-sky-600 font-medium",children:"Files"}),(0,b.jsx)("button",{className:"pb-2 border-b-2 border-transparent text-slate-700",children:"Follow Up"}),(0,b.jsx)("button",{className:"pb-2 border-b-2 border-transparent text-slate-700",children:"People"}),(0,b.jsx)("button",{className:"pb-2 border-b-2 border-transparent text-slate-700",children:"Notes"}),(0,b.jsx)("button",{className:"pb-2 border-b-2 border-transparent text-slate-700",children:"Comments"}),(0,b.jsx)("button",{className:"pb-2 border-b-2 border-transparent text-slate-700",children:"Tags"})]}),(0,b.jsxs)("div",{className:"mt-4 text-sm",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Upload File"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("input",{id:"deal-file-input",type:"file",onChange:a=>{n(null),l(a.target.files?.[0]??null)},className:"text-sm"}),(0,b.jsx)("button",{onClick:o,disabled:h,className:`px-3 py-2 rounded bg-blue-600 text-white ${h?"opacity-60":"hover:bg-blue-700"}`,children:h?"Uploading...":"Upload"}),m&&(0,b.jsx)("div",{className:"text-destructive text-xs",children:m})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h5",{className:"text-sm font-medium mb-2",children:"Files"}),0===f.length?(0,b.jsx)("div",{className:"text-muted-foreground",children:"No files uploaded."}):(0,b.jsx)("ul",{className:"list-disc pl-5 text-sm",children:f.map((a,c)=>(0,b.jsx)("li",{children:a.url?(0,b.jsx)("a",{href:a.url,className:"text-sky-600 underline",target:"_blank",rel:"noreferrer",children:a.name}):a.name},c))})]}),(0,b.jsx)("div",{className:"mt-4",children:"Follow ups / files listing area â€” replicate your existing UI here as needed."})]})]})]})]})})]})}function u({onClose:a,onSaved:c}){let[d,f]=(0,e.useState)([]),[g,h]=(0,e.useState)(!0),[i,j]=(0,e.useState)(""),[k,l]=(0,e.useState)(null),m=async()=>{h(!0),l(null);try{let a=localStorage.getItem("accessToken");if(!a)throw Error("No access token.");let b=await fetch(n,{headers:{Authorization:`Bearer ${a}`}});if(!b.ok)throw Error(await b.text());let c=await b.json();f(c)}catch(a){l(a?.message??"Failed to load categories")}finally{h(!1)}};(0,e.useEffect)(()=>{m()},[]);let o=async()=>{if(!i.trim())return void l("Category name required.");l(null);try{let a=localStorage.getItem("accessToken");if(!a)throw Error("No access token.");let b=await fetch(n,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({categoryName:i})});if(!b.ok)throw Error(await b.text());await m(),c()}catch(a){l(a?.message??"Failed to add category")}},p=async a=>{if(confirm("Delete this category?"))try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let d=await fetch(`${n}/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}});if(!d.ok)throw Error(await d.text());await m(),c()}catch(a){alert("Error: "+(a?.message??a))}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:a}),(0,b.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-12",children:(0,b.jsxs)("div",{className:"max-w-3xl w-full bg-white rounded-lg shadow-lg border overflow-auto",style:{maxHeight:"80vh"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Deal Category"}),(0,b.jsx)("button",{onClick:a,className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("div",{className:"p-6",children:[k&&(0,b.jsx)("div",{className:"text-destructive mb-3",children:k}),(0,b.jsx)("div",{className:"rounded-lg border p-4 mb-4",children:(0,b.jsx)("div",{className:"overflow-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-sky-50 text-left",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-2 w-12",children:"#"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Category Name"}),(0,b.jsx)("th",{className:"px-4 py-2 w-24",children:"Action"})]})}),(0,b.jsx)("tbody",{children:g?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:3,className:"px-4 py-4 text-center text-muted-foreground",children:"Loadingâ€¦"})}):0===d.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:3,className:"px-4 py-4 text-center text-muted-foreground",children:"No categories."})}):d.map((a,c)=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:c+1}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.categoryName}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("button",{onClick:()=>p(a.id),className:"text-destructive px-2 py-1 rounded border",children:"ðŸ—‘"})})]},a.id))})]})})}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm text-muted-foreground mb-2",children:"Deal Category Name *"}),(0,b.jsx)("input",{value:i,onChange:a=>j(a.target.value),className:"w-full p-2 border rounded-md"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-6",children:[(0,b.jsx)("button",{onClick:a,className:"px-6 py-2 border rounded-full text-blue-600 hover:bg-blue-50",children:"Cancel"}),(0,b.jsx)("button",{onClick:o,className:"px-6 py-2 rounded-full text-white bg-blue-600 hover:bg-blue-700",children:"Save"})]})]})]})})]})}function v({lead:a,onClose:c,onCreated:d,possibleAgents:f,possibleWatchers:g}){let[h,i]=(0,e.useState)({leadContact:a?.id??"",title:"",pipeline:"",dealStage:"Qualified",dealCategory:"",dealAgent:"",dealWatchers:[],value:"",closeDate:""}),[j,k]=(0,e.useState)(!1),[m,o]=(0,e.useState)(null),[p,q]=(0,e.useState)(!1),r=(0,e.useRef)(null),[s,t]=(0,e.useState)(null),[v,w]=(0,e.useState)([]),[x,y]=(0,e.useState)(!0),[z,A]=(0,e.useState)(!1),B=(a,b)=>i(c=>({...c,[a]:b}));(0,e.useEffect)(()=>{let a=a=>{"Escape"===a.key&&c()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[c]);let C=async()=>{y(!0);try{let a=localStorage.getItem("accessToken");if(!a)throw Error("No access token.");let b=await fetch(n,{headers:{Authorization:`Bearer ${a}`}});if(!b.ok)throw Error(await b.text());let c=await b.json();w(c),!h.dealCategory&&c.length>0&&i(a=>({...a,dealCategory:c[0].categoryName}))}catch(a){console.error("Failed to load categories",a)}finally{y(!1)}};(0,e.useEffect)(()=>{C()},[]);let D=async b=>{b?.preventDefault();let e=h.title.trim()?h.pipeline.trim()?h.dealStage.trim()?h.closeDate.trim()?null:"Close date is required.":"Deal stage is required.":"Pipeline is required.":"Deal Name is required.";if(e)return void o(e);o(null),k(!0);try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let e={title:h.title,pipeline:h.pipeline||void 0,dealStage:h.dealStage||void 0,dealCategory:h.dealCategory||void 0,dealAgent:h.dealAgent||void 0,dealWatchers:h.dealWatchers&&h.dealWatchers.length?h.dealWatchers:void 0,value:h.value?Number(h.value):void 0,closeDate:h.closeDate||void 0,leadId:a.id},f=await fetch(l,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!f.ok){let a=await f.text().catch(()=>"");throw Error(a||"Failed to create deal.")}let g=await f.json();d(g),c()}catch(a){o(a?.message??"Failed to create deal.")}finally{k(!1)}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:c}),(0,b.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-12",children:(0,b.jsxs)("div",{className:"max-w-4xl w-full bg-white rounded-lg shadow-lg border overflow-auto",style:{maxHeight:"92vh"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Add Deal Information"}),(0,b.jsx)("button",{onClick:c,className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("form",{onSubmit:D,className:"p-6",children:[m&&(0,b.jsx)("div",{className:"text-destructive text-sm mb-3",children:m}),(0,b.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,b.jsx)("h4",{className:"font-medium mb-4",children:"Deal Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Lead Contact *"}),(0,b.jsx)("select",{className:"w-full p-2 border rounded-md bg-white text-sm",value:String(h.leadContact),onChange:a=>B("leadContact",Number(a.target.value)),children:(0,b.jsx)("option",{value:"",children:a?.name??"--"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Deal Name *"}),(0,b.jsx)("input",{className:"w-full p-2 border rounded-md text-sm",value:h.title,onChange:a=>B("title",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Pipeline *"}),(0,b.jsxs)("select",{className:"w-full p-2 border rounded-md bg-white text-sm",value:h.pipeline,onChange:a=>B("pipeline",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),(0,b.jsx)("option",{children:"Default Pipeline"}),(0,b.jsx)("option",{children:"Sales"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Deal Stages *"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{className:"w-full p-2 border rounded-md bg-white text-sm",value:h.dealStage,onChange:a=>B("dealStage",a.target.value),children:[(0,b.jsx)("option",{children:"Qualified"}),(0,b.jsx)("option",{children:"Generated"}),(0,b.jsx)("option",{children:"Proposal"}),(0,b.jsx)("option",{children:"Won"}),(0,b.jsx)("option",{children:"Lost"})]}),(0,b.jsx)("div",{className:"absolute left-3 top-3 w-2 h-2 rounded-full bg-sky-600"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Deal Category"}),(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsxs)("select",{className:"flex-1 p-2 border rounded-l-md bg-white text-sm",value:h.dealCategory,onChange:a=>B("dealCategory",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),!x&&v.map(a=>(0,b.jsx)("option",{value:a.categoryName,children:a.categoryName},a.id))]}),(0,b.jsx)("button",{type:"button",onClick:()=>A(!0),className:"px-3 py-2 border rounded-r-md bg-gray-200 text-sm",children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Deal Agent"}),(0,b.jsxs)("select",{className:"w-full p-2 border rounded-md bg-white text-sm",value:h.dealAgent,onChange:a=>B("dealAgent",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"--"}),f.map(a=>(0,b.jsx)("option",{value:a.employeeId,children:a.name},a.employeeId))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Deal Value"}),(0,b.jsxs)("div",{className:"flex items-stretch",children:[(0,b.jsx)("span",{className:"inline-flex items-center px-3 rounded-l-md border bg-slate-100 text-sm",children:"USD $"}),(0,b.jsx)("input",{type:"number",className:"w-full p-2 border rounded-r-md text-sm",value:h.value,onChange:a=>B("value",a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Close Date *"}),(0,b.jsx)("input",{type:"date",className:"w-full p-2 border rounded-md text-sm",value:h.closeDate,onChange:a=>B("closeDate",a.target.value)})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Deal Watcher"}),(0,b.jsxs)("button",{type:"button",ref:r,onClick:()=>{let a=r.current;if(!a)return void q(!0);let b=a.getBoundingClientRect(),c=b.bottom+8;t({top:c,left:b.left,width:b.width}),q(a=>!a)},className:"w-full p-2 border rounded-md text-left bg-white text-sm flex items-center justify-between",children:[(0,b.jsx)("span",{className:"truncate",children:(()=>{let a=g.filter(a=>h.dealWatchers.includes(a.employeeId||""));return 0===a.length?"--":a.map(a=>a.name).join(", ")})()}),(0,b.jsx)("svg",{className:`w-4 h-4 transform ${p?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{d:"M6 8l4 4 4-4",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]}),p&&s&&(0,b.jsx)("div",{style:{position:"fixed",top:s.top+window.scrollY,left:s.left,width:s.width,zIndex:60},children:(0,b.jsx)("div",{className:"bg-white border rounded-md shadow-lg p-3 max-h-[60vh] overflow-auto",children:0===g.length?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"No employees"}):(0,b.jsx)("div",{className:"grid gap-2",children:g.map(a=>(0,b.jsxs)("label",{className:"flex items-start gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",className:"mt-1",checked:h.dealWatchers.includes(a.employeeId||""),onChange:b=>{var c,d;return c=a.employeeId||"",d=b.target.checked,void i(a=>{let b=a.dealWatchers||[],e=d?[...b,c]:b.filter(a=>a!==c);return{...a,dealWatchers:e}})}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm",children:a.name}),a.designation&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.designation})]})]},a.employeeId))})})}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Click to open and select watchers"})]})]})]}),(0,b.jsxs)("div",{className:"mt-6 flex items-center justify-center gap-6",children:[(0,b.jsx)("button",{type:"button",onClick:c,className:"px-6 py-2 border rounded-full text-blue-600 hover:bg-blue-50",disabled:j,children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:j,className:`px-6 py-2 rounded-full text-white ${j?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:j?"Creating...":"Create"})]})]})]})}),z&&(0,b.jsx)(u,{onClose:()=>{A(!1)},onSaved:()=>{C()}})]})}function w({lead:a,onClose:c,onSaved:d}){let[f,h]=(0,e.useState)({name:a?.name??"",email:a?.email??"",clientCategory:a?.clientCategory??"",leadSource:a?.leadSource??"",leadOwner:a?.leadOwner??"",addedBy:a?.addedBy??"",autoConvertToClient:!!a?.autoConvertToClient,companyName:a?.companyName??"",officialWebsite:a?.officialWebsite??"",mobileNumber:String(a?.mobileNumber??""),officePhone:a?.officePhone??"",city:a?.city??"",state:a?.state??"",postalCode:a?.postalCode??"",country:a?.country??"",companyAddress:a?.companyAddress??""}),[i,j]=(0,e.useState)(!1),[l,m]=(0,e.useState)(null);(0,e.useEffect)(()=>{let a=a=>{"Escape"===a.key&&c()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[c]);let n=(a,b)=>h(c=>({...c,[a]:b})),o=async b=>{b?.preventDefault();let c=f.name.trim()&&f.email.trim()?null:"Name and Email are required.";if(c)return void m(c);m(null),j(!0);try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let c={name:f.name,email:f.email,clientCategory:f.clientCategory||void 0,leadSource:f.leadSource||void 0,leadOwner:f.leadOwner||void 0,addedBy:f.addedBy||void 0,autoConvertToClient:!!f.autoConvertToClient,companyName:f.companyName||void 0,officialWebsite:f.officialWebsite||void 0,mobileNumber:f.mobileNumber?Number(f.mobileNumber):void 0,officePhone:f.officePhone||void 0,city:f.city||void 0,state:f.state||void 0,postalCode:f.postalCode||void 0,country:f.country||void 0,companyAddress:f.companyAddress||void 0},e=await fetch(`${k}/leads/${a.id}`,{method:"PUT",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify(c)});if(!e.ok){let a=await e.text().catch(()=>"");throw Error(a||"Update failed")}await e.json(),alert("Lead updated successfully."),await d()}catch(a){m(a?.message??"Failed to update lead.")}finally{j(!1)}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:c}),(0,b.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-12",children:(0,b.jsxs)("div",{className:"max-w-4xl w-full bg-white rounded-lg shadow-lg border overflow-auto",style:{maxHeight:"92vh"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Update Lead Contact"}),(0,b.jsx)("button",{onClick:c,className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("form",{onSubmit:o,className:"p-6 space-y-6",children:[l&&(0,b.jsx)("div",{className:"text-destructive text-sm",children:l}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Contact Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Name *"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.name,onChange:a=>n("name",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Email *"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.email,onChange:a=>n("email",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Lead Source"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.leadSource,onChange:a=>n("leadSource",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Lead Owner"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.leadOwner,onChange:a=>n("leadOwner",a.target.value)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 md:col-span-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"autoConvert",checked:!!f.autoConvertToClient,onChange:a=>n("autoConvertToClient",a.target.checked)}),(0,b.jsx)("label",{htmlFor:"autoConvert",className:"text-sm",children:'Auto Convert lead to client when the deal stage is set to "WIN".'})]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Company Name"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.companyName,onChange:a=>n("companyName",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Official Website"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.officialWebsite,onChange:a=>n("officialWebsite",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Mobile Number"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.mobileNumber,onChange:a=>n("mobileNumber",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Office Phone No."}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.officePhone,onChange:a=>n("officePhone",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"City"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.city,onChange:a=>n("city",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"State"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.state,onChange:a=>n("state",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Postal Code"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.postalCode,onChange:a=>n("postalCode",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Country"}),(0,b.jsx)("input",{className:"w-full border rounded-md p-2",value:f.country,onChange:a=>n("country",a.target.value)})]}),(0,b.jsxs)("div",{className:"md:col-span-3",children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground",children:"Company Address"}),(0,b.jsx)("textarea",{className:"w-full border rounded-md p-2 h-28",value:f.companyAddress,onChange:a=>n("companyAddress",a.target.value)})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:c,disabled:i,children:"Cancel"}),(0,b.jsx)(g.Button,{type:"submit",onClick:o,disabled:i,children:i?"Updating...":"Update"})]})]})]})})]})}function x({leadId:a,initial:c,onClose:d,onSaved:f}){let g=!!c?.id,[h,i]=(0,e.useState)({noteTitle:c?.noteTitle??"",noteType:c?.noteType??"PUBLIC",noteDetails:c?.noteDetails??""}),[j,l]=(0,e.useState)(!1),[m,n]=(0,e.useState)(null);(0,e.useEffect)(()=>{let a=a=>{"Escape"===a.key&&d()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[d]);let o=(a,b)=>i(c=>({...c,[a]:b})),p=async b=>{b?.preventDefault();let d=h.noteTitle.trim()?null:"Note Title is required.";if(d)return void n(d);n(null),l(!0);try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let d=g?`${k}/leads/${a}/notes/${c?.id}`:`${k}/leads/${a}/notes`,e=await fetch(d,{method:g?"PUT":"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({noteTitle:h.noteTitle,noteType:h.noteType,noteDetails:h.noteDetails})});if(!e.ok){let a=await e.text().catch(()=>"");throw Error(a||"Failed to save note.")}let i=await e.json();f(i)}catch(a){n(a?.message??"Save failed")}finally{l(!1)}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:d}),(0,b.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-12",children:(0,b.jsxs)("div",{className:"max-w-3xl w-full bg-white rounded-lg shadow-lg border overflow-auto",style:{maxHeight:"90vh"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:g?"Edit Lead Note":"Add Lead Note"}),(0,b.jsx)("button",{onClick:d,className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("form",{onSubmit:p,className:"p-6",children:[m&&(0,b.jsx)("div",{className:"text-destructive text-sm mb-3",children:m}),(0,b.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,b.jsx)("h4",{className:"font-medium mb-4",children:"Lead Note Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Note Title *"}),(0,b.jsx)("input",{className:"w-full p-2 border rounded-md text-sm",value:h.noteTitle,onChange:a=>o("noteTitle",a.target.value),placeholder:"Enter Note Title"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Note Type"}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"radio",checked:"PUBLIC"===h.noteType,onChange:()=>o("noteType","PUBLIC")}),(0,b.jsx)("span",{children:"Public"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"radio",checked:"PRIVATE"===h.noteType,onChange:()=>o("noteType","PRIVATE")}),(0,b.jsx)("span",{children:"Private"})]})]})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground mb-2",children:"Note Detail"}),(0,b.jsx)("textarea",{className:"w-full p-3 border rounded-md text-sm h-36",value:h.noteDetails,onChange:a=>o("noteDetails",a.target.value),placeholder:"Enter details..."})]})]})]}),(0,b.jsxs)("div",{className:"mt-6 flex items-center justify-center gap-6",children:[(0,b.jsx)("button",{type:"button",onClick:d,className:"px-6 py-2 border rounded-full text-blue-600 hover:bg-blue-50",disabled:j,children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:j,className:`px-6 py-2 rounded-full text-white ${j?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"}`,children:j?"Saving...":"Save"})]})]})]})})]})}function y({note:a,onClose:c}){return(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:c}),(0,b.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-12",children:(0,b.jsxs)("div",{className:"max-w-3xl w-full bg-white rounded-lg shadow-lg border overflow-auto",style:{maxHeight:"90vh"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:a.noteTitle??"My Note"}),(0,b.jsx)("button",{onClick:c,className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:(0,b.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,b.jsx)("h4",{className:"font-medium mb-4",children:"Project Note Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,b.jsx)("div",{className:"text-muted-foreground",children:"Note Title"}),(0,b.jsx)("div",{className:"md:col-span-2",children:a.noteTitle??"--"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:"Note Type"}),(0,b.jsx)("div",{className:"md:col-span-2",children:"PUBLIC"===a.noteType?"Public":"Private"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:"Note Detail"}),(0,b.jsx)("div",{className:"md:col-span-2",children:a.noteDetails?a.noteDetails:"---"})]})]})})]})})]})}function z({params:a}){let l=(0,c.useRouter)(),{data:n,error:u,isLoading:z,mutate:A}=(0,d.default)(`/api/leads/admin/get/${a.id}`,o,{refreshInterval:3e4,revalidateOnFocus:!0}),[B,C]=(0,e.useState)("profile"),[D,E]=(0,e.useState)(!1),F=(0,e.useRef)(null),[G,H]=(0,e.useState)(!1),{data:I,error:J,isLoading:K,mutate:L}=(0,d.default)("deals"===B?`${k}/deals/lead/${a.id}`:null,o,{refreshInterval:3e4,revalidateOnFocus:!0}),{data:M}=(0,d.default)(m,o,{refreshInterval:0}),N=M&&Array.isArray(M.content)?M.content.map(a=>({employeeId:a.employeeId,name:a.name,designation:a.designationName??null,department:a.departmentName??null,profileUrl:a.profilePictureUrl??null})):[],[O,P]=(0,e.useState)(!1),[Q,R]=(0,e.useState)(null),[S,T]=(0,e.useState)(null);(0,e.useEffect)(()=>{let a=a=>{if(!F.current)return;let b=a.target;D&&!F.current.contains(b)&&E(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[D]);let U=async()=>{if(E(!1),confirm("Convert this lead to client?"))try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let c=await fetch(`${k}/leads/${a.id}/convert`,{method:"POST",headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error(await c.text());alert("Converted to client."),await A(),l.push("/leads")}catch(a){alert("Error: "+(a?.message??a))}},V=async()=>{if(E(!1),confirm("Delete this lead?"))try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let c=await fetch(`${k}/leads/${a.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error(await c.text());alert("Deleted."),l.push("/leads")}catch(a){alert("Error: "+(a?.message??a))}},W=async a=>{L&&L(b=>b?[a,...b]:[a],!1)},[X,Y]=(0,e.useState)([]),[Z,$]=(0,e.useState)(!1),[_,aa]=(0,e.useState)(null),[ab,ac]=(0,e.useState)(!1),[ad,ae]=(0,e.useState)(null),[af,ag]=(0,e.useState)(null),[ah,ai]=(0,e.useState)(null),aj=(0,e.useRef)(null),[ak,al]=(0,e.useState)(null),am=a=>`${k}/leads/${a}/notes`,an=async()=>{$(!0),aa(null);try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let c=await fetch(am(a.id),{headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error(await c.text());let d=await c.json();Y(Array.isArray(d)?d:[])}catch(a){aa(a?.message??"Failed to load notes")}finally{$(!1)}};(0,e.useEffect)(()=>{"notes"===B&&an()},[B,a.id]);let ao=async b=>{if(b&&confirm("Delete this note?"))try{let c=localStorage.getItem("accessToken");if(!c)throw Error("No access token.");let d=await fetch(`${am(a.id)}/${b}`,{method:"DELETE",headers:{Authorization:`Bearer ${c}`}});if(!d.ok)throw Error(await d.text());Y(a=>a.filter(a=>a.id!==b)),ag(null),ai(null)}catch(a){alert("Error: "+(a?.message??a))}};return(0,e.useEffect)(()=>{if(null==af)return;let a=a=>{let b=a.target;aj.current&&(aj.current.contains(b)||(ag(null),ai(null)))},b=()=>{ag(null),ai(null)},c=()=>{ag(null),ai(null)};return document.addEventListener("mousedown",a),window.addEventListener("scroll",b,!0),window.addEventListener("resize",c),()=>{document.removeEventListener("mousedown",a),window.removeEventListener("scroll",b,!0),window.removeEventListener("resize",c)}},[af]),(0,b.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[(0,b.jsxs)("div",{className:"container mx-auto max-w-6xl px-4 py-8",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",onClick:()=>l.back(),"aria-label":"Back",children:(0,b.jsx)(i.ArrowLeft,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-semibold",children:n?.name??"â€”"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Detailed information about the selected lead."})]})]}),(0,b.jsx)("div",{className:"mb-4 border-b bg-white rounded-t",children:(0,b.jsxs)("nav",{className:"flex items-center gap-6 px-4",children:[(0,b.jsx)("button",{onClick:()=>C("profile"),className:`py-3 text-sm ${"profile"===B?"border-b-2 border-sky-600 text-sky-600":"text-muted-foreground"}`,children:"Profile"}),(0,b.jsx)("button",{onClick:()=>C("deals"),className:`py-3 text-sm ${"deals"===B?"border-b-2 border-sky-600 text-sky-600":"text-muted-foreground"}`,children:"Deals"}),(0,b.jsx)("button",{onClick:()=>C("notes"),className:`py-3 text-sm ${"notes"===B?"border-b-2 border-sky-600 text-sky-600":"text-muted-foreground"}`,children:"Notes"})]})}),(0,b.jsx)(f.Card,{className:"p-6",children:z?(0,b.jsx)("div",{className:"py-12 text-center text-muted-foreground",children:"Loading lead detailsâ€¦"}):u?(0,b.jsxs)("div",{className:"py-12 text-center",children:[(0,b.jsx)("p",{className:"text-destructive",children:"Failed to load lead details."}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:u?.message}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(g.Button,{variant:"ghost",onClick:()=>l.back(),children:"Back to Leads"})})]}):n?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"profile"===B?"Profile Information":"deals"===B?"Deals":"Notes"}),(0,b.jsxs)("div",{className:"relative",ref:F,children:[(0,b.jsx)("button",{onClick:()=>E(a=>!a),className:"p-2 rounded hover:bg-slate-100","aria-label":"More actions",children:(0,b.jsxs)("svg",{className:"w-5 h-5 text-muted-foreground",viewBox:"0 0 24 24",fill:"currentColor",children:[(0,b.jsx)("circle",{cx:"5",cy:"12",r:"1.5"}),(0,b.jsx)("circle",{cx:"12",cy:"12",r:"1.5"}),(0,b.jsx)("circle",{cx:"19",cy:"12",r:"1.5"})]})}),D&&(0,b.jsx)("div",{className:"absolute right-0 mt-2 w-44 rounded-md border bg-white shadow-lg z-30",children:(0,b.jsxs)("ul",{className:"py-1",children:[(0,b.jsx)("li",{children:(0,b.jsx)("button",{onClick:()=>{E(!1),H(!0)},className:"w-full text-left px-4 py-2 hover:bg-slate-50 flex items-center gap-2 text-sm",children:"Edit"})}),(0,b.jsx)("li",{children:(0,b.jsx)("button",{onClick:U,className:"w-full text-left px-4 py-2 hover:bg-slate-50 flex items-center gap-2 text-sm",children:"Change to Client"})}),(0,b.jsx)("li",{children:(0,b.jsx)("button",{onClick:V,className:"w-full text-left px-4 py-2 hover:bg-slate-50 flex items-center gap-2 text-sm text-destructive",children:"Delete"})})]})})]})]}),"profile"===B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"rounded-lg border p-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("dl",{className:"hidden md:block md:col-span-1 space-y-4 text-sm text-muted-foreground",children:[(0,b.jsx)("dt",{children:"Name"}),(0,b.jsx)("dt",{children:"Email"}),(0,b.jsx)("dt",{children:"Lead Owner"}),(0,b.jsx)("dt",{children:"Source"}),(0,b.jsx)("dt",{children:"Company Name"}),(0,b.jsx)("dt",{children:"Website"}),(0,b.jsx)("dt",{children:"Mobile"}),(0,b.jsx)("dt",{children:"Office Phone Number"}),(0,b.jsx)("dt",{children:"City"}),(0,b.jsx)("dt",{children:"State"}),(0,b.jsx)("dt",{children:"Country"}),(0,b.jsx)("dt",{children:"Postal Code"}),(0,b.jsx)("dt",{children:"Address"})]}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsxs)("div",{className:"grid gap-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Name"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.name)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Email"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.email)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Lead Owner"}),(0,b.jsx)("div",{className:"text-sm",children:n?.leadOwnerMeta?.name??n?.leadOwner??"--"})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Source"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.leadSource)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Company Name"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.companyName)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Website"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.officialWebsite)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Mobile"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.mobileNumber)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Office Phone Number"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.officePhone)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"City"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.city)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"State"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.state)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Country"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.country)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Postal Code"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.postalCode)})]}),(0,b.jsxs)("div",{className:"flex items-start gap-6",children:[(0,b.jsx)("div",{className:"w-48 md:hidden text-sm text-muted-foreground",children:"Address"}),(0,b.jsx)("div",{className:"text-sm",children:p(n?.companyAddress)})]})]})})]})}),(0,b.jsxs)("div",{className:"mt-6 text-sm text-muted-foreground grid md:grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:["Created: ",q(n?.createdAt)]}),(0,b.jsxs)("div",{className:"text-right",children:["Status: ",(0,b.jsx)(h.Badge,{variant:"secondary",children:n?.status??"--"})]})]})]}),"deals"===B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(g.Button,{onClick:()=>P(!0),children:"+ Add Deal"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-muted-foreground mr-2",children:"Pipeline"}),(0,b.jsxs)("select",{className:"border rounded p-2 text-sm",children:[(0,b.jsx)("option",{children:n?.deals&&n.deals?.length?n?.deals:n?.pipeline??"Default Pipeline"}),(0,b.jsx)("option",{children:"Sales"}),(0,b.jsx)("option",{children:"Default Pipeline "})]})]})]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Result per page - 8"})]}),(0,b.jsx)("div",{className:"rounded-lg border overflow-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-sky-50 text-left",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-2",children:"Deal Name"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Lead Name"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Contact Details"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Value"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Close Date"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Follow Up"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Deal Agent"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Deal Watcher"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Stage"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Action"})]})}),(0,b.jsx)("tbody",{children:K?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:10,className:"px-4 py-6 text-center text-muted-foreground",children:"Loading dealsâ€¦"})}):J?(0,b.jsx)("tr",{children:(0,b.jsxs)("td",{colSpan:10,className:"px-4 py-6 text-center text-destructive",children:["Failed to load deals: ",J?.message]})}):I&&0!==I.length?I.map(a=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsx)("div",{className:"font-medium",children:a.title??`Deal ${a.id}`}),(0,b.jsx)("div",{className:"text-muted-foreground text-xs",children:a.dealCategory??"--"})]}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.leadName??n?.name??"--"}),(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsx)("div",{className:"text-xs",children:p(a.leadMobile)}),(0,b.jsx)("div",{className:"text-muted-foreground text-xs",children:n?.email??"--"})]}),(0,b.jsx)("td",{className:"px-4 py-3",children:s(a.value??0)}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.expectedCloseDate?r(a.expectedCloseDate):a.updatedAt?r(a.updatedAt):"--"}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.followups&&a.followups.length>0?(0,b.jsx)("div",{className:"text-sm",children:r(a.followups[0].nextDate)}):(0,b.jsx)("div",{className:"text-muted-foreground",children:"------"})}),(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsx)("div",{className:"text-sm",children:a.dealAgentMeta?.name??a.dealAgent??"--"}),(0,b.jsx)("div",{className:"text-muted-foreground text-xs",children:a.dealAgentMeta?.designation??""})]}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.dealWatchersMeta&&a.dealWatchersMeta.length>0?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm",children:a.dealWatchersMeta[0].name}),(0,b.jsx)("div",{className:"text-muted-foreground text-xs",children:a.dealWatchersMeta[0].designation})]}):(0,b.jsx)("div",{className:"text-muted-foreground",children:"--"})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("select",{defaultValue:a.dealStage,className:"border rounded p-1 text-sm",children:[(0,b.jsx)("option",{children:a.dealStage??"Generated"}),(0,b.jsx)("option",{children:"Generated "}),(0,b.jsx)("option",{children:"Qualified"}),(0,b.jsx)("option",{children:"Proposal"}),(0,b.jsx)("option",{children:"Won"}),(0,b.jsx)("option",{children:"Lost"})]})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>{R(a),T(n??null)},className:"text-sm px-2 py-1 border rounded hover:bg-slate-50",children:(0,b.jsx)(j.default,{href:`/deals/get/${a.id}`,children:"View"})}),(0,b.jsx)("button",{onClick:()=>{l.push(`/deals/create/DealEdit/${a.id}`)},className:"text-sm px-2 py-1 border rounded hover:bg-slate-50",children:"Edit"}),(0,b.jsx)("button",{onClick:async()=>{if(confirm("Delete this deal?"))try{let b=localStorage.getItem("accessToken");if(!b)throw Error("No access token.");let c=await fetch(`${k}/deals/${a.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error(await c.text());alert("Deal deleted."),await L()}catch(a){alert("Error: "+(a?.message??a))}},className:"text-sm px-2 py-1 border rounded text-destructive hover:bg-slate-50",children:"Delete"})]})})]},a.id)):(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:10,className:"px-4 py-6 text-center text-muted-foreground",children:"No deals found for this lead."})})})]})}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between text-sm text-muted-foreground",children:[(0,b.jsx)("div",{children:"Page 1 of 1 "}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"px-2 py-1",disabled:!0,children:"â€¹"}),(0,b.jsx)("button",{className:"px-2 py-1",disabled:!0,children:"â€º"})]})]})]}),"notes"===B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsx)("button",{onClick:()=>{ae(null),ac(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded",children:"+ Add Note"})}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Result per page - 8"})]}),(0,b.jsx)("div",{className:"rounded-lg border overflow-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-sky-50 text-left",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-2",children:"Note Title"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Note Type"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Created"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Action"})]})}),(0,b.jsx)("tbody",{children:Z?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:4,className:"px-4 py-6 text-center text-muted-foreground",children:"Loading notesâ€¦"})}):_?(0,b.jsx)("tr",{children:(0,b.jsxs)("td",{colSpan:4,className:"px-4 py-6 text-center text-destructive",children:["Failed to load notes: ",_]})}):X&&0!==X.length?X.map(a=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsx)("div",{className:"font-medium",children:a.noteTitle}),a.noteDetails&&(0,b.jsx)("div",{className:"text-muted-foreground text-xs truncate max-w-xl",children:a.noteDetails})]}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("div",{className:"flex items-center gap-2 text-sm",children:"PUBLIC"===a.noteType?(0,b.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-4 h-4 text-sky-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.5"})}),(0,b.jsx)("span",{children:"Public"})]}):(0,b.jsxs)("div",{className:"inline-flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,b.jsx)("path",{d:"M12 2v6",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,b.jsx)("span",{children:"Private"})]})})}),(0,b.jsx)("td",{className:"px-4 py-3",children:q(a.createdAt)}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("button",{onClick:b=>((a,b)=>{if(a.stopPropagation(),!b)return;let c=a.currentTarget.getBoundingClientRect(),d=c.bottom+8+window.scrollY,e=c.right-160;ag(a=>a===b?null:b),ai({top:d,left:Math.max(e,8)})})(b,a.id),className:"p-1 rounded hover:bg-slate-100","aria-label":"Note actions",children:(0,b.jsxs)("svg",{className:"w-5 h-5 text-muted-foreground",viewBox:"0 0 24 24",fill:"currentColor",children:[(0,b.jsx)("circle",{cx:"5",cy:"12",r:"1.5"}),(0,b.jsx)("circle",{cx:"12",cy:"12",r:"1.5"}),(0,b.jsx)("circle",{cx:"19",cy:"12",r:"1.5"})]})})})]},a.id)):(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:4,className:"px-4 py-6 text-center text-muted-foreground",children:"No notes found for this lead."})})})]})}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between text-sm text-muted-foreground",children:[(0,b.jsx)("div",{children:"Page 1 of 1"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"px-2 py-1",disabled:!0,children:"â€¹"}),(0,b.jsx)("button",{className:"px-2 py-1",disabled:!0,children:"â€º"})]})]}),null!=af&&ah&&(0,b.jsx)("div",{ref:aj,style:{position:"fixed",top:ah.top,left:ah.left,zIndex:70,minWidth:160},children:(0,b.jsx)("div",{className:"rounded-md border bg-white shadow-lg",children:(0,b.jsxs)("ul",{className:"py-1",children:[(0,b.jsx)("li",{children:(0,b.jsx)("button",{onClick:()=>{let a=X.find(a=>a.id===af)??null;a&&al(a),ag(null),ai(null)},className:"w-full text-left px-4 py-2 hover:bg-slate-50 text-sm",children:"View"})}),(0,b.jsx)("li",{children:(0,b.jsx)("button",{onClick:()=>{let a=X.find(a=>a.id===af)??null;a&&(ae(a),ac(!0)),ag(null),ai(null)},className:"w-full text-left px-4 py-2 hover:bg-slate-50 text-sm",children:"Edit"})}),(0,b.jsx)("li",{children:(0,b.jsx)("button",{onClick:()=>{ao(af??void 0),ag(null),ai(null)},className:"w-full text-left px-4 py-2 hover:bg-slate-50 text-sm text-destructive",children:"Delete"})})]})})})]})]}):(0,b.jsx)("div",{className:"py-12 text-center text-muted-foreground",children:"No lead found."})})]}),G&&n&&(0,b.jsx)(w,{lead:n,onClose:()=>H(!1),onSaved:async()=>{H(!1),await A()}}),O&&n&&(0,b.jsx)(v,{lead:n,onClose:()=>P(!1),onCreated:W,possibleAgents:N,possibleWatchers:N}),Q&&(0,b.jsx)(t,{deal:Q,lead:S,onClose:()=>{R(null),T(null)}}),ab&&n&&(0,b.jsx)(x,{leadId:n.id,initial:ad,onClose:()=>{ac(!1),ae(null)},onSaved:a=>{ac(!1),ae(null),ag(null),an()}}),ak&&(0,b.jsx)(y,{note:ak,onClose:()=>{al(null)}})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_leads_admin_get_%5Bid%5D_page_tsx_ccff83f5._.js.map