module.exports=[322191,a=>{"use strict";a.s(["default",()=>u],322191);var b=a.i(187924),c=a.i(572131),d=a.i(699570),e=a.i(866718),f=a.i(580701),g=a.i(206015),h=a.i(335732),i=a.i(613749),j=a.i(50522),k=a.i(177156),l=a.i(781560),m=a.i(369012),n=a.i(633508);let o=(a,b)=>{let c=new Date(a);return c.setDate(c.getDate()+b),c},p=(a,b)=>a.toDateString()===b.toDateString();function q(){let[a,d]=(0,c.useState)([]),[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(new Date),i=async()=>{try{f(!0);let a=await fetch("https://6jnqmj85-80.inc1.devtunnels.ms/api/projects",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},credentials:"include"});if(!a.ok)throw Error("Failed to fetch projects");let b=(await a.json()).map(a=>({id:a.id,name:a.name,startDate:a.startDate,deadline:a.deadline}));d(b)}catch(a){console.error("Project fetch error:",a)}finally{f(!1)}};(0,c.useEffect)(()=>{i()},[]);let j=(0,c.useMemo)(()=>{let a=new Date(g.getFullYear(),g.getMonth(),1),b=new Date(g.getFullYear(),g.getMonth()+1,0),c=[],d=new Date(a);d.setDate(a.getDate()-a.getDay());let e=new Date(b);e.setDate(b.getDate()+(6-b.getDay()));let f=d;for(;f<=e;)c.push(new Date(f)),f=o(f,1);return c},[g]);return(0,b.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-sm border p-4 ",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("button",{onClick:()=>h(new Date(g.getFullYear(),g.getMonth()-1,1)),className:"px-3 py-1 border rounded",children:"◀"}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:g.toLocaleString("default",{month:"long",year:"numeric"})}),(0,b.jsx)("button",{onClick:()=>h(new Date(g.getFullYear(),g.getMonth()+1,1)),className:"px-3 py-1 border rounded",children:"▶"})]}),e&&(0,b.jsx)("div",{className:"text-center py-6 text-sm text-gray-500",children:"Loading projects..."}),(0,b.jsx)("div",{className:"grid grid-cols-7 text-sm font-medium text-center border-b pb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(a=>(0,b.jsx)("div",{children:a},a))}),(0,b.jsx)("div",{className:"mt-2 max-h-[70vh] overflow-y-auto overflow-x-hidden",children:(0,b.jsx)("div",{className:"grid grid-cols-7 gap-px bg-gray-200 mt-2",children:j.map((c,d)=>{let e=a.filter(a=>{let b=new Date(a.startDate),d=new Date(a.deadline);return c>=b&&c<=d}),f=c.getMonth()===g.getMonth();return(0,b.jsxs)("div",{className:`min-h-[110px] bg-white p-1 text-xs ${!f?"opacity-40":""}`,children:[(0,b.jsx)("div",{className:"text-right font-semibold",children:c.getDate()}),(0,b.jsx)("div",{className:"space-y-1 mt-1",children:e.map(a=>{let d=p(c,new Date(a.startDate)),e=p(c,new Date(a.deadline));return(0,b.jsxs)("div",{className:`px-2 py-1 rounded text-white text-[11px]
                        ${d||e?"bg-blue-600":"bg-blue-400"}`,children:[d&&(0,b.jsx)("span",{children:"▶ "}),a.name,e&&(0,b.jsx)("span",{children:" ◀"})]},a.id)})})]},d)})})})]})}let r="https://6jnqmj85-80.inc1.devtunnels.ms",s=["IN_PROGRESS","NOT_STARTED","ON_HOLD","CANCELLED","FINISHED"],t="projectProgressOverrides";function u(){let[a,o]=(0,c.useState)([]),[p,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)("all"),[D,E]=(0,c.useState)("all"),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)("all"),[N,O]=(0,c.useState)("all"),[P,Q]=(0,c.useState)("all"),[R,S]=(0,c.useState)(1),[T,U]=(0,c.useState)(1),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(""),[Z,$]=(0,c.useState)(""),[_,aa]=(0,c.useState)(""),[ab,ac]=(0,c.useState)(""),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)("none"),[ah,ai]=(0,c.useState)("none"),[aj,ak]=(0,c.useState)("none"),[al,am]=(0,c.useState)(""),[an,ao]=(0,c.useState)(!0),[ap,aq]=(0,c.useState)(""),[ar,as]=(0,c.useState)(null),[at,au]=(0,c.useState)("USD"),[av,aw]=(0,c.useState)(""),[ax,ay]=(0,c.useState)(""),[az,aA]=(0,c.useState)(!1),aB=(0,c.useRef)(null),[aC,aD]=(0,c.useState)("you"),[aE,aF]=(0,c.useState)(!1),[aG,aH]=(0,c.useState)(!1),[aI,aJ]=(0,c.useState)([]),[aK,aL]=(0,c.useState)(!1),[aM,aN]=(0,c.useState)(""),[aO,aP]=(0,c.useState)(!1),[aQ,aR]=(0,c.useState)([]),[aS,aT]=(0,c.useState)(!1),[aU,aV]=(0,c.useState)([]),[aW,aX]=(0,c.useState)(!1),[aY,aZ]=(0,c.useState)(!1),[a$,a_]=(0,c.useState)(null),[a0,a1]=(0,c.useState)("grid"),[a2,a3]=(0,c.useState)(!1),[a4,a5]=(0,c.useState)(!1),[a6,a7]=(0,c.useState)(!1);(0,c.useEffect)(()=>{document.body.style.overflow=J||V||aG||aY||a6?"hidden":"auto"},[J,V,aG,aY,a6]);let a8=Array.from(new Set(a.map(a=>a.name))).filter(Boolean),a9=Array.from(new Set(a.flatMap(a=>(a.assignedEmployees||[]).map(a=>a.name)))).filter(Boolean),ba=aI.map(a=>({id:String(a.id),name:a.name})),bb=aQ.map(a=>({id:String(a.id),name:a.name})),bc=aU.map(a=>({id:String(a.id),name:a.departmentName})),bd=()=>{try{let a=localStorage.getItem(t);if(!a)return{};return JSON.parse(a)}catch{return{}}},be=(a,b)=>{let c=bd(),d=String(a);null==b?delete c[d]:c[d]=b;try{localStorage.setItem(t,JSON.stringify(c))}catch{}},bf=(0,c.useCallback)(async a=>{u(!0);try{let b=a||v||null;if(!b){o([]),U(1),u(!1);return}let c=new URLSearchParams({page:String(R),limit:String(9),search:z||"",status:"all"!==B?B:"",progress:"all"!==D?D:"",project:"all"!==L?L:"",member:"all"!==N?N:"",client:"all"!==P?P:""}),d=await fetch(`${r}/api/projects?${c.toString()}`,{headers:{Authorization:`Bearer ${b}`},cache:"no-store"});if(401===d.status){try{localStorage.removeItem("accessToken")}catch{}w(null),o([]),U(1),u(!1);return}if(!d.ok){let a=await d.text().catch(()=>"");throw console.error("getProjects failed",d.status,a),Error("Failed to load projects")}let e=await d.json(),f=[];Array.isArray(e)?f=e:(f=e.projects||e.items||[],U(e.totalPages||Math.max(1,Math.ceil((e.total||9)/9))));let g=bd();Object.keys(g).length>0&&(f=f.map(a=>{let b=g[String(a.id)];return null!=b?{...a,progressPercent:b}:a})),o(f)}catch(a){console.error("Error loading projects:",a),o([]),U(1)}finally{u(!1)}},[R,z,B,D,L,N,P,v]),bg=(0,c.useCallback)(async a=>{aL(!0);try{let b=a||v||null,c=await fetch(`${r}/api/projects/category`,{headers:b?{Authorization:`Bearer ${b}`}:void 0,cache:"no-store"});if(!c.ok){console.warn("Failed to load categories, status:",c.status),aJ([]),aL(!1);return}let d=await c.json();Array.isArray(d)?d.length>0&&"string"==typeof d[0]?aJ(d.map((a,b)=>({id:b+1,name:String(a)}))):aJ(d.map(a=>({id:a.id??a.name??Math.random(),name:a.name??String(a)}))):aJ([])}catch(a){console.error("Error loading categories:",a),aJ([])}finally{aL(!1)}},[v]),bh=async()=>{aH(!0),await bg()},bi=()=>{aH(!1),aN("")},bj=async()=>{let a=aM.trim();if(!a)return alert("Category name required");aP(!0);let b=aI.slice(),c={id:`temp-${Date.now()}`,name:a};aJ(a=>[...a,c]);try{let d=v||null,e=await fetch(`${r}/api/projects/category`,{method:"POST",headers:{"Content-Type":"application/json",...d?{Authorization:`Bearer ${d}`}:{}},body:JSON.stringify({name:a}),cache:"no-store"});if(!e.ok){let a=await e.text().catch(()=>"");console.error("Add category failed",e.status,a),aJ(b),alert("Failed to add category");return}let f=await e.json().catch(()=>null);if(f&&(f.id||f.name))aJ(b=>b.map(b=>b.id===c.id?{id:f.id??f.name??Math.random(),name:f.name??a}:b)),ag(String(f.id??f.name??a));else{await bg();let b=aI.find(b=>b.name===a);b&&ag(String(b.id))}aN("")}catch(a){console.error("Add category error:",a),aJ(b),alert("Failed to add category")}finally{aP(!1)}},bk=async a=>{if(!confirm("Delete this category?"))return;let b=aI.slice();aJ(b=>b.filter(b=>b.id!==a));try{let b=v||null;if(!(await fetch(`${r}/api/projects/category/${encodeURIComponent(String(a))}`,{method:"DELETE",headers:b?{Authorization:`Bearer ${b}`}:void 0,cache:"no-store"})).ok)throw Error("Delete failed")}catch(a){console.error("Delete category failed:",a),aJ(b),alert("Failed to delete category")}};async function bl(b,c){if(!v)return alert("Not authenticated");o(a=>a.map(a=>a.id===b?{...a,projectStatus:c}:a));try{let a=new FormData;a.append("status",c);let d=await fetch(`${r}/api/projects/${b}/status`,{method:"PUT",body:a,headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),e=null;try{e=await d.json()}catch{e=null}e&&e.id?(o(a=>a.map(a=>a.id===e.id?{...a,...e}:a)),null!=e.progressPercent&&be(e.id,null)):await bf(v)}catch(b){console.error("Status update failed",b),o(a),alert("Failed to update status on server")}}async function bm(b,c){if(!v)return alert("Not authenticated");let d=Math.max(0,Math.min(100,Math.round(c)));o(a=>a.map(a=>a.id===b?{...a,progressPercent:d}:a)),be(b,d);try{let c=new FormData;c.append("percent",String(d));let e=await fetch(`${r}/api/projects/${b}/progress`,{method:"PUT",body:c,headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(401===e.status){console.error("patchProgress 401 unauthorized"),o(a),be(b,null),localStorage.removeItem("accessToken"),w(null),alert("Session expired. Please login again.");return}if(!e.ok){let c=await e.text().catch(()=>"");console.error("patchProgress failed:",e.status,c),o(a),be(b,null),alert("Failed to update progress on server");return}let f=null;try{f=204!==e.status?await e.json():null}catch{f=null}f&&f.id?(o(a=>a.map(a=>a.id===f.id?{...a,...f}:a)),null!=f.progressPercent&&be(f.id,null)):await bf(v)}catch(c){console.error("Progress update failed:",c),o(a),be(b,null),alert("Failed to update progress on server")}}(0,c.useCallback)(async a=>{aT(!0);try{let b=a||v||null,c=await fetch(`${r}/clients`,{headers:b?{Authorization:`Bearer ${b}`}:void 0,cache:"no-store"});if(!c.ok){console.warn("Failed to load clients, status:",c.status),aR([]),aT(!1);return}let d=await c.json();Array.isArray(d)?aR(d):Array.isArray(d.items)?aR(d.items):aR([])}catch(a){console.error("Error loading clients:",a),aR([])}finally{aT(!1)}},[v]),(0,c.useCallback)(async a=>{aX(!0);try{let b=a||v||null,c=await fetch(`${r}/admin/departments`,{headers:b?{Authorization:`Bearer ${b}`}:void 0,cache:"no-store"});if(!c.ok){console.warn("Failed to load departments, status:",c.status),aV([]),aX(!1);return}let d=await c.json();Array.isArray(d)?aV(d):Array.isArray(d.items)?aV(d.items):aV([])}catch(a){console.error("Error loading departments:",a),aV([])}finally{aX(!1)}},[v]),(0,c.useEffect)(()=>{let a=setTimeout(()=>{A(a=>a!==x?(S(1),x):a)},500);return()=>clearTimeout(a)},[x]),(0,c.useEffect)(()=>{},[]),(0,c.useEffect)(()=>{v&&bf(v)},[bf,v,R,z,B,D,L,N,P]);let bn=()=>{Y(""),$(""),aa(""),ac(""),ae(!1),ag("none"),ai("none"),ak("none"),am(""),ao(!0),aq(""),as(null),au("USD"),aw(""),ay(""),aA(!1),aD("you"),aF(!1)},bo=async()=>{if(!Z.trim())return alert("Project Name is required");aF(!0);try{let a=X.trim();if(!a){let b=Z.toString().normalize("NFKD").replace(/[\u0300-\u036F]/g,"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"");a=b?b.toUpperCase().replace(/-/g,"").slice(0,10):`PRJ${Date.now().toString().slice(-6)}`}let b=new FormData;b.append("shortCode",a),b.append("name",Z),b.append("projectName",Z),b.append("startDate",_||""),ad?b.append("deadline",""):b.append("deadline",ab||""),b.append("noDeadline",String(!!ad)),b.append("category","none"===af?"":String(af)),b.append("department","none"===ah?"":String(ah)),b.append("clientId","none"===aj?"":String(aj)),b.append("summary",al||""),b.append("tasksNeedAdminApproval",String(!!an));let c=Array.isArray(ap)?ap:String(ap||"").split(",").map(a=>a.trim()).filter(Boolean);b.append("assignedEmployeeIds",JSON.stringify(c)),ar&&b.append("companyFile",ar),b.append("currency",at||""),b.append("budget",""!==av?String(av):"0"),b.append("hoursEstimate",""!==ax?String(ax):"0"),b.append("allowManualTimeLogs",String(!!az)),b.append("addedBy",String(aC||""));let d=v||null,e=await fetch(`${r}/api/projects`,{method:"POST",body:b,headers:d?{Authorization:`Bearer ${d}`}:void 0});if(!e.ok){let a=await e.text().catch(()=>"");console.error("Create project failed",e.status,a);let b=`Failed to create project (status ${e.status})`;try{let c=JSON.parse(a||"{}");c&&c.message&&(b=c.message)}catch{}alert(b),aF(!1);return}try{await e.json()}catch{}await bf(d),W(!1),bn()}catch(a){console.error("Create project error",a),alert("Failed to create project")}finally{aF(!1)}},bp=a=>a.shortCode||a.code||a.projectCode||`RTA-${String(a.id).padStart(2,"0")}`,bq=()=>K(!1),br=async()=>{S(1),await bf(v??null),K(!1)},bs=async()=>{M("all"),O("all"),Q("all"),S(1),await bf(v??null),K(!1)},bt=(0,c.useMemo)(()=>a.filter(a=>{if("all"!==B&&(!a.projectStatus||a.projectStatus!==B))return!1;if("all"!==D){if("number"!=typeof a.progressPercent)return!1;let b=a.progressPercent;if("0-33"===D&&!(b>=0&&b<=33)||"34-66"===D&&!(b>=34&&b<=66)||"67-100"===D&&!(b>=67&&b<=100))return!1}if(F||H){let b=a.startDate?new Date(a.startDate):null,c=a.deadline?new Date(a.deadline):null;if(!b||!c||F&&b<new Date(F)||H&&c>new Date(H))return!1}return!0}),[a,B,D,F,H]);if(p)return(0,b.jsx)("p",{className:"p-8 text-center",children:"Loading projects..."});let bu=({p:a})=>{let c=a.startDate?new Date(a.startDate).toLocaleDateString():"-",e=a.noDeadline?"No Deadline":a.deadline?new Date(a.deadline).toLocaleDateString():"-",f=Math.max(0,Math.min(100,a.progressPercent??0)),i=null==f?"bg-gray-300":f<33?"bg-red-500":f<66?"bg-yellow-400":"bg-green-500";return(0,b.jsxs)(g.TableRow,{className:"bg-white hover:bg-gray-50",children:[(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top w-28",children:(0,b.jsx)("div",{className:"text-sm font-medium",children:bp(a)})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top",children:(0,b.jsx)("div",{className:"font-medium",children:a.name})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top",children:(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsxs)("div",{className:"flex -space-x-2",children:[(a.assignedEmployees||[]).slice(0,3).map(a=>(0,b.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white overflow-hidden bg-gray-100",title:a.name,children:a.profileUrl?(0,b.jsx)("img",{src:a.profileUrl,alt:a.name,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-xs text-white bg-gray-400",children:(a.name||"U").charAt(0)})},a.employeeId)),(a.assignedEmployees||[]).length>3&&(0,b.jsxs)("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-gray-200 text-xs text-gray-700 flex items-center justify-center",children:["+",(a.assignedEmployees||[]).length-3]})]})})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top text-sm",children:c}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top text-sm",children:e}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:a.client?.profilePictureUrl?(0,b.jsx)("img",{src:a.client.profilePictureUrl,alt:a.client?.name,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"text-xs text-gray-500",children:(a.client?.name||"C").charAt(0)})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:a.client?.name??"Client"}),(0,b.jsx)("div",{className:"text-xs text-gray-400",children:a.client?.company??""})]})]})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top",children:(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("div",{className:"w-44 cursor-pointer",title:"Click to filter by this progress bucket",onClick:()=>{var b;null==(b=a.progressPercent??null)?E("all"):b<=33?E("0-33"):b<=66?E("34-66"):E("67-100"),S(1)},children:(0,b.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,b.jsx)("div",{className:`h-4 rounded-full ${i}`,style:{width:`${f}%`}}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,b.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[f,"%"]})})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("button",{className:`inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs ${function(a){switch(a){case"IN_PROGRESS":return"bg-green-600 text-white";case"NOT_STARTED":default:return"bg-gray-400 text-white";case"ON_HOLD":return"bg-yellow-500 text-white";case"CANCELLED":return"bg-red-600 text-white";case"FINISHED":return"bg-blue-600 text-white"}}(a.projectStatus)}`,title:"Click to filter by this status",onClick:()=>{C(a.projectStatus??"all"),S(1)},children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full",style:{background:function(a){switch(a){case"IN_PROGRESS":return"#10B981";case"NOT_STARTED":default:return"#9CA3AF";case"ON_HOLD":return"#F59E0B";case"CANCELLED":return"#EF4444";case"FINISHED":return"#3B82F6"}}(a.projectStatus)}}),(0,b.jsx)("span",{children:a.projectStatus??"N/A"})]}),(0,b.jsx)("div",{className:"relative",children:(0,b.jsxs)(h.DropdownMenu,{children:[(0,b.jsx)(h.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)("button",{className:"inline-flex items-center gap-1 px-2 py-1 border rounded text-sm bg-white hover:bg-gray-50",children:(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"▾"})})}),(0,b.jsxs)(h.DropdownMenuContent,{align:"start",className:"w-64 p-2",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Change status"}),(0,b.jsx)("div",{className:"space-y-1",children:s.map(c=>(0,b.jsx)("button",{onClick:()=>bl(a.id,c),className:`w-full text-left px-3 py-2 rounded text-sm hover:bg-gray-50 ${c===a.projectStatus?"font-medium":""}`,children:c},c))}),(0,b.jsx)(h.DropdownMenuSeparator,{}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-2 mb-1",children:"Adjust progress"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("input",{type:"range",min:0,max:100,value:a.progressPercent??0,onChange:b=>{let c=Number(b.target.value);o(b=>b.map(b=>b.id===a.id?{...b,progressPercent:c}:b))},onMouseUp:async b=>{let c=Number(b.target.value);await bm(a.id,c)},onTouchEnd:async b=>{let c=Number(b.target.value);await bm(a.id,c)},className:"w-full"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,b.jsx)("span",{children:"0%"}),(0,b.jsxs)("span",{children:[a.progressPercent??0,"%"]}),(0,b.jsx)("span",{children:"100%"})]})]}),(0,b.jsx)("div",{className:"flex justify-end mt-2",children:(0,b.jsx)(d.Button,{size:"sm",variant:"ghost",onClick:()=>bf(v??null),children:"Refresh"})})]})]})})]})]})}),(0,b.jsx)(g.TableCell,{className:"py-4 px-4 align-top text-right",children:(0,b.jsxs)(h.DropdownMenu,{children:[(0,b.jsxs)(d.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>window.location.assign(`/work/roadmap/${a.id}`),children:[(0,b.jsx)(k.Eye,{className:"h-4 w-4 mr-2"})," "]}),(0,b.jsx)(h.DropdownMenuContent,{align:"end",className:"w-48",children:(0,b.jsxs)(h.DropdownMenuItem,{onClick:()=>window.location.assign(`/work/roadmap/${a.id}`),children:[(0,b.jsx)(k.Eye,{className:"h-4 w-4 mr-2"})," View"]})})]})})]},a.id)};return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("main",{className:"w-full",children:(0,b.jsxs)("div",{className:"max-w-[1200px] mx-auto p-6  overflow-y-auto overflow-x-hidden",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg border p-3 mb-4 flex items-center gap-4 overflow-y-auto overflow-x-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,b.jsx)(e.Input,{type:"date",value:F??"",onChange:a=>{G(a.target.value||null),S(1)},className:"w-40"}),(0,b.jsx)("span",{className:"text-gray-400 text-sm",children:"to"}),(0,b.jsx)(e.Input,{type:"date",value:H??"",onChange:a=>{I(a.target.value||null),S(1)},className:"w-40"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Status"}),(0,b.jsxs)(f.Select,{value:B,onValueChange:a=>{C(a),S(1)},children:[(0,b.jsx)(f.SelectTrigger,{className:"w-40",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(f.SelectItem,{value:"IN_PROGRESS",children:"In Progress"}),(0,b.jsx)(f.SelectItem,{value:"NOT_STARTED",children:"Not Started"}),(0,b.jsx)(f.SelectItem,{value:"ON_HOLD",children:"On Hold"}),(0,b.jsx)(f.SelectItem,{value:"CANCELLED",children:"Cancelled"}),(0,b.jsx)(f.SelectItem,{value:"FINISHED",children:"Finished"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Progress"}),(0,b.jsxs)(f.Select,{value:D,onValueChange:a=>{E(a),S(1)},children:[(0,b.jsx)(f.SelectTrigger,{className:"w-40",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(f.SelectItem,{value:"0-33",children:"0 - 33%"}),(0,b.jsx)(f.SelectItem,{value:"34-66",children:"34 - 66%"}),(0,b.jsx)(f.SelectItem,{value:"67-100",children:"67 - 100%"})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg border overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-blue-50 px-6 py-3 border-b flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"font-semibold text-gray-900",children:["Projects (",bt.length,")"]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:a2?"Viewing: Archived":a4?"Viewing: Pinned":"All active"})]}),(0,b.jsx)("div",{className:"overflow-auto p-4",children:"calendar"===a0||a6?(0,b.jsx)(q,{}):"list"===a0?(0,b.jsx)("div",{children:0===bt.length?(0,b.jsx)("div",{className:"p-6 text-center text-gray-500",children:"No projects found"}):(0,b.jsx)("div",{className:"space-y-3",children:bt.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between border rounded p-3 bg-white",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"text-sm font-medium w-28",children:bp(a)}),(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:a.client?.name??"Client"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"text-sm",children:[a.progressPercent??0,"%"]}),(0,b.jsx)(d.Button,{variant:"ghost",size:"sm",onClick:()=>window.location.assign(`/work/roadmap/${a.id}`),children:"View"})]})]},a.id))})}):(0,b.jsx)("div",{children:(0,b.jsxs)(g.Table,{children:[(0,b.jsx)(g.TableHeader,{children:(0,b.jsxs)(g.TableRow,{className:"bg-blue-50",children:[(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Code"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Project Name"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Members"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Start Date"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Deadline"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Client"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3",children:"Status"}),(0,b.jsx)(g.TableHead,{className:"px-4 py-3 text-right",children:"Action"})]})}),(0,b.jsx)(g.TableBody,{children:0===bt.length?(0,b.jsx)(g.TableRow,{children:(0,b.jsx)(g.TableCell,{colSpan:8,className:"py-8 text-center text-gray-500",children:"No projects found"})}):bt.map(a=>(0,b.jsx)(bu,{p:a},a.id))})]})})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["Result per page -",bt.length?bt.length:0]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>{S(a=>Math.max(1,a-1))},disabled:1===R,children:[(0,b.jsx)(i.ChevronLeft,{})," Prev"]}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["Page ",R," of ",T]}),(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>{S(a=>Math.min(T,a+1))},disabled:R===T,children:["Next ",(0,b.jsx)(j.ChevronRight,{})]})]})]})]})}),(0,b.jsx)("div",{"aria-hidden":!J,onClick:bq,className:`fixed inset-0 transition-opacity duration-300 z-[9990] ${J?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,style:{backgroundColor:"rgba(0,0,0,0.3)"}}),(0,b.jsxs)("aside",{"aria-hidden":!J,className:`fixed right-0 top-0 h-full w-[360px] bg-white shadow-xl transform transition-transform duration-300 z-[9999] ${J?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Filter,{className:"w-5 h-5"}),(0,b.jsx)("h3",{className:"font-semibold",children:"Filters"})]}),(0,b.jsx)("button",{onClick:bq,className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(n.X,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-4 overflow-auto h-[calc(100%-140px)]",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Project"}),(0,b.jsxs)(f.Select,{value:L,onValueChange:a=>M(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),a8.map(a=>(0,b.jsx)(f.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Project Members"}),(0,b.jsxs)(f.Select,{value:N,onValueChange:a=>O(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),a9.map(a=>(0,b.jsx)(f.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Client"}),(0,b.jsxs)(f.Select,{value:P,onValueChange:a=>Q(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,b.jsx)(f.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"all",children:"All"}),bb.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]})]}),(0,b.jsxs)("div",{className:"p-4 border-t flex items-center justify-between gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:bs,children:"Reset"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Button,{variant:"ghost",onClick:bq,children:"Close"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:br,children:"Apply"})]})]})]}),V&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-start justify-center pt-12 px-4 overflow-y-auto",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{W(!1),bn()}}),(0,b.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Add Project"}),(0,b.jsx)("button",{onClick:()=>{W(!1),bn()},className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(n.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,b.jsx)(e.Input,{value:X,onChange:a=>Y(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name *"}),(0,b.jsx)(e.Input,{value:Z,onChange:a=>$(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,b.jsx)(e.Input,{type:"date",value:_,onChange:a=>aa(a.target.value)})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,b.jsx)(e.Input,{type:"date",value:ab,onChange:a=>ac(a.target.value),disabled:ad})]}),(0,b.jsx)("div",{className:"pt-6",children:(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)("input",{type:"checkbox",checked:ad,onChange:a=>ae(a.target.checked)}),(0,b.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Select,{value:af,onValueChange:a=>ag(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),ba.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)(d.Button,{variant:"outline",onClick:bh,children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,b.jsxs)(f.Select,{value:ah,onValueChange:a=>ai(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),bc.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,b.jsxs)(f.Select,{value:aj,onValueChange:a=>ak(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),bb.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,b.jsx)("textarea",{rows:4,value:al,onChange:a=>am(a.target.value),className:"w-full p-2 border rounded"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"approval",checked:!0===an,onChange:()=>ao(!0)}),(0,b.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"approval",checked:!1===an,onChange:()=>ao(!1)}),(0,b.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Add Project Members *"}),(0,b.jsx)(e.Input,{placeholder:"Comma separated names",value:Array.isArray(ap)?ap.join(","):ap,onChange:a=>aq(a.target.value)})]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,b.jsxs)("div",{onClick:()=>aB.current?.click(),className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[ar?(0,b.jsx)("div",{children:ar.name}):(0,b.jsx)("div",{children:"Choose File"}),(0,b.jsx)("input",{ref:aB,type:"file",className:"hidden",onChange:a=>as(a.target.files?.[0]??null)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,b.jsxs)(f.Select,{value:at,onValueChange:a=>au(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"USD"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"USD",children:"USD $"}),(0,b.jsx)(f.SelectItem,{value:"USD",children:"USD ₹"}),(0,b.jsx)(f.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,b.jsx)(e.Input,{value:av,onChange:a=>aw(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,b.jsx)(e.Input,{value:ax,onChange:a=>ay(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:az,onChange:a=>aA(a.target.checked)}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,b.jsxs)(f.Select,{value:aC,onValueChange:a=>aD(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-44",children:(0,b.jsx)(f.SelectValue,{placeholder:"You"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"you",children:"You"}),a9.map(a=>(0,b.jsx)(f.SelectItem,{value:a,children:a},a))]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{W(!1),bn()},children:"Cancel"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:bo,disabled:aE,children:aE?"Saving...":"Save"})]})]})]})]}),aG&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[11000] flex items-center justify-center px-4",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>bi()}),(0,b.jsxs)("div",{className:"relative w-full max-w-2xl bg-white rounded-lg shadow-2xl z-20 overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Project Category"}),(0,b.jsx)("button",{onClick:()=>bi(),className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(n.X,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[(0,b.jsx)("div",{className:"rounded border overflow-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left",children:[(0,b.jsx)("thead",{className:"bg-blue-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-2 text-sm",children:"#"}),(0,b.jsx)("th",{className:"px-4 py-2 text-sm",children:"Category Name"}),(0,b.jsx)("th",{className:"px-4 py-2 text-sm",children:"Action"})]})}),(0,b.jsx)("tbody",{children:aK?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"Loading..."})}):0===aI.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"No categories"})}):aI.map((a,c)=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm",children:c+1}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm",children:a.name}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100 text-red-600",onClick:()=>bk(a.id),title:"Delete",children:(0,b.jsx)(l.Trash2,{className:"w-4 h-4"})})})]},a.id))})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Category Name *"}),(0,b.jsx)(e.Input,{placeholder:"Enter category name",value:aM,onChange:a=>aN(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>bi(),children:"Cancel"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:bj,disabled:aO,children:aO?"Saving...":"Save"})]})]})]})]}),aY&&null!=a$&&(0,b.jsx)(function({projectId:a,onClose:g,onSaved:h}){let[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),[m,p]=(0,c.useState)(""),[q,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)("none"),[C,D]=(0,c.useState)("none"),[E,F]=(0,c.useState)("none"),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(!0),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(null),O=(0,c.useRef)(null),[P,Q]=(0,c.useState)("USD"),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)("none"),[Z,$]=(0,c.useState)(0),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)("you"),ad=()=>{p(""),s(""),u(""),x(""),z(!1),B("none"),D("none"),F("none"),H(""),J(!0),L(""),N(null),Q("USD"),S(""),U(""),W(!1),Y("none"),$(0),aa(!1),ac("you")};(0,c.useEffect)(()=>{if(!a)return;let b=!0;return(async()=>{j(!0);try{let c=v||null,d=await fetch(`${r}/api/projects/${a}`,{headers:c?{Authorization:`Bearer ${c}`}:void 0,cache:"no-store"});if(!d.ok){let a=await d.text().catch(()=>"");console.error("Failed to fetch project",d.status,a),b&&alert("Failed to load project details");return}let e=await d.json();if(!b)return;p(e.shortCode??e.code??e.projectCode??""),s(e.name??""),u(e.startDate?e.startDate.split("T")[0]:e.startDate??""),x(e.deadline?e.deadline.split("T")[0]:e.deadline??""),z(!!e.noDeadline),B(e.category?String(e.category):"none"),D(e.department??"none"),F(e.client?.clientId?String(e.client.clientId):e.client?.name??e.client??"none"),H(e.summary??""),J(!!(e.tasksNeedAdminApproval??!0)),L(Array.isArray(e.assignedEmployees)?e.assignedEmployees.map(a=>a.name).join(","):e.members??""),Q(e.currency??"USD"),S(null!=e.budget?String(e.budget):""),U(null!=e.hoursEstimate?String(e.hoursEstimate):""),W(!!e.allowManualTimeLogs),Y(e.projectStatus??"none"),$(Number(e.progressPercent??0)),aa(!!e.calculateProgressThroughTasks),ac(e.addedBy??"you")}catch(a){console.error("Error loading project:",a),b&&alert("Failed to load project details")}finally{b&&j(!1)}})(),()=>{b=!1}},[a,v]);let ae=async()=>{if(a){if(!q.trim())return alert("Project name required");l(!0);try{let b=new FormData;m&&b.append("shortCode",m),b.append("name",q),t&&b.append("startDate",t),y?b.append("deadline",""):b.append("deadline",w||""),b.append("noDeadline",String(!!y)),b.append("category","none"===A?"":A),b.append("department","none"===C?"":C),b.append("clientId","none"===E?"":E),b.append("summary",G||""),b.append("tasksNeedAdminApproval",String(!!I));let c=Array.isArray(K)?K:String(K||"").split(",").map(a=>a.trim()).filter(Boolean);b.append("assignedEmployeeIds",JSON.stringify(c)),M&&b.append("companyFile",M),b.append("currency",P||""),b.append("budget",R||"0"),b.append("hoursEstimate",T||"0"),b.append("allowManualTimeLogs",String(!!V)),X&&"none"!==X&&b.append("projectStatus",String(X)),null==Z||Number.isNaN(Number(Z))||b.append("progressPercent",String(Math.max(0,Math.min(100,Math.round(Z||0))))),b.append("calculateProgressThroughTasks",String(!!_)),b.append("addedBy",String(ab||""));let d=v||null,e=await fetch(`${r}/api/projects/${a}`,{method:"PUT",body:b,headers:d?{Authorization:`Bearer ${d}`}:void 0});if(!e.ok){let a=await e.text().catch(()=>"");console.error("Update failed",e.status,a),alert("Failed to update project");return}let f=null;try{f=await e.json()}catch{f=null}f&&f.id?o(a=>a.map(a=>a.id===f.id?{...a,...f}:a)):await bf(d),h(),g(),ad()}catch(a){console.error("Update error:",a),alert("Failed to update project")}finally{l(!1)}}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-[12000] flex items-start justify-center pt-12 px-4 overflow-y-auto; ",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{g(),ad()}}),(0,b.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Update Project"}),(0,b.jsx)("button",{onClick:()=>{g(),ad()},className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(n.X,{className:"w-5 h-5"})})]}),(0,b.jsx)("div",{className:"p-6 space-y-6",children:i?(0,b.jsx)("p",{className:"p-4 text-center",children:"Loading project..."}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,b.jsx)(e.Input,{value:m,onChange:a=>p(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name  *"}),(0,b.jsx)(e.Input,{value:q,onChange:a=>s(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,b.jsx)(e.Input,{type:"date",value:t,onChange:a=>u(a.target.value)})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,b.jsx)(e.Input,{type:"date",value:w,onChange:a=>x(a.target.value),disabled:y})]}),(0,b.jsx)("div",{className:"pt-6",children:(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)("input",{type:"checkbox",checked:y,onChange:a=>z(a.target.checked)}),(0,b.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Select,{value:A,onValueChange:a=>B(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),ba.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)(d.Button,{variant:"outline",onClick:bh,children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,b.jsxs)(f.Select,{value:C,onValueChange:a=>D(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),bc.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,b.jsxs)(f.Select,{value:E,onValueChange:a=>F(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"--"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),bb.map(a=>(0,b.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,b.jsx)("textarea",{rows:4,value:G,onChange:a=>H(a.target.value),className:"w-full p-2 border rounded"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"ucApproval",checked:!0===I,onChange:()=>J(!0)}),(0,b.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"ucApproval",checked:!1===I,onChange:()=>J(!1)}),(0,b.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Assigned to *"}),(0,b.jsx)(e.Input,{placeholder:"Comma separated names or ids",value:Array.isArray(K)?K.join(","):K,onChange:a=>L(a.target.value)})]}),(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Status"}),(0,b.jsxs)(f.Select,{value:X,onValueChange:a=>Y(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"Select status"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"none",children:"--"}),(0,b.jsx)(f.SelectItem,{value:"IN_PROGRESS",children:"In Progress"}),(0,b.jsx)(f.SelectItem,{value:"NOT_STARTED",children:"Not Started"}),(0,b.jsx)(f.SelectItem,{value:"ON_HOLD",children:"On Hold"}),(0,b.jsx)(f.SelectItem,{value:"CANCELLED",children:"Cancelled"}),(0,b.jsx)(f.SelectItem,{value:"FINISHED",children:"Finished"})]})]})]}),(0,b.jsxs)("div",{className:"w-1/2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Progress Status"}),(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,b.jsx)("div",{className:`h-4 rounded-full ${null==Z?"bg-gray-300":Z<33?"bg-red-500":Z<66?"bg-yellow-400":"bg-green-500"}`,style:{width:`${Math.max(0,Math.min(100,Z))}%`}}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,b.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[Math.round(Z),"%"]})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)("input",{type:"range",min:0,max:100,value:Z,onChange:a=>$(Number(a.target.value)),className:"flex-1"}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:_,onChange:a=>aa(a.target.checked)}),(0,b.jsx)("span",{className:"text-xs",children:"Calculate Progress through tasks"})]})]})]})]})]})})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,b.jsxs)("div",{onClick:()=>O.current?.click(),className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[M?(0,b.jsx)("div",{children:M.name}):(0,b.jsx)("div",{children:"Choose File"}),(0,b.jsx)("input",{ref:O,type:"file",className:"hidden",onChange:a=>N(a.target.files?.[0]??null)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,b.jsxs)(f.Select,{value:P,onValueChange:a=>Q(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-full",children:(0,b.jsx)(f.SelectValue,{placeholder:"USD"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"USD",children:"USD $"}),(0,b.jsx)(f.SelectItem,{value:"USD",children:"USD ₹"}),(0,b.jsx)(f.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,b.jsx)(e.Input,{value:R,onChange:a=>S(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,b.jsx)(e.Input,{value:T,onChange:a=>U(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:V,onChange:a=>W(a.target.checked)}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs "})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,b.jsxs)(f.Select,{value:ab,onValueChange:a=>ac(a),children:[(0,b.jsx)(f.SelectTrigger,{className:"w-44",children:(0,b.jsx)(f.SelectValue,{placeholder:"You"})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"you",children:"You"}),a9.map(a=>(0,b.jsx)(f.SelectItem,{value:a,children:a},a))]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{g(),ad()},children:"Cancel"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:ae,disabled:k,children:k?"Updating...":"Update"})]})]})})]})]})},{projectId:a$,onClose:()=>{aZ(!1),a_(null)},onSaved:()=>{bf(v??null)}})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_work_roadmap_page_tsx_19b67601._.js.map