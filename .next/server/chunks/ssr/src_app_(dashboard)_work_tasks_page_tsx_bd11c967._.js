module.exports=[779360,a=>{"use strict";a.s(["default",()=>ag],779360);var b=a.i(187924),c=a.i(572131),d=a.i(591119),e=a.i(596221),f=a.i(941675),g=a.i(172162),h=a.i(699570),i=a.i(599209),j=a.i(580701),k=a.i(866718);let l=({status:a,onStatusChange:c,dateRange:d,onDateRangeChange:e})=>(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,b.jsxs)(i.Popover,{children:[(0,b.jsx)(i.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",className:"flex h-10 items-center gap-2 rounded-xl border-slate-300 bg-white px-4 text-sm font-normal text-slate-700 shadow-sm",children:[(0,b.jsx)(f.Calendar,{size:16}),d.start&&d.end?`${d.start} â†’ ${d.end}`:"Duration  Start Date to End Date"]})}),(0,b.jsxs)(i.PopoverContent,{className:"w-80 rounded-xl border bg-white p-4 shadow",children:[(0,b.jsx)("h2",{className:"mb-3 text-sm font-medium text-slate-700",children:"Select Duration"}),(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-slate-500",children:"Start Date"}),(0,b.jsx)(k.Input,{type:"date",value:d.start??"",onChange:a=>e({...d,start:a.target.value}),className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-slate-500",children:"End Date"}),(0,b.jsx)(k.Input,{type:"date",value:d.end??"",onChange:a=>e({...d,end:a.target.value}),className:"mt-1"})]}),(0,b.jsx)("div",{className:"flex justify-end gap-2 pt-2",children:(0,b.jsx)(h.Button,{variant:"outline",className:"rounded-lg",onClick:()=>e({start:null,end:null}),children:"Reset"})})]})]})]}),(0,b.jsxs)(j.Select,{value:a,onValueChange:a=>c(a),children:[(0,b.jsx)(j.SelectTrigger,{className:"w-40 rounded-xl border-slate-300 bg-white shadow-sm h-10",children:(0,b.jsx)(j.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"All",children:"All"}),(0,b.jsx)(j.SelectItem,{value:"Waiting",children:"Waiting"}),(0,b.jsx)(j.SelectItem,{value:"Doing",children:"Doing"}),(0,b.jsx)(j.SelectItem,{value:"Completed",children:"Completed"}),(0,b.jsx)(j.SelectItem,{value:"Approval",children:"Approval"})]})]}),(0,b.jsxs)(h.Button,{variant:"outline",className:"ml-auto flex h-10 items-center gap-2 rounded-xl border-slate-300 bg-white px-4 shadow-sm",children:[(0,b.jsx)(g.SlidersHorizontal,{size:16}),"Filters"]})]});var m=a.i(915618),n=a.i(957064),o=a.i(367329),p=a.i(960702),q=a.i(167453),r=a.i(101239),s=a.i(587532),t=a.i(368114);let u=({taskSource:a,onTaskSourceChange:c,viewMode:d,onViewModeChange:e,onAddTask:f,onOpenCalendar:g,onSearchChange:i,onOpenStages:j})=>(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,b.jsxs)(h.Button,{onClick:f,className:"flex h-10 items-center gap-2 rounded-xl bg-indigo-500 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-600",children:[(0,b.jsx)(m.Plus,{size:16}),"Add Task"]}),"kanban"===d?(0,b.jsx)(h.Button,{variant:"outline",className:"h-10 rounded-xl border-slate-300 bg-white px-4 text-sm font-medium shadow-sm",onClick:()=>j?.(),children:"All Task Stages"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Button,{variant:"outline",className:(0,t.cn)("h-10 rounded-xl border-slate-300 bg-white px-4 text-sm font-medium shadow-sm","all"===a&&"border-indigo-500 bg-indigo-50 text-indigo-600"),onClick:()=>c("all"),children:"All Tasks"}),(0,b.jsx)(h.Button,{variant:"outline",className:(0,t.cn)("h-10 rounded-xl border-slate-300 bg-white px-4 text-sm font-medium shadow-sm","me"===a&&"border-indigo-500 bg-indigo-50 text-indigo-600"),onClick:()=>c("me"),children:"My Tasks"})]})]}),(0,b.jsxs)("div",{className:"ml-auto flex flex-wrap items-center gap-3",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(s.Search,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,b.jsx)(k.Input,{placeholder:"Search...",className:"h-10 w-52 rounded-xl border-slate-300 bg-white pl-9 pr-3 text-sm shadow-sm",onChange:a=>i?.(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(v,{active:"kanban"===d,onClick:()=>{e("kanban")},icon:(0,b.jsx)(n.LayoutGrid,{size:16})}),(0,b.jsx)(v,{active:"list"===d,onClick:()=>{e("list")},icon:(0,b.jsx)(o.List,{size:16})}),(0,b.jsx)(v,{active:"calendar"===d,onClick:()=>{e("calendar"),g()},icon:(0,b.jsx)(p.CalendarDays,{size:16})}),(0,b.jsx)(v,{active:"approval"===a,onClick:()=>c("approval"),icon:(0,b.jsx)(q.CheckCircle2,{size:16})}),(0,b.jsx)(v,{active:"pinned"===a,onClick:()=>c("pinned"),icon:(0,b.jsx)(r.Pin,{size:16})})]})]})]}),v=({active:a,onClick:c,icon:d})=>(0,b.jsx)(h.Button,{variant:"outline",size:"icon",onClick:c,className:(0,t.cn)("flex h-9 w-9 items-center justify-center rounded-xl border-slate-300 bg-white shadow-sm",a&&"border-indigo-500 bg-indigo-50 text-indigo-600"),children:d});var w=a.i(571987),x=a.i(206015),y=a.i(177156),z=a.i(699464),A=a.i(705151),B=a.i(781560),C=a.i(879360),D=a.i(335732);let E=({task:a,onView:c,onEdit:d,onDuplicate:e,onTogglePin:f,onDelete:g})=>(0,b.jsxs)(D.DropdownMenu,{children:[(0,b.jsx)(D.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(h.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full hover:bg-slate-100",children:(0,b.jsx)(C.MoreVertical,{size:18,className:"text-slate-600"})})}),(0,b.jsxs)(D.DropdownMenuContent,{align:"end",className:"w-40 rounded-xl border border-slate-200 bg-white shadow-lg",children:[(0,b.jsxs)(D.DropdownMenuItem,{className:"flex cursor-pointer items-center gap-2 text-slate-700",onClick:()=>c?.(a),children:[(0,b.jsx)(y.Eye,{size:16}),"View"]}),(0,b.jsxs)(D.DropdownMenuItem,{className:"flex cursor-pointer items-center gap-2 text-slate-700",onClick:()=>d?.(a),children:[(0,b.jsx)(z.Pencil,{size:16}),"Edit"]}),(0,b.jsxs)(D.DropdownMenuItem,{className:"flex cursor-pointer items-center gap-2 text-slate-700",onClick:()=>e?.(a),children:[(0,b.jsx)(A.Copy,{size:16}),"Duplicate"]}),(0,b.jsx)(D.DropdownMenuSeparator,{}),(0,b.jsxs)(D.DropdownMenuItem,{className:"flex cursor-pointer items-center gap-2 text-slate-700",onClick:()=>f?.(a),children:[(0,b.jsx)(r.Pin,{size:16}),a.pinned?"Unpin Task":"Pin Task"]}),(0,b.jsx)(D.DropdownMenuSeparator,{}),(0,b.jsxs)(D.DropdownMenuItem,{className:"flex cursor-pointer items-center gap-2 text-red-600",onClick:()=>g?.(a),children:[(0,b.jsx)(B.Trash2,{size:16,className:"text-red-600"}),"Delete"]})]})]});function F({task:a}){let d="https://6jnqmj85-80.inc1.devtunnels.ms",[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(a.taskStage),[i,j]=(0,c.useState)(!1),k=async()=>{try{let a=await fetch(`${d}/status`,{headers:{Authorization:"Bearer null"}}),b=await a.json();f(b)}catch(a){console.error("Stage fetch error:",a)}};(0,c.useEffect)(()=>{k()},[]);let l=async b=>{try{j(!0);let c=`${d}/api/projects/tasks/${a.id}/status?statusId=${b}`,f=await fetch(c,{method:"PATCH",headers:{Authorization:"Bearer null","Content-Length":"0"}});if(!f.ok){let a=await f.text();throw console.error("Backend says:",a),Error("Failed to update stage")}await f.json();let g=e.find(a=>String(a.id)===b);h(g)}catch(a){console.error("Update error:",a),alert("Failed to update status")}finally{j(!1)}};return(0,b.jsxs)(D.DropdownMenu,{children:[(0,b.jsx)(D.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{className:"flex w-fit items-center gap-2 rounded-full border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600 hover:bg-slate-100",disabled:i,children:[(0,b.jsx)("span",{className:"h-2 w-2 rounded-full",style:{background:g?.labelColor}}),i?"Updating...":g?.name]})}),(0,b.jsx)(D.DropdownMenuContent,{className:"w-40",children:e.map(a=>(0,b.jsxs)(D.DropdownMenuItem,{onClick:()=>l(String(a.id)),className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("span",{className:"h-2 w-2 rounded-full",style:{background:a.labelColor}}),a.name,a.id]},a.id))})]})}let G=({tasks:a,onView:c,onEdit:d,onDelete:e,onDuplicate:f,onTogglePin:g})=>(0,b.jsx)("div",{className:"w-full overflow-hidden rounded-xl bg-white",children:(0,b.jsxs)(x.Table,{children:[(0,b.jsx)(x.TableHeader,{className:"bg-slate-100",children:(0,b.jsxs)(x.TableRow,{children:[(0,b.jsx)(x.TableHead,{className:"w-[120px] text-slate-600",children:"Code"}),(0,b.jsx)(x.TableHead,{className:"min-w-[260px] text-slate-600",children:"Task Name"}),(0,b.jsx)(x.TableHead,{className:"text-slate-600",children:"Completed On"}),(0,b.jsx)(x.TableHead,{className:"text-slate-600",children:"Start Date"}),(0,b.jsx)(x.TableHead,{className:"text-slate-600",children:"Due Date"}),(0,b.jsx)(x.TableHead,{className:"text-slate-600",children:"Estimated Time"}),(0,b.jsx)(x.TableHead,{className:"text-slate-600",children:"Hours Logged"}),(0,b.jsx)(x.TableHead,{className:"text-slate-600",children:"Assigned To"}),(0,b.jsx)(x.TableHead,{className:"text-slate-600",children:"Status"}),(0,b.jsx)(x.TableHead,{className:"text-right text-slate-600",children:"Action"})]})}),(0,b.jsx)(x.TableBody,{children:a.map(a=>{let h=a.hoursLogged?`${a.hoursLogged}h`:"--";return(0,b.jsxs)(x.TableRow,{className:"hover:bg-slate-50",children:[(0,b.jsx)(x.TableCell,{className:"font-medium text-slate-800",children:a.projectShortCode?`${a.projectShortCode}-${a.id}`:`TASK-${a.id}`}),(0,b.jsx)(x.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium text-slate-900",children:a.title}),(0,b.jsx)("div",{className:"mt-1 flex flex-wrap gap-2",children:a.labels?.map(a=>(0,b.jsx)("span",{className:(0,t.cn)("rounded-full px-2 py-0.5 text-xs font-medium","text-white"),style:{backgroundColor:a.colorCode},children:a.name},a.id))}),(0,b.jsx)("span",{className:"text-xs text-slate-500",children:a.categoryId?.name??"Project name"}),a.pinned&&(0,b.jsx)("span",{className:"mt-1 w-fit rounded-md bg-yellow-100 px-2 py-0.5 text-[10px] font-medium text-yellow-700",children:"Pinned"})]})}),(0,b.jsx)(x.TableCell,{className:"text-slate-600",children:a.completedOn??"--"}),(0,b.jsx)(x.TableCell,{className:"text-slate-600",children:a.startDate??"--"}),(0,b.jsx)(x.TableCell,{className:"text-slate-600",children:a.dueDate??"--"}),(0,b.jsx)(x.TableCell,{className:"text-slate-600",children:a.timeEstimate?`${a.timeEstimateMinutes}m`:"--"}),(0,b.jsx)(x.TableCell,{className:"font-medium text-slate-700",children:h}),(0,b.jsx)(x.TableCell,{children:(0,b.jsx)("div",{className:"flex -space-x-2",children:a.assignedEmployees?.map(a=>(0,b.jsx)("div",{className:"h-8 w-8 rounded-full border-2 border-white shadow-sm overflow-hidden bg-slate-200",children:a.profileUrl?(0,b.jsx)(w.default,{src:a.profileUrl,alt:a.name,width:32,height:32,className:"h-full w-full object-cover"}):(0,b.jsx)("div",{className:"flex h-full w-full items-center justify-center text-xs text-slate-600",children:a.name?.charAt(0)})},a.employeeId))})}),(0,b.jsx)(x.TableCell,{children:(0,b.jsx)(F,{task:a})}),(0,b.jsx)(x.TableCell,{className:"text-right",children:(0,b.jsx)(E,{task:a,onView:c,onEdit:d,onDelete:e,onDuplicate:f,onTogglePin:g})})]},a.id)})})]})});var H=a.i(814574);let I=({open:a,onOpenChange:c,tasks:d})=>(0,b.jsx)(H.Dialog,{open:a,onOpenChange:c,children:(0,b.jsxs)(H.DialogContent,{className:"max-h-[90vh] w-[600px] overflow-y-auto rounded-2xl border border-slate-200 p-0",children:[(0,b.jsx)(H.DialogHeader,{className:"border-b border-slate-200 px-6 py-4",children:(0,b.jsxs)(H.DialogTitle,{className:"flex items-center gap-2 text-lg font-semibold text-slate-800",children:[(0,b.jsx)(p.CalendarDays,{size:20}),"Task Date Overview"]})}),(0,b.jsx)("div",{className:"space-y-4 px-6 py-4",children:0===d.length?(0,b.jsx)("p",{className:"py-10 text-center text-sm text-slate-500",children:"No tasks available for selected filters."}):(0,b.jsx)("div",{className:"space-y-4",children:d.map(a=>(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-1 flex justify-between",children:[(0,b.jsx)("h3",{className:"font-medium text-slate-800",children:a.title}),(0,b.jsxs)("span",{className:"rounded-md bg-slate-200 px-2 py-1 text-xs font-medium text-slate-700",children:[a.projectShortCode??"TASK","-",a.id]})]}),(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"Start Date"}),(0,b.jsx)("p",{className:"text-sm font-medium text-slate-700",children:a.startDate??"--"})]}),(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"Due Date"}),(0,b.jsx)("p",{className:"text-sm font-medium text-slate-700",children:a.dueDate??"--"})]}),(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsxs)("span",{className:"flex w-fit items-center gap-2 rounded-full border border-slate-300 px-3 py-1 text-xs font-medium text-slate-700",children:[(0,b.jsx)("span",{className:"h-2 w-2 rounded-full",style:{background:a.taskStage?.labelColor}}),a.taskStage?.name]})})]},a.id))})})]})});var J=a.i(870430),K=a.i(315055),L=a.i(429246);let M=({open:a,onOpenChange:d,onCreated:f})=>{let g="https://6jnqmj85-80.inc1.devtunnels.ms",[i,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),[G,I]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)(null),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)([]),[Y,Z]=(0,c.useState)([]),[$,_]=(0,c.useState)([]),[aa,ab]=(0,c.useState)([]),[ac,ad]=(0,c.useState)([]),[ae,af]=(0,c.useState)([]),ag=async()=>{let a=localStorage.getItem("accessToken"),b=await fetch(`${g}/task/task-categories`,{headers:{Authorization:`Bearer ${a}`}});X(await b.json())},ah=async()=>{let a=await fetch(`${g}/api/projects`,{headers:{Authorization:"Bearer null"}});Z(await a.json())},ai=async()=>{let a=await fetch(`${g}/status`,{headers:{Authorization:"Bearer null"}});_(await a.json())},aj=async()=>{let a=await fetch(`${g}/employee/all`,{headers:{Authorization:"Bearer null"}});ab(await a.json())},ak=async a=>{if(!a)return;let b=await fetch(`${g}/api/projects/${a}/milestones`,{headers:{Authorization:"Bearer null"}});ad(await b.json())},al=async a=>{if(!a)return;let b=await fetch(`${g}/projects/${a}/labels`,{headers:{Authorization:"Bearer null"}});af(await b.json())};(0,c.useEffect)(()=>{a&&(ag(),ah(),ai(),aj())},[a]),(0,c.useEffect)(()=>{o&&(ak(o),al(o))},[o]);let am=(a,b)=>a.includes(b)?a.filter(a=>a!==b):[...a,b],an=async()=>{try{V(!0);let a=new FormData;if(a.append("title",i),a.append("category",m),a.append("projectId",o),a.append("startDate",q),a.append("dueDate",s),a.append("taskStageId",u),a.append("description",y),a.append("priority",C),a.append("isPrivate",String(E)),a.append("timeEstimate",String(G)),a.append("timeEstimateMinutes",M),a.append("isDependent",String(O)),a.append("milestoneId",Q),w.forEach(b=>a.append("assignedEmployeeIds",b)),A.forEach(b=>a.append("labelIds",b)),S&&a.append("taskFile",S),!(await fetch(`${g}/api/projects/tasks`,{method:"POST",body:a,headers:{Authorization:"Bearer null"}})).ok)throw Error("Failed");f(),d(!1)}catch(a){alert("Failed to create task")}finally{V(!1)}};return(0,b.jsx)(H.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(H.DialogContent,{className:"max-h-[95vh] w-[900px] overflow-y-auto rounded-xl",children:[(0,b.jsx)(H.DialogHeader,{children:(0,b.jsx)(H.DialogTitle,{children:"Add New Task"})}),(0,b.jsxs)("div",{className:"grid gap-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Title *"}),(0,b.jsx)(k.Input,{value:i,onChange:a=>l(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Category *"}),(0,b.jsxs)(j.Select,{onValueChange:n,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select category"})}),(0,b.jsx)(j.SelectContent,{children:W.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Project *"}),(0,b.jsxs)(j.Select,{onValueChange:p,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select project"})}),(0,b.jsx)(j.SelectContent,{children:Y.map(a=>(0,b.jsxs)(j.SelectItem,{value:String(a.id),children:[a.shortCode," - ",a.name]},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Milestone *"}),(0,b.jsxs)(j.Select,{onValueChange:R,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select milestone"})}),(0,b.jsx)(j.SelectContent,{children:ac.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.title},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Task Stage *"}),(0,b.jsxs)(j.Select,{onValueChange:v,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select stage"})}),(0,b.jsx)(j.SelectContent,{children:$.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Assign To *"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:aa.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:w.includes(a.employeeId),onCheckedChange:()=>x(am(w,a.employeeId))}),(0,b.jsx)("span",{className:"text-sm",children:a.name})]},a.employeeId))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Labels *"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:ae.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:A.includes(String(a.id)),onCheckedChange:()=>B(am(A,String(a.id)))}),(0,b.jsx)("span",{children:a.name})]},a.id))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Start Date *"}),(0,b.jsx)(k.Input,{type:"date",value:q,onChange:a=>r(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Due Date *"}),(0,b.jsx)(k.Input,{type:"date",value:s,onChange:a=>t(a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Description *"}),(0,b.jsx)(L.Textarea,{value:y,onChange:a=>z(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Priority *"}),(0,b.jsxs)(j.Select,{onValueChange:D,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select priority"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"LOW",children:"Low"}),(0,b.jsx)(j.SelectItem,{value:"MEDIUM",children:"Medium"}),(0,b.jsx)(j.SelectItem,{value:"HIGH",children:"High"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(K.Checkbox,{checked:E,onCheckedChange:a=>F(!!a)}),(0,b.jsx)("span",{children:"Private Task"})]}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(K.Checkbox,{checked:O,onCheckedChange:a=>P(!!a)}),(0,b.jsx)("span",{children:"Dependent Task"})]}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(K.Checkbox,{checked:G,onCheckedChange:a=>I(!!a)}),(0,b.jsx)("span",{children:"Time Estimate"})]}),G&&(0,b.jsx)(k.Input,{placeholder:"Minutes",value:M,onChange:a=>N(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Attachment *"}),(0,b.jsx)(k.Input,{type:"file",onChange:a=>T(a.target.files?.[0]??null)})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsx)(h.Button,{onClick:an,disabled:U,children:U?(0,b.jsx)(e.Loader2,{className:"h-4 w-4 animate-spin"}):"Save Task"})]})]})})},N=({task:a})=>(0,b.jsxs)("div",{className:"rounded-xl bg-white p-4 shadow hover:shadow-md transition cursor-pointer border border-slate-200",children:[(0,b.jsx)("div",{className:"flex justify-between",children:(0,b.jsx)("h3",{className:"font-medium text-slate-800 text-sm",children:a.title})}),(0,b.jsx)("div",{className:"mt-3 text-xs text-slate-500",children:a?.projectName}),a.labels&&(0,b.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:a.labels.map(a=>(0,b.jsx)("span",{className:"rounded-full px-2 py-0.5 text-xs text-white",style:{background:a.colorCode},children:a.name},a.id))}),(0,b.jsxs)("div",{className:"mt-3 text-xs text-slate-500",children:[a.projectShortCode,"-",a.id]}),(0,b.jsx)("div",{className:"mt-3 flex -space-x-2",children:a.assignedEmployees?.map(a=>(0,b.jsx)("img",{src:a.profileUrl??"https://avatar.iran.liara.run/public/boy?57",className:"h-7 w-7 rounded-full border-2 border-white object-cover"},a.employeeId))})]}),O=({title:a,color:c,tasks:d})=>(0,b.jsxs)("div",{className:"min-w-[280px] w-[280px] rounded-xl bg-slate-100 p-4 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"h-3 w-3 rounded-full",style:{background:c||"#d1d5db"}}),(0,b.jsx)("h2",{className:"font-semibold text-slate-700",children:a}),(0,b.jsx)("span",{className:"ml-auto rounded-md bg-white px-2 py-1 text-xs text-slate-500 shadow",children:d.length})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[d.map(a=>(0,b.jsx)(N,{task:a},a.id)),0===d.length&&(0,b.jsx)("p",{className:"text-xs text-slate-400 text-center py-4",children:"No tasks"})]})]}),P=({tasks:a})=>{let d=(0,c.useMemo)(()=>{let b={};return a.forEach(a=>{let c=a.taskStage?.name||"Uncategorized";b[c]||(b[c]=[]),b[c].push(a)}),b},[a]),e=["Waiting","Doing","Approval","Completed"];return(0,b.jsxs)("div",{className:"flex w-full gap-4 overflow-x-auto pb-4",children:[e.map(c=>(0,b.jsx)(O,{title:c,color:a.find(a=>a.taskStage?.name===c)?.taskStage?.labelColor,tasks:d[c]??[]},c)),Object.keys(d).filter(a=>!e.includes(a)).map(a=>(0,b.jsx)(O,{title:a,color:d[a][0]?.taskStage?.labelColor,tasks:d[a]},a))]})},Q=({open:a,onOpenChange:d})=>{let f="https://6jnqmj85-80.inc1.devtunnels.ms",[g,i]=(0,c.useState)(!1),[j,l]=(0,c.useState)([]),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)("#000000"),v=async()=>{try{let a=await fetch(`${f}/status`,{headers:{Authorization:"Bearer null"}}),b=await a.json();l(b)}catch(a){console.error("Failed to load stages",a)}};(0,c.useEffect)(()=>{a&&v()},[a]);let w=async()=>{try{i(!0);let a={name:p,position:Number(r),labelColor:t},b=n?`${f}/status/${n}`:`${f}/status`;if(!(await fetch(b,{method:n?"PUT":"POST",headers:{Authorization:"Bearer null","Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw Error("Failed");o(null),q(""),s(""),u("#000000"),v()}catch(a){alert("Operation failed"),console.error(a)}finally{i(!1)}},x=async a=>{if(confirm("Are you sure you want to delete this stage?"))try{if(i(!0),!(await fetch(`${f}/status/${a}`,{method:"DELETE",headers:{Authorization:"Bearer null"}})).ok)throw Error("Failed");v()}catch(a){alert("Delete failed")}finally{i(!1)}};return(0,b.jsx)(H.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(H.DialogContent,{className:"max-w-xl rounded-xl",children:[(0,b.jsx)(H.DialogHeader,{children:(0,b.jsx)(H.DialogTitle,{className:"text-lg font-semibold",children:"Task Stages"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Name"}),(0,b.jsx)(k.Input,{placeholder:"Stage Name",value:p,onChange:a=>q(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Position"}),(0,b.jsx)(k.Input,{placeholder:"Position",type:"number",value:r,onChange:a=>s(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Label Color"}),(0,b.jsx)(k.Input,{type:"color",className:"h-10 w-20 p-1",value:t,onChange:a=>u(a.target.value)})]}),(0,b.jsx)(h.Button,{onClick:w,disabled:g||!p||!r,className:"flex items-center gap-2 rounded-lg bg-indigo-600 text-white",children:g?(0,b.jsx)(e.Loader2,{className:"h-4 w-4 animate-spin"}):n?"Update Stage":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Plus,{size:16})," Add Stage"]})}),(0,b.jsx)("hr",{className:"my-3"}),(0,b.jsx)("div",{className:"space-y-3",children:j.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"h-4 w-4 rounded-full",style:{background:a.labelColor}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-slate-500",children:["Position: ",a.position]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("button",{onClick:()=>(a=>{o(a.id),q(a.name),s(String(a.position)),u(a.labelColor||"#000000")})(a),className:"text-blue-600 hover:text-blue-800",children:(0,b.jsx)(z.Pencil,{size:18})}),(0,b.jsx)("button",{onClick:()=>x(a.id),className:"text-red-500 hover:text-red-700",children:(0,b.jsx)(B.Trash2,{size:18})})]})]},a.id))})]})]})})};var R=a.i(633508);function S({task:a}){var c;if(!a)return null;let e=a?.assignedEmployees?.map(a=>a.name).join(", ")||"--",f=a?.labels?.map(a=>a.name).join(", ")||"--";return(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 p-6 border-b",children:[(0,b.jsxs)(d.Card,{className:"p-6 rounded-2xl border-slate-200 shadow-sm",children:[(0,b.jsx)("button",{className:"px-4 py-2 mb-6 bg-indigo-500 text-white rounded-xl text-sm",children:"Mark As Complete"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-y-4 text-sm",children:[(0,b.jsx)("p",{className:"text-slate-500",children:"Project"}),(0,b.jsx)("p",{className:"text-slate-700",children:a.projectName||"--"}),(0,b.jsx)("p",{className:"text-slate-500",children:"Priority"}),(0,b.jsxs)("p",{className:"flex items-center gap-2 text-slate-700",children:[(0,b.jsx)("span",{className:(0,t.cn)("h-2 w-2 rounded-full inline-block","LOW"===a.priority&&"bg-green-500","MEDIUM"===a.priority&&"bg-yellow-500","HIGH"===a.priority&&"bg-red-500")}),a.priority||"--"]}),(0,b.jsx)("p",{className:"text-slate-500",children:"Assigned To"}),(0,b.jsx)("p",{className:"text-slate-700",children:e}),(0,b.jsx)("p",{className:"text-slate-500",children:"Project Code"}),(0,b.jsxs)("p",{className:"text-slate-700",children:[a.projectShortCode,"-",a.id]}),(0,b.jsx)("p",{className:"text-slate-500",children:"Milestones"}),(0,b.jsx)("p",{className:"text-slate-700",children:a.milestone?.title||"--"}),(0,b.jsx)("p",{className:"text-slate-500",children:"Label"}),(0,b.jsx)("p",{className:"text-slate-700",children:f}),(0,b.jsx)("p",{className:"text-slate-500",children:"Task Category"}),(0,b.jsx)("p",{className:"text-slate-700",children:a.categoryId?.name||"--"}),(0,b.jsx)("p",{className:"text-slate-500",children:"Description"}),(0,b.jsx)("p",{className:"text-slate-700",children:a.description||"--"})]})]}),(0,b.jsxs)(d.Card,{className:"p-6 rounded-2xl border-slate-200 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:a?.taskStage?.labelColor||"#3b82f6"}}),(0,b.jsx)("p",{className:"font-medium text-slate-700",children:a?.taskStage?.name||"--"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-y-4 text-sm",children:[(0,b.jsx)("p",{className:"text-slate-500",children:"Created On"}),(0,b.jsx)("p",{className:"text-slate-700",children:(c=a.createdAt)?new Date(c).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"--"}),(0,b.jsx)("p",{className:"text-slate-500",children:"Start Date"}),(0,b.jsx)("p",{className:"text-slate-700",children:T(a.startDate)||"--"}),(0,b.jsx)("p",{className:"text-slate-500",children:"Due Date"}),(0,b.jsx)("p",{className:"text-slate-700",children:T(a.dueDate)||"--"}),(0,b.jsx)("p",{className:"text-slate-500",children:"Hours Logged"}),(0,b.jsxs)("p",{className:"text-slate-700",children:[a.hoursLogged||0,"h"]})]})]})]})}function T(a){return a?new Date(a).toLocaleDateString("en-GB"):"--"}var U=a.i(773320);let V="https://6jnqmj85-80.inc1.devtunnels.ms";function W({taskId:a}){let[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(!1);async function l(){try{i(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`${V}/files/tasks/${a}`,{headers:{Authorization:`Bearer ${b}`}}),d=await c.json();g(d||[])}catch(a){console.error("Error fetching files:",a)}finally{i(!1)}}async function m(b){let c=b.target.files?.[0];if(!c)return;let d=new FormData;d.append("file",c);try{k(!0);let b=localStorage.getItem("accessToken");if(!(await fetch(`${V}/files/tasks/${a}`,{method:"POST",headers:{Authorization:`Bearer ${b}`},body:d})).ok)throw Error("Upload failed");l()}catch(a){console.error("File upload error:",a)}finally{k(!1)}}async function n(a){if(confirm("Delete this file?"))try{let b=localStorage.getItem("accessToken");await fetch(`${V}/files/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}}),g(b=>b.filter(b=>b.id!==a))}catch(a){console.error("Delete error:",a)}}return(0,c.useEffect)(()=>{l()},[a]),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 text-indigo-600 cursor-pointer",children:[(0,b.jsx)(U.Upload,{size:18}),(0,b.jsx)("span",{className:"text-sm",children:"Upload File"}),(0,b.jsx)("input",{type:"file",className:"hidden",onChange:m})]}),j&&(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"Uploading..."}),h?(0,b.jsx)("div",{className:"flex justify-center py-10",children:(0,b.jsx)(e.Loader2,{className:"h-6 w-6 animate-spin text-slate-400"})}):0===f.length?(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"No files uploaded."}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.map(a=>(0,b.jsxs)(d.Card,{className:"p-4 flex items-center justify-between border border-slate-200 rounded-xl",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-slate-700 text-sm",children:a.filename}),(0,b.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 text-xs underline",children:"View / Download"})]}),(0,b.jsx)("button",{onClick:()=>n(a.id),className:"p-2 rounded-full hover:bg-red-50",children:(0,b.jsx)(B.Trash2,{size:16,className:"text-red-500"})})]},a.id))})]})}let X="https://6jnqmj85-80.inc1.devtunnels.ms";function Y({taskId:a}){let[f,g]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(null);async function r(){try{j(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`${X}/tasks/${a}/subtasks`,{headers:{Authorization:`Bearer ${b}`}}),d=await c.json();g(d||[])}catch(a){console.error("Subtask fetch error:",a)}finally{j(!1)}}async function s(){if(!l.trim())return alert("Title is required");try{let b=localStorage.getItem("accessToken");if(!(await fetch(`${X}/tasks/${a}/subtasks`,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({title:l,description:n})})).ok)throw Error("Failed to add subtask");m(""),o(""),r()}catch(a){console.error("Create error:",a)}}async function t(b){try{let c=localStorage.getItem("accessToken");if(!(await fetch(`${X}/tasks/${a}/subtasks/${b}`,{method:"PATCH",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({title:l,description:n})})).ok)throw Error("Update failed");q(null),m(""),o(""),r()}catch(a){console.error("Update error:",a)}}async function u(b){if(confirm("Delete this subtask?"))try{let c=localStorage.getItem("accessToken");await fetch(`${X}/tasks/${a}/subtasks/${b}`,{method:"DELETE",headers:{Authorization:`Bearer ${c}`}}),g(a=>a.filter(a=>a.id!==b))}catch(a){console.error("Delete error:",a)}}return(0,c.useEffect)(()=>{r()},[a]),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.Card,{className:"p-4 rounded-xl border-slate-200",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm mb-3",children:p?"Edit Sub Task":"Add Sub Task"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(k.Input,{placeholder:"Title",value:l,onChange:a=>m(a.target.value)}),(0,b.jsx)(L.Textarea,{placeholder:"Description",value:n,onChange:a=>o(a.target.value)}),p?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Button,{className:"bg-indigo-500 text-white",onClick:()=>t(p),children:"Update"}),(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>{q(null),m(""),o("")},children:"Cancel"})]}):(0,b.jsx)(h.Button,{className:"bg-indigo-500 text-white",onClick:s,children:"Add Sub Task"})]})]}),i?(0,b.jsx)("div",{className:"flex justify-center py-10",children:(0,b.jsx)(e.Loader2,{className:"animate-spin text-slate-400",size:26})}):0===f.length?(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"No sub tasks found."}):(0,b.jsx)("div",{className:"space-y-3",children:f.map(a=>(0,b.jsxs)(d.Card,{className:"p-4 rounded-xl border-slate-200 flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-slate-700",children:a.title}),(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:a.description})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>{q(a.id),m(a.title),o(a.description)},className:"p-2 hover:bg-slate-100 rounded-full",children:(0,b.jsx)(z.Pencil,{size:18,className:"text-slate-600"})}),(0,b.jsx)("button",{onClick:()=>u(a.id),className:"p-2 hover:bg-red-50 rounded-full",children:(0,b.jsx)(B.Trash2,{size:18,className:"text-red-500"})})]})]},a.id))})]})}function Z({taskId:a}){let[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!1);async function j(){try{i(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`https://6jnqmj85-80.inc1.devtunnels.ms/timesheets/task/${a}`,{headers:{Authorization:`Bearer ${b}`}}),d=await c.json();g(d||[])}catch(a){console.error("Timesheet fetch error:",a)}finally{i(!1)}}return(0,c.useEffect)(()=>{j()},[a]),(0,b.jsx)("div",{className:"space-y-6",children:h?(0,b.jsx)("div",{className:"flex justify-center py-10",children:(0,b.jsx)(e.Loader2,{className:"animate-spin text-slate-400",size:26})}):0===f.length?(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"No timesheet entries found."}):(0,b.jsx)(d.Card,{className:"rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-slate-100 text-slate-600",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left px-4 py-3",children:"Employee"}),(0,b.jsx)("th",{className:"text-left px-4 py-3",children:"Start"}),(0,b.jsx)("th",{className:"text-left px-4 py-3",children:"End"}),(0,b.jsx)("th",{className:"text-left px-4 py-3",children:"Duration"}),(0,b.jsx)("th",{className:"text-left px-4 py-3",children:"Memo"})]})}),(0,b.jsx)("tbody",{children:f.map(a=>(0,b.jsxs)("tr",{className:"border-t border-slate-200 hover:bg-slate-50",children:[(0,b.jsxs)("td",{className:"px-4 py-3 flex items-center gap-3",children:[a.employees?.[0]?.profileUrl?(0,b.jsx)("img",{src:a.employees[0].profileUrl,alt:"avatar",className:"h-8 w-8 rounded-full object-cover"}):(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-slate-300"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-slate-700",children:a.employees?.[0]?.name||"Unknown"}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.employees?.[0]?.designation||""})]})]}),(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsx)("p",{className:"text-slate-700",children:a.startDate}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.startTime})]}),(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsx)("p",{className:"text-slate-700",children:a.endDate}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.endTime})]}),(0,b.jsxs)("td",{className:"px-4 py-3 text-slate-700",children:[a.durationHours,"h"]}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-500",children:a.memo||"--"})]},a.id))})]})})})}let $="https://6jnqmj85-80.inc1.devtunnels.ms";function _({taskId:a}){let[f,g]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(!0);async function r(){try{j(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`${$}/tasks/${a}/notes`,{headers:{Authorization:`Bearer ${b}`}}),d=await c.json();g(d||[])}catch(a){console.error("Notes fetch error:",a)}finally{j(!1)}}async function s(){if(!l.trim()||!n.trim())return alert("Title and content are required");try{let b=localStorage.getItem("accessToken"),c=await fetch(`${$}/tasks/${a}/notes`,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({title:l,content:n,isPublic:p})});if(!c.ok)throw Error("Failed to create note");let d=await c.json();g(a=>[d,...a]),m(""),o("")}catch(a){console.error("Create note error:",a)}}async function t(a){if(confirm("Delete this note?"))try{let b=localStorage.getItem("accessToken");await fetch(`${$}/notes/task/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}}),g(b=>b.filter(b=>b.id!==a))}catch(a){console.error("Delete error:",a)}}return(0,c.useEffect)(()=>{r()},[a]),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.Card,{className:"p-4 rounded-xl border-slate-200",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm mb-3",children:"Add Note"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(k.Input,{placeholder:"Note Title",value:l,onChange:a=>m(a.target.value)}),(0,b.jsx)(L.Textarea,{placeholder:"Write your note here...",value:n,onChange:a=>o(a.target.value)}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:p,onChange:a=>q(a.target.checked)}),(0,b.jsx)("span",{className:"text-sm text-slate-600",children:"Public Note"})]}),(0,b.jsx)(h.Button,{className:"bg-indigo-500 text-white",onClick:s,children:"Add Note"})]})]}),i?(0,b.jsx)("div",{className:"flex justify-center py-10",children:(0,b.jsx)(e.Loader2,{className:"animate-spin text-slate-400",size:26})}):0===f.length?(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"No notes found."}):(0,b.jsx)("div",{className:"space-y-4",children:f.map(a=>(0,b.jsxs)(d.Card,{className:"p-4 rounded-xl border-slate-200",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-slate-800",children:a.title}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.isPublic?"Public":"Private"})]}),(0,b.jsx)("button",{onClick:()=>t(a.id),className:"p-2 hover:bg-red-50 rounded-full",children:(0,b.jsx)(B.Trash2,{size:18,className:"text-red-600"})})]}),(0,b.jsx)("p",{className:"mt-3 text-sm text-slate-700",children:a.content}),(0,b.jsxs)("p",{className:"mt-2 text-xs text-slate-400",children:["Created by ",a.ownerEmployeeId]})]},a.id))})]})}function aa({open:a,onOpenChange:d,taskId:e}){let[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)("files");async function l(){try{i(!0);let a=localStorage.getItem("accessToken"),b=await fetch(`https://6jnqmj85-80.inc1.devtunnels.ms/projects/tasks/${e}`,{headers:{Authorization:`Bearer ${a}`}}),c=await b.json();g(c)}catch(a){console.error(a)}finally{i(!1)}}return(0,c.useEffect)(()=>{a&&e&&l()},[a,e]),(0,b.jsx)("div",{className:`fixed inset-0 z-[999] bg-black/30 transition-opacity duration-300 
                ${a?"opacity-100 visible":"opacity-0 invisible"}`,children:(0,b.jsxs)("div",{className:`
                    fixed right-0 top-0 h-full w-[83vw] max-w-[83vw] 
                    bg-white shadow-xl border-l 
                    transform transition-transform duration-300
                    flex flex-col
                    ${a?"translate-x-0":"translate-x-full"}
                `,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-white",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"text-sm text-gray-500",children:["Task #",f?.projectShortCode,"-",f?.id]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full",style:{background:f?.taskStage?.labelColor}}),(0,b.jsx)("div",{className:"text-lg font-semibold",children:f?.title??"Task Name"})]})]}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>d(!1),children:(0,b.jsx)(R.X,{className:"w-5 h-5 text-gray-600"})})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto",children:h?(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:"Loading..."}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S,{task:f}),(0,b.jsx)("div",{className:"px-6 mt-4 border-b flex gap-8 text-sm",children:["files","subtasks","timesheet","notes"].map(a=>(0,b.jsxs)("button",{className:`pb-3 ${j===a?"border-b-2 border-blue-600 text-blue-600 font-medium":"text-gray-500"}`,onClick:()=>k(a),children:["files"===a&&"Files","subtasks"===a&&"Sub Task","timesheet"===a&&"Timesheet","notes"===a&&"Notes"]},a))}),(0,b.jsxs)("div",{className:"p-6 min-h-[350px]",children:["files"===j&&(0,b.jsx)(W,{taskId:e}),"subtasks"===j&&(0,b.jsx)(Y,{taskId:e}),"timesheet"===j&&(0,b.jsx)(Z,{taskId:e}),"notes"===j&&(0,b.jsx)(_,{taskId:e})]})]})})]})})}let ab="https://6jnqmj85-80.inc1.devtunnels.ms";function ac({open:a,onOpenChange:d,taskId:f,onUpdated:g}){let[h,i]=(0,c.useState)(""),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(""),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(""),[Q,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)([]),[V,W]=(0,c.useState)([]),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)([]),[_,aa]=(0,c.useState)([]),[ac,ad]=(0,c.useState)([]);async function ae(){S(!0);try{let a=await fetch(`${ab}/projects/tasks/${f}`,{method:"GET",headers:{Authorization:"Bearer null"}}),b=await a.json();i(b.title||""),m(String(b.categoryId?.id??"")),o(String(b.projectId??"")),q(b.startDate??""),s(b.dueDate??""),u(String(b.taskStageId??"")),y(b.description??""),C(b.priority??""),E(b.isPrivate??!1),G(b.timeEstimate??!1),I(String(b.timeEstimateMinutes??"")),N(b.isDependent??!1),P(String(b.milestoneId??"")),w(b.assignedEmployeeIds??[]),A((b.labels??[]).map(a=>String(a.id))),aj(String(b.projectId)),ak(String(b.projectId))}finally{S(!1)}}(0,c.useEffect)(()=>{a&&f&&ae()},[a,f]),(0,c.useEffect)(()=>{a&&(af(),ag(),ah(),ai())},[a]);let af=async()=>{let a=await fetch(`${ab}/task/task-categories`,{method:"GET",headers:{Authorization:"Bearer null"}});U(await a.json())},ag=async()=>{let a=await fetch(`${ab}/api/projects`,{method:"GET",headers:{Authorization:"Bearer null"}});W(await a.json())},ah=async()=>{let a=await fetch(`${ab}/status`,{method:"GET",headers:{Authorization:"Bearer null"}});Y(await a.json())},ai=async()=>{let a=await fetch(`${ab}/employee/all`,{method:"GET",headers:{Authorization:"Bearer null"}});$(await a.json())},aj=async a=>{if(!a)return;let b=await fetch(`${ab}/api/projects/${a}/milestones`,{method:"GET",headers:{Authorization:"Bearer null"}});aa(await b.json())},ak=async a=>{if(!a)return;let b=await fetch(`${ab}/projects/${a}/labels`,{method:"GET",headers:{Authorization:"Bearer null"}});ad(await b.json())},al=(a,b)=>a.includes(b)?a.filter(a=>a!==b):[...a,b],am=async()=>{S(!0);try{let a=new FormData;if(a.append("title",h),a.append("category",l),a.append("projectId",n),a.append("startDate",p),a.append("dueDate",r),a.append("taskStageId",t),a.append("description",x),a.append("priority",B),a.append("isPrivate",String(D)),a.append("timeEstimate",String(F)),a.append("timeEstimateMinutes",H),a.append("isDependent",String(M)),a.append("milestoneId",O),v.forEach(b=>a.append("assignedEmployeeIds",b)),z.forEach(b=>a.append("labelIds",b)),!(await fetch(`${ab}/api/projects/tasks/${f}`,{method:"PUT",headers:{Authorization:"Bearer null"},body:a})).ok)throw Error("Update failed");g(),d(!1)}catch(a){alert("Failed to update task")}finally{S(!1)}};return(0,b.jsx)("div",{className:`fixed inset-0 z-[999] bg-black/30 transition-opacity duration-300
                ${a?"opacity-100 visible":"opacity-0 invisible"}`,children:(0,b.jsxs)("div",{className:`
                    fixed right-0 top-0 h-full w-[83vw] max-w-[83vw] bg-white 
                    shadow-xl border-l overflow-y-auto
                    transform transition-transform duration-300
                    ${a?"translate-x-0":"translate-x-full"}
                `,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-white",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Edit Task"}),(0,b.jsx)("button",{onClick:()=>d(!1),className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(R.X,{className:"w-5 h-5 text-gray-600"})})]}),(0,b.jsx)("div",{className:"p-6 space-y-6",children:Q?(0,b.jsx)("div",{className:"flex justify-center py-20",children:(0,b.jsx)(e.Loader2,{className:"w-8 h-8 animate-spin text-gray-500"})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Title *"}),(0,b.jsx)(k.Input,{value:h,onChange:a=>i(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Category *"}),(0,b.jsxs)(j.Select,{value:l,onValueChange:m,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select"})}),(0,b.jsx)(j.SelectContent,{children:T.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Project *"}),(0,b.jsxs)(j.Select,{value:n,onValueChange:a=>{o(a),aj(a),ak(a)},children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select project"})}),(0,b.jsx)(j.SelectContent,{children:V.map(a=>(0,b.jsxs)(j.SelectItem,{value:String(a.id),children:[a.shortCode," - ",a.name]},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Milestone *"}),(0,b.jsxs)(j.Select,{value:O,onValueChange:P,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select milestone"})}),(0,b.jsx)(j.SelectContent,{children:_.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.title},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Task Stage *"}),(0,b.jsxs)(j.Select,{value:t,onValueChange:u,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select stage"})}),(0,b.jsx)(j.SelectContent,{children:X.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Assign To"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:Z.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:v.includes(a.employeeId),onCheckedChange:()=>w(al(v,a.employeeId))}),a.name]},a.employeeId))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Labels"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:ac.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:z.includes(String(a.id)),onCheckedChange:()=>A(al(z,String(a.id)))}),a.name]},a.id))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Start Date *"}),(0,b.jsx)(k.Input,{type:"date",value:p,onChange:a=>q(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Due Date *"}),(0,b.jsx)(k.Input,{type:"date",value:r,onChange:a=>s(a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Description"}),(0,b.jsx)(L.Textarea,{value:x,onChange:a=>y(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Priority *"}),(0,b.jsxs)(j.Select,{value:B,onValueChange:C,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select priority"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"LOW",children:"Low"}),(0,b.jsx)(j.SelectItem,{value:"MEDIUM",children:"Medium"}),(0,b.jsx)(j.SelectItem,{value:"HIGH",children:"High"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:D,onCheckedChange:a=>E(!!a)}),"Private Task"]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:M,onCheckedChange:a=>N(!!a)}),"Dependent Task"]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:F,onCheckedChange:a=>G(!!a)}),"Time Estimate"]}),F&&(0,b.jsx)(k.Input,{placeholder:"Minutes",value:H,onChange:a=>I(a.target.value)})]})]})}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 p-6 border-t bg-white",children:[(0,b.jsx)("button",{onClick:()=>d(!1),className:"px-5 py-2 rounded-md border",children:"Cancel"}),(0,b.jsx)("button",{onClick:am,disabled:Q,className:"px-5 py-2 bg-indigo-600 text-white rounded-md",children:Q?(0,b.jsx)(e.Loader2,{className:"w-4 h-4 animate-spin"}):"Update Task"})]})]})})}let ad=({open:a,onOpenChange:d,onCreated:f,task:g})=>{let i="https://6jnqmj85-80.inc1.devtunnels.ms",[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(!1),[I,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(null),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)([]),[_,aa]=(0,c.useState)([]),[ab,ac]=(0,c.useState)([]),[ad,ae]=(0,c.useState)([]),[af,ag]=(0,c.useState)([]),ah=async()=>{let a=await fetch(`${i}/task/task-categories`,{headers:{Authorization:"Bearer null"}});Y(await a.json())},ai=async()=>{let a=await fetch(`${i}/api/projects`,{headers:{Authorization:"Bearer null"}});$(await a.json())},aj=async()=>{let a=await fetch(`${i}/status`,{headers:{Authorization:"Bearer null"}});aa(await a.json())},ak=async()=>{let a=await fetch(`${i}/employee/all`,{headers:{Authorization:"Bearer null"}});ac(await a.json())},al=async a=>{if(!a)return;let b=await fetch(`${i}/api/projects/${a}/milestones`,{headers:{Authorization:"Bearer null"}});ae(await b.json())},am=async a=>{if(!a)return;let b=await fetch(`${i}/projects/${a}/labels`,{headers:{Authorization:"Bearer null"}});ag(await b.json())};(0,c.useEffect)(()=>{a&&(ah(),ai(),aj(),ak())},[a]),(0,c.useEffect)(()=>{a&&g&&(m(g.title||""),o(String(g.categoryId||"")),q(String(g.projectId||"")),s(g.startDate||""),u(g.dueDate||""),w(String(g.taskStageId||"")),A(g.description||""),E(g.priority||""),G(!!g.isPrivate),M(!!g.timeEstimate),O(g.timeEstimateMinutes?String(g.timeEstimateMinutes):""),Q(!!g.isDependent),S(String(g.milestoneId||"")),y(g.assignedEmployees?.map(a=>a.employeeId)||[]),C(g.labels?.map(a=>String(a.id))||[]))},[a,g]),(0,c.useEffect)(()=>{p&&(al(p),am(p))},[p]);let an=(a,b)=>a.includes(b)?a.filter(a=>a!==b):[...a,b],ao=async()=>{try{W(!0);let a=new FormData;if(a.append("title",l),a.append("category",n),a.append("projectId",p),a.append("startDate",r),a.append("dueDate",t),a.append("taskStageId",v),a.append("description",z),a.append("priority",D),a.append("isPrivate",String(F)),a.append("timeEstimate",String(I)),a.append("timeEstimateMinutes",N),a.append("isDependent",String(P)),a.append("milestoneId",R),x.forEach(b=>a.append("assignedEmployeeIds",b)),B.forEach(b=>a.append("labelIds",b)),T&&a.append("taskFile",T),!(await fetch(`${i}/api/projects/tasks`,{method:"POST",body:a,headers:{Authorization:"Bearer null"}})).ok)throw Error("Failed");f(),d(!1)}catch(a){console.error(a),alert("Failed to duplicate task")}finally{W(!1)}};return(0,b.jsx)(H.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(H.DialogContent,{className:"max-h-[95vh] w-[900px] overflow-y-auto rounded-xl",children:[(0,b.jsx)(H.DialogHeader,{children:(0,b.jsx)(H.DialogTitle,{children:"Duplicate Task"})}),(0,b.jsxs)("div",{className:"grid gap-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Title *"}),(0,b.jsx)(k.Input,{value:l,onChange:a=>m(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Category *"}),(0,b.jsxs)(j.Select,{onValueChange:o,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select category"})}),(0,b.jsx)(j.SelectContent,{children:X.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Project *"}),(0,b.jsxs)(j.Select,{onValueChange:q,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select project"})}),(0,b.jsx)(j.SelectContent,{children:Z.map(a=>(0,b.jsxs)(j.SelectItem,{value:String(a.id),children:[a.shortCode," - ",a.name]},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Milestone *"}),(0,b.jsxs)(j.Select,{onValueChange:S,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select milestone"})}),(0,b.jsx)(j.SelectContent,{children:ad.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.title},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Task Stage *"}),(0,b.jsxs)(j.Select,{onValueChange:w,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select stage"})}),(0,b.jsx)(j.SelectContent,{children:_.map(a=>(0,b.jsx)(j.SelectItem,{value:String(a.id),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Assign To *"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:ab.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:x.includes(a.employeeId),onCheckedChange:()=>y(an(x,a.employeeId))}),(0,b.jsx)("span",{className:"text-sm",children:a.name})]},a.employeeId))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Labels *"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:af.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Checkbox,{checked:B.includes(String(a.id)),onCheckedChange:()=>C(an(B,String(a.id)))}),(0,b.jsx)("span",{children:a.name})]},a.id))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Start Date *"}),(0,b.jsx)(k.Input,{type:"date",value:r,onChange:a=>s(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Due Date *"}),(0,b.jsx)(k.Input,{type:"date",value:t,onChange:a=>u(a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Description *"}),(0,b.jsx)(L.Textarea,{value:z,onChange:a=>A(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Priority *"}),(0,b.jsxs)(j.Select,{onValueChange:E,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select priority"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"LOW",children:"Low"}),(0,b.jsx)(j.SelectItem,{value:"MEDIUM",children:"Medium"}),(0,b.jsx)(j.SelectItem,{value:"HIGH",children:"High"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(K.Checkbox,{checked:F,onCheckedChange:a=>G(!!a)}),(0,b.jsx)("span",{children:"Private Task"})]}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(K.Checkbox,{checked:P,onCheckedChange:a=>Q(!!a)}),(0,b.jsx)("span",{children:"Dependent Task"})]}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(K.Checkbox,{checked:I,onCheckedChange:a=>M(!!a)}),(0,b.jsx)("span",{children:"Time Estimate"})]}),I&&(0,b.jsx)(k.Input,{placeholder:"Minutes",value:N,onChange:a=>O(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{children:"Attachment *"}),(0,b.jsx)(k.Input,{type:"file",onChange:a=>U(a.target.files?.[0]??null)})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsx)(h.Button,{onClick:ao,disabled:V,children:V?(0,b.jsx)(e.Loader2,{className:"h-4 w-4 animate-spin"}):"Save Task"})]})]})})},ae="https://6jnqmj85-80.inc1.devtunnels.ms",af=process.env.NEXT_PUBLIC_GATEWAY??ae,ag=()=>{let[a,f]=(0,c.useState)([]),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1),[k,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)("All"),[r,s]=(0,c.useState)({}),[t,v]=(0,c.useState)("all"),[w,x]=(0,c.useState)("list"),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(null),[H,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[N,O]=(0,c.useState)(null),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(null),V=async()=>{try{j(!0),o(null);let a=await fetch(`${ae}/api/projects/tasks/getAll`,{headers:{Authorization:"Bearer null"}});if(!a.ok)throw Error("Failed to fetch all tasks");let b=await a.json();f(b)}catch(a){console.error(a),o(a.message||"Failed to fetch all tasks")}finally{j(!1),m(!0)}},W=async()=>{if(!af)return void console.error("NEXT_PUBLIC_GATEWAY (or MAIN) is not defined");try{let a=localStorage.getItem("accessToken"),b=await fetch(`${af}/me/tasks`,{headers:{Authorization:`Bearer ${a}`}});if(!b.ok)throw Error("Failed to fetch my tasks");let c=await b.json();h(c)}catch(a){console.error(a)}};(0,c.useEffect)(()=>{V(),W()},[]);let X=(0,c.useMemo)(()=>{let b=[];switch(t){case"all":default:b=a;break;case"me":b=g.length?g:a;break;case"approval":b=a.filter(a=>a.taskStage?.name==="Waiting");break;case"pinned":b=a.filter(a=>a.pinned)}return"All"!==p&&(b=b.filter(a=>a.taskStage?.name===p)),(r.start||r.end)&&(b=b.filter(a=>{let b=a.startDate?new Date(a.startDate):null,c=a.dueDate?new Date(a.dueDate):null;if(!b&&!c)return!1;let d=r.start?new Date(r.start):null,e=r.end?new Date(r.end):null;return(!d||!c||!(c<d))&&(!e||!b||!(b>e))})),b},[a,g,t,p,r]),Y=async a=>{if(!confirm("Are you sure you want to delete this task?"))return;let b=localStorage.getItem("accessToken");(await fetch(`${ae}/api/projects/tasks/${a}/delete`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}})).ok?(V(),W()):alert("Failed to delete")},Z=async a=>{let b=localStorage.getItem("accessToken");(await fetch(`${ae}/projects/tasks/${a}/pin`,{method:"POST",headers:{Authorization:`Bearer ${b}`}})).ok?(V(),W()):alert("Unable to toggle pin")};return(0,b.jsxs)("div",{className:"flex min-h-screen flex-col bg-slate-50",children:[(0,b.jsxs)("header",{className:"flex items-center justify-between px-8 py-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"My Task"}),(0,b.jsx)("div",{className:"flex items-center gap-4 text-sm text-slate-500",children:(0,b.jsx)("div",{className:"hidden text-xs md:block"})})]}),(0,b.jsxs)("main",{className:"flex-1 space-y-4 px-4 pb-6 md:px-8",children:[(0,b.jsx)(d.Card,{className:"border-none bg-white shadow-sm",children:(0,b.jsx)("div",{className:"p-4",children:(0,b.jsx)(l,{status:p,onStatusChange:q,dateRange:r,onDateRangeChange:s})})}),(0,b.jsx)(d.Card,{className:"border-none bg-white shadow-sm",children:(0,b.jsx)("div",{className:"p-4",children:(0,b.jsx)(u,{taskSource:t,onTaskSourceChange:v,viewMode:w,onViewModeChange:x,onAddTask:()=>z(!0),onOpenCalendar:()=>{B(!0),x("calendar")},onOpenStages:()=>D(!0)})})}),(0,b.jsx)(d.Card,{className:"border-none bg-white shadow-sm",children:(0,b.jsx)("div",{className:"p-0",children:i&&!k?(0,b.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,b.jsx)(e.Loader2,{className:"h-6 w-6 animate-spin text-slate-400"})}):n?(0,b.jsxs)("div",{className:"flex h-64 flex-col items-center justify-center gap-2 text-sm text-red-500",children:[(0,b.jsx)("p",{children:n}),(0,b.jsx)("button",{onClick:V,className:"rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-700 hover:bg-slate-50",children:"Retry"})]}):0===X.length?(0,b.jsx)("div",{className:"flex h-64 flex-col items-center justify-center gap-2 text-sm text-slate-500",children:(0,b.jsx)("p",{children:"No tasks found for selected filters."})}):"list"===w?(0,b.jsx)(G,{tasks:X,onView:a=>{F(a.id),J(!0)},onEdit:a=>{U(a.id),S(!0)},onDelete:a=>Y(a.id),onDuplicate:a=>{O(a),L(!0)},onTogglePin:a=>Z(a.id)}):"kanban"===w?(0,b.jsx)(P,{tasks:X}):(0,b.jsx)("div",{className:"flex h-64 items-center justify-center text-sm text-slate-500",children:"Calendar data is available in the calendar modal."})})})]}),(0,b.jsx)(M,{open:y,onOpenChange:z,onCreated:()=>{V(),W()}}),(0,b.jsx)(I,{open:A,onOpenChange:B,tasks:X}),(0,b.jsx)(Q,{open:C,onOpenChange:D}),(0,b.jsx)(aa,{open:H,onOpenChange:J,taskId:E}),(0,b.jsx)(ac,{open:R,onOpenChange:S,taskId:T,onUpdated:()=>{V(),W()}}),N&&(0,b.jsx)(ad,{open:K,onOpenChange:L,task:N,onCreated:()=>{L(!1),O(null),V(),W()}})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_work_tasks_page_tsx_bd11c967._.js.map