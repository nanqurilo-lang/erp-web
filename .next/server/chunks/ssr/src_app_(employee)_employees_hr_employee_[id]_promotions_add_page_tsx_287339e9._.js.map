{"version":3,"sources":["turbopack:///[project]/src/app/(employee)/employees/hr/employee/[id]/promotions/add/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { useParams, useRouter } from \"next/navigation\"\n\ntype PromotionPayload = {\n  oldDesignationId: number\n  oldDepartmentId: number\n  newDepartmentId: number\n  newDesignationId: number\n  isPromotion: boolean\n  sendNotification: boolean\n  remarks: string\n}\n\nexport default function AddPromotionPage() {\n  const router = useRouter()\n  const params = useParams<{ id: string }>()\n  const employeeId = params?.id\n\n  const [form, setForm] = useState<PromotionPayload>({\n    oldDesignationId: 1,\n    oldDepartmentId: 1,\n    newDepartmentId: 2,\n    newDesignationId: 2,\n    isPromotion: true,\n    sendNotification: true,\n    remarks: \"\",\n  })\n\n  const [submitting, setSubmitting] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault()\n\n    if (!employeeId) {\n      setError(\"Missing employee ID in route\")\n      return\n    }\n\n    if (!form.oldDesignationId || !form.newDesignationId) {\n      setError(\"Both old and new designation IDs are required\")\n      return\n    }\n\n    setSubmitting(true)\n    setError(null)\n\n    try {\n      const token = typeof window !== \"undefined\" ? localStorage.getItem(\"accessToken\") : null\n      if (!token) throw new Error(\"Authentication required\")\n\n      const res = await fetch(`/api/hr/employee/${employeeId}/promotions`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify(form),\n      })\n\n      const contentType = res.headers.get(\"content-type\") || \"application/json\"\n      const raw = await res.text()\n\n      let data: any = raw\n      if (contentType.includes(\"application/json\")) {\n        try {\n          data = JSON.parse(raw)\n        } catch {\n          // fallback to raw string\n        }\n      }\n\n      if (!res.ok) {\n        const message =\n          typeof data === \"string\" && data.trim().length > 0\n            ? data\n            : data?.message || `Failed to create promotion (status ${res.status})`\n        throw new Error(message)\n      }\n\n      alert(\"Promotion saved successfully\")\n      router.push(`/hr/employee/${employeeId}`)\n    } catch (err: any) {\n      setError(err?.message || \"Unexpected error occurred\")\n    } finally {\n      setSubmitting(false)\n    }\n  }\n\n  return (\n    <div className=\"p-4 max-w-2xl\">\n      <h1 className=\"text-xl font-semibold mb-4\">Add Promotion</h1>\n\n      {error && <div className=\"mb-4 text-red-600 text-sm\">{error}</div>}\n\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {[\n            { label: \"Old Designation ID\", key: \"oldDesignationId\" },\n            { label: \"Old Department ID\", key: \"oldDepartmentId\" },\n            { label: \"New Department ID\", key: \"newDepartmentId\" },\n            { label: \"New Designation ID\", key: \"newDesignationId\" },\n          ].map(({ label, key }) => (\n            <label key={key} className=\"flex flex-col gap-1\">\n              <span className=\"text-sm\">{label}</span>\n              <input\n                type=\"number\"\n                className=\"border rounded px-3 py-2\"\n                value={form[key as keyof PromotionPayload] as number}\n                onChange={(e) =>\n                  setForm((f) => ({ ...f, [key]: Number(e.target.value) }))\n                }\n                required\n                min={1}\n              />\n            </label>\n          ))}\n        </div>\n\n        <div className=\"flex items-center gap-4\">\n          <label className=\"inline-flex items-center gap-2\">\n            <input\n              type=\"checkbox\"\n              checked={form.isPromotion}\n              onChange={(e) => setForm((f) => ({ ...f, isPromotion: e.target.checked }))}\n            />\n            <span className=\"text-sm\">Is Promotion</span>\n          </label>\n\n          <label className=\"inline-flex items-center gap-2\">\n            <input\n              type=\"checkbox\"\n              checked={form.sendNotification}\n              onChange={(e) =>\n                setForm((f) => ({ ...f, sendNotification: e.target.checked }))\n              }\n            />\n            <span className=\"text-sm\">Send Notification</span>\n          </label>\n        </div>\n\n        <label className=\"flex flex-col gap-1\">\n          <span className=\"text-sm\">Remarks</span>\n          <textarea\n            className=\"border rounded px-3 py-2 min-h-[100px]\"\n            value={form.remarks}\n            onChange={(e) => setForm((f) => ({ ...f, remarks: e.target.value }))}\n            placeholder=\"Exceptional performance in Q2\"\n          />\n        </label>\n\n        <div className=\"flex gap-3\">\n          <button\n            type=\"submit\"\n            disabled={submitting}\n            className=\"bg-black text-white px-4 py-2 rounded disabled:opacity-60\"\n          >\n            {submitting ? \"Saving...\" : \"Save Promotion\"}\n          </button>\n          <button\n            type=\"button\"\n            className=\"border px-4 py-2 rounded\"\n            onClick={() => router.back()}\n          >\n            Cancel\n          </button>\n        </div>\n      </form>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}