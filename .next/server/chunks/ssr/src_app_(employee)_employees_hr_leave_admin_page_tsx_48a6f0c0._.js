module.exports=[269171,a=>{"use strict";a.s(["default",()=>n],269171);var b=a.i(187924),c=a.i(572131),d=a.i(177156);function e({status:a,onView:e,onApprove:f,onReject:g,onDelete:h,loading:i}){let[j,k]=(0,c.useState)(!1);return(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(d.Eye,{className:"text-right    w-4 h-4",onClick:()=>{k(!1),e()}}),j&&(0,b.jsxs)("div",{className:"absolute right-0 mt-2 w-40 bg-white border rounded shadow-md z-50",children:["PENDING"===a&&(0,b.jsx)(b.Fragment,{}),(0,b.jsx)("div",{className:"border-t my-1"})]})]})}var f=a.i(50944),g=a.i(633508);let h="https://6jnqmj85-80.inc1.devtunnels.ms";function i({open:a,onClose:d,onSuccess:e}){let[f,i]=(0,c.useState)([]),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)({employeeIds:[],leaveType:"",durationType:"FULL_DAY",singleDate:"",reason:"",status:"PENDING"});(0,c.useEffect)(()=>{a&&(async()=>{let a=localStorage.getItem("accessToken");if(!a)return;let b=await fetch(`${h}/employee/all`,{headers:{Authorization:`Bearer ${a}`}});if(!b.ok)return console.error("Failed to load employees");i((await b.json()).filter(a=>a.active))})()},[a]);let p=async()=>{if(!n.employeeIds.length||!n.leaveType||!n.singleDate||!n.reason)return void alert("Please fill all required fields");m(!0);let a=localStorage.getItem("accessToken"),b=new FormData;if(b.append("leaveData",JSON.stringify({employeeIds:n.employeeIds,leaveType:n.leaveType,durationType:n.durationType,singleDate:n.singleDate,reason:n.reason,status:n.status})),j.forEach(a=>b.append("documents",a)),!(await fetch(`${h}/employee/api/leaves/admin/apply`,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:b})).ok){alert("Failed to apply leave"),m(!1);return}e(),d(),m(!1)};return a?(0,b.jsxs)("div",{className:"fixed inset-0 z-[10000]",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:d}),(0,b.jsxs)("div",{className:"absolute right-0 top-0 h-full w-[83vw] max-w-[82vw] bg-white shadow-xl overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"New Leave"}),(0,b.jsx)("button",{onClick:d,children:(0,b.jsx)(g.X,{className:"w-6 h-6 text-gray-500"})})]}),(0,b.jsx)("div",{className:"p-6 space-y-6",children:(0,b.jsxs)("div",{className:"border rounded-xl p-6",children:[(0,b.jsx)("h3",{className:"font-medium mb-6",children:"Assign Leave"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Choose Member *"}),(0,b.jsx)("div",{className:"mt-1 border rounded-lg max-h-56 overflow-y-auto",children:f.map(a=>{let c=n.employeeIds.includes(a.employeeId);return(0,b.jsxs)("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:c,onChange:()=>{o(b=>({...b,employeeIds:c?b.employeeIds.filter(b=>b!==a.employeeId):[...b.employeeIds,a.employeeId]}))}}),a.profilePictureUrl?(0,b.jsx)("img",{src:a.profilePictureUrl,className:"w-8 h-8 rounded-full object-cover"}):(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-xs",children:a.name.charAt(0)}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:a.name}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:a.role})]})]},a.employeeId)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Leave Type *"}),(0,b.jsxs)("select",{className:"w-full mt-1 border rounded px-3 py-2",onChange:a=>o({...n,leaveType:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"--"}),(0,b.jsx)("option",{value:"SICK",children:"Sick"}),(0,b.jsx)("option",{value:"CASUAL",children:"Casual"}),(0,b.jsx)("option",{value:"EARNED",children:"Earned"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Status *"}),(0,b.jsxs)("select",{className:"w-full mt-1 border rounded px-3 py-2",onChange:a=>o({...n,status:a.target.value}),children:[(0,b.jsx)("option",{value:"PENDING",children:"Pending"}),(0,b.jsx)("option",{value:"APPROVED",children:"Approved"})]})]})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("label",{className:"text-sm font-medium block mb-2",children:"Select Duration"}),(0,b.jsx)("div",{className:"flex gap-6 text-sm",children:[["FULL_DAY","Full Day"],["MULTIPLE_DAYS","Multiple Days"],["FIRST_HALF","First Half"],["SECOND_HALF","Second Half"]].map(([a,c])=>(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",checked:n.durationType===a,onChange:()=>o({...n,durationType:a})}),c]},a))})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"You can select multiple dates"}),(0,b.jsx)("input",{type:"date",className:"w-full mt-1 border rounded px-3 py-2",onChange:a=>o({...n,singleDate:a.target.value})})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Reason for absence *"}),(0,b.jsx)("textarea",{rows:4,className:"w-full mt-1 border rounded px-3 py-2",onChange:a=>o({...n,reason:a.target.value})})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Add File"}),(0,b.jsx)("input",{type:"file",multiple:!0,className:"mt-2",onChange:a=>k(Array.from(a.target.files||[]))})]})]})}),(0,b.jsxs)("div",{className:"flex justify-end gap-4 px-6 py-4 border-t",children:[(0,b.jsx)("button",{onClick:d,className:"px-6 py-2 border rounded text-blue-600",children:"Cancel"}),(0,b.jsx)("button",{onClick:p,disabled:l,className:"px-8 py-2 bg-blue-600 text-white rounded",children:l?"Saving...":"Save"})]})]})]}):null}var j=a.i(941675),k=a.i(367329),l=a.i(546842);let m="https://6jnqmj85-80.inc1.devtunnels.ms";function n(){let[a,d]=(0,c.useState)("LIST"),[g,h]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!1),v=(0,f.useRouter)(),[w,x]=(0,c.useState)({fromDate:"",toDate:"",status:"",leaveType:"",paid:""}),y=async()=>{let a=localStorage.getItem("accessToken");if(!a)return;let b=await fetch(`${m}/employee/api/leaves/my-leaves`,{headers:{Authorization:`Bearer ${a}`}});h(await b.json())},z=async()=>{let a=localStorage.getItem("employeeId"),b=localStorage.getItem("accessToken");if(!a||!b)return;let c=await fetch(`${m}/employee/leave-quota/me`,{headers:{Authorization:`Bearer ${b}`}});o(await c.json())},A=async()=>{let a=localStorage.getItem("employeeId"),b=localStorage.getItem("accessToken");if(!a||!b)return;let c=await fetch(`${m}/employee/me`,{headers:{Authorization:`Bearer ${b}`}});q(await c.json())};(0,c.useEffect)(()=>{y()},[]),(0,c.useEffect)(()=>{"PROFILE"===a&&(z(),A())},[a]);let B=(0,c.useMemo)(()=>g.filter(a=>{let b=a.singleDate??a.startDate;return!!b&&(!w.fromDate||!(b<w.fromDate))&&(!w.toDate||!(b>w.toDate))&&(!w.status||a.status===w.status)&&(!w.leaveType||a.leaveType===w.leaveType)&&(""===w.paid||String(a.isPaid)===w.paid)&&!0}),[g,w]),[C,D]=(0,c.useState)(new Date),E=C.getFullYear(),F=C.getMonth(),G=new Date(E,F+1,0).getDate(),H=new Date(E,F,1).getDay(),I=(0,c.useMemo)(()=>{let a={};return B.forEach(b=>{if(b.singleDate)a[b.singleDate]=[...a[b.singleDate]||[],b];else if(b.startDate&&b.endDate){let c=new Date(b.startDate),d=new Date(b.endDate);for(;c<=d;){let d=c.toISOString().split("T")[0];a[d]=[...a[d]||[],b],c.setDate(c.getDate()+1)}}}),a},[B]),J=(0,c.useMemo)(()=>n.reduce((a,b)=>a+b.remainingLeaves,0),[n]),K=async a=>{let b=localStorage.getItem("accessToken");b&&(s(a),await fetch(`${m}/employee/api/leaves/${a}/status`,{method:"PATCH",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({status:"APPROVED"})}),await y(),s(null))},L=async(a,b)=>{let c=localStorage.getItem("accessToken");c&&b&&(s(a),await fetch(`${m}/employee/api/leaves/${a}/status`,{method:"PATCH",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({status:"REJECTED",rejectionReason:b})}),await y(),s(null))};return(0,b.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:["PROFILE"!==a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded",onClick:()=>u(!0),children:"+ New Leave"}),(0,b.jsx)(i,{open:t,onClose:()=>u(!1),onSuccess:y})]}),"PROFILE"===a&&p&&(0,b.jsxs)("div",{className:"flex gap-6 mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 border rounded-xl p-4 w-1/2",children:[(0,b.jsx)("img",{src:p.profilePictureUrl||"/avatar.png",className:"w-14 h-14 rounded-full object-cover"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold",children:p.name}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:[p.designationName," · ",p.departmentName]}),(0,b.jsxs)("p",{className:"text-xs text-gray-400",children:["Last login: ",p.createdAt?.split("T")[0]]})]})]}),(0,b.jsxs)("div",{className:"border rounded-xl p-4 w-1/2",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Remaining Leaves"}),(0,b.jsx)("p",{className:"text-2xl font-semibold text-blue-600",children:J})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(k.List,{onClick:()=>d("LIST")}),(0,b.jsx)(j.Calendar,{onClick:()=>d("CALENDAR")}),(0,b.jsx)(l.User,{onClick:()=>d("PROFILE")})]})]}),"PROFILE"===a&&(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full border",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"p-3 text-left",children:"Leave Type"}),(0,b.jsx)("th",{className:"p-3",children:"Total"}),(0,b.jsx)("th",{className:"p-3",children:"Monthly"}),(0,b.jsx)("th",{className:"p-3",children:"Taken"}),(0,b.jsx)("th",{className:"p-3",children:"Over"}),(0,b.jsx)("th",{className:"p-3",children:"Remaining"})]})}),(0,b.jsx)("tbody",{children:n.map(a=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"p-3",children:a.leaveType}),(0,b.jsx)("td",{className:"p-3",children:a.totalLeaves}),(0,b.jsx)("td",{className:"p-3",children:a.monthlyLimit}),(0,b.jsx)("td",{className:"p-3",children:a.totalTaken}),(0,b.jsx)("td",{className:"p-3",children:a.overUtilized}),(0,b.jsx)("td",{className:"p-3",children:a.remainingLeaves})]},a.id))})]})}),"LIST"===a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 mb-6",children:[(0,b.jsx)("input",{type:"date",className:"border py-3 px-6 rounded-2xl",onChange:a=>x(b=>({...b,fromDate:a.target.value}))}),(0,b.jsx)("input",{type:"date",className:"border py-3 px-6 rounded-2xl",onChange:a=>x(b=>({...b,toDate:a.target.value}))}),(0,b.jsxs)("select",{className:"border py-3 px-6 rounded-2xl",onChange:a=>x(b=>({...b,status:a.target.value})),children:[(0,b.jsx)("option",{value:"",children:"Status"}),(0,b.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,b.jsx)("option",{value:"PENDING",children:"Pending"}),(0,b.jsx)("option",{value:"REJECTED",children:"Rejected"})]}),(0,b.jsxs)("select",{className:"border py-3 px-6 rounded-2xl",onChange:a=>x(b=>({...b,leaveType:a.target.value})),children:[(0,b.jsx)("option",{value:"",children:"Leave Type"}),(0,b.jsx)("option",{value:"SICK",children:"Sick"}),(0,b.jsx)("option",{value:"CASUAL",children:"Casual"}),(0,b.jsx)("option",{value:"EARNED",children:"Earned"})]}),(0,b.jsxs)("select",{className:"border py-3 px-6 rounded-2xl",onChange:a=>x(b=>({...b,paid:a.target.value})),children:[(0,b.jsx)("option",{value:"",children:"Paid"}),(0,b.jsx)("option",{value:"true",children:"Paid"}),(0,b.jsx)("option",{value:"false",children:"Unpaid"})]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium",children:"Employee"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium",children:"Leave Type"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium",children:"Duration"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium",children:"Dates"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium",children:"Paid"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:B.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-6 py-4",children:a.employeeName}),(0,b.jsx)("td",{className:"px-6 py-4",children:a.leaveType}),(0,b.jsx)("td",{className:"px-6 py-4",children:a.durationType}),(0,b.jsx)("td",{className:"px-6 py-4",children:a.singleDate?a.singleDate:a.startDate&&a.endDate?`${a.startDate} to ${a.endDate}`:"N/A"}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:`px-2 py-1 text-xs rounded-full font-medium
      ${a.isPaid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:a.isPaid?"Paid":"Unpaid"})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:(a=>{switch(a){case"APPROVED":return"text-green-700 flex items-center gap-2";case"REJECTED":return"text-red-600 flex items-center gap-2";case"PENDING":return"text-yellow-600 flex items-center gap-2";default:return"text-gray-600"}})(a.status),children:a.status})}),(0,b.jsx)("td",{className:"px-6 py-4 text-right",children:(0,b.jsx)(e,{status:a.status,loading:r===a.id,onView:()=>v.push(`/hr/leave/admin/${a.id}`),onApprove:()=>K(a.id),onReject:()=>{let b=prompt("Enter rejection reason");b&&L(a.id,b)},onDelete:()=>confirm("Delete this leave?")})})]},a.id))})]})})]}),"CALENDAR"===a&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,b.jsx)("button",{onClick:()=>D(new Date(E,F-1)),children:"←"}),(0,b.jsxs)("h2",{className:"font-semibold",children:[C.toLocaleString("default",{month:"long"})," ",E]}),(0,b.jsx)("button",{onClick:()=>D(new Date(E,F+1)),children:"→"})]}),(0,b.jsx)("div",{className:"grid grid-cols-7 text-center font-medium mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(a=>(0,b.jsx)("div",{children:a},a))}),(0,b.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[Array.from({length:H}).map((a,c)=>(0,b.jsx)("div",{},c)),Array.from({length:G}).map((a,c)=>{let d=c+1,e=`${E}-${String(F+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;return(0,b.jsxs)("div",{className:"border rounded p-1 min-h-[90px]",children:[(0,b.jsx)("div",{className:"font-semibold",children:d}),I[e]?.map(a=>(0,b.jsxs)("div",{className:"text-xs bg-blue-100 rounded px-1 mt-1",children:[a.employeeName," (",a.leaveType,")"]},a.id))]},e)})]})]})]})}}];

//# sourceMappingURL=src_app_%28employee%29_employees_hr_leave_admin_page_tsx_48a6f0c0._.js.map