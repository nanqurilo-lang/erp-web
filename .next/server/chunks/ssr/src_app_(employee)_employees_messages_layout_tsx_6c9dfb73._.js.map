{"version":3,"sources":["turbopack:///[project]/src/app/(employee)/employees/messages/layout.tsx","turbopack:///[project]/src/app/(employee)/employees/messages/_components/ChatRoomsList.tsx"],"sourcesContent":["\n\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport ChatRoomsList from \"./_components/ChatRoomsList\";\n\ntype Employee = {\n  employeeId: string;\n  name: string;\n  email?: string | null;\n  profilePictureUrl?: string | null;\n  departmentId?: number | null;\n  departmentName?: string | null;\n  designationId?: number | null;\n  designationName?: string | null;\n  role?: string | null;\n  mobile?: string | null;\n  about?: string | null;\n  active?: boolean;\n  createdAt?: string | null;\n};\n\nfunction getCookie(name: string) {\n  if (typeof document === \"undefined\") return null;\n  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));\n  return match ? decodeURIComponent(match[2]) : null;\n}\n\nexport default function MessagesLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const router = useRouter();\n  const BASE_URL =  `${process.env.NEXT_PUBLIC_MAIN}`;\n  const API_PATH = \"/employee/all\";\n\n  const [employees, setEmployees] = useState<Employee[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [search, setSearch] = useState<string>(\"\");\n\n  useEffect(() => {\n    const controller = new AbortController();\n\n    const fetchEmployees = async () => {\n      setLoading(true);\n      setError(null);\n\n      // Use the same key your ChatRoomsList expects: 'accessToken' in localStorage.\n      // Also fallback to cookie 'token' if present.\n      const localToken =\n        typeof window !== \"undefined\" ? window.localStorage.getItem(\"accessToken\") : null;\n      const cookieToken = getCookie(\"token\");\n      const token = localToken || cookieToken || null;\n\n      const headers: HeadersInit = {\n        Accept: \"application/json\",\n      };\n      if (token) {\n        headers[\"Authorization\"] = `Bearer ${token}`;\n      }\n\n      try {\n        const res = await fetch(`${BASE_URL}${API_PATH}`, {\n          method: \"GET\",\n          headers,\n          // enable if your backend uses cookies for auth\n          // credentials: \"include\",\n          signal: controller.signal,\n        });\n\n        // If unauthorized -> clear token and redirect to login\n        if (res.status === 401) {\n          // clear any stale token that might cause repeated 401s\n          try {\n            if (typeof window !== \"undefined\") {\n              window.localStorage.removeItem(\"accessToken\");\n              window.localStorage.removeItem(\"token\");\n            }\n          } catch (e) {\n            // ignore\n          }\n\n          const msg = \"Unauthorized: You need to be logged in to fetch employees. (401)\";\n          setEmployees([]);\n          setError(msg);\n          setLoading(false);\n\n          // Redirect to login page so user can re-authenticate\n          // (preserves UX rather than leaving them stuck).\n          // If you want a confirm or modal instead, remove this push.\n          router.push(\"/login\");\n          return;\n        }\n\n        if (!res.ok) {\n          const text = await res.text().catch(() => \"\");\n          setEmployees([]);\n          setError(\n            `Failed to load employees: ${res.status} ${res.statusText}${\n              text ? ` ‚Äî ${text}` : \"\"\n            }`\n          );\n          setLoading(false);\n          return;\n        }\n\n        const data = await res.json();\n        if (Array.isArray(data)) {\n          setEmployees(data);\n        } else if (data && Array.isArray((data as any).content)) {\n          setEmployees((data as any).content);\n        } else {\n          setEmployees([]);\n          if (process.env.NODE_ENV !== \"production\") {\n            // eslint-disable-next-line no-console\n            console.warn(\"[MessagesLayout] Unexpected employee API shape:\", data);\n          }\n        }\n      } catch (err: any) {\n        if (err?.name === \"AbortError\") return;\n        setEmployees([]);\n        setError(err?.message || \"Failed to fetch employees\");\n        if (process.env.NODE_ENV !== \"production\") {\n          // eslint-disable-next-line no-console\n          console.error(\"[MessagesLayout] fetch exception:\", err);\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchEmployees();\n\n    return () => {\n      controller.abort();\n    };\n    // NOTE: we intentionally do not include router in dependency array to avoid refetch loops\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <div className=\"h-screen md:h-[calc(100vh-0rem)] flex flex-col md:flex-row\">\n      <aside className=\"w-full md:w-80 border-b md:border-b-0 md:border-r border-border bg-card\">\n        {/* Header: compact rounded search box (matches provided image) */}\n        <div className=\"p-4 border-b border-border\">\n          <div className=\"w-full\">\n            <label htmlFor=\"chat-search\" className=\"sr-only\">\n              Search a contact\n            </label>\n            <div className=\"relative\">\n              <svg\n                className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n                aria-hidden\n              >\n                <path\n                  strokeWidth=\"2\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  d=\"M21 21l-4.35-4.35M16.65 16.65A7.5 7.5 0 1116.65 2a7.5 7.5 0 010 14.65z\"\n                />\n              </svg>\n\n              <input\n                id=\"chat-search\"\n                type=\"text\"\n                placeholder=\"Search a contact\"\n                value={search}\n                onChange={(e) => setSearch(e.target.value)}\n                className=\"w-full rounded-full border border-gray-200 px-10 py-2 text-sm bg-white placeholder:text-gray-400 focus:outline-none focus:ring-0\"\n                aria-label=\"Search a contact\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"h-[calc(100vh-4rem)] md:h-screen overflow-y-auto\">\n          {/* Pass employees, loading, error and search into ChatRoomsList */}\n          <ChatRoomsList\n            employees={employees.map((e) => ({\n              employeeId: e.employeeId,\n              name: e.name,\n              email: e.email ?? null,\n              profilePictureUrl: e.profilePictureUrl ?? null,\n              designationName: e.designationName ?? null,\n              departmentName: e.departmentName ?? null,\n            }))}\n            loading={loading}\n            error={error}\n            search={search}\n          />\n        </div>\n      </aside>\n\n      <main className=\"flex-1 min-w-0 bg-background\">{children}</main>\n    </div>\n  );\n}\n\n","\n\"use client\"\n\nimport { useEffect, useMemo, useState } from \"react\"\nimport Image from \"next/image\"\nimport Link from \"next/link\"\nimport { usePathname } from \"next/navigation\"\n\ninterface EmployeeItem {\n  employeeId: string\n  name: string\n  email?: string | null\n  profilePictureUrl?: string | null\n  designationName?: string | null\n  departmentName?: string | null\n}\n\ninterface ChatRoom {\n  id: string\n  participant1Id: string\n  participant2Id: string\n  participant1Details: {\n    employeeId: string\n    name: string\n    profileUrl: string | null\n    designation: string | null\n    department: string | null\n  }\n  participant2Details: {\n    employeeId: string\n    name: string\n    profileUrl: string | null\n    designation: string | null\n    department: string | null\n  }\n  lastMessage?: {\n    content: string | null\n    messageType: \"TEXT\" | \"FILE\"\n    fileAttachment?: {\n      fileName: string\n      fileUrl: string\n    } | null\n    createdAt: string\n  }\n  unreadCount: number\n}\n\ninterface CurrentUser {\n  employeeId: string\n}\n\n/**\n * Props:\n * - employees?: array from parent (e.g. MessagesLayout)\n * - loading?: parent loading state (optional override)\n * - error?: parent error string (optional override)\n * - search?: string (parent search term). If provided and employees[] exists, component\n *            will show matching employees as search results.\n */\nexport default function ChatRoomsList({\n  employees: employeesFromParent,\n  loading: loadingFromParent,\n  error: errorFromParent,\n  search: searchFromParent,\n}: {\n  employees?: EmployeeItem[] // optional list coming from parent API\n  loading?: boolean\n  error?: string | null\n  search?: string\n}) {\n  const [rooms, setRooms] = useState<ChatRoom[]>([])\n  const [currentUser, setCurrentUser] = useState<CurrentUser | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  const pathname = usePathname()\n  const selectedIdFromPath = pathname?.split(\"/\").pop() ?? \"\"\n\n  // Prefer parent-provided loading/error when present\n  const effectiveLoading = typeof loadingFromParent === \"boolean\" ? loadingFromParent : loading\n  const effectiveError = typeof errorFromParent !== \"undefined\" ? errorFromParent : error\n  const searchTerm = (searchFromParent ?? \"\").trim()\n\n  // fetch profile + rooms only when parent didn't give an employees[] prop and we need rooms\n  useEffect(() => {\n    // If parent passed employees and likely controls search, we can still fetch rooms/profile\n    // so chat list is available below the search results. But it's optional ‚Äî if you want to skip fetch when parent provides everything, you can early-return.\n    const fetchRooms = async () => {\n      setLoading(true)\n      setError(null)\n\n      try {\n        const token = typeof window !== \"undefined\" ? localStorage.getItem(\"accessToken\") : null\n        const headers: HeadersInit = {}\n        if (token) headers[\"Authorization\"] = `Bearer ${token}`\n\n        // Attempt to fetch profile and rooms; if these endpoints are proxied via /api in your Next app,\n        // they should work in dev and production.\n        const [profileRes, roomsRes] = await Promise.all([\n          fetch(`${process.env.NEXT_PUBLIC_MAIN}/employee/me`, { headers }),\n          fetch(`${process.env.NEXT_PUBLIC_MAIN}/api/chat/rooms`, { headers, cache: \"no-store\" })\n        ])\n\n        if (!profileRes.ok) {\n          // don't throw ‚Äî surface friendly message\n          throw new Error(`Failed to fetch profile (${profileRes.status})`)\n        }\n        if (!roomsRes.ok) {\n          throw new Error(`Failed to fetch chat rooms (${roomsRes.status})`)\n        }\n\n        const profileData = await profileRes.json()\n        setCurrentUser({ employeeId: profileData.employeeId })\n\n        const roomsData = await roomsRes.json()\n        setRooms(Array.isArray(roomsData) ? roomsData : [])\n      } catch (err: any) {\n        setError(err?.message || \"An error occurred while loading chats\")\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    fetchRooms()\n  }, [])\n\n  // If parent passed employees and we have a searchTerm, compute filtered employees\n  const filteredEmployees = useMemo(() => {\n    if (!employeesFromParent || !searchTerm) return []\n    const q = searchTerm.toLowerCase()\n    return employeesFromParent.filter((emp) =>\n      `${emp.name ?? \"\"} ${emp.email ?? \"\"} ${emp.employeeId ?? \"\"}`\n        .toLowerCase()\n        .includes(q)\n    )\n  }, [employeesFromParent, searchTerm])\n\n  const formatRelative = (iso?: string) => {\n    if (!iso) return \"\"\n    const d = new Date(iso)\n    const diff = Date.now() - d.getTime()\n    const min = Math.floor(diff / 60000)\n    const hr = Math.floor(min / 60)\n    const day = Math.floor(hr / 24)\n    if (day >= 1) return `${day}d ago`\n    if (hr >= 1) return `${hr}h ago`\n    if (min >= 1) return `${min}m ago`\n    return \"just now\"\n  }\n\n  // Render helper: user row (used for employee-search results and rooms partner)\n  const UserRow = ({\n    employeeId,\n    name,\n    profileUrl,\n    smallText,\n    isSelected,\n  }: {\n    employeeId: string\n    name: string\n    profileUrl?: string | null\n    smallText?: string | null\n    isSelected?: boolean\n  }) => {\n    return (\n      <Link\n        href={`/messages/${employeeId}`}\n        key={employeeId}\n        className=\"block\"\n        aria-label={`Open chat with ${name}`}\n      >\n        <div\n          className={\n            \"flex items-center gap-3 p-3 rounded-2xl border \" +\n            (isSelected\n              ? \"bg-blue-100 border-blue-200 shadow-sm\"\n              : \"bg-white border-gray-200 hover:shadow-sm\")\n          }\n        >\n          <div className=\"flex-none\">\n            <div className=\"w-12 h-12 rounded-full overflow-hidden border-2 border-white shadow-sm\">\n              <Image\n                src={profileUrl || \"/placeholder.svg?height=48&width=48&query=User%20avatar\"}\n                alt={name}\n                width={48}\n                height={48}\n                className=\"object-cover rounded-full\"\n              />\n            </div>\n          </div>\n\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-start justify-between\">\n              <div className=\"min-w-0\">\n                <h3 className=\"text-sm font-semibold text-gray-800 truncate\">{name}</h3>\n                {smallText ? (\n                  <p className=\"text-xs text-gray-500 mt-1 line-clamp-2 truncate\">{smallText}</p>\n                ) : null}\n              </div>\n\n              <div className=\"flex flex-col items-end ml-3\">\n                {/* For search results we don't show relative time */}\n                <span className=\"text-xs text-gray-400\" />\n              </div>\n            </div>\n          </div>\n        </div>\n      </Link>\n    )\n  }\n\n  // Loading / error / no results handling\n  if (effectiveLoading) return <p className=\"text-center text-muted-foreground\">Loading chats...</p>\n  if (effectiveError) return <p className=\"text-center text-destructive\">{effectiveError}</p>\n  if (!currentUser && rooms.length === 0 && !employeesFromParent) return <p className=\"text-center text-muted-foreground\">Unable to load user profile.</p>\n\n  return (\n    <aside className=\"w-full max-w-[340px] p-4\">\n      {/* If a parent search term is present and parent provided employees => show employee search results */}\n      {searchTerm && employeesFromParent ? (\n        <div className=\"space-y-3\">\n          {filteredEmployees.length === 0 ? (\n            <p className=\"text-center text-sm text-gray-500\">No employees match ‚Äú{searchTerm}‚Äù.</p>\n          ) : (\n            filteredEmployees.map((emp) => (\n              <UserRow\n                key={emp.employeeId}\n                employeeId={emp.employeeId}\n                name={emp.name}\n                profileUrl={emp.profilePictureUrl ?? undefined}\n                smallText={emp.designationName ?? emp.departmentName ?? emp.email ?? \"\"}\n                isSelected={emp.employeeId === selectedIdFromPath}\n              />\n            ))\n          )}\n        </div>\n      ) : (\n        // Default: render chat rooms list (original behaviour)\n        <div className=\"space-y-3\">\n          {rooms.map((room) => {\n            const partner =\n              room.participant1Details.employeeId === currentUser?.employeeId\n                ? room.participant2Details\n                : room.participant1Details\n\n            const isSelected = partner.employeeId === selectedIdFromPath\n\n            const lastText =\n              room.lastMessage?.messageType === \"FILE\"\n                ? `üìé ${room.lastMessage.fileAttachment?.fileName ?? \"Attachment\"}`\n                : room.lastMessage?.content ?? \"No messages yet\"\n\n            return (\n              <Link\n                key={room.id}\n                href={`/messages/${partner.employeeId}`}\n                className=\"block\"\n                aria-label={`Open chat with ${partner.name}`}\n              >\n                <div\n                  className={\n                    \"flex items-center gap-3 p-3 rounded-2xl border \" +\n                    (isSelected\n                      ? \"bg-blue-100 border-blue-200 shadow-sm\"\n                      : \"bg-white border-gray-200 hover:shadow-sm\")\n                  }\n                >\n                  <div className=\"flex-none\">\n                    <div className=\"w-12 h-12 rounded-full overflow-hidden border-2 border-white shadow-sm\">\n                      <Image\n                        src={partner.profileUrl || \"/placeholder.svg?height=48&width=48&query=User%20avatar\"}\n                        alt={partner.name}\n                        width={48}\n                        height={48}\n                        className=\"object-cover rounded-full\"\n                      />\n                    </div>\n                  </div>\n\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"min-w-0\">\n                        <h3 className=\"text-sm font-semibold text-gray-800 truncate\">{partner.name}</h3>\n                        <p className=\"text-xs text-gray-500 mt-1 line-clamp-2 truncate\">{lastText}</p>\n                      </div>\n\n                      <div className=\"flex flex-col items-end ml-3\">\n                        <span className=\"text-xs text-gray-400\">{formatRelative(room.lastMessage?.createdAt)}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </Link>\n            )\n          })}\n        </div>\n      )}\n    </aside>\n  )\n}\n"],"names":[],"mappings":"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"}