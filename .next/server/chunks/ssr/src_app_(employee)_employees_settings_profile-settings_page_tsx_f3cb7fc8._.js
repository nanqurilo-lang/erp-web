module.exports=[158855,a=>{"use strict";a.s(["default",()=>r],158855);var b=a.i(187924),c=a.i(572131),d=a.i(238246),e=a.i(596221),f=a.i(114548),g=a.i(533441),h=a.i(699570),i=a.i(866718),j=a.i(429246),k=a.i(124348),l=a.i(915618),m=a.i(417755);let n="https://6jnqmj85-80.inc1.devtunnels.ms";function o({employeeId:a}){let[d,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!1),[k,o]=(0,c.useState)(null),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)({name:"",email:"",mobile:"",address:"",relationship:""}),w=()=>localStorage.getItem("accessToken")||"";(0,c.useEffect)(()=>{a&&fetch(`${n}/employee/${a}/emergency-contacts`,{headers:{Authorization:`Bearer ${w()}`}}).then(a=>a.json()).then(e).catch(()=>{})},[a]);let x=async()=>{let b=await fetch(`${n}/employee/${a}/emergency-contacts`,{method:"POST",headers:{Authorization:`Bearer ${w()}`,"Content-Type":"application/json"},body:JSON.stringify(u)}),c=await b.json();e(a=>[...a,c]),g(!1),v({name:"",email:"",mobile:"",address:"",relationship:""})},y=async()=>{if(!s?.id)return;let b=await fetch(`${n}/employee/${a}/emergency-contacts/${s.id}`,{method:"PUT",headers:{Authorization:`Bearer ${w()}`,"Content-Type":"application/json"},body:JSON.stringify({name:s.name,mobile:s.mobile,address:s.address,relationship:s.relationship})}),c=await b.json();e(a=>a.map(a=>a.id===c.id?c:a)),t(null)},z=async b=>{b&&confirm("Delete this emergency contact?")&&(await fetch(`${n}/employee/${a}/emergency-contacts/${b}`,{method:"DELETE",headers:{Authorization:`Bearer ${w()}`}}),e(a=>a.filter(a=>a.id!==b)))};return(0,b.jsxs)("div",{className:"bg-white border rounded-xl p-6 shadow-sm mt-8",children:[(0,b.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Emergency Details"}),(0,b.jsxs)(h.Button,{variant:"outline",onClick:()=>g(!0),children:[(0,b.jsx)(l.Plus,{className:"w-4 h-4 mr-2"})," Create New"]})]}),f&&(0,b.jsxs)("div",{className:"border rounded-md p-4 bg-slate-50 mb-4",children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-3",children:[(0,b.jsx)(i.Input,{placeholder:"Name",onChange:a=>v({...u,name:a.target.value})}),(0,b.jsx)(i.Input,{placeholder:"Email",onChange:a=>v({...u,email:a.target.value})}),(0,b.jsx)(i.Input,{placeholder:"Mobile",onChange:a=>v({...u,mobile:a.target.value})}),(0,b.jsx)(i.Input,{placeholder:"Relationship",onChange:a=>v({...u,relationship:a.target.value})}),(0,b.jsx)(j.Textarea,{className:"md:col-span-2",placeholder:"Address",onChange:a=>v({...u,address:a.target.value})})]}),(0,b.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,b.jsx)(h.Button,{onClick:x,children:"Add"}),(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>g(!1),children:"Cancel"})]})]}),(0,b.jsxs)("table",{className:"w-full text-sm border",children:[(0,b.jsx)("thead",{className:"bg-slate-100",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"p-3 text-left",children:"Name"}),(0,b.jsx)("th",{className:"p-3",children:"Email"}),(0,b.jsx)("th",{className:"p-3",children:"Mobile"}),(0,b.jsx)("th",{className:"p-3",children:"Relationship"}),(0,b.jsx)("th",{className:"p-3 text-right",children:"Action"})]})}),(0,b.jsx)("tbody",{children:d.map(a=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"p-3",children:a.name}),(0,b.jsx)("td",{className:"p-3",children:a.email}),(0,b.jsx)("td",{className:"p-3",children:a.mobile}),(0,b.jsx)("td",{className:"p-3",children:a.relationship}),(0,b.jsxs)("td",{className:"p-3 text-right relative",children:[(0,b.jsx)("button",{onClick:()=>o(a.id),children:(0,b.jsx)(m.MoreHorizontal,{})}),k===a.id&&(0,b.jsxs)("div",{className:"absolute right-0 mt-2 bg-white border rounded shadow w-32 z-10",children:[(0,b.jsx)("button",{className:"w-full px-3 py-2 hover:bg-slate-100",onClick:()=>{r(a),o(null)},children:"View"}),(0,b.jsx)("button",{className:"w-full px-3 py-2 hover:bg-slate-100",onClick:()=>{t(a),o(null)},children:"Edit"}),(0,b.jsx)("button",{className:"w-full px-3 py-2 text-red-600 hover:bg-slate-100",onClick:()=>z(a.id),children:"Delete"})]})]})]},a.id))})]}),q&&(0,b.jsx)(p,{title:"View Emergency Contact",onClose:()=>r(null),children:Object.entries(q).map(([a,c])=>"id"!==a&&(0,b.jsxs)("div",{className:"flex mb-2",children:[(0,b.jsx)("div",{className:"w-32 capitalize text-slate-500",children:a}),(0,b.jsx)("div",{children:c||"--"})]},a))}),s&&(0,b.jsxs)(p,{title:"Edit Emergency Contact",onClose:()=>t(null),children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-3",children:[(0,b.jsx)(i.Input,{value:s.name,onChange:a=>t({...s,name:a.target.value})}),(0,b.jsx)(i.Input,{value:s.email,disabled:!0}),(0,b.jsx)(i.Input,{value:s.mobile,onChange:a=>t({...s,mobile:a.target.value})}),(0,b.jsx)(i.Input,{value:s.relationship,onChange:a=>t({...s,relationship:a.target.value})}),(0,b.jsx)(j.Textarea,{className:"md:col-span-2",value:s.address,onChange:a=>t({...s,address:a.target.value})})]}),(0,b.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>t(null),children:"Cancel"}),(0,b.jsx)(h.Button,{onClick:y,children:"Save"})]})]})]})}function p({title:a,children:c,onClose:d}){return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl w-[520px] p-6",children:[(0,b.jsx)("h3",{className:"font-semibold mb-4",children:a}),c,(0,b.jsx)("div",{className:"mt-4 text-right",children:(0,b.jsx)(h.Button,{onClick:d,children:"Close"})})]})})}let q="https://6jnqmj85-80.inc1.devtunnels.ms";function r(){let a=(0,c.useRef)(null);(0,c.useRef)(null);let[l,m]=(0,c.useState)(!0),[n,p]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)({employeeId:void 0,name:"",email:"",profilePictureUrl:null,gender:"",birthday:"",bloodGroup:"",language:"",country:"usa",mobile:"",address:"",about:"",slackMemberId:"",maritalStatus:""}),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)({name:"",email:"",mobile:"",address:"",relationship:""}),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(null),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)([]),[X,Y]=(0,c.useState)("");(0,c.useEffect)(()=>{let a=!0;return(async()=>{try{let b=localStorage.getItem("accessToken")||"",c=await fetch(`${q}/employee/me`,{headers:{Authorization:`Bearer ${b}`,Accept:"application/json"}});if(!c.ok){console.warn("Failed to load profile",c.status),m(!1);return}let d=await c.json();if(!a)return;w({employeeId:d.employeeId??void 0,name:d.name??"",email:d.email??"",profilePictureUrl:d.profilePictureUrl??null,gender:d.gender??"",birthday:d.birthday??"",bloodGroup:d.bloodGroup??"",language:d.language??"",country:d.country??"usa",mobile:d.mobile??"",address:d.address??"",about:d.about??"",slackMemberId:d.slackMemberId??"",maritalStatus:d.maritalStatus??""}),d.profilePictureUrl&&A(d.profilePictureUrl);let e={Authorization:`Bearer ${b}`,Accept:"application/json"};if(d.employeeId){try{let b=await fetch(`${q}/employee/${encodeURIComponent(d.employeeId)}/emergency-contacts`,{headers:e});if(b.ok){let c=await b.json();a&&Array.isArray(c)&&C(c)}else console.warn("Failed to load emergency contacts",b.status)}catch(a){console.warn("Error fetching emergency contacts",a)}try{let b=await fetch(`${q}/employee/${encodeURIComponent(d.employeeId)}/documents`,{headers:e});if(b.ok){let c=await b.json();a&&Array.isArray(c)&&M(c)}else console.warn("Failed to load documents",b.status)}catch(a){console.warn("Error fetching documents",a)}}}catch(a){console.error("Error loading profile:",a),u("Failed to load profile")}finally{a&&m(!1)}})(),()=>{a=!1}},[]);let Z=(a,b)=>{w(c=>({...c,[a]:b}))},$=async a=>{if(a&&a.preventDefault(),u(""),s(""),!v.name||!v.email)return void u("Name and Email are required.");p(!0);try{let a=localStorage.getItem("accessToken")||"",b={name:v.name??"",email:v.email??"",gender:v.gender??"",birthday:v.birthday??"",bloodGroup:v.bloodGroup??"",language:v.language??"",country:v.country??"",mobile:v.mobile??"",address:v.address??"",about:v.about??"",slackMemberId:v.slackMemberId??"",maritalStatus:v.maritalStatus??""},c=new FormData;c.append("employee",JSON.stringify(b)),x&&c.append("file",x);let d=await fetch(`${q}/employee/me`,{method:"PUT",headers:{Authorization:`Bearer ${a}`},body:c}),e=await d.json().catch(()=>({}));if(!d.ok){console.error("Save failed:",d.status,e),u(e?.error||`Save failed (${d.status})`),p(!1);return}w(a=>({...a,employeeId:e.employeeId??a.employeeId,profilePictureUrl:e.profilePictureUrl??a.profilePictureUrl,name:e.name??a.name,email:e.email??a.email,gender:e.gender??a.gender,birthday:e.birthday??a.birthday,bloodGroup:e.bloodGroup??a.bloodGroup,language:e.language??a.language,country:e.country??a.country,mobile:e.mobile??a.mobile,address:e.address??a.address,about:e.about??a.about,slackMemberId:e.slackMemberId??a.slackMemberId,maritalStatus:e.maritalStatus??a.maritalStatus})),e.profilePictureUrl&&(A(e.profilePictureUrl),y(null)),s("Profile saved successfully."),setTimeout(()=>s(""),3e3)}catch(a){console.error("Unexpected save error:",a),u("Unexpected error while saving. See console.")}finally{p(!1)}};return l?(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-8",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(e.Loader2,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-slate-600",children:"Loading profile..."})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 py-8 px-4",children:(0,b.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Settings"}),(0,b.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Profile Details"})]}),(0,b.jsxs)("form",{onSubmit:$,className:"bg-white border rounded-xl p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-slate-700 mb-2",children:"Profile Picture"}),(0,b.jsx)("div",{onClick:()=>a.current?.click(),className:"border rounded-md h-36 flex items-center justify-center cursor-pointer bg-white hover:bg-gray-50",children:z?(0,b.jsxs)("div",{className:"flex items-center gap-4 px-4",children:[(0,b.jsx)("img",{src:z,alt:"profile preview",className:"h-24 w-24 object-cover rounded-full border"}),(0,b.jsx)("div",{className:"text-sm text-slate-600",children:"Click to change picture"})]}):(0,b.jsxs)("div",{className:"text-center text-slate-400",children:[(0,b.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",className:"mx-auto mb-2",children:[(0,b.jsx)("path",{d:"M12 3v10",stroke:"#9CA3AF",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,b.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"#9CA3AF",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,b.jsx)("path",{d:"M7 10l5-5 5 5",stroke:"#9CA3AF",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,b.jsx)("div",{className:"text-sm",children:"Choose a file"})]})}),(0,b.jsx)("input",{ref:a,type:"file",accept:"image/*",className:"hidden",onChange:a=>{(a=>{if(!a){y(null),A(v.profilePictureUrl??"");return}y(a),A(URL.createObjectURL(a))})(a.target.files?.[0]??null)}})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"col-span-1",children:[(0,b.jsxs)("label",{className:"text-sm font-medium text-slate-700",children:["Your Name ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(i.Input,{value:v.name||"",onChange:a=>Z("name",a.target.value),placeholder:"--",className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Date of Birth"}),(0,b.jsx)(i.Input,{type:"date",value:v.birthday??"",onChange:a=>Z("birthday",a.target.value),className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Gender"}),(0,b.jsxs)("select",{value:v.gender??"",onChange:a=>Z("gender",a.target.value),className:"mt-1 block w-full border rounded-md h-11 px-3",children:[(0,b.jsx)("option",{value:"",children:"--"}),(0,b.jsx)("option",{value:"female",children:"Female"}),(0,b.jsx)("option",{value:"male",children:"Male"}),(0,b.jsx)("option",{value:"other",children:"Other"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Blood Group"}),(0,b.jsxs)("select",{value:v.bloodGroup??"",onChange:a=>Z("bloodGroup",a.target.value),className:"mt-1 block w-full border rounded-md h-11 px-3",children:[(0,b.jsx)("option",{value:"",children:"--"}),(0,b.jsx)("option",{children:"O+"}),(0,b.jsx)("option",{children:"O-"}),(0,b.jsx)("option",{children:"A+"}),(0,b.jsx)("option",{children:"A-"}),(0,b.jsx)("option",{children:"B+"}),(0,b.jsx)("option",{children:"B-"}),(0,b.jsx)("option",{children:"AB+"}),(0,b.jsx)("option",{children:"AB-"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"text-sm font-medium text-slate-700",children:["Email Id ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(i.Input,{type:"email",value:v.email||"",onChange:a=>Z("email",a.target.value),placeholder:"--",className:"mt-1"}),(0,b.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Must have at least 8 characters"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Slack Member Id"}),(0,b.jsxs)("div",{className:"flex mt-1",children:[(0,b.jsx)("span",{className:"inline-flex items-center px-3 border border-r-0 rounded-l-md bg-gray-50 text-slate-600",children:"@"}),(0,b.jsx)("input",{value:v.slackMemberId??"",onChange:a=>Z("slackMemberId",a.target.value),className:"border rounded-r-md h-11 px-3 w-full",placeholder:"--"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Marital Status"}),(0,b.jsxs)("select",{value:v.maritalStatus??"",onChange:a=>Z("maritalStatus",a.target.value),className:"mt-1 block w-full border rounded-md h-11 px-3",children:[(0,b.jsx)("option",{value:"",children:"--"}),(0,b.jsx)("option",{value:"single",children:"Single"}),(0,b.jsx)("option",{value:"married",children:"Married"}),(0,b.jsx)("option",{value:"divorced",children:"Divorced"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Language"}),(0,b.jsxs)("select",{value:v.language??"",onChange:a=>Z("language",a.target.value),className:"mt-1 block w-full border rounded-md h-11 px-3",children:[(0,b.jsx)("option",{value:"",children:"--"}),(0,b.jsx)("option",{value:"French",children:"French"}),(0,b.jsx)("option",{value:"English",children:"English"}),(0,b.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Country"}),(0,b.jsxs)("select",{value:v.country??"usa",onChange:a=>Z("country",a.target.value),className:"mt-1 block w-full border rounded-md h-11 px-3",children:[(0,b.jsx)("option",{children:"usa"}),(0,b.jsx)("option",{children:"United States"}),(0,b.jsx)("option",{children:"United Kingdom"}),(0,b.jsx)("option",{children:"Australia"}),(0,b.jsx)("option",{children:"Other"})]})]}),(0,b.jsxs)("div",{className:"col-span-1 md:col-span-1 lg:col-span-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Mobile"}),(0,b.jsxs)("div",{className:"flex mt-1",children:[(0,b.jsx)("div",{className:"inline-flex items-center px-3 border rounded-l-md bg-gray-50 text-slate-600",children:"+370"}),(0,b.jsx)("input",{value:v.mobile??"",onChange:a=>Z("mobile",a.target.value),className:"border rounded-r-md h-11 px-3 w-full",placeholder:"--"})]})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Address"}),(0,b.jsx)(j.Textarea,{value:v.address??"",onChange:a=>Z("address",a.target.value),className:"mt-1 h-20",placeholder:"--"})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"About"}),(0,b.jsx)(j.Textarea,{value:v.about??"",onChange:a=>Z("about",a.target.value),className:"mt-1 h-28",placeholder:"--"})]}),(0,b.jsxs)("div",{className:"mt-4",children:[r&&(0,b.jsx)(k.Alert,{className:"bg-green-50 border-green-200",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Check,{className:"w-4 h-4 text-green-600"}),(0,b.jsx)(k.AlertDescription,{className:"text-green-800",children:r})]})}),t&&(0,b.jsx)(k.Alert,{variant:"destructive",className:"mt-2",children:(0,b.jsx)(k.AlertDescription,{children:t})})]}),(0,b.jsxs)("div",{className:"mt-6 flex justify-center gap-4",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>{window.location.href="/settings"},children:"Cancel"}),(0,b.jsx)(h.Button,{type:"submit",onClick:$,disabled:n,children:n?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Save,{className:"w-4 h-4 mr-2"}),"Save"]})})]})]}),(0,b.jsx)(o,{employeeId:v.employeeId}),(0,b.jsx)("div",{className:"mt-6 text-center text-sm text-slate-500",children:(0,b.jsx)(d.default,{href:"/settings",className:"underline",children:"Back to settings"})})]})})}}];

//# sourceMappingURL=src_app_%28employee%29_employees_settings_profile-settings_page_tsx_f3cb7fc8._.js.map