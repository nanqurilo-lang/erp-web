module.exports=[169605,a=>{"use strict";a.s(["default",()=>K],169605);var b=a.i(187924),c=a.i(572131),d=a.i(699570),e=a.i(580701),f=a.i(613749),g=a.i(50522),h=a.i(587532),i=a.i(633508),j=a.i(866718);let k=({employeeFilter:a,setEmployeeFilter:c,employeeOptions:d,getEmployeeLabel:f,onOpenFiltersDrawer:g})=>(0,b.jsxs)("div",{className:"bg-white rounded-lg border p-3 mb-4 flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,b.jsx)(j.Input,{placeholder:"Start Date to End Date",className:"w-64"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Employee"}),(0,b.jsxs)(e.Select,{value:a,onValueChange:a=>c(a),children:[(0,b.jsx)(e.SelectTrigger,{className:"w-40",children:(0,b.jsx)(e.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(e.SelectContent,{children:[(0,b.jsx)(e.SelectItem,{value:"All",children:"All"}),d.slice(1).map(a=>(0,b.jsx)(e.SelectItem,{value:a,children:f(a)},a))]})]})]}),(0,b.jsx)("div",{className:"ml-auto flex items-center gap-4",children:(0,b.jsxs)("button",{onClick:g,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-800",children:[(0,b.jsx)(h.Search,{className:"w-4 h-4"})," Filters"]})})]});var l=a.i(367329),m=a.i(941675),n=a.i(546842);let o=({searchInput:a,setSearchInput:c,setSearchQuery:e,setCurrentPage:f,viewMode:g,setViewMode:i,showCalendarModal:k,setShowCalendarModal:o,openLogForm:p})=>(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:["weekly"===g?(0,b.jsx)("h1",{className:"text-xl font-semibold",children:"Weekly Timesheet"}):(0,b.jsx)("div",{children:(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:p,children:"+ Log Time"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 border rounded px-2 py-1 bg-white",children:[(0,b.jsx)(h.Search,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)(j.Input,{placeholder:"Search",value:a,onChange:a=>c(a.target.value),onKeyDown:b=>{"Enter"===b.key&&(e(a),f(()=>1))},className:"border-0 bg-transparent focus-visible:ring-0"})]}),(0,b.jsxs)("div",{className:"flex items-center bg-white border rounded-lg overflow-hidden",children:[(0,b.jsx)("button",{onClick:()=>{let a=document.querySelector('input[placeholder="Search"]');a&&a.focus()},className:"px-3 py-2 hover:bg-gray-50",title:"Search",children:(0,b.jsx)(h.Search,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>i("list"),className:`px-3 py-2 hover:bg-gray-50 ${"list"===g?"bg-gray-100":""}`,title:"List view",children:(0,b.jsx)(l.List,{className:"w-4 h-4"})}),(0,b.jsxs)("button",{onClick:()=>{i("weekly")},"aria-pressed":"weekly"===g,title:"Weekly calendar",className:`relative px-3 py-2 hover:bg-gray-50 ${"weekly"===g?"bg-violet-600 text-white":""}`,children:[(0,b.jsx)(m.Calendar,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:`absolute -top-1 -right-1 w-5 h-5 rounded-full flex items-center justify-center text-xs font-semibold leading-none
                ${"weekly"===g?"bg-white text-violet-600":"bg-violet-600 text-white"}`,"aria-hidden":"true",children:"7"})]}),(0,b.jsx)("button",{onClick:()=>o(!0),className:`px-3 py-2 hover:bg-gray-50 ${k?"ring-2 ring-indigo-300":""}`,title:"Open calendar view",children:(0,b.jsx)(m.Calendar,{className:"w-4 h-4 text-gray-600"})}),(0,b.jsx)("button",{onClick:()=>i("TimesheetSummary"),className:`px-3 py-2 hover:bg-gray-50 ${"TimesheetSummary"===g?"bg-violet-600 text-white":""}`,title:"User",children:(0,b.jsx)(n.User,{className:"w-4 h-4 text-gray-600"})})]})]})]});var p=a.i(177156),q=a.i(510448),r=a.i(879360);let s=({t:a,openMenuId:c,onToggleMenu:d,onCloseMenu:e,onView:f,onEdit:g,onDelete:h,fmtDateTime:i})=>{let j=a.employees&&a.employees.length>0?a.employees[0]:void 0,k=j?.profileUrl??"/_next/static/media/avatar-placeholder.7b9f2b3a.jpg";return(0,b.jsxs)("tr",{className:"even:bg-white odd:bg-white border-t",children:[(0,b.jsx)("td",{className:"py-4 px-4 text-sm text-gray-700 border-r align-top",children:a.projectShortCode??"—"}),(0,b.jsxs)("td",{className:"py-4 px-4 border-r align-top",children:[(0,b.jsxs)("div",{className:"text-sm font-medium",children:["Task ",a.taskId??"—"]}),(0,b.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:a.memo??""})]}),(0,b.jsx)("td",{className:"py-4 px-4 w-48 border-r align-top",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:(0,b.jsx)("img",{src:k,alt:j?.name??"employee",className:"w-full h-full object-cover"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-800",children:j?.name??a.employeeId??"—"}),(0,b.jsx)("div",{className:"text-xs text-gray-400",children:j?.designation??j?.department??""})]})]})}),(0,b.jsx)("td",{className:"py-4 px-4 border-r align-top text-sm text-gray-600",children:i(a.startDate,a.startTime)}),(0,b.jsx)("td",{className:"py-4 px-4 border-r align-top text-sm text-gray-600",children:i(a.endDate,a.endTime)}),(0,b.jsxs)("td",{className:"py-4 px-4 border-r align-top text-sm text-gray-700",children:[a.durationHours??0,"h"]}),(0,b.jsx)("td",{className:"py-4 px-4 align-top text-right",children:(0,b.jsxs)("div",{className:"inline-flex items-center relative",children:[(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),"number"==typeof a.id&&d(a.id)},className:"p-2 rounded hover:bg-gray-100",title:"Actions","aria-expanded":c===a.id,children:(0,b.jsx)(r.MoreVertical,{className:"h-5 w-5 text-gray-600"})}),c===a.id&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{onClick:e,className:"fixed inset-0 z-[10005]"}),(0,b.jsx)("div",{className:"absolute right-0 top-8 z-[10010] w-44 bg-white rounded-md border shadow-lg",children:(0,b.jsxs)("div",{className:"p-2",children:[(0,b.jsxs)("button",{onClick:()=>f(a),className:"w-full flex items-center gap-3 px-3 py-2 rounded hover:bg-gray-50 text-sm text-gray-700",children:[(0,b.jsx)(p.Eye,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"View"})]}),(0,b.jsxs)("button",{onClick:()=>g(a),className:"w-full flex items-center gap-3 px-3 py-2 rounded hover:bg-gray-50 text-sm text-gray-700",children:[(0,b.jsx)(q.Edit2,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"Edit"})]})]})})]})]})})]},a.id)},t="https://6jnqmj85-80.inc1.devtunnels.ms",u=["Mon","Tue","Wed","Thurs","Fri","Sat","Sun"],v=["January","February","March","April","May","June","July","August","September","October","November","December"],w=({open:a,onClose:d,apiBaseUrl:e=t,authToken:h=null})=>{let i=(0,c.useRef)(null),[j,k]=(0,c.useState)([{id:"r-0",taskId:"",taskLabel:"",hours:Array(7).fill(0)}]),l=A(new Date),[m,n]=(0,c.useState)(B(l)),[o,p]=(0,c.useState)(z(l)),[q,r]=(0,c.useState)(!1),[s,u]=(0,c.useState)(null),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(!1);function C(){try{let a=localStorage.getItem("accessToken");if(a&&""!==a.trim())return a.trim()}catch{}return h??null}async function D(){y(!0);let a=C();try{let b=await fetch(`${e}/me/tasks`,{headers:a?{Authorization:`Bearer ${a}`}:{}});if(!b.ok)throw Error("Failed to fetch tasks");let c=await b.json();w(c.map(a=>({id:a.id,title:a.title,projectShortCode:a.projectShortCode})))}catch(a){}finally{y(!1)}}async function E(){r(!0),u("");let a=C(),b={"Content-Type":"application/json"};a&&(b.Authorization=`Bearer ${a}`);try{for(let a of j){if(!a.taskId)continue;let c={taskId:Number(a.taskId),days:m.map((b,c)=>({date:b.iso,hours:Number(a.hours[c]||0)})).filter(a=>a.hours>0)};0!==c.days.length&&await fetch(`${e}/timesheets/weekly`,{method:"POST",headers:b,body:JSON.stringify(c)})}u("Saved successfully.")}catch(a){u("Save failed.")}finally{r(!1)}}return(0,c.useEffect)(()=>{D()},[]),(0,b.jsxs)("div",{className:"w-full bg-white border rounded-md shadow-sm p-6",children:[(0,b.jsx)("input",{type:"date",ref:i,className:"hidden",onChange:function(a){let b=new Date(a.target.value);if(isNaN(b.getTime()))return;let c=A(b);n(B(c)),p(z(c))}}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,b.jsx)("span",{className:"w-16 text-sm",children:"Week"}),(0,b.jsxs)("div",{onClick:function(){i.current?.showPicker?.()},className:"flex items-center border rounded-md bg-white cursor-pointer",children:[(0,b.jsx)("button",{className:"h-9 px-3 border-r",children:(0,b.jsx)(f.ChevronLeft,{className:"w-4 h-4"})}),(0,b.jsx)("div",{className:"px-4 text-sm min-w-[160px] text-center",children:o}),(0,b.jsx)("button",{className:"h-9 px-3 border-l",children:(0,b.jsx)(g.ChevronRight,{className:"w-4 h-4"})})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-md border shadow-sm",children:[(0,b.jsx)("div",{className:"bg-[#e8f0ff] border-b",children:(0,b.jsxs)("div",{className:"grid grid-cols-[180px_repeat(7,1fr)]",children:[(0,b.jsx)("div",{className:"px-4 py-3 text-xs font-medium",children:"Task"}),m.map(a=>(0,b.jsxs)("div",{className:"px-2 py-2 text-center border-l",children:[(0,b.jsx)("div",{className:"text-sm font-semibold",children:a.date}),(0,b.jsx)("div",{className:"text-[10px]",children:a.month}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500",children:a.label})]},a.iso))]})}),j.map((a,c)=>(0,b.jsx)("div",{className:"border-b",children:(0,b.jsxs)("div",{className:"grid grid-cols-[180px_repeat(7,1fr)]",children:[(0,b.jsx)("div",{className:"px-4 py-3 border-r",children:(0,b.jsxs)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:a.taskId,onChange:a=>(function(a,b){let c=v.find(a=>String(a.id)===b),d=c?`${c.title} (${c.projectShortCode||"PRJ"})`:"";k(c=>c.map((c,e)=>e===a?{...c,taskId:b,taskLabel:d}:c))})(c,a.target.value),children:[(0,b.jsx)("option",{value:"",children:x?"Loading…":"Select Task"}),v.map(a=>(0,b.jsx)("option",{value:a.id,children:a.title},a.id))]})}),m.map((d,e)=>(0,b.jsx)("div",{className:"px-2 py-3 border-l flex justify-center",children:(0,b.jsx)("input",{type:"number",min:0,step:"0.25",className:"w-14 text-center border rounded-md text-sm",value:a.hours[e],onChange:a=>{var b;return b=a.target.value,void k(a=>a.map((a,d)=>d===c?{...a,hours:a.hours.map((a,c)=>c===e?function(a){let b=Number(a);return isNaN(b)||b<0?0:b}(b):a)}:a))}})},e))]})},a.id)),(0,b.jsx)("div",{className:"border-t bg-white",children:(0,b.jsxs)("div",{className:"grid grid-cols-[180px_repeat(7,1fr)]",children:[(0,b.jsx)("div",{className:"px-4 py-3 border-r text-sm",children:"Total"}),m.map((a,c)=>(0,b.jsxs)("div",{className:"px-2 py-3 border-l text-center text-sm",children:[j.reduce((a,b)=>a+(Number(b.hours[c])||0),0)," hrs"]},c))]})})]}),(0,b.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("button",{onClick:function(){k(a=>[...a,{id:`r-${Date.now()}`,taskId:"",taskLabel:"",hours:Array(7).fill(0)}])},className:"px-4 py-2 border border-blue-500 text-blue-600 rounded-md bg-white",children:"+ Add More"}),s&&(0,b.jsx)("div",{className:"mt-3 text-sm whitespace-pre-line",children:s})]}),(0,b.jsx)("button",{onClick:E,disabled:q,className:"px-6 py-2 bg-blue-600 text-white rounded-md",children:q?"Saving…":"Save"})]})]})};function x(a){return String(a).padStart(2,"0")}function y(a){return v[a.getMonth()].slice(0,3)}function z(a){let b=`${x(a.getDate())} ${y(a)}`,c=new Date(a);return c.setDate(a.getDate()+6),`${b} - ${x(c.getDate())} ${y(c)}`}function A(a){let b=new Date(a);return b.setDate(b.getDate()-(b.getDay()+6)%7),b}function B(a){return Array.from({length:7}).map((b,c)=>{let d=new Date(a);return d.setDate(a.getDate()+c),{date:`${d.getDate()}`,month:y(d),label:u[c],iso:`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`}})}let C=({events:a,onEventClick:d})=>{let[e,h]=(0,c.useState)(()=>{let a=new Date;return new Date(a.getFullYear(),a.getMonth(),1)}),i=(0,c.useMemo)(()=>{let b=new Map;return a.forEach(a=>{if(!a.startDate)return;let c=a.startDate??"";b.has(c)||b.set(c,[]),b.get(c).push(a)}),b},[a]),j=(0,c.useMemo)(()=>{let a=e.getFullYear(),b=e.getMonth(),c=(new Date(a,b,1).getDay()+6)%7,d=new Date(a,b+1,0).getDate(),f=[];for(let a=0;a<c;a++)f.push({date:null});for(let c=1;c<=d;c++)f.push({date:new Date(a,b,c)});for(;f.length%7!=0;)f.push({date:null});return f},[e]),k=e.toLocaleDateString(void 0,{month:"long",year:"numeric"});function l(a){h(b=>new Date(b.getFullYear(),b.getMonth()+a,1))}return(0,b.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg overflow-hidden border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b  bg-gradient-to-r from-indigo-50 to-blue-50",children:[(0,b.jsx)("button",{onClick:()=>l(-1),className:"p-2 hover:bg-white rounded-full shadow-sm",children:(0,b.jsx)(f.ChevronLeft,{className:"w-5 h-5 text-gray-700"})}),(0,b.jsx)("div",{className:"text-lg font-semibold text-gray-700",children:k}),(0,b.jsx)("button",{onClick:()=>l(1),className:"p-2 hover:bg-white rounded-full shadow-sm",children:(0,b.jsx)(g.ChevronRight,{className:"w-5 h-5 text-gray-700"})})]}),(0,b.jsx)("div",{className:"grid grid-cols-7 text-xs text-center border-b bg-gray-100",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(a=>(0,b.jsx)("div",{className:"py-3 font-semibold text-gray-700 tracking-wide",children:a},a))}),(0,b.jsx)("div",{className:"grid grid-cols-7 gap-[1px] bg-gray-200",children:j.map((a,c)=>{if(!a.date)return(0,b.jsx)("div",{className:"bg-gray-50 h-[120px]"},c);let e=function(a){return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`}(a.date),f=i.get(e)??[];return(0,b.jsxs)("div",{className:"bg-white h-[120px] p-2 flex flex-col border border-gray-100 hover:bg-gray-50 transition group",children:[(0,b.jsx)("div",{className:"text-[12px] font-semibold text-gray-800 mb-1 group-hover:text-blue-600",children:a.date.getDate()}),(0,b.jsxs)("div",{className:"flex flex-col gap-1 overflow-hidden",children:[f.slice(0,4).map(a=>(0,b.jsxs)("button",{onClick:()=>d(a),className:"text-left rounded-md bg-blue-50 hover:bg-blue-100 transition px-2 py-1 text-[11px] truncate shadow-sm",children:[(0,b.jsxs)("span",{className:"font-medium text-blue-700",children:["Task ",a.taskId??a.id]}),(0,b.jsxs)("span",{className:"text-gray-500",children:[" • ",a.durationHours??0,"h "]})]},a.id)),f.length>4&&(0,b.jsxs)("div",{className:"text-[10px] text-gray-500",children:["+",f.length-4," more…"]})]})]},c)})})]})},D="undefined"!=typeof process&&"https://6jnqmj85-80.inc1.devtunnels.ms"||"undefined"!=typeof process&&process.env.NEXT_PUBLIC_GATEWAY||"http://localhost:3000",E=()=>`${D}/timesheets/me/summary`;function F(a){if(null==a||isNaN(Number(a)))return"0h";let b=Number(a);return 0===b?"0h":`${b%1==0?b.toFixed(0):b.toFixed(2)}h`}function G(a,b){if(!a)return"-";let c=new Date(b?`${a}T${b}`:a);return isNaN(c.getTime())?`${a}${b?" "+b:""}`:c.toLocaleString(void 0,{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function H(a,b,c,d){if(!a||!c)return 0;try{let e=a.split("-").map(Number),f=c.split("-").map(Number),g=0,h=0,i=0,j=0;if(b){let a=b.split(":").map(a=>Number(a));g=a[0]??0,h=a[1]??0}if(d){let a=d.split(":").map(a=>Number(a));i=a[0]??0,j=a[1]??0}let k=new Date(e[0],e[1]-1,e[2],g,h),l=new Date(f[0],f[1]-1,f[2],i,j).getTime()-k.getTime();if(isNaN(l)||l<=0)return 0;return Math.round(l/36e5)}catch{return 0}}function I(){let[a,d]=(0,c.useState)(null),[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)({}),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""}),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(!1),[C,I]=(0,c.useState)([]),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)([]),[P,Q]=(0,c.useState)([]);(0,c.useEffect)(()=>{let a=!0;return async function(){f(!0),h(null);try{let b=await fetch(E(),{headers:{"Content-Type":"application/json"},cache:"no-store"});if(401===b.status){try{localStorage.removeItem("accessToken")}catch{}throw Error("401: Unauthorized — please login.")}if(!b.ok){let a=await b.text().catch(()=>"");throw Error(`Failed to fetch: ${b.status} ${a}`)}let c=await b.json(),e=Array.isArray(c)?c:[c];a&&d(e)}catch(b){a&&h(b?.message||"Unknown error")}finally{a&&f(!1)}}(),()=>{a=!1}},[]);let R=async a=>{K(!0),M(null);try{let b=a||null,c=`${D.replace(/\/$/,"")}/projects/AllProject`,d=await fetch(c,{method:"GET",headers:b?{Authorization:`Bearer ${b}`,Accept:"application/json"}:{Accept:"application/json"},cache:"no-store"});if(401===d.status){try{localStorage.removeItem("accessToken")}catch{}I([]),K(!1);return}if(!d.ok){let a=await d.text().catch(()=>"");throw console.error("projects fetch failed",d.status,a),Error(`Failed to load projects (${d.status})`)}let e=await d.json();if(Array.isArray(e)){let a=[];e.forEach(b=>{let c=(b?.shortCode??"").toString().trim(),d=b?.id??b?.projectId??b?._id??null,e=(b?.name??"").toString().trim(),f=Array.isArray(b?.assignedEmployees)?b.assignedEmployees:[];null!=d&&c&&a.push({id:d,shortCode:c,name:e,assignedEmployees:f})});let b=new Set,c=[];a.forEach(a=>{b.has(String(a.id))||(b.add(String(a.id)),c.push(a))}),I(c)}else console.warn("unexpected projects response",e),I([])}catch(a){console.error("loadProjects error",a),M(String(a?.message??a)),I([])}finally{K(!1)}},S=async(a,b)=>{if(!a){O([]),Q([]);return}let c=Number(a);if(!c||Number.isNaN(c)){O([]),Q([]);return}try{let a=`${D.replace(/\/$/,"")}/projects/${c}/tasks`,d=await fetch(a,{method:"GET",headers:{Accept:"application/json"},cache:"no-store"});if(!d.ok){let a=await d.text().catch(()=>"");console.error("project tasks fetch failed",d.status,a),O([]),Q([]);return}let e=await d.json(),f=Array.isArray(e)?e:[];if(O(f),null!=b&&f.length>0){let a=f.find(a=>a.id===b);Q(a?.assignedEmployees??[])}else Q([])}catch(a){console.error("fetchProjectTasks error",a),O([]),Q([])}},T=a=>{O([]),Q([]),z(null),a?(t(a.id),v({projectId:void 0!==a.projectId&&null!==a.projectId?String(a.projectId):"",taskId:void 0!==a.taskId&&null!==a.taskId?String(a.taskId):"",employeeId:a.employeeId??(a.employees&&a.employees[0]?.employeeId)??"",startDate:a.startDate??"",startTime:a.startTime?a.startTime.slice(0,5):"",endDate:a.endDate??"",endTime:a.endTime?a.endTime.slice(0,5):"",memo:a.memo??""}),a.projectId&&S(a.projectId,a.taskId??null)):(t(null),v({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""})),R(),r(!0),l(null)},U=async()=>{x(!0),z(null);try{if(!u.projectId||!u.taskId||!u.employeeId||!u.startDate||!u.startTime||!u.endDate||!u.endTime||!u.memo){z("Please fill all required fields."),x(!1);return}let a={projectId:Number(u.projectId),taskId:Number(u.taskId),employeeId:u.employeeId,startDate:u.startDate,startTime:u.startTime,endDate:u.endDate,endTime:u.endTime,memo:u.memo,durationHours:H(u.startDate,u.startTime,u.endDate,u.endTime)},b=s?`${D.replace(/\/$/,"")}/timesheets/${s}`:`${D.replace(/\/$/,"")}/timesheets`,c=await fetch(b,{method:s?"PUT":"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)});if(!c.ok){let a=await c.text().catch(()=>"");throw console.error("save entry failed",c.status,a),Error("Failed to save entry")}r(!1),t(null),v({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""});try{let a=await fetch(E(),{headers:{"Content-Type":"application/json"},cache:"no-store"});if(a.ok){let b=await a.json();d(b)}}catch(a){}}catch(a){console.error("saveEntry error",a),z(a?.message||"Failed to save entry")}finally{x(!1)}},V=async()=>{if(o){x(!0),z(null);try{let a=await fetch(`${D.replace(/\/$/,"")}/timesheets/${o.id}`,{method:"DELETE",headers:void 0});if(!a.ok){let b=await a.text().catch(()=>"");throw console.error("deleteTimesheet failed",a.status,b),Error("Failed to delete timesheet")}B(!1),p(null);try{let a=await fetch(E(),{headers:{"Content-Type":"application/json"},cache:"no-store"});if(a.ok){let b=await a.json();d(b)}}catch(a){}}catch(a){console.error("deleteTimesheet error",a),z(a?.message||"Failed to delete timesheet")}finally{x(!1)}}},W=c.default.useMemo(()=>{let a=new Map;return C.forEach(b=>{null!=b.id&&b.assignedEmployees?.length&&a.set(String(b.id),b.assignedEmployees)}),a},[C]),X=c.default.useMemo(()=>{let b=new Set;return(a??[]).forEach(a=>{a.timeLogs.forEach(a=>{a.employeeId&&b.add(a.employeeId),a.employees&&a.employees.length>0&&a.employees.forEach(a=>a?.employeeId&&b.add(a.employeeId))})}),["--",...Array.from(b)]},[a]),Y=H(u.startDate,u.startTime,u.endDate,u.endTime);return((0,c.useEffect)(()=>{if(null!=k)return document.addEventListener("mousedown",a),document.addEventListener("keydown",b),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("keydown",b)};function a(a){let b=a.target;b&&(b.closest("[data-menu-id]")||l(null))}function b(a){"Escape"===a.key&&l(null)}},[k]),e)?(0,b.jsx)("div",{className:"py-6 px-4 text-gray-600",children:"Loading summary…"}):g?(0,b.jsxs)("div",{className:"py-6 px-4 text-red-600",children:["Error loading summaries: ",g]}):a&&0!==a.length?(0,b.jsxs)("div",{className:"space-y-3 px-4 pb-8",children:[a.map(a=>{let c=!!i[a.employeeId],d=a.timeLogs?.[0]?.employees?.[0]?.profileUrl;return(0,b.jsxs)("div",{className:"border rounded-lg bg-white shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 px-4 py-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-50 flex items-center justify-center overflow-hidden border",children:d?(0,b.jsx)("img",{src:d,alt:a.employeeName,className:"w-full h-full object-cover"}):(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:a.employeeName?a.employeeName.split(" ").map(a=>a[0]).join("").toUpperCase():"?"})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"font-medium text-sm text-gray-800 truncate",children:a.employeeName}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:a.designation??"—"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsxs)("div",{className:"text-right mr-2",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Total"}),(0,b.jsx)("div",{className:"font-medium text-sm",children:F(a.totalHours)})]}),(0,b.jsx)("button",{onClick:()=>{var b;return b=a.employeeId,void j(a=>({...a,[b]:!a[b]}))},"aria-expanded":c,className:"w-9 h-9 flex items-center justify-center rounded border hover:bg-gray-50",children:c?(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,"aria-hidden":!0,children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 12H4"})}):(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,"aria-hidden":!0,children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})})]})]}),c&&(0,b.jsx)("div",{className:"border-t bg-gray-50 px-4 py-4",children:(0,b.jsx)("div",{className:"overflow-auto",children:(0,b.jsxs)("table",{className:"w-full min-w-[720px] table-fixed text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"text-left text-xs text-gray-600",children:[(0,b.jsx)("th",{className:"w-1/3 py-2 px-3",children:"Task"}),(0,b.jsx)("th",{className:"w-1/3 py-2 px-3",children:"Time"}),(0,b.jsx)("th",{className:"w-1/6 py-2 px-3 text-center",children:"Total Hours"}),(0,b.jsx)("th",{className:"w-1/6 py-2 px-3 text-center",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:a.timeLogs&&a.timeLogs.length>0?a.timeLogs.map(a=>(0,b.jsxs)("tr",{className:"border-t bg-white last:border-b",children:[(0,b.jsxs)("td",{className:"py-3 px-3 align-top",children:[(0,b.jsx)("div",{className:"font-medium",children:a.taskName??"Task Name"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:a.projectName??""})]}),(0,b.jsxs)("td",{className:"py-3 px-3 align-top",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:G(a.startDate,a.startTime)}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:G(a.endDate,a.endTime)})]}),(0,b.jsx)("td",{className:"py-3 px-3 align-top text-center",children:(0,b.jsx)("div",{className:"font-medium",children:F(a.durationHours)})}),(0,b.jsx)("td",{className:"py-3 px-3 align-top text-center relative",children:(0,b.jsxs)("div",{className:"inline-flex items-center gap-2 justify-center relative","data-menu-wrapper":!0,children:[(0,b.jsx)("button",{title:"Actions",onClick:()=>{var b;return b=a.id,void l(a=>a===b?null:b)},className:"p-1 rounded hover:bg-gray-100","aria-haspopup":"true","aria-expanded":k===a.id,children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor",children:(0,b.jsx)("path",{d:"M10 6a2 2 0 100-4 2 2 0 000 4zM10 12a2 2 0 100-4 2 2 0 000 4zM10 18a2 2 0 100-4 2 2 0 000 4z"})})}),k===a.id&&(0,b.jsx)("div",{"data-menu-id":!0,className:"absolute right-0 top-full mt-2 w-44 bg-white rounded-md shadow-lg border z-50",children:(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsxs)("button",{onClick:()=>{p(a),n(!0),l(null),l(null)},className:"w-full text-left px-4 py-2 flex items-center gap-3 text-sm hover:bg-gray-50",children:[(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-700",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,b.jsx)("path",{d:"M10 3C6 3 2.7 5.1 1 8c1.7 2.9 5 5 9 5s7.3-2.1 9-5c-1.7-2.9-5-5-9-5zM10 12a4 4 0 110-8 4 4 0 010 8z"}),(0,b.jsx)("path",{d:"M10 7a3 3 0 100 6 3 3 0 000-6z"})]}),(0,b.jsx)("span",{className:"text-gray-800",children:"View"})]}),(0,b.jsxs)("button",{onClick:()=>{T(a),l(null)},className:"w-full text-left px-4 py-2 flex items-center gap-3 text-sm hover:bg-gray-50",children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-700",viewBox:"0 0 20 20",fill:"currentColor",children:(0,b.jsx)("path",{d:"M17.414 2.586a2 2 0 010 2.828l-9.9 9.9a1 1 0 01-.465.263l-4 1a1 1 0 01-1.212-1.212l1-4a1 1 0 01.263-.465l9.9-9.9a2 2 0 012.828 0z"})}),(0,b.jsx)("span",{className:"text-gray-800",children:"Edit"})]})]})})]})})]},a.id)):(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:4,className:"py-4 px-3 text-gray-500",children:"No time logs available."})})})]})})})]},a.employeeId)}),m&&o&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10030] flex items-start justify-center pt-8 px-6",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>n(!1)}),(0,b.jsxs)("div",{className:"relative bg-white w-full max-w-6xl rounded-xl shadow-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold",children:"Timesheet"}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>n(!1),"aria-label":"Close",children:"✕"})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 relative bg-white rounded-xl border p-6",children:[(0,b.jsx)("div",{className:"absolute top-4 right-4 text-gray-500",children:"⋮"}),(0,b.jsx)("h4",{className:"text-lg font-medium mb-4",children:"TimeLog Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-y-4 gap-x-6 items-center text-sm",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,b.jsx)("div",{className:"col-span-2",children:G(o.startDate,o.startTime)}),(0,b.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,b.jsx)("div",{className:"col-span-2",children:G(o.endDate,o.endTime)}),(0,b.jsx)("div",{className:"text-gray-500",children:"Total Hours"}),(0,b.jsx)("div",{className:"col-span-2",children:"number"==typeof o.durationHours?`${o.durationHours}h`:"-"}),(0,b.jsx)("div",{className:"text-gray-500",children:"Memo"}),(0,b.jsx)("div",{className:"col-span-2",children:o.memo??"-"}),(0,b.jsx)("div",{className:"text-gray-500",children:"Project"}),(0,b.jsx)("div",{className:"col-span-2",children:o.projectName??o.projectShortCode??o.projectId??"-"}),(0,b.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,b.jsx)("div",{className:"col-span-2",children:o.taskName??`Task ${o.taskId??"-"}`}),(0,b.jsx)("div",{className:"text-gray-500",children:"Employee"}),(0,b.jsxs)("div",{className:"col-span-2 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:o.employees&&o.employees[0]?.profileUrl?(0,b.jsx)("img",{src:o.employees[0].profileUrl,alt:o.employees[0].name??"",className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-gray-200"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:o.employees&&o.employees[0]?.name?o.employees[0].name:o.employeeId}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:o.employees&&o.employees[0]?.designation?o.employees[0].designation:""})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border p-5",children:[(0,b.jsx)("h5",{className:"font-medium mb-3",children:"History"}),(0,b.jsxs)("div",{className:"space-y-4 text-sm text-gray-700",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,b.jsx)("div",{children:G(o.startDate,o.startTime)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,b.jsx)("div",{children:o.taskName??`Task ${o.taskId??"-"}`})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,b.jsx)("div",{children:G(o.endDate,o.endTime)})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,b.jsx)("button",{onClick:()=>n(!1),className:"px-6 py-2 rounded-md border text-blue-600",children:"Close"}),(0,b.jsx)("button",{onClick:()=>{o&&T(o),n(!1)},className:"px-6 py-2 rounded-md bg-blue-600 text-white",children:"Edit"})]})]})]})]}),q&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10020] flex items-start justify-center pt-12 px-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>r(!1)}),(0,b.jsxs)("div",{className:"relative bg-white w-full max-w-4xl rounded-xl shadow-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:s?"Edit TimeLog":"Log Time"}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>r(!1),"aria-label":"Close",children:"✕"})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-md border p-6",children:[(0,b.jsx)("h4",{className:"text-md font-medium mb-4",children:"TimeLog Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Project *"}),(0,b.jsxs)("select",{value:u.projectId||"",onChange:a=>{let b=a.target.value;v(a=>({...a,projectId:b,taskId:"",employeeId:""})),b?S(b):(O([]),Q([]))},className:"w-full border rounded px-3 py-2 text-sm",children:[(0,b.jsx)("option",{value:"",children:"--"}),J&&(0,b.jsx)("option",{value:"",children:"Loading..."}),L&&(0,b.jsx)("option",{value:"",children:"Error loading projects"}),C.map(a=>(0,b.jsx)("option",{value:String(a.id),children:null!=a.id?`#${a.id} - ${a.name||a.shortCode}`:a.name||a.shortCode},`${a.id}-${a.shortCode}`))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Task *"}),(0,b.jsx)("select",{value:u.taskId||"--",onChange:a=>{let b=a.target.value;if("--"===b){v(a=>({...a,taskId:"",employeeId:""})),Q([]);return}let c=Number(b),d=N.find(a=>a.id===c);v(a=>({...a,taskId:b,employeeId:""})),Q(d?.assignedEmployees??[])},className:"w-full border rounded px-3 py-2 text-sm",disabled:!!u.projectId&&0===N.length,children:u.projectId?0===N.length?(0,b.jsx)("option",{value:"--",children:"No tasks"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"--",children:"--"}),N.map(a=>(0,b.jsx)("option",{value:String(a.id),children:a.title?`${a.id} - ${a.title}`:`Task ${a.id}`},a.id))]}):(0,b.jsx)("option",{value:"--",children:"--"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Employee *"}),(0,b.jsx)("select",{value:u.employeeId||"--",onChange:a=>v(b=>({...b,employeeId:"--"===a.target.value?"":a.target.value})),className:"w-full border rounded px-3 py-2 text-sm",disabled:!!u.projectId&&0===N.length,children:(()=>{let a=u.projectId?W.get(u.projectId)??[]:[];return u.projectId&&0===N.length?(0,b.jsx)("option",{value:"--",children:"No employees"}):P.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"--",children:"--"}),P.map(a=>(0,b.jsx)("option",{value:a.employeeId,children:a.name?`${a.name} (${a.employeeId})`:a.employeeId},a.employeeId))]}):u.projectId&&a.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"--",children:"--"}),a.map(a=>(0,b.jsx)("option",{value:a.employeeId,children:a.name?`${a.name} (${a.employeeId})`:a.employeeId},a.employeeId))]}):X.map(a=>(0,b.jsx)("option",{value:a,children:"--"===a?"--":a},a))})()})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Date *"}),(0,b.jsx)("input",{type:"date",value:u.startDate,onChange:a=>v(b=>({...b,startDate:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Time *"}),(0,b.jsx)("input",{type:"time",value:u.startTime,onChange:a=>v(b=>({...b,startTime:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Date *"}),(0,b.jsx)("input",{type:"date",value:u.endDate,onChange:a=>v(b=>({...b,endDate:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Time *"}),(0,b.jsx)("input",{type:"time",value:u.endTime,onChange:a=>v(b=>({...b,endTime:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]})]}),(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Memo *"}),(0,b.jsx)("input",{type:"text",value:u.memo,onChange:a=>v(b=>({...b,memo:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Memo"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Total Hours"}),(0,b.jsxs)("div",{className:"text-2xl font-semibold text-blue-600",children:[Y,"h"]})]})]}),y&&(0,b.jsx)("div",{className:"mt-4 text-sm text-red-600",children:y})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,b.jsx)("button",{onClick:()=>r(!1),className:"px-6 py-2 rounded-md border text-blue-600",disabled:w,children:"Cancel"}),(0,b.jsx)("button",{onClick:U,className:"px-6 py-2 rounded-md bg-blue-600 text-white shadow",disabled:w,children:w?"Saving...":s?"Update":"Save"})]})]})]})]}),A&&o&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10040] flex items-start justify-center pt-12 px-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>B(!1)}),(0,b.jsx)("div",{className:"relative bg-white w-full max-w-md rounded-lg shadow-xl overflow-hidden",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Delete TimeLog"}),(0,b.jsxs)("p",{className:"text-sm text-gray-700",children:["Are you sure you want to delete timesheet ",(0,b.jsxs)("strong",{children:["#",String(o.id)]}),"? This action cannot be undone."]}),y&&(0,b.jsx)("div",{className:"mt-4 text-sm text-red-600",children:y}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-4 mt-6",children:[(0,b.jsx)("button",{className:"px-4 py-2 rounded border",onClick:()=>B(!1),disabled:w,children:"Cancel"}),(0,b.jsx)("button",{className:"px-4 py-2 rounded bg-red-600 text-white",onClick:V,disabled:w,children:w?"Deleting...":"Delete"})]})]})})]})]}):(0,b.jsx)("div",{className:"py-6 px-4 text-gray-600",children:"No summary found."})}let J="https://6jnqmj85-80.inc1.devtunnels.ms";function K(){let[a,j]=(0,c.useState)([]),[l,m]=(0,c.useState)(!0),[n,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(null),[t,u]=(0,c.useState)(""),[v,x]=(0,c.useState)(""),[y,z]=(0,c.useState)("All"),[A,B]=(0,c.useState)(!1),[D,E]=(0,c.useState)("all"),[F,G]=(0,c.useState)(1),[H,K]=(0,c.useState)(1),[L,M]=(0,c.useState)("table"),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(null),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""}),[Z,$]=(0,c.useState)(null),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(null),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)([]),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(null),[al,am]=(0,c.useState)([]),[an,ao]=(0,c.useState)([]),ap=(0,c.useMemo)(()=>{let a=new Map;return af.forEach(b=>{null!=b.id&&b.assignedEmployees?.length&&a.set(String(b.id),b.assignedEmployees)}),a},[af]),aq=(0,c.useMemo)(()=>{let b=new Set;return a.forEach(a=>{a.employees&&a.employees.length>0?a.employees.forEach(a=>{a?.employeeId&&b.add(a.employeeId)}):a.employeeId&&b.add(a.employeeId)}),["--",...Array.from(b)]},[a]),ar=(0,c.useMemo)(()=>{let b=new Map;return a.forEach(a=>{a.employees?.forEach(a=>{a?.employeeId&&!b.has(a.employeeId)&&b.set(a.employeeId,a)})}),b},[a]),as=a=>{if(!a||"--"===a)return"--";let b=ar.get(a);return b?.name?`${b.name} (${a})`:a},at=(0,c.useMemo)(()=>{let b=new Set;return a.forEach(a=>{"number"==typeof a.taskId&&b.add(a.taskId)}),["--",...Array.from(b).map(a=>String(a))]},[a]),au=a=>{if(!a||"--"===a)return"--";let b=Number(a),c=al.find(a=>a.id===b);return c?.title?`Task ${b} - ${c.title}`:`Task ${a}`},av=(a,b)=>(function(a,b){if(!a)return"";try{let c=b?`${a}T${b}`:`${a}T00:00:00`,d=new Date(c);if(Number.isNaN(d.getTime()))return`${a} ${b??""}`;let e=String(d.getDate()).padStart(2,"0"),f=String(d.getMonth()+1).padStart(2,"0"),g=d.getFullYear(),h=d.getHours(),i=String(d.getMinutes()).padStart(2,"0"),j=h>=12?"PM":"AM";return h%=12,0===h&&(h=12),`${e}/${f}/${g} ${h}:${i} ${j}`}catch{return`${a} ${b??""}`}})(a,b),aw=(a,b,c,d)=>{if(!a||!c)return 0;try{let e=a.split("-").map(Number),f=c.split("-").map(Number),g=0,h=0,i=0,j=0;b&&([g,h]=b.split(":").map(a=>Number(a))),d&&([i,j]=d.split(":").map(a=>Number(a)));let k=new Date(e[0],e[1]-1,e[2],g,h),l=new Date(f[0],f[1]-1,f[2],i,j).getTime()-k.getTime();if(isNaN(l)||l<=0)return 0;return Math.round(l/36e5)}catch{return 0}},ax=aw(X.startDate,X.startTime,X.endDate,X.endTime),ay=(0,c.useCallback)(async a=>{m(!0),r(null);try{let b=a||n||null;new URLSearchParams({page:String(F),limit:String(9),search:v||"",employee:"all"!==D?D:""});let c=`${J}/timesheets/me`,d=await fetch(c,{method:"GET",headers:b?{Authorization:`Bearer ${b}`,Accept:"application/json"}:{Accept:"application/json"},cache:"no-store"});if(401===d.status){try{localStorage.removeItem("accessToken")}catch{}p(null),j([]),K(1),m(!1);return}if(!d.ok){let a=await d.text().catch(()=>"");throw console.error("timesheets fetch failed",d.status,a),Error(`Failed to load timesheets (${d.status})`)}let e=await d.json(),f=[];Array.isArray(e)?(f=e,K(Math.max(1,Math.ceil((e.length||0)/9)))):(f=Array.isArray(e.items)?e.items:[],K(e.totalPages??Math.max(1,Math.ceil((e.total??f.length)/9)))),j(f)}catch(a){console.error("loadTimesheets error",a),r(String(a?.message??a)),j([]),K(1)}finally{m(!1)}},[F,v,D,n]),az=(0,c.useCallback)(async a=>{ai(!0),ak(null);try{let b=a||n||null,c=`${J}/projects/AllProject`,d=await fetch(c,{method:"GET",headers:b?{Authorization:`Bearer ${b}`,Accept:"application/json"}:{Accept:"application/json"},cache:"no-store"});if(401===d.status){try{localStorage.removeItem("accessToken")}catch{}p(null),ag([]),ai(!1);return}if(!d.ok){let a=await d.text().catch(()=>"");throw console.error("projects fetch failed",d.status,a),Error(`Failed to load projects (${d.status})`)}let e=await d.json();if(Array.isArray(e)){let a=[];e.forEach(b=>{let c=(b?.shortCode??"").toString().trim(),d=b?.id??b?.projectId??b?._id??null,e=(b?.name??"").toString().trim(),f=Array.isArray(b?.assignedEmployees)?b.assignedEmployees:[];null!=d&&c&&a.push({id:d,shortCode:c,name:e,assignedEmployees:f})});let b=new Set,c=[];a.forEach(a=>{b.has(String(a.id))||(b.add(String(a.id)),c.push(a))}),ag(c)}else console.warn("unexpected projects response",e),ag([])}catch(a){console.error("loadProjects error",a),ak(String(a?.message??a)),ag([])}finally{ai(!1)}},[n]),aA=(0,c.useCallback)(async(a,b)=>{if(!a){am([]),ao([]);return}let c=Number(a);if(!c||Number.isNaN(c)){am([]),ao([]);return}try{let a=n||null,d=`${J}/projects/${c}/tasks`,e=await fetch(d,{method:"GET",headers:a?{Authorization:`Bearer ${a}`,Accept:"application/json"}:{Accept:"application/json"},cache:"no-store"});if(!e.ok){let a=await e.text().catch(()=>"");console.error("project tasks fetch failed",e.status,a),am([]),ao([]);return}let f=await e.json(),g=Array.isArray(f)?f:[];if(am(g),null!=b&&g.length>0){let a=g.find(a=>a.id===b);ao(a?.assignedEmployees??[])}else ao([])}catch(a){console.error("fetchProjectTasks error",a),am([]),ao([])}},[n]);(0,c.useEffect)(()=>{let a=setTimeout(()=>{x(a=>a!==t?(G(1),t):a)},400);return()=>clearTimeout(a)},[t]),(0,c.useEffect)(()=>{m(!1)},[]),(0,c.useEffect)(()=>{n?(ay(n),az(n)):(ay(null),az(null))},[ay,az,n,F,v,D]),(0,c.useEffect)(()=>{$(null)},[F,L]);let aB=a=>{if(am([]),ao([]),a){let b=a.employees&&a.employees[0]?a.employees[0]:void 0;W(a.id),Y({projectId:void 0!==a.projectId&&null!==a.projectId?String(a.projectId):"",taskId:void 0!==a.taskId&&null!==a.taskId?String(a.taskId):"",employeeId:a.employeeId??b?.employeeId??"",startDate:a.startDate??"",startTime:a.startTime??"",endDate:a.endDate??"",endTime:a.endTime??"",memo:a.memo??""}),a.projectId&&aA(a.projectId,a.taskId??null)}else W(null),Y({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""});U(null),Q(!0)},aC=async()=>{S(!0),U(null);try{if(!X.projectId||!X.taskId||!X.employeeId||!X.startDate||!X.startTime||!X.endDate||!X.endTime||!X.memo){U("Please fill all required fields."),S(!1);return}let a={projectId:Number(X.projectId),taskId:Number(X.taskId),employeeId:X.employeeId,startDate:X.startDate,startTime:X.startTime,endDate:X.endDate,endTime:X.endTime,memo:X.memo,durationHours:aw(X.startDate,X.startTime,X.endDate,X.endTime)},b=n||null,c=V?`${J}/timesheets/${V}`:`${J}/timesheets`,d=await fetch(c,{method:V?"PUT":"POST",headers:{...b?{Authorization:`Bearer ${b}`}:{},"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)});if(!d.ok){let a=await d.text().catch(()=>"");throw console.error("save entry failed",d.status,a),Error("Failed to save entry")}Q(!1),W(null),Y({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""}),await ay(n??null)}catch(a){console.error("saveEntry error",a),U(a?.message||"Failed to save entry")}finally{S(!1)}},aD=a=>{ac(a),aa(!0),$(null)},aE=a=>{ac(a),ae(!0),$(null),U(null)},aF=(0,c.useMemo)(()=>{let b=v.trim().toLowerCase();return a.filter(a=>{if("All"!==y){let b=(a.employees??[]).some(a=>a.employeeId===y),c=a.employeeId===y;if(!b&&!c)return!1}return!!(!b||String(a.projectShortCode??"").toLowerCase().includes(b)||String(a.memo??"").toLowerCase().includes(b)||(a.employees??[]).some(a=>(a.name??"").toLowerCase().includes(b)||(a.designation??"").toLowerCase().includes(b)))})},[a,v,y]);return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("main",{className:"w-full",children:(0,b.jsxs)("div",{className:"max-w-[1180px] mx-auto ",children:[(0,b.jsx)(k,{employeeFilter:y,setEmployeeFilter:z,employeeOptions:aq,getEmployeeLabel:as,onOpenFiltersDrawer:()=>B(!0)}),(0,b.jsx)(o,{searchInput:t,setSearchInput:u,setSearchQuery:x,setCurrentPage:G,viewMode:L,setViewMode:M,showCalendarModal:N,setShowCalendarModal:O,openLogForm:()=>aB()}),"table"!==L&&"list"!==L?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"bg-white border border-gray-200 rounded-md overflow-hidden",children:(0,b.jsx)("div",{className:"p-0",children:(0,b.jsxs)("table",{className:"w-full table-auto border-collapse",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"text-left text-sm text-gray-600 border-b bg-blue-50",children:[(0,b.jsx)("th",{className:"py-3 px-4 w-28 border-r",children:"Code"}),(0,b.jsx)("th",{className:"py-3 px-4 border-r",children:"Task"}),(0,b.jsx)("th",{className:"py-3 px-4 w-48 border-r",children:"Employee"}),(0,b.jsx)("th",{className:"py-3 px-4 w-40 border-r",children:"Start Time"}),(0,b.jsx)("th",{className:"py-3 px-4 w-40 border-r",children:"End Time"}),(0,b.jsx)("th",{className:"py-3 px-4 w-28 border-r",children:"Total Hours"}),(0,b.jsx)("th",{className:"py-3 px-4 w-16",children:"Action"})]})}),(0,b.jsxs)("tbody",{children:[l&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,className:"py-6 text-center text-gray-500",children:"Loading..."})}),!l&&0===aF.length&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,className:"py-6 text-center text-gray-500",children:q?`Error: ${q}`:"No timesheets found"})}),!l&&aF.map(a=>(0,b.jsx)(s,{t:a,openMenuId:Z,onToggleMenu:a=>$(b=>b===a?null:a),onCloseMenu:()=>$(null),onView:aD,onEdit:aB,onDelete:aE,fmtDateTime:av},a.id))]})]})})}),(0,b.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between text-sm text-gray-600",children:[(0,b.jsxs)("div",{children:["Result per page - ",aF.length]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>G(a=>Math.max(1,a-1)),disabled:1===F,children:(0,b.jsx)(f.ChevronLeft,{})}),(0,b.jsxs)("div",{children:["Page ",F," of ",H]}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>G(a=>Math.min(H,a+1)),disabled:F===H,children:(0,b.jsx)(g.ChevronRight,{})})]})]})]})]})}),(0,b.jsx)("div",{"aria-hidden":!A,onClick:()=>B(!1),className:`fixed inset-0 transition-opacity duration-300 z-[9990] ${A?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,style:{backgroundColor:"rgba(0,0,0,0.3)"}}),(0,b.jsxs)("aside",{"aria-hidden":!A,className:`fixed right-0 top-0 h-full w-[360px] bg-white shadow-xl transform transition-transform duration-300 z-[9999] ${A?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Search,{className:"w-5 h-5"}),(0,b.jsx)("h3",{className:"font-semibold",children:"Filters"})]}),(0,b.jsx)("button",{onClick:()=>B(!1),className:"p-2 rounded hover:bg-gray-100",children:(0,b.jsx)(i.X,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:"p-4 space-y-4 overflow-auto h-[calc(100%-140px)]",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Employee"}),(0,b.jsxs)(e.Select,{value:D,onValueChange:a=>E(a),children:[(0,b.jsx)(e.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,b.jsx)(e.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(e.SelectContent,{children:[(0,b.jsx)(e.SelectItem,{value:"all",children:"All"}),aq.slice(1).map(a=>(0,b.jsx)(e.SelectItem,{value:a,children:as(a)},a))]})]})]})}),(0,b.jsxs)("div",{className:"p-4 border-t flex items-center justify-between gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{E("all"),B(!1)},children:"Reset"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Button,{variant:"ghost",onClick:()=>B(!1),children:"Close"}),(0,b.jsx)(d.Button,{className:"bg-blue-600 text-white",onClick:()=>{B(!1),G(1),ay(n??null)},children:"Apply"})]})]})]}),P&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10020] flex items-start justify-center pt-12 px-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Q(!1)}),(0,b.jsxs)("div",{className:"relative bg-white w-full max-w-4xl rounded-xl shadow-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:V?"Edit TimeLog":"Log Time"}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>Q(!1),"aria-label":"Close",children:(0,b.jsx)(i.X,{className:"w-5 h-5 text-gray-500"})})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-md border p-6",children:[(0,b.jsx)("h4",{className:"text-md font-medium mb-4",children:"TimeLog Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Project *"}),(0,b.jsxs)("select",{value:X.projectId||"",onChange:a=>{let b=a.target.value;Y(a=>({...a,projectId:b,taskId:"",employeeId:""})),b?aA(b):(am([]),ao([]))},className:"w-full border rounded px-3 py-2 text-sm",children:[(0,b.jsx)("option",{value:"",children:"--"}),ah&&(0,b.jsx)("option",{value:"",children:"Loading..."}),aj&&(0,b.jsx)("option",{value:"",children:"Error loading projects"}),af.map(a=>(0,b.jsx)("option",{value:String(a.id),children:null!=a.id?`#${a.id} - ${a.name||a.shortCode}`:a.name||a.shortCode},`${a.id}-${a.shortCode}`))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Task *"}),(0,b.jsx)("select",{value:X.taskId||"--",onChange:a=>{let b=a.target.value;if("--"===b){Y(a=>({...a,taskId:"",employeeId:""})),ao([]);return}let c=Number(b),d=al.find(a=>a.id===c);Y(a=>({...a,taskId:b,employeeId:""})),ao(d?.assignedEmployees??[])},className:"w-full border rounded px-3 py-2 text-sm",disabled:!!X.projectId&&0===al.length,children:X.projectId?0===al.length?(0,b.jsx)("option",{value:"--",children:"No tasks"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"--",children:"--"}),al.map(a=>(0,b.jsx)("option",{value:String(a.id),children:au(String(a.id))},a.id))]}):at.map(a=>(0,b.jsx)("option",{value:a,children:"--"===a?"--":au(a)},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Employee *"}),(0,b.jsx)("select",{value:X.employeeId||"--",onChange:a=>Y(b=>({...b,employeeId:"--"===a.target.value?"":a.target.value})),className:"w-full border rounded px-3 py-2 text-sm",disabled:!!X.projectId&&0===al.length,children:(()=>{let a=X.projectId?ap.get(X.projectId)??[]:[];return X.projectId&&0===al.length?(0,b.jsx)("option",{value:"--",children:"No employees"}):an.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"--",children:"--"}),an.map(a=>(0,b.jsx)("option",{value:a.employeeId,children:a.name?`${a.name} (${a.employeeId})`:a.employeeId},a.employeeId))]}):X.projectId&&a.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"--",children:"--"}),a.map(a=>(0,b.jsx)("option",{value:a.employeeId,children:a.name?`${a.name} (${a.employeeId})`:a.employeeId},a.employeeId))]}):aq.map(a=>(0,b.jsx)("option",{value:a,children:as(a)},a))})()})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Date *"}),(0,b.jsx)("input",{type:"date",value:X.startDate,onChange:a=>Y(b=>({...b,startDate:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Time *"}),(0,b.jsx)("input",{type:"time",value:X.startTime,onChange:a=>Y(b=>({...b,startTime:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Date *"}),(0,b.jsx)("input",{type:"date",value:X.endDate,onChange:a=>Y(b=>({...b,endDate:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Time *"}),(0,b.jsx)("input",{type:"time",value:X.endTime,onChange:a=>Y(b=>({...b,endTime:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]})]}),(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Memo *"}),(0,b.jsx)("input",{type:"text",value:X.memo,onChange:a=>Y(b=>({...b,memo:a.target.value})),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Memo"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Total Hours"}),(0,b.jsxs)("div",{className:"text-2xl font-semibold text-blue-600",children:[ax,"h"]})]})]}),T&&(0,b.jsx)("div",{className:"mt-4 text-sm text-red-600",children:T})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,b.jsx)("button",{onClick:()=>Q(!1),className:"px-6 py-2 rounded-md border text-blue-600",disabled:R,children:"Cancel"}),(0,b.jsx)("button",{onClick:aC,className:"px-6 py-2 rounded-md bg-blue-600 text-white shadow",disabled:R,children:R?"Saving...":V?"Update":"Save"})]})]})]})]}),_&&ab&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10030] flex items-start justify-center pt-8 px-6",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>aa(!1)}),(0,b.jsxs)("div",{className:"relative bg-white w-full max-w-6xl rounded-xl shadow-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold",children:"Timesheet"}),(0,b.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>aa(!1),"aria-label":"Close",children:(0,b.jsx)(i.X,{className:"w-5 h-5 text-gray-500"})})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 relative bg-white rounded-xl border p-6",children:[(0,b.jsx)("div",{className:"absolute top-4 right-4 text-gray-500",children:"⋮"}),(0,b.jsx)("h4",{className:"text-lg font-medium mb-4",children:"TimeLog Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-y-4 gap-x-6 items-center text-sm",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,b.jsx)("div",{className:"col-span-2",children:av(ab.startDate,ab.startTime)}),(0,b.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,b.jsx)("div",{className:"col-span-2",children:av(ab.endDate,ab.endTime)}),(0,b.jsx)("div",{className:"text-gray-500",children:"Total Hours"}),(0,b.jsx)("div",{className:"col-span-2",children:"number"==typeof ab.durationHours?`${ab.durationHours}h`:"-"}),(0,b.jsx)("div",{className:"text-gray-500",children:"Memo"}),(0,b.jsx)("div",{className:"col-span-2",children:ab.memo??"-"}),(0,b.jsx)("div",{className:"text-gray-500",children:"Project"}),(0,b.jsx)("div",{className:"col-span-2",children:ab.projectShortCode??ab.projectId??"-"}),(0,b.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,b.jsxs)("div",{className:"col-span-2",children:["Task ",ab.taskId??"-"]}),(0,b.jsx)("div",{className:"text-gray-500",children:"Employee"}),(0,b.jsxs)("div",{className:"col-span-2 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:ab.employees&&ab.employees[0]?.profileUrl?(0,b.jsx)("img",{src:ab.employees[0].profileUrl,alt:ab.employees[0].name??"",className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-gray-200"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:ab.employees&&ab.employees[0]?.name?ab.employees[0].name:ab.employeeId}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:ab.employees&&ab.employees[0]?.designation?ab.employees[0].designation:""})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border p-5",children:[(0,b.jsx)("h5",{className:"font-medium mb-3",children:"History"}),(0,b.jsxs)("div",{className:"space-y-4 text-sm text-gray-700",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,b.jsx)("div",{children:av(ab.startDate,ab.startTime)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,b.jsxs)("div",{children:["Task ",ab.taskId??"-"]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,b.jsx)("div",{children:av(ab.endDate,ab.endTime)})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,b.jsx)("button",{onClick:()=>aa(!1),className:"px-6 py-2 rounded-md border text-blue-600",children:"Close"}),(0,b.jsx)("button",{onClick:()=>{ab&&aB(ab),aa(!1)},className:"px-6 py-2 rounded-md bg-blue-600 text-white",children:"Edit"})]})]})]})]}),"weekly"===L&&(0,b.jsx)(w,{open:!0,onClose:()=>M("table")}),"TimesheetSummary"===L&&(0,b.jsx)(I,{}),N&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10050] flex items-start justify-center pt-8 px-6",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>O(!1)}),(0,b.jsxs)("div",{className:"relative bg-white w-full max-w-[1180px] rounded-xl shadow-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold",children:"Calendar"}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)("button",{className:"px-3 py-1 rounded hover:bg-gray-100",onClick:()=>O(!1),"aria-label":"Close",children:"Close"})})]}),(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,b.jsx)(C,{events:a,onEventClick:a=>{aB(a),O(!1)}})})}),(0,b.jsx)("div",{className:"flex items-center justify-end gap-4 px-6 py-4 border-t",children:(0,b.jsx)("button",{onClick:()=>O(!1),className:"px-4 py-2 rounded border",children:"Close"})})]})]})]})}}];

//# sourceMappingURL=src_app_%28employee%29_employees_work_timesheet_page_tsx_f5748646._.js.map