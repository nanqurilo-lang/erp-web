(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,221581,e=>{"use strict";e.s(["default",()=>H],221581);var t=e.i(247167),s=e.i(843476),l=e.i(271645),a=e.i(519455),r=e.i(967489),n=e.i(373375),i=e.i(463059),c=e.i(555436),d=e.i(37727),o=e.i(793479);let m=e=>{let{employeeFilter:t,setEmployeeFilter:l,employeeOptions:a,getEmployeeLabel:n,onOpenFiltersDrawer:i}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg border p-3 mb-4 flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,s.jsx)(o.Input,{placeholder:"Start Date to End Date",className:"w-64"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Employee"}),(0,s.jsxs)(r.Select,{value:t,onValueChange:e=>l(e),children:[(0,s.jsx)(r.SelectTrigger,{className:"w-40",children:(0,s.jsx)(r.SelectValue,{placeholder:"All"})}),(0,s.jsxs)(r.SelectContent,{children:[(0,s.jsx)(r.SelectItem,{value:"All",children:"All"}),a.slice(1).map(e=>(0,s.jsx)(r.SelectItem,{value:e,children:n(e)},e))]})]})]}),(0,s.jsx)("div",{className:"ml-auto flex items-center gap-4",children:(0,s.jsxs)("button",{onClick:i,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-800",children:[(0,s.jsx)(c.Search,{className:"w-4 h-4"})," Filters"]})})]})};var x=e.i(370956),h=e.i(87316);let u=e=>{let{searchInput:t,setSearchInput:l,setSearchQuery:r,setCurrentPage:n,viewMode:i,setViewMode:d,showCalendarModal:m,setShowCalendarModal:u,openLogForm:p}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("div",{children:(0,s.jsx)(a.Button,{className:"bg-blue-600 text-white",onClick:p,children:"+ Log Time"})}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 border rounded px-2 py-1 bg-white",children:[(0,s.jsx)(c.Search,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)(o.Input,{placeholder:"Search",value:t,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(r(t),n(()=>1))},className:"border-0 bg-transparent focus-visible:ring-0"})]}),(0,s.jsxs)("div",{className:"flex items-center bg-white border rounded-lg overflow-hidden",children:[(0,s.jsx)("button",{onClick:()=>{let e=document.querySelector('input[placeholder="Search"]');e&&e.focus()},className:"px-3 py-2 hover:bg-gray-50",title:"Search",children:(0,s.jsx)(c.Search,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>d("list"),className:"px-3 py-2 hover:bg-gray-50 ".concat("list"===i?"bg-gray-100":""),title:"List view",children:(0,s.jsx)(x.List,{className:"w-4 h-4"})}),(0,s.jsxs)("button",{onClick:()=>{d("weekly")},"aria-pressed":"weekly"===i,title:"Weekly calendar",className:"relative px-3 py-2 hover:bg-gray-50 ".concat("weekly"===i?"bg-violet-600 text-white":""),children:[(0,s.jsx)(h.Calendar,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 rounded-full flex items-center justify-center text-xs font-semibold leading-none\n                ".concat("weekly"===i?"bg-white text-violet-600":"bg-violet-600 text-white"),"aria-hidden":"true",children:"7"})]}),(0,s.jsx)("button",{onClick:()=>u(!0),className:"px-3 py-2 hover:bg-gray-50 ".concat(m?"ring-2 ring-indigo-300":""),title:"Open calendar view",children:(0,s.jsx)(h.Calendar,{className:"w-4 h-4 text-gray-600"})}),(0,s.jsx)("button",{onClick:()=>d("TimesheetSummary"),className:"px-3 py-2 hover:bg-gray-50 ".concat("TimesheetSummary"===i?"bg-violet-600 text-white":""),title:"User",children:"S"})]})]})]})};var p=e.i(286536),g=e.i(592930),j=e.i(727612),y=e.i(323585);let v=e=>{var t,l,a,r,n,i,c,d,o,m;let{t:x,openMenuId:h,onToggleMenu:u,onCloseMenu:v,onView:b,onEdit:N,onDelete:f,fmtDateTime:w}=e,S=x.employees&&x.employees.length>0?x.employees[0]:void 0,k=null!=(t=null==S?void 0:S.profileUrl)?t:"/_next/static/media/avatar-placeholder.7b9f2b3a.jpg";return(0,s.jsxs)("tr",{className:"even:bg-white odd:bg-white border-t",children:[(0,s.jsx)("td",{className:"py-4 px-4 text-sm text-gray-700 border-r align-top",children:null!=(l=x.projectShortCode)?l:"—"}),(0,s.jsxs)("td",{className:"py-4 px-4 border-r align-top",children:[(0,s.jsxs)("div",{className:"text-sm font-medium",children:["Task ",null!=(a=x.taskId)?a:"—"]}),(0,s.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:null!=(r=x.memo)?r:""})]}),(0,s.jsx)("td",{className:"py-4 px-4 w-48 border-r align-top",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:(0,s.jsx)("img",{src:k,alt:null!=(n=null==S?void 0:S.name)?n:"employee",className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-gray-800",children:null!=(c=null!=(i=null==S?void 0:S.name)?i:x.employeeId)?c:"—"}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:null!=(o=null!=(d=null==S?void 0:S.designation)?d:null==S?void 0:S.department)?o:""})]})]})}),(0,s.jsx)("td",{className:"py-4 px-4 border-r align-top text-sm text-gray-600",children:w(x.startDate,x.startTime)}),(0,s.jsx)("td",{className:"py-4 px-4 border-r align-top text-sm text-gray-600",children:w(x.endDate,x.endTime)}),(0,s.jsxs)("td",{className:"py-4 px-4 border-r align-top text-sm text-gray-700",children:[null!=(m=x.durationHours)?m:0,"h"]}),(0,s.jsx)("td",{className:"py-4 px-4 align-top text-right",children:(0,s.jsxs)("div",{className:"inline-flex items-center relative",children:[(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),"number"==typeof x.id&&u(x.id)},className:"p-2 rounded hover:bg-gray-100",title:"Actions","aria-expanded":h===x.id,children:(0,s.jsx)(y.MoreVertical,{className:"h-5 w-5 text-gray-600"})}),h===x.id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{onClick:v,className:"fixed inset-0 z-[10005]"}),(0,s.jsx)("div",{className:"absolute right-0 top-8 z-[10010] w-44 bg-white rounded-md border shadow-lg",children:(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsxs)("button",{onClick:()=>b(x),className:"w-full flex items-center gap-3 px-3 py-2 rounded hover:bg-gray-50 text-sm text-gray-700",children:[(0,s.jsx)(p.Eye,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"View"})]}),(0,s.jsxs)("button",{onClick:()=>N(x),className:"w-full flex items-center gap-3 px-3 py-2 rounded hover:bg-gray-50 text-sm text-gray-700",children:[(0,s.jsx)(g.Edit2,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Edit"})]}),(0,s.jsxs)("button",{onClick:()=>f(x),className:"w-full flex items-center gap-3 px-3 py-2 rounded hover:bg-gray-50 text-sm text-red-600",children:[(0,s.jsx)(j.Trash2,{className:"w-4 h-4 text-red-600"}),(0,s.jsx)("span",{children:"Delete"})]})]})})]})]})})]},x.id)};var b=e.i(489853),N=e.i(245423),f=e.i(284614);let w="".concat("https://6jnqmj85-80.inc1.devtunnels.ms"),S=["Mon","Tue","Wed","Thurs","Fri","Sat","Sun"],k=["January","February","March","April","May","June","July","August","September","October","November","December"],T=e=>{let{open:t,onClose:a,apiBaseUrl:r=w,authToken:d=null}=e,o=(0,l.useRef)(null),[m,u]=(0,l.useState)([{id:"r-0",taskId:"",taskLabel:"",hours:Array(7).fill(0)}]),p=E(new Date),[g,j]=(0,l.useState)(A(p)),[y,v]=(0,l.useState)(D(p)),[S,k]=(0,l.useState)(!1),[T,C]=(0,l.useState)(null),[I,M]=(0,l.useState)([]),[L,F]=(0,l.useState)(!1);function z(){try{let e=localStorage.getItem("accessToken");if(e&&""!==e.trim())return e.trim()}catch(e){}return null!=d?d:null}async function P(){F(!0);let e=z();try{let t=await fetch("".concat(r,"/me/tasks"),{headers:e?{Authorization:"Bearer ".concat(e)}:{}});if(!t.ok)throw Error("Failed to fetch tasks");let s=await t.json();M(s.map(e=>({id:e.id,title:e.title,projectShortCode:e.projectShortCode})))}catch(e){}finally{F(!1)}}async function B(){k(!0),C("");let e=z(),t={"Content-Type":"application/json"};e&&(t.Authorization="Bearer ".concat(e));try{for(let e of m){if(!e.taskId)continue;let s={taskId:Number(e.taskId),days:g.map((t,s)=>({date:t.iso,hours:Number(e.hours[s]||0)})).filter(e=>e.hours>0)};0!==s.days.length&&await fetch("".concat(r).concat("/timesheets/weekly"),{method:"POST",headers:t,body:JSON.stringify(s)})}C("Saved successfully.")}catch(e){C("Save failed.")}finally{k(!1)}}return(0,l.useEffect)(()=>{P()},[]),(0,s.jsxs)("div",{className:"w-full bg-white border rounded-md shadow-sm p-6",children:[(0,s.jsx)("input",{type:"date",ref:o,className:"hidden",onChange:function(e){let t=new Date(e.target.value);if(isNaN(t.getTime()))return;let s=E(t);j(A(s)),v(D(s))}}),(0,s.jsxs)("header",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold",children:"Weekly Timesheet"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{className:"w-9 h-9 rounded-full border flex items-center justify-center",children:(0,s.jsx)(c.Search,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{className:"flex items-center rounded-md border bg-white overflow-hidden",children:[(0,s.jsx)("button",{className:"px-3 h-9 border-r",children:(0,s.jsx)(x.List,{className:"w-4 h-4"})}),(0,s.jsx)("button",{className:"px-3 h-9 bg-indigo-500 text-white",children:(0,s.jsx)(b.CalendarDays,{className:"w-4 h-4"})}),(0,s.jsx)("button",{className:"px-3 h-9 border-l",children:(0,s.jsx)(h.Calendar,{className:"w-4 h-4"})})]}),(0,s.jsx)("button",{className:"w-9 h-9 rounded-full border flex items-center justify-center",children:(0,s.jsx)(N.Bell,{className:"w-4 h-4"})}),(0,s.jsx)("div",{className:"w-9 h-9 rounded-full border bg-gray-100 flex items-center justify-center",children:(0,s.jsx)(f.User,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,s.jsx)("span",{className:"w-16 text-sm",children:"Week"}),(0,s.jsxs)("div",{onClick:function(){var e,t;null==(t=o.current)||null==(e=t.showPicker)||e.call(t)},className:"flex items-center border rounded-md bg-white cursor-pointer",children:[(0,s.jsx)("button",{className:"h-9 px-3 border-r",children:(0,s.jsx)(n.ChevronLeft,{className:"w-4 h-4"})}),(0,s.jsx)("div",{className:"px-4 text-sm min-w-[160px] text-center",children:y}),(0,s.jsx)("button",{className:"h-9 px-3 border-l",children:(0,s.jsx)(i.ChevronRight,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-md border shadow-sm",children:[(0,s.jsx)("div",{className:"bg-[#e8f0ff] border-b",children:(0,s.jsxs)("div",{className:"grid grid-cols-[180px_repeat(7,1fr)]",children:[(0,s.jsx)("div",{className:"px-4 py-3 text-xs font-medium",children:"Task"}),g.map(e=>(0,s.jsxs)("div",{className:"px-2 py-2 text-center border-l",children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:e.date}),(0,s.jsx)("div",{className:"text-[10px]",children:e.month}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:e.label})]},e.iso))]})}),m.map((e,t)=>(0,s.jsx)("div",{className:"border-b",children:(0,s.jsxs)("div",{className:"grid grid-cols-[180px_repeat(7,1fr)]",children:[(0,s.jsx)("div",{className:"px-4 py-3 border-r",children:(0,s.jsxs)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:e.taskId,onChange:e=>(function(e,t){let s=I.find(e=>String(e.id)===t),l=s?"".concat(s.title," (").concat(s.projectShortCode||"PRJ",")"):"";u(s=>s.map((s,a)=>a===e?{...s,taskId:t,taskLabel:l}:s))})(t,e.target.value),children:[(0,s.jsx)("option",{value:"",children:L?"Loading…":"Select Task"}),I.map(e=>(0,s.jsx)("option",{value:e.id,children:e.title},e.id))]})}),g.map((l,a)=>(0,s.jsx)("div",{className:"px-2 py-3 border-l flex justify-center",children:(0,s.jsx)("input",{type:"number",min:0,step:"0.25",className:"w-14 text-center border rounded-md text-sm",value:e.hours[a],onChange:e=>{var s;return s=e.target.value,void u(e=>e.map((e,l)=>l===t?{...e,hours:e.hours.map((e,t)=>t===a?function(e){let t=Number(e);return isNaN(t)||t<0?0:t}(s):e)}:e))}})},a))]})},e.id)),(0,s.jsx)("div",{className:"border-t bg-white",children:(0,s.jsxs)("div",{className:"grid grid-cols-[180px_repeat(7,1fr)]",children:[(0,s.jsx)("div",{className:"px-4 py-3 border-r text-sm",children:"Total"}),g.map((e,t)=>(0,s.jsxs)("div",{className:"px-2 py-3 border-l text-center text-sm",children:[m.reduce((e,s)=>e+(Number(s.hours[t])||0),0)," hrs"]},t))]})})]}),(0,s.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{onClick:function(){u(e=>[...e,{id:"r-".concat(Date.now()),taskId:"",taskLabel:"",hours:Array(7).fill(0)}])},className:"px-4 py-2 border border-blue-500 text-blue-600 rounded-md bg-white",children:"+ Add More"}),T&&(0,s.jsx)("div",{className:"mt-3 text-sm whitespace-pre-line",children:T})]}),(0,s.jsx)("button",{onClick:B,disabled:S,className:"px-6 py-2 bg-blue-600 text-white rounded-md",children:S?"Saving…":"Save"})]})]})};function C(e){return String(e).padStart(2,"0")}function I(e){return k[e.getMonth()].slice(0,3)}function D(e){let t="".concat(C(e.getDate())," ").concat(I(e)),s=new Date(e);return s.setDate(e.getDate()+6),"".concat(t," - ").concat(C(s.getDate())," ").concat(I(s))}function E(e){let t=new Date(e);return t.setDate(t.getDate()-(t.getDay()+6)%7),t}function A(e){return Array.from({length:7}).map((t,s)=>{let l=new Date(e);return l.setDate(e.getDate()+s),{date:"".concat(l.getDate()),month:I(l),label:S[s],iso:"".concat(l.getFullYear(),"-").concat(String(l.getMonth()+1).padStart(2,"0"),"-").concat(String(l.getDate()).padStart(2,"0"))}})}let M=e=>{let{events:t,onEventClick:a}=e,[r,c]=(0,l.useState)(()=>{let e=new Date;return new Date(e.getFullYear(),e.getMonth(),1)}),d=(0,l.useMemo)(()=>{let e=new Map;return t.forEach(t=>{var s;if(!t.startDate)return;let l=null!=(s=t.startDate)?s:"";e.has(l)||e.set(l,[]),e.get(l).push(t)}),e},[t]),o=(0,l.useMemo)(()=>{let e=r.getFullYear(),t=r.getMonth(),s=(new Date(e,t,1).getDay()+6)%7,l=new Date(e,t+1,0).getDate(),a=[];for(let e=0;e<s;e++)a.push({date:null});for(let s=1;s<=l;s++)a.push({date:new Date(e,t,s)});for(;a.length%7!=0;)a.push({date:null});return a},[r]),m=r.toLocaleDateString(void 0,{month:"long",year:"numeric"});function x(e){c(t=>new Date(t.getFullYear(),t.getMonth()+e,1))}return(0,s.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-lg overflow-hidden border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b  bg-gradient-to-r from-indigo-50 to-blue-50",children:[(0,s.jsx)("button",{onClick:()=>x(-1),className:"p-2 hover:bg-white rounded-full shadow-sm",children:(0,s.jsx)(n.ChevronLeft,{className:"w-5 h-5 text-gray-700"})}),(0,s.jsx)("div",{className:"text-lg font-semibold text-gray-700",children:m}),(0,s.jsx)("button",{onClick:()=>x(1),className:"p-2 hover:bg-white rounded-full shadow-sm",children:(0,s.jsx)(i.ChevronRight,{className:"w-5 h-5 text-gray-700"})})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 text-xs text-center border-b bg-gray-100",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(e=>(0,s.jsx)("div",{className:"py-3 font-semibold text-gray-700 tracking-wide",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-[1px] bg-gray-200",children:o.map((e,t)=>{var l;if(!e.date)return(0,s.jsx)("div",{className:"bg-gray-50 h-[120px]"},t);let r=function(e){return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))}(e.date),n=null!=(l=d.get(r))?l:[];return(0,s.jsxs)("div",{className:"bg-white h-[120px] p-2 flex flex-col border border-gray-100 hover:bg-gray-50 transition group",children:[(0,s.jsx)("div",{className:"text-[12px] font-semibold text-gray-800 mb-1 group-hover:text-blue-600",children:e.date.getDate()}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 overflow-hidden",children:[n.slice(0,4).map(e=>{var t,l;return(0,s.jsxs)("button",{onClick:()=>a(e),className:"text-left rounded-md bg-blue-50 hover:bg-blue-100 transition px-2 py-1 text-[11px] truncate shadow-sm",children:[(0,s.jsxs)("span",{className:"font-medium text-blue-700",children:["Task ",null!=(t=e.taskId)?t:e.id]}),(0,s.jsxs)("span",{className:"text-gray-500",children:[" • ",null!=(l=e.durationHours)?l:0,"h "]})]},e.id)}),n.length>4&&(0,s.jsxs)("div",{className:"text-[10px] text-gray-500",children:["+",n.length-4," more…"]})]})]},t)})})]})},L=void 0!==t.default&&"https://6jnqmj85-80.inc1.devtunnels.ms"||void 0!==t.default&&t.default.env.NEXT_PUBLIC_GATEWAY||"http://localhost:3000";function F(e){if(null==e||isNaN(Number(e)))return"0h";let t=Number(e);return 0===t?"0h":"".concat(t%1==0?t.toFixed(0):t.toFixed(2),"h")}function z(e,t){if(!e)return"-";let s=new Date(t?"".concat(e,"T").concat(t):e);return isNaN(s.getTime())?"".concat(e).concat(t?" "+t:""):s.toLocaleString(void 0,{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function P(){let[e,t]=(0,l.useState)(null),[a,r]=(0,l.useState)(!1),[n,i]=(0,l.useState)(null),[c,d]=(0,l.useState)({});return((0,l.useEffect)(()=>{let e=!0;return async function(){r(!0),i(null);try{let s=localStorage.getItem("accessToken"),l={"Content-Type":"application/json"};s&&(l.Authorization="Bearer ".concat(s));let a=await fetch("".concat(L.replace(/\/$/,""),"/timesheets/summary"),{headers:l,cache:"no-store"});if(401===a.status){try{localStorage.removeItem("accessToken")}catch(e){}throw Error("401: Unauthorized — please login.")}if(!a.ok){let e=await a.text().catch(()=>"");throw Error("Failed to fetch: ".concat(a.status," ").concat(e))}let r=await a.json();e&&t(r)}catch(t){e&&i((null==t?void 0:t.message)||"Unknown error")}finally{e&&r(!1)}}(),()=>{e=!1}},[]),a)?(0,s.jsx)("div",{className:"py-6 px-4 text-gray-600",children:"Loading summary…"}):n?(0,s.jsxs)("div",{className:"py-6 px-4 text-red-600",children:["Error loading summaries: ",n]}):e&&0!==e.length?(0,s.jsx)("div",{className:"space-y-3 px-4 pb-8",children:e.map(e=>{var t,l,a,r,n;let i=!!c[e.employeeId],o=null==(r=e.timeLogs)||null==(a=r[0])||null==(l=a.employees)||null==(t=l[0])?void 0:t.profileUrl;return(0,s.jsxs)("div",{className:"border rounded-lg bg-white shadow-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 px-4 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-50 flex items-center justify-center overflow-hidden border",children:o?(0,s.jsx)("img",{src:o,alt:e.employeeName,className:"w-full h-full object-cover"}):(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.employeeName?e.employeeName.split(" ").map(e=>e[0]).join("").toUpperCase():"?"})}),(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"font-medium text-sm text-gray-800 truncate",children:e.employeeName}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:null!=(n=e.designation)?n:"—"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[(0,s.jsxs)("div",{className:"text-right mr-2",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"Total"}),(0,s.jsx)("div",{className:"font-medium text-sm",children:F(e.totalHours)})]}),(0,s.jsx)("button",{onClick:()=>{var t;return t=e.employeeId,void d(e=>({...e,[t]:!e[t]}))},"aria-expanded":i,className:"w-9 h-9 flex items-center justify-center rounded border hover:bg-gray-50",children:i?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,"aria-hidden":!0,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 12H4"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,"aria-hidden":!0,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})})]})]}),i&&(0,s.jsx)("div",{className:"border-t bg-gray-50 px-4 py-4",children:(0,s.jsx)("div",{className:"overflow-auto",children:(0,s.jsxs)("table",{className:"w-full min-w-[720px] table-fixed text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"text-left text-xs text-gray-600",children:[(0,s.jsx)("th",{className:"w-1/3 py-2 px-3",children:"Task"}),(0,s.jsx)("th",{className:"w-1/3 py-2 px-3",children:"Time"}),(0,s.jsx)("th",{className:"w-1/6 py-2 px-3 text-center",children:"Total Hours"}),(0,s.jsx)("th",{className:"w-1/6 py-2 px-3 text-center",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.timeLogs&&e.timeLogs.length>0?e.timeLogs.map(e=>{var t,l;return(0,s.jsxs)("tr",{className:"border-t bg-white last:border-b",children:[(0,s.jsxs)("td",{className:"py-3 px-3 align-top",children:[(0,s.jsx)("div",{className:"font-medium",children:null!=(t=e.taskName)?t:"Task Name"}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:null!=(l=e.projectName)?l:""})]}),(0,s.jsxs)("td",{className:"py-3 px-3 align-top",children:[(0,s.jsx)("div",{className:"text-xs text-gray-600",children:z(e.startDate,e.startTime)}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:z(e.endDate,e.endTime)})]}),(0,s.jsx)("td",{className:"py-3 px-3 align-top text-center",children:(0,s.jsx)("div",{className:"font-medium",children:F(e.durationHours)})}),(0,s.jsx)("td",{className:"py-3 px-3 align-top text-center",children:(0,s.jsx)("button",{title:"More actions",className:"p-1 rounded hover:bg-gray-100",onClick:()=>{},children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{d:"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM18 10a2 2 0 11-4 0 2 2 0 014 0z"})})})})]},e.id)}):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"py-4 px-3 text-gray-500",children:"No time logs available."})})})]})})})]},e.employeeId)})}):(0,s.jsx)("div",{className:"py-6 px-4 text-gray-600",children:"No summary found."})}let B="https://6jnqmj85-80.inc1.devtunnels.ms";function H(){var e,t,o,x,h,p,g,j,y;let[b,N]=(0,l.useState)([]),[f,w]=(0,l.useState)(!0),[S,k]=(0,l.useState)(null),[C,I]=(0,l.useState)(null),[D,E]=(0,l.useState)(""),[A,L]=(0,l.useState)(""),[F,z]=(0,l.useState)("All"),[H,U]=(0,l.useState)("All"),[R,O]=(0,l.useState)(!1),[V,W]=(0,l.useState)("all"),[Y,_]=(0,l.useState)("all"),[J,q]=(0,l.useState)(1),[G,X]=(0,l.useState)(1),[K,Q]=(0,l.useState)("table"),[$,Z]=(0,l.useState)(!1),[ee,et]=(0,l.useState)(!1),[es,el]=(0,l.useState)(!1),[ea,er]=(0,l.useState)(null),[en,ei]=(0,l.useState)(null),[ec,ed]=(0,l.useState)({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""}),[eo,em]=(0,l.useState)(null),[ex,eh]=(0,l.useState)(!1),[eu,ep]=(0,l.useState)(null),[eg,ej]=(0,l.useState)(!1),[ey,ev]=(0,l.useState)([]),[eb,eN]=(0,l.useState)(!1),[ef,ew]=(0,l.useState)(null),[eS,ek]=(0,l.useState)([]),[eT,eC]=(0,l.useState)([]),eI=(0,l.useMemo)(()=>{let e=new Map;return ey.forEach(t=>{var s;null!=t.id&&(null==(s=t.assignedEmployees)?void 0:s.length)&&e.set(String(t.id),t.assignedEmployees)}),e},[ey]),eD=(0,l.useMemo)(()=>{let e=new Set;return b.forEach(t=>{t.employees&&t.employees.length>0?t.employees.forEach(t=>{(null==t?void 0:t.employeeId)&&e.add(t.employeeId)}):t.employeeId&&e.add(t.employeeId)}),["--",...Array.from(e)]},[b]),eE=(0,l.useMemo)(()=>{let e=new Map;return b.forEach(t=>{var s;null==(s=t.employees)||s.forEach(t=>{(null==t?void 0:t.employeeId)&&!e.has(t.employeeId)&&e.set(t.employeeId,t)})}),e},[b]),eA=e=>{if(!e||"--"===e)return"--";let t=eE.get(e);return(null==t?void 0:t.name)?"".concat(t.name," (").concat(e,")"):e},eM=(0,l.useMemo)(()=>{let e=new Set;return b.forEach(t=>{"number"==typeof t.taskId&&e.add(t.taskId)}),["--",...Array.from(e).map(e=>String(e))]},[b]),eL=e=>{if(!e||"--"===e)return"--";let t=Number(e),s=eS.find(e=>e.id===t);return(null==s?void 0:s.title)?"Task ".concat(t," - ").concat(s.title):"Task ".concat(e)},eF=(0,l.useMemo)(()=>{let e=new Set;return b.forEach(t=>{var s;return null==(s=t.employees)?void 0:s.forEach(t=>(null==t?void 0:t.department)&&e.add(t.department))}),["All",...Array.from(e)]},[b]),ez=(e,t)=>(function(e,t){if(!e)return"";try{let s=t?"".concat(e,"T").concat(t):"".concat(e,"T00:00:00"),l=new Date(s);if(Number.isNaN(l.getTime()))return"".concat(e," ").concat(null!=t?t:"");let a=String(l.getDate()).padStart(2,"0"),r=String(l.getMonth()+1).padStart(2,"0"),n=l.getFullYear(),i=l.getHours(),c=String(l.getMinutes()).padStart(2,"0"),d=i>=12?"PM":"AM";return i%=12,0===i&&(i=12),"".concat(a,"/").concat(r,"/").concat(n," ").concat(i,":").concat(c," ").concat(d)}catch(s){return"".concat(e," ").concat(null!=t?t:"")}})(e,t),eP=(e,t,s,l)=>{if(!e||!s)return 0;try{let a=e.split("-").map(Number),r=s.split("-").map(Number),n=0,i=0,c=0,d=0;t&&([n,i]=t.split(":").map(e=>Number(e))),l&&([c,d]=l.split(":").map(e=>Number(e)));let o=new Date(a[0],a[1]-1,a[2],n,i),m=new Date(r[0],r[1]-1,r[2],c,d).getTime()-o.getTime();if(isNaN(m)||m<=0)return 0;return Math.round(m/36e5)}catch(e){return 0}},eB=eP(ec.startDate,ec.startTime,ec.endDate,ec.endTime),eH=(0,l.useCallback)(async e=>{var t,s,l;w(!0),I(null);try{let l=e||S||localStorage.getItem("accessToken"),a=new URLSearchParams({page:String(J),limit:String(9),search:A||"",employee:"all"!==V?V:"",department:"all"!==Y?Y:""}),r="".concat(B,"/timesheets?").concat(a.toString()),n=await fetch(r,{method:"GET",headers:l?{Authorization:"Bearer ".concat(l),Accept:"application/json"}:{Accept:"application/json"},cache:"no-store"});if(401===n.status){try{localStorage.removeItem("accessToken")}catch(e){}k(null),N([]),X(1),w(!1);return}if(!n.ok){let e=await n.text().catch(()=>"");throw console.error("timesheets fetch failed",n.status,e),Error("Failed to load timesheets (".concat(n.status,")"))}let i=await n.json(),c=[];Array.isArray(i)?(c=i,X(Math.max(1,Math.ceil((i.length||0)/9)))):(c=Array.isArray(i.items)?i.items:[],X(null!=(s=i.totalPages)?s:Math.max(1,Math.ceil((null!=(t=i.total)?t:c.length)/9)))),N(c)}catch(e){console.error("loadTimesheets error",e),I(String(null!=(l=null==e?void 0:e.message)?l:e)),N([]),X(1)}finally{w(!1)}},[J,A,V,Y,S]),eU=(0,l.useCallback)(async e=>{eN(!0),ew(null);try{let t=e||S||localStorage.getItem("accessToken"),s=await fetch("".concat(B,"/projects/AllProject"),{method:"GET",headers:t?{Authorization:"Bearer ".concat(t),Accept:"application/json"}:{Accept:"application/json"},cache:"no-store"});if(401===s.status){try{localStorage.removeItem("accessToken")}catch(e){}k(null),ev([]),eN(!1);return}if(!s.ok){let e=await s.text().catch(()=>"");throw console.error("projects fetch failed",s.status,e),Error("Failed to load projects (".concat(s.status,")"))}let l=await s.json();if(Array.isArray(l)){let e=[];l.forEach(t=>{var s,l,a,r,n;let i=(null!=(s=null==t?void 0:t.shortCode)?s:"").toString().trim(),c=null!=(r=null!=(a=null!=(l=null==t?void 0:t.id)?l:null==t?void 0:t.projectId)?a:null==t?void 0:t._id)?r:null,d=(null!=(n=null==t?void 0:t.name)?n:"").toString().trim(),o=Array.isArray(null==t?void 0:t.assignedEmployees)?t.assignedEmployees:[];null!=c&&i&&e.push({id:c,shortCode:i,name:d,assignedEmployees:o})});let t=new Set,s=[];e.forEach(e=>{t.has(String(e.id))||(t.add(String(e.id)),s.push(e))}),ev(s)}else console.warn("unexpected projects response",l),ev([])}catch(e){var t;console.error("loadProjects error",e),ew(String(null!=(t=null==e?void 0:e.message)?t:e)),ev([])}finally{eN(!1)}},[S]),eR=(0,l.useCallback)(async(e,t)=>{if(!e){ek([]),eC([]);return}let s=Number(e);if(!s||Number.isNaN(s)){ek([]),eC([]);return}try{let e=S||localStorage.getItem("accessToken"),a="".concat(B,"/projects/").concat(s,"/tasks"),r=await fetch(a,{method:"GET",headers:e?{Authorization:"Bearer ".concat(e),Accept:"application/json"}:{Accept:"application/json"},cache:"no-store"});if(!r.ok){let e=await r.text().catch(()=>"");console.error("project tasks fetch failed",r.status,e),ek([]),eC([]);return}let n=await r.json(),i=Array.isArray(n)?n:[];if(ek(i),null!=t&&i.length>0){var l;let e=i.find(e=>e.id===t);eC(null!=(l=null==e?void 0:e.assignedEmployees)?l:[])}else eC([])}catch(e){console.error("fetchProjectTasks error",e),ek([]),eC([])}},[S]);(0,l.useEffect)(()=>{let e=setTimeout(()=>{L(e=>e!==D?(q(1),D):e)},400);return()=>clearTimeout(e)},[D]),(0,l.useEffect)(()=>{{let e=localStorage.getItem("accessToken");k(e),eH(e),eU(e)}},[]),(0,l.useEffect)(()=>{S?(eH(S),eU(S)):(eH(null),eU(null))},[eH,eU,S,J,A,V,Y]),(0,l.useEffect)(()=>{em(null)},[J,K]);let eO=e=>{if(ek([]),eC([]),e){var t,s,l,a,r,n,i,c;let d=e.employees&&e.employees[0]?e.employees[0]:void 0;ei(e.id),ed({projectId:void 0!==e.projectId&&null!==e.projectId?String(e.projectId):"",taskId:void 0!==e.taskId&&null!==e.taskId?String(e.taskId):"",employeeId:null!=(s=null!=(t=e.employeeId)?t:null==d?void 0:d.employeeId)?s:"",startDate:null!=(l=e.startDate)?l:"",startTime:null!=(a=e.startTime)?a:"",endDate:null!=(r=e.endDate)?r:"",endTime:null!=(n=e.endTime)?n:"",memo:null!=(i=e.memo)?i:""}),e.projectId&&eR(e.projectId,null!=(c=e.taskId)?c:null)}else ei(null),ed({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""});er(null),et(!0)},eV=async()=>{el(!0),er(null);try{if(!ec.projectId||!ec.taskId||!ec.employeeId||!ec.startDate||!ec.startTime||!ec.endDate||!ec.endTime||!ec.memo){er("Please fill all required fields."),el(!1);return}let e={projectId:Number(ec.projectId),taskId:Number(ec.taskId),employeeId:ec.employeeId,startDate:ec.startDate,startTime:ec.startTime,endDate:ec.endDate,endTime:ec.endTime,memo:ec.memo,durationHours:eP(ec.startDate,ec.startTime,ec.endDate,ec.endTime)},t=S||localStorage.getItem("accessToken"),s=en?"".concat(B,"/timesheets/").concat(en):"".concat(B,"/timesheets"),l=await fetch(s,{method:en?"PUT":"POST",headers:{...t?{Authorization:"Bearer ".concat(t)}:{},"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)});if(!l.ok){let e=await l.text().catch(()=>"");throw console.error("save entry failed",l.status,e),Error("Failed to save entry")}et(!1),ei(null),ed({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""}),await eH(null!=S?S:null)}catch(e){console.error("saveEntry error",e),er((null==e?void 0:e.message)||"Failed to save entry")}finally{el(!1)}},eW=e=>{ep(e),eh(!0),em(null)},eY=e=>{ep(e),ej(!0),em(null),er(null)},e_=async()=>{if(eu){el(!0),er(null);try{let e=S||localStorage.getItem("accessToken"),t=await fetch("".concat(B,"/timesheets/").concat(eu.id),{method:"DELETE",headers:e?{Authorization:"Bearer ".concat(e)}:void 0});if(!t.ok){let e=await t.text().catch(()=>"");throw console.error("deleteTimesheet failed",t.status,e),Error("Failed to delete timesheet")}ej(!1),ep(null),await eH(null!=S?S:null)}catch(e){console.error("deleteTimesheet error",e),er((null==e?void 0:e.message)||"Failed to delete timesheet")}finally{el(!1)}}},eJ=(0,l.useMemo)(()=>{let e=A.trim().toLowerCase();return b.filter(t=>{var s,l,a,r,n;if("All"!==F){let e=(null!=(s=t.employees)?s:[]).some(e=>e.employeeId===F),l=t.employeeId===F;if(!e&&!l)return!1}return("All"===H||!!(null!=(l=t.employees)?l:[]).some(e=>e.department===H))&&!!(!e||String(null!=(a=t.projectShortCode)?a:"").toLowerCase().includes(e)||String(null!=(r=t.memo)?r:"").toLowerCase().includes(e)||(null!=(n=t.employees)?n:[]).some(t=>{var s,l;return(null!=(s=t.name)?s:"").toLowerCase().includes(e)||(null!=(l=t.designation)?l:"").toLowerCase().includes(e)}))})},[b,A,F,H]);return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("main",{className:"w-full",children:(0,s.jsxs)("div",{className:"max-w-[1180px] mx-auto ",children:[(0,s.jsx)(m,{employeeFilter:F,setEmployeeFilter:z,employeeOptions:eD,getEmployeeLabel:eA,onOpenFiltersDrawer:()=>O(!0)}),(0,s.jsx)(u,{searchInput:D,setSearchInput:E,setSearchQuery:L,setCurrentPage:q,viewMode:K,setViewMode:Q,showCalendarModal:$,setShowCalendarModal:Z,openLogForm:()=>eO()}),"table"!==K&&"list"!==K?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-md overflow-hidden",children:(0,s.jsx)("div",{className:"p-0",children:(0,s.jsxs)("table",{className:"w-full table-auto border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"text-left text-sm text-gray-600 border-b bg-blue-50",children:[(0,s.jsx)("th",{className:"py-3 px-4 w-28 border-r",children:"Code"}),(0,s.jsx)("th",{className:"py-3 px-4 border-r",children:"Task"}),(0,s.jsx)("th",{className:"py-3 px-4 w-48 border-r",children:"Employee"}),(0,s.jsx)("th",{className:"py-3 px-4 w-40 border-r",children:"Start Time"}),(0,s.jsx)("th",{className:"py-3 px-4 w-40 border-r",children:"End Time"}),(0,s.jsx)("th",{className:"py-3 px-4 w-28 border-r",children:"Total Hours"}),(0,s.jsx)("th",{className:"py-3 px-4 w-16",children:"Action"})]})}),(0,s.jsxs)("tbody",{children:[f&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:7,className:"py-6 text-center text-gray-500",children:"Loading..."})}),!f&&0===eJ.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:7,className:"py-6 text-center text-gray-500",children:C?"Error: ".concat(C):"No timesheets found"})}),!f&&eJ.map(e=>(0,s.jsx)(v,{t:e,openMenuId:eo,onToggleMenu:e=>em(t=>t===e?null:e),onCloseMenu:()=>em(null),onView:eW,onEdit:eO,onDelete:eY,fmtDateTime:ez},e.id))]})]})})}),(0,s.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between text-sm text-gray-600",children:[(0,s.jsxs)("div",{children:["Result per page - ",eJ.length]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>q(e=>Math.max(1,e-1)),disabled:1===J,children:(0,s.jsx)(n.ChevronLeft,{})}),(0,s.jsxs)("div",{children:["Page ",J," of ",G]}),(0,s.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>q(e=>Math.min(G,e+1)),disabled:J===G,children:(0,s.jsx)(i.ChevronRight,{})})]})]})]})]})}),(0,s.jsx)("div",{"aria-hidden":!R,onClick:()=>O(!1),className:"fixed inset-0 transition-opacity duration-300 z-[9990] ".concat(R?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),style:{backgroundColor:"rgba(0,0,0,0.3)"}}),(0,s.jsxs)("aside",{"aria-hidden":!R,className:"fixed right-0 top-0 h-full w-[360px] bg-white shadow-xl transform transition-transform duration-300 z-[9999] ".concat(R?"translate-x-0":"translate-x-full"),role:"dialog","aria-modal":"true",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Search,{className:"w-5 h-5"}),(0,s.jsx)("h3",{className:"font-semibold",children:"Filters"})]}),(0,s.jsx)("button",{onClick:()=>O(!1),className:"p-2 rounded hover:bg-gray-100",children:(0,s.jsx)(d.X,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"p-4 space-y-4 overflow-auto h-[calc(100%-140px)]",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Employee"}),(0,s.jsxs)(r.Select,{value:V,onValueChange:e=>W(e),children:[(0,s.jsx)(r.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,s.jsx)(r.SelectValue,{placeholder:"All"})}),(0,s.jsxs)(r.SelectContent,{children:[(0,s.jsx)(r.SelectItem,{value:"all",children:"All"}),eD.slice(1).map(e=>(0,s.jsx)(r.SelectItem,{value:e,children:eA(e)},e))]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Department"}),(0,s.jsxs)(r.Select,{value:Y,onValueChange:e=>_(e),children:[(0,s.jsx)(r.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,s.jsx)(r.SelectValue,{placeholder:"All"})}),(0,s.jsxs)(r.SelectContent,{children:[(0,s.jsx)(r.SelectItem,{value:"all",children:"All"}),eF.slice(1).map(e=>(0,s.jsx)(r.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,s.jsxs)("div",{className:"p-4 border-t flex items-center justify-between gap-2",children:[(0,s.jsx)(a.Button,{variant:"outline",onClick:()=>{W("all"),_("all"),O(!1)},children:"Reset"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a.Button,{variant:"ghost",onClick:()=>O(!1),children:"Close"}),(0,s.jsx)(a.Button,{className:"bg-blue-600 text-white",onClick:()=>{O(!1),q(1),eH(null!=S?S:null)},children:"Apply"})]})]})]}),ee&&(0,s.jsxs)("div",{className:"fixed inset-0 z-[10020] flex items-start justify-center pt-12 px-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>et(!1)}),(0,s.jsxs)("div",{className:"relative bg-white w-full max-w-4xl rounded-xl shadow-xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:en?"Edit TimeLog":"Log Time"}),(0,s.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>et(!1),"aria-label":"Close",children:(0,s.jsx)(d.X,{className:"w-5 h-5 text-gray-500"})})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-md border p-6",children:[(0,s.jsx)("h4",{className:"text-md font-medium mb-4",children:"TimeLog Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Project *"}),(0,s.jsxs)("select",{value:ec.projectId||"",onChange:e=>{let t=e.target.value;ed(e=>({...e,projectId:t,taskId:"",employeeId:""})),t?eR(t):(ek([]),eC([]))},className:"w-full border rounded px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"",children:"--"}),eb&&(0,s.jsx)("option",{value:"",children:"Loading..."}),ef&&(0,s.jsx)("option",{value:"",children:"Error loading projects"}),ey.map(e=>(0,s.jsx)("option",{value:String(e.id),children:null!=e.id?"#".concat(e.id," - ").concat(e.name||e.shortCode):e.name||e.shortCode},"".concat(e.id,"-").concat(e.shortCode)))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Task *"}),(0,s.jsx)("select",{value:ec.taskId||"--",onChange:e=>{var t;let s=e.target.value;if("--"===s){ed(e=>({...e,taskId:"",employeeId:""})),eC([]);return}let l=Number(s),a=eS.find(e=>e.id===l);ed(e=>({...e,taskId:s,employeeId:""})),eC(null!=(t=null==a?void 0:a.assignedEmployees)?t:[])},className:"w-full border rounded px-3 py-2 text-sm",disabled:!!ec.projectId&&0===eS.length,children:ec.projectId?0===eS.length?(0,s.jsx)("option",{value:"--",children:"No tasks"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("option",{value:"--",children:"--"}),eS.map(e=>(0,s.jsx)("option",{value:String(e.id),children:eL(String(e.id))},e.id))]}):eM.map(e=>(0,s.jsx)("option",{value:e,children:"--"===e?"--":eL(e)},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Employee *"}),(0,s.jsx)("select",{value:ec.employeeId||"--",onChange:e=>ed(t=>({...t,employeeId:"--"===e.target.value?"":e.target.value})),className:"w-full border rounded px-3 py-2 text-sm",disabled:!!ec.projectId&&0===eS.length,children:(()=>{var e;let t=ec.projectId&&null!=(e=eI.get(ec.projectId))?e:[];return ec.projectId&&0===eS.length?(0,s.jsx)("option",{value:"--",children:"No employees"}):eT.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("option",{value:"--",children:"--"}),eT.map(e=>(0,s.jsx)("option",{value:e.employeeId,children:e.name?"".concat(e.name," (").concat(e.employeeId,")"):e.employeeId},e.employeeId))]}):ec.projectId&&t.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("option",{value:"--",children:"--"}),t.map(e=>(0,s.jsx)("option",{value:e.employeeId,children:e.name?"".concat(e.name," (").concat(e.employeeId,")"):e.employeeId},e.employeeId))]}):eD.map(e=>(0,s.jsx)("option",{value:e,children:eA(e)},e))})()})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Date *"}),(0,s.jsx)("input",{type:"date",value:ec.startDate,onChange:e=>ed(t=>({...t,startDate:e.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Time *"}),(0,s.jsx)("input",{type:"time",value:ec.startTime,onChange:e=>ed(t=>({...t,startTime:e.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Date *"}),(0,s.jsx)("input",{type:"date",value:ec.endDate,onChange:e=>ed(t=>({...t,endDate:e.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Time *"}),(0,s.jsx)("input",{type:"time",value:ec.endTime,onChange:e=>ed(t=>({...t,endTime:e.target.value})),className:"w-full border rounded px-3 py-2 text-sm"})]})]}),(0,s.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Memo *"}),(0,s.jsx)("input",{type:"text",value:ec.memo,onChange:e=>ed(t=>({...t,memo:e.target.value})),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Memo"})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Total Hours"}),(0,s.jsxs)("div",{className:"text-2xl font-semibold text-blue-600",children:[eB,"h"]})]})]}),ea&&(0,s.jsx)("div",{className:"mt-4 text-sm text-red-600",children:ea})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,s.jsx)("button",{onClick:()=>et(!1),className:"px-6 py-2 rounded-md border text-blue-600",disabled:es,children:"Cancel"}),(0,s.jsx)("button",{onClick:eV,className:"px-6 py-2 rounded-md bg-blue-600 text-white shadow",disabled:es,children:es?"Saving...":en?"Update":"Save"})]})]})]})]}),ex&&eu&&(0,s.jsxs)("div",{className:"fixed inset-0 z-[10030] flex items-start justify-center pt-8 px-6",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>eh(!1)}),(0,s.jsxs)("div",{className:"relative bg-white w-full max-w-6xl rounded-xl shadow-xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold",children:"Timesheet"}),(0,s.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>eh(!1),"aria-label":"Close",children:(0,s.jsx)(d.X,{className:"w-5 h-5 text-gray-500"})})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 relative bg-white rounded-xl border p-6",children:[(0,s.jsx)("div",{className:"absolute top-4 right-4 text-gray-500",children:"⋮"}),(0,s.jsx)("h4",{className:"text-lg font-medium mb-4",children:"TimeLog Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-y-4 gap-x-6 items-center text-sm",children:[(0,s.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,s.jsx)("div",{className:"col-span-2",children:ez(eu.startDate,eu.startTime)}),(0,s.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,s.jsx)("div",{className:"col-span-2",children:ez(eu.endDate,eu.endTime)}),(0,s.jsx)("div",{className:"text-gray-500",children:"Total Hours"}),(0,s.jsx)("div",{className:"col-span-2",children:"number"==typeof eu.durationHours?"".concat(eu.durationHours,"h"):"-"}),(0,s.jsx)("div",{className:"text-gray-500",children:"Memo"}),(0,s.jsx)("div",{className:"col-span-2",children:null!=(x=eu.memo)?x:"-"}),(0,s.jsx)("div",{className:"text-gray-500",children:"Project"}),(0,s.jsx)("div",{className:"col-span-2",children:null!=(p=null!=(h=eu.projectShortCode)?h:eu.projectId)?p:"-"}),(0,s.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,s.jsxs)("div",{className:"col-span-2",children:["Task ",null!=(g=eu.taskId)?g:"-"]}),(0,s.jsx)("div",{className:"text-gray-500",children:"Employee"}),(0,s.jsxs)("div",{className:"col-span-2 flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:eu.employees&&(null==(e=eu.employees[0])?void 0:e.profileUrl)?(0,s.jsx)("img",{src:eu.employees[0].profileUrl,alt:null!=(j=eu.employees[0].name)?j:"",className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-6 h-6 rounded-full bg-gray-200"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:eu.employees&&(null==(t=eu.employees[0])?void 0:t.name)?eu.employees[0].name:eu.employeeId}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:eu.employees&&(null==(o=eu.employees[0])?void 0:o.designation)?eu.employees[0].designation:""})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl border p-5",children:[(0,s.jsx)("h5",{className:"font-medium mb-3",children:"History"}),(0,s.jsxs)("div",{className:"space-y-4 text-sm text-gray-700",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,s.jsx)("div",{children:ez(eu.startDate,eu.startTime)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,s.jsxs)("div",{children:["Task ",null!=(y=eu.taskId)?y:"-"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,s.jsx)("div",{children:ez(eu.endDate,eu.endTime)})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,s.jsx)("button",{onClick:()=>eh(!1),className:"px-6 py-2 rounded-md border text-blue-600",children:"Close"}),(0,s.jsx)("button",{onClick:()=>{eu&&eO(eu),eh(!1)},className:"px-6 py-2 rounded-md bg-blue-600 text-white",children:"Edit"})]})]})]})]}),eg&&eu&&(0,s.jsxs)("div",{className:"fixed inset-0 z-[10040] flex items-start justify-center pt-12 px-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>ej(!1)}),(0,s.jsx)("div",{className:"relative bg-white w-full max-w-md rounded-lg shadow-xl overflow-hidden",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Delete TimeLog"}),(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:["Are you sure you want to delete timesheet"," ",(0,s.jsxs)("strong",{children:["RTA-",String(eu.id).padStart(2,"0")]}),"? This action cannot be undone."]}),ea&&(0,s.jsx)("div",{className:"mt-4 text-sm text-red-600",children:ea}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-4 mt-6",children:[(0,s.jsx)("button",{className:"px-4 py-2 rounded border",onClick:()=>ej(!1),disabled:es,children:"Cancel"}),(0,s.jsx)("button",{className:"px-4 py-2 rounded bg-red-600 text-white",onClick:e_,disabled:es,children:es?"Deleting...":"Delete"})]})]})})]}),"weekly"===K&&(0,s.jsx)(T,{open:!0,onClose:()=>Q("table")}),"TimesheetSummary"===K&&(0,s.jsx)(P,{}),$&&(0,s.jsxs)("div",{className:"fixed inset-0 z-[10050] flex items-start justify-center pt-8 px-6",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Z(!1)}),(0,s.jsxs)("div",{className:"relative bg-white w-full max-w-[1180px] rounded-xl shadow-xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold",children:"Calendar"}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("button",{className:"px-3 py-1 rounded hover:bg-gray-100",onClick:()=>Z(!1),"aria-label":"Close",children:"Close"})})]}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,s.jsx)(M,{events:b,onEventClick:e=>{eO(e),Z(!1)}})})}),(0,s.jsx)("div",{className:"flex items-center justify-end gap-4 px-6 py-4 border-t",children:(0,s.jsx)("button",{onClick:()=>Z(!1),className:"px-4 py-2 rounded border",children:"Close"})})]})]})]})}}]);