(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,178006,e=>{"use strict";e.s(["default",()=>S],178006);var t=e.i(843476),a=e.i(271645),l=e.i(519455),s=e.i(793479),n=e.i(967489),r=e.i(784774),c=e.i(755146),i=e.i(373375),d=e.i(463059),o=e.i(286536),x=e.i(727612),m=e.i(687130),u=e.i(37727);let h="".concat("https://6jnqmj85-80.inc1.devtunnels.ms"),p=(e,t)=>{let a=new Date(e);return a.setDate(a.getDate()+t),a},j=(e,t)=>e.toDateString()===t.toDateString();function g(){let[e,l]=(0,a.useState)([]),[s,n]=(0,a.useState)(!1),[r,c]=(0,a.useState)(new Date),i=async()=>{try{n(!0);let e=await fetch("".concat(h,"/api/projects"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},credentials:"include"});if(!e.ok)throw Error("Failed to fetch projects");let t=(await e.json()).map(e=>({id:e.id,name:e.name,startDate:e.startDate,deadline:e.deadline}));l(t)}catch(e){console.error("Project fetch error:",e)}finally{n(!1)}};(0,a.useEffect)(()=>{i()},[]);let d=(0,a.useMemo)(()=>{let e=new Date(r.getFullYear(),r.getMonth(),1),t=new Date(r.getFullYear(),r.getMonth()+1,0),a=[],l=new Date(e);l.setDate(e.getDate()-e.getDay());let s=new Date(t);s.setDate(t.getDate()+(6-t.getDay()));let n=l;for(;n<=s;)a.push(new Date(n)),n=p(n,1);return a},[r]);return(0,t.jsxs)("div",{className:"w-full bg-white rounded-xl shadow-sm border p-4 ",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("button",{onClick:()=>c(new Date(r.getFullYear(),r.getMonth()-1,1)),className:"px-3 py-1 border rounded",children:"◀"}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:r.toLocaleString("default",{month:"long",year:"numeric"})}),(0,t.jsx)("button",{onClick:()=>c(new Date(r.getFullYear(),r.getMonth()+1,1)),className:"px-3 py-1 border rounded",children:"▶"})]}),s&&(0,t.jsx)("div",{className:"text-center py-6 text-sm text-gray-500",children:"Loading projects..."}),(0,t.jsx)("div",{className:"grid grid-cols-7 text-sm font-medium text-center border-b pb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,t.jsx)("div",{children:e},e))}),(0,t.jsx)("div",{className:"mt-2 max-h-[70vh] overflow-y-auto overflow-x-hidden",children:(0,t.jsx)("div",{className:"grid grid-cols-7 gap-px bg-gray-200 mt-2",children:d.map((a,l)=>{let s=e.filter(e=>{let t=new Date(e.startDate),l=new Date(e.deadline);return a>=t&&a<=l}),n=a.getMonth()===r.getMonth();return(0,t.jsxs)("div",{className:"min-h-[110px] bg-white p-1 text-xs ".concat(n?"":"opacity-40"),children:[(0,t.jsx)("div",{className:"text-right font-semibold",children:a.getDate()}),(0,t.jsx)("div",{className:"space-y-1 mt-1",children:s.map(e=>{let l=j(a,new Date(e.startDate)),s=j(a,new Date(e.deadline));return(0,t.jsxs)("div",{className:"px-2 py-1 rounded text-white text-[11px]\n                        ".concat(l||s?"bg-blue-600":"bg-blue-400"),children:[l&&(0,t.jsx)("span",{children:"▶ "}),e.name,s&&(0,t.jsx)("span",{children:" ◀"})]},e.id)})})]},l)})})})]})}let v="https://6jnqmj85-80.inc1.devtunnels.ms",y=["IN_PROGRESS","NOT_STARTED","ON_HOLD","CANCELLED","FINISHED"],N="projectProgressOverrides";function S(){let[e,h]=(0,a.useState)([]),[p,j]=(0,a.useState)(!0),[S,f]=(0,a.useState)(null),[b,w]=(0,a.useState)(""),[C,D]=(0,a.useState)(""),[k,I]=(0,a.useState)("all"),[T,A]=(0,a.useState)("all"),[P,E]=(0,a.useState)(null),[F,B]=(0,a.useState)(null),[M,U]=(0,a.useState)(!1),[V,O]=(0,a.useState)("all"),[R,L]=(0,a.useState)("all"),[z,H]=(0,a.useState)("all"),[_,Y]=(0,a.useState)(1),[J,q]=(0,a.useState)(1),[G,X]=(0,a.useState)(!1),[K,$]=(0,a.useState)(""),[W,Q]=(0,a.useState)(""),[Z,ee]=(0,a.useState)(""),[et,ea]=(0,a.useState)(""),[el,es]=(0,a.useState)(!1),[en,er]=(0,a.useState)("none"),[ec,ei]=(0,a.useState)("none"),[ed,eo]=(0,a.useState)("none"),[ex,em]=(0,a.useState)(""),[eu,eh]=(0,a.useState)(!0),[ep,ej]=(0,a.useState)(""),[eg,ev]=(0,a.useState)(null),[ey,eN]=(0,a.useState)("USD"),[eS,ef]=(0,a.useState)(""),[eb,ew]=(0,a.useState)(""),[eC,eD]=(0,a.useState)(!1),ek=(0,a.useRef)(null),[eI,eT]=(0,a.useState)("you"),[eA,eP]=(0,a.useState)(!1),[eE,eF]=(0,a.useState)(!1),[eB,eM]=(0,a.useState)([]),[eU,eV]=(0,a.useState)(!1),[eO,eR]=(0,a.useState)(""),[eL,ez]=(0,a.useState)(!1),[eH,e_]=(0,a.useState)([]),[eY,eJ]=(0,a.useState)(!1),[eq,eG]=(0,a.useState)([]),[eX,eK]=(0,a.useState)(!1),[e$,eW]=(0,a.useState)(!1),[eQ,eZ]=(0,a.useState)(null),[e0,e1]=(0,a.useState)("grid"),[e4,e6]=(0,a.useState)(!1),[e2,e3]=(0,a.useState)(!1),[e5,e7]=(0,a.useState)(!1);(0,a.useEffect)(()=>{document.body.style.overflow=M||G||eE||e$||e5?"hidden":"auto"},[M,G,eE,e$,e5]);let e8=Array.from(new Set(e.map(e=>e.name))).filter(Boolean),e9=Array.from(new Set(e.flatMap(e=>(e.assignedEmployees||[]).map(e=>e.name)))).filter(Boolean),te=eB.map(e=>({id:String(e.id),name:e.name})),tt=eH.map(e=>({id:String(e.id),name:e.name})),ta=eq.map(e=>({id:String(e.id),name:e.departmentName})),tl=()=>{try{let e=localStorage.getItem(N);if(!e)return{};return JSON.parse(e)}catch(e){return{}}},ts=(e,t)=>{let a=tl(),l=String(e);null==t?delete a[l]:a[l]=t;try{localStorage.setItem(N,JSON.stringify(a))}catch(e){}},tn=(0,a.useCallback)(async e=>{j(!0);try{let t=e||localStorage.getItem("accessToken")||S||null;if(!t){h([]),q(1),j(!1);return}let a=new URLSearchParams({page:String(_),limit:String(9),search:C||"",status:"all"!==k?k:"",progress:"all"!==T?T:"",project:"all"!==V?V:"",member:"all"!==R?R:"",client:"all"!==z?z:""}),l=await fetch("".concat(v,"/api/projects?").concat(a.toString()),{headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"});if(401===l.status){try{localStorage.removeItem("accessToken")}catch(e){}f(null),h([]),q(1),j(!1);return}if(!l.ok){let e=await l.text().catch(()=>"");throw console.error("getProjects failed",l.status,e),Error("Failed to load projects")}let s=await l.json(),n=[];Array.isArray(s)?n=s:(n=s.projects||s.items||[],q(s.totalPages||Math.max(1,Math.ceil((s.total||9)/9))));let r=tl();Object.keys(r).length>0&&(n=n.map(e=>{let t=r[String(e.id)];return null!=t?{...e,progressPercent:t}:e})),h(n)}catch(e){console.error("Error loading projects:",e),h([]),q(1)}finally{j(!1)}},[_,C,k,T,V,R,z,S]),tr=(0,a.useCallback)(async e=>{eV(!0);try{let t=e||S||localStorage.getItem("accessToken"),a=await fetch("".concat(v,"/api/projects/category"),{headers:t?{Authorization:"Bearer ".concat(t)}:void 0,cache:"no-store"});if(!a.ok){console.warn("Failed to load categories, status:",a.status),eM([]),eV(!1);return}let l=await a.json();Array.isArray(l)?l.length>0&&"string"==typeof l[0]?eM(l.map((e,t)=>({id:t+1,name:String(e)}))):eM(l.map(e=>{var t,a,l;return{id:null!=(a=null!=(t=e.id)?t:e.name)?a:Math.random(),name:null!=(l=e.name)?l:String(e)}})):eM([])}catch(e){console.error("Error loading categories:",e),eM([])}finally{eV(!1)}},[S]),tc=async()=>{eF(!0),await tr()},ti=()=>{eF(!1),eR("")},td=async()=>{let e=eO.trim();if(!e)return alert("Category name required");ez(!0);let t=eB.slice(),a={id:"temp-".concat(Date.now()),name:e};eM(e=>[...e,a]);try{let n=S||localStorage.getItem("accessToken"),r=await fetch("".concat(v,"/api/projects/category"),{method:"POST",headers:{"Content-Type":"application/json",...n?{Authorization:"Bearer ".concat(n)}:{}},body:JSON.stringify({name:e}),cache:"no-store"});if(!r.ok){let e=await r.text().catch(()=>"");console.error("Add category failed",r.status,e),eM(t),alert("Failed to add category");return}let c=await r.json().catch(()=>null);if(c&&(c.id||c.name)){var l,s;eM(t=>t.map(t=>{var l,s,n;return t.id===a.id?{id:null!=(s=null!=(l=c.id)?l:c.name)?s:Math.random(),name:null!=(n=c.name)?n:e}:t})),er(String(null!=(s=null!=(l=c.id)?l:c.name)?s:e))}else{await tr();let t=eB.find(t=>t.name===e);t&&er(String(t.id))}eR("")}catch(e){console.error("Add category error:",e),eM(t),alert("Failed to add category")}finally{ez(!1)}},to=async e=>{if(!confirm("Delete this category?"))return;let t=eB.slice();eM(t=>t.filter(t=>t.id!==e));try{let t=S||localStorage.getItem("accessToken");if(!(await fetch("".concat(v,"/api/projects/category/").concat(encodeURIComponent(String(e))),{method:"DELETE",headers:t?{Authorization:"Bearer ".concat(t)}:void 0,cache:"no-store"})).ok)throw Error("Delete failed")}catch(e){console.error("Delete category failed:",e),eM(t),alert("Failed to delete category")}},tx=(0,a.useCallback)(async e=>{eJ(!0);try{let t=e||S||localStorage.getItem("accessToken"),a=await fetch("".concat(v,"/clients"),{headers:t?{Authorization:"Bearer ".concat(t)}:void 0,cache:"no-store"});if(!a.ok){console.warn("Failed to load clients, status:",a.status),e_([]),eJ(!1);return}let l=await a.json();Array.isArray(l)?e_(l):Array.isArray(l.items)?e_(l.items):e_([])}catch(e){console.error("Error loading clients:",e),e_([])}finally{eJ(!1)}},[S]),tm=(0,a.useCallback)(async e=>{eK(!0);try{let t=e||S||localStorage.getItem("accessToken"),a=await fetch("".concat(v,"/admin/departments"),{headers:t?{Authorization:"Bearer ".concat(t)}:void 0,cache:"no-store"});if(!a.ok){console.warn("Failed to load departments, status:",a.status),eG([]),eK(!1);return}let l=await a.json();Array.isArray(l)?eG(l):Array.isArray(l.items)?eG(l.items):eG([])}catch(e){console.error("Error loading departments:",e),eG([])}finally{eK(!1)}},[S]);async function tu(t,a){if(!S)return alert("Not authenticated");h(e=>e.map(e=>e.id===t?{...e,projectStatus:a}:e));try{let e=new FormData;e.append("status",a);let l=await fetch("".concat(v,"/api/projects/").concat(t,"/status"),{method:"PUT",body:e,headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}),s=null;try{s=await l.json()}catch(e){s=null}s&&s.id?(h(e=>e.map(e=>e.id===s.id?{...e,...s}:e)),null!=s.progressPercent&&ts(s.id,null)):await tn(S)}catch(t){console.error("Status update failed",t),h(e),alert("Failed to update status on server")}}async function th(t,a){if(!S)return alert("Not authenticated");let l=Math.max(0,Math.min(100,Math.round(a)));h(e=>e.map(e=>e.id===t?{...e,progressPercent:l}:e)),ts(t,l);try{let a=new FormData;a.append("percent",String(l));let s=await fetch("".concat(v,"/api/projects/").concat(t,"/progress"),{method:"PUT",body:a,headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}});if(401===s.status){console.error("patchProgress 401 unauthorized"),h(e),ts(t,null),localStorage.removeItem("accessToken"),f(null),alert("Session expired. Please login again.");return}if(!s.ok){let a=await s.text().catch(()=>"");console.error("patchProgress failed:",s.status,a),h(e),ts(t,null),alert("Failed to update progress on server");return}let n=null;try{n=204!==s.status?await s.json():null}catch(e){n=null}n&&n.id?(h(e=>e.map(e=>e.id===n.id?{...e,...n}:e)),null!=n.progressPercent&&ts(n.id,null)):await tn(S)}catch(a){console.error("Progress update failed:",a),h(e),ts(t,null),alert("Failed to update progress on server")}}(0,a.useEffect)(()=>{let e=setTimeout(()=>{D(e=>e!==b?(Y(1),b):e)},500);return()=>clearTimeout(e)},[b]),(0,a.useEffect)(()=>{{let e=localStorage.getItem("accessToken");f(e),tr(e||null),tx(e||null),tm(e||null),e?tn(e):j(!1)}},[]),(0,a.useEffect)(()=>{if(!S){let e=localStorage.getItem("accessToken");e&&(f(e),tn(e),tr(e),tx(e),tm(e));return}S&&tn(S)},[tn,S,_,C,k,T,V,R,z]);let tp=()=>{$(""),Q(""),ee(""),ea(""),es(!1),er("none"),ei("none"),eo("none"),em(""),eh(!0),ej(""),ev(null),eN("USD"),ef(""),ew(""),eD(!1),eT("you"),eP(!1)},tj=async()=>{if(!W.trim())return alert("Project Name is required");eP(!0);try{let e=K.trim();if(!e){let t=W.toString().normalize("NFKD").replace(/[\u0300-\u036F]/g,"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"");e=t?t.toUpperCase().replace(/-/g,"").slice(0,10):"PRJ".concat(Date.now().toString().slice(-6))}let t=new FormData;t.append("shortCode",e),t.append("name",W),t.append("projectName",W),t.append("startDate",Z||""),el?t.append("deadline",""):t.append("deadline",et||""),t.append("noDeadline",String(!!el)),t.append("category","none"===en?"":String(en)),t.append("department","none"===ec?"":String(ec)),t.append("clientId","none"===ed?"":String(ed)),t.append("summary",ex||""),t.append("tasksNeedAdminApproval",String(!!eu));let a=Array.isArray(ep)?ep:String(ep||"").split(",").map(e=>e.trim()).filter(Boolean);t.append("assignedEmployeeIds",JSON.stringify(a)),eg&&t.append("companyFile",eg),t.append("currency",ey||""),t.append("budget",""!==eS?String(eS):"0"),t.append("hoursEstimate",""!==eb?String(eb):"0"),t.append("allowManualTimeLogs",String(!!eC)),t.append("addedBy",String(eI||""));let l=S||localStorage.getItem("accessToken"),s=await fetch("".concat(v,"/api/projects"),{method:"POST",body:t,headers:l?{Authorization:"Bearer ".concat(l)}:void 0});if(!s.ok){let e=await s.text().catch(()=>"");console.error("Create project failed",s.status,e);let t="Failed to create project (status ".concat(s.status,")");try{let a=JSON.parse(e||"{}");a&&a.message&&(t=a.message)}catch(e){}alert(t),eP(!1);return}try{await s.json()}catch(e){}await tn(l),X(!1),tp()}catch(e){console.error("Create project error",e),alert("Failed to create project")}finally{eP(!1)}},tg=e=>e.shortCode||e.code||e.projectCode||"RTA-".concat(String(e.id).padStart(2,"0")),tv=()=>U(!1),ty=async()=>{Y(1),await tn(null!=S?S:null),U(!1)},tN=async()=>{O("all"),L("all"),H("all"),Y(1),await tn(null!=S?S:null),U(!1)},tS=(0,a.useMemo)(()=>e.filter(e=>{if("all"!==k&&(!e.projectStatus||e.projectStatus!==k))return!1;if("all"!==T){if("number"!=typeof e.progressPercent)return!1;let t=e.progressPercent;if("0-33"===T&&!(t>=0&&t<=33)||"34-66"===T&&!(t>=34&&t<=66)||"67-100"===T&&!(t>=67&&t<=100))return!1}if(P||F){let t=e.startDate?new Date(e.startDate):null,a=e.deadline?new Date(e.deadline):null;if(!t||!a||P&&t<new Date(P)||F&&a>new Date(F))return!1}return!0}),[e,k,T,P,F]);if(p)return(0,t.jsx)("p",{className:"p-8 text-center",children:"Loading projects..."});let tf=e=>{var a,s,n,i,d,x,m,u,p,j,g;let{p:v}=e,N=v.startDate?new Date(v.startDate).toLocaleDateString():"-",f=v.noDeadline?"No Deadline":v.deadline?new Date(v.deadline).toLocaleDateString():"-",b=Math.max(0,Math.min(100,null!=(x=v.progressPercent)?x:0)),w=null==b?"bg-gray-300":b<33?"bg-red-500":b<66?"bg-yellow-400":"bg-green-500";return(0,t.jsxs)(r.TableRow,{className:"bg-white hover:bg-gray-50",children:[(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top w-28",children:(0,t.jsx)("div",{className:"text-sm font-medium",children:tg(v)})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top",children:(0,t.jsx)("div",{className:"font-medium",children:v.name})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top",children:(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)("div",{className:"flex -space-x-2",children:[(v.assignedEmployees||[]).slice(0,3).map(e=>(0,t.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white overflow-hidden bg-gray-100",title:e.name,children:e.profileUrl?(0,t.jsx)("img",{src:e.profileUrl,alt:e.name,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center text-xs text-white bg-gray-400",children:(e.name||"U").charAt(0)})},e.employeeId)),(v.assignedEmployees||[]).length>3&&(0,t.jsxs)("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-gray-200 text-xs text-gray-700 flex items-center justify-center",children:["+",(v.assignedEmployees||[]).length-3]})]})})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top text-sm",children:N}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top text-sm",children:f}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:(null==(a=v.client)?void 0:a.profilePictureUrl)?(0,t.jsx)("img",{src:v.client.profilePictureUrl,alt:null==(s=v.client)?void 0:s.name,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"text-xs text-gray-500",children:((null==(n=v.client)?void 0:n.name)||"C").charAt(0)})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:null!=(m=null==(i=v.client)?void 0:i.name)?m:"Client"}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:null!=(u=null==(d=v.client)?void 0:d.company)?u:""})]})]})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"w-44 cursor-pointer",title:"Click to filter by this progress bucket",onClick:()=>{var e,t;null==(t=null!=(e=v.progressPercent)?e:null)?A("all"):t<=33?A("0-33"):t<=66?A("34-66"):A("67-100"),Y(1)},children:(0,t.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,t.jsx)("div",{className:"h-4 rounded-full ".concat(w),style:{width:"".concat(b,"%")}}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[b,"%"]})})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("button",{className:"inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs ".concat(function(e){switch(e){case"IN_PROGRESS":return"bg-green-600 text-white";case"NOT_STARTED":default:return"bg-gray-400 text-white";case"ON_HOLD":return"bg-yellow-500 text-white";case"CANCELLED":return"bg-red-600 text-white";case"FINISHED":return"bg-blue-600 text-white"}}(v.projectStatus)),title:"Click to filter by this status",onClick:()=>{var e;I(null!=(e=v.projectStatus)?e:"all"),Y(1)},children:[(0,t.jsx)("span",{className:"w-2 h-2 rounded-full",style:{background:function(e){switch(e){case"IN_PROGRESS":return"#10B981";case"NOT_STARTED":default:return"#9CA3AF";case"ON_HOLD":return"#F59E0B";case"CANCELLED":return"#EF4444";case"FINISHED":return"#3B82F6"}}(v.projectStatus)}}),(0,t.jsx)("span",{children:null!=(p=v.projectStatus)?p:"N/A"})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)(c.DropdownMenu,{children:[(0,t.jsx)(c.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)("button",{className:"inline-flex items-center gap-1 px-2 py-1 border rounded text-sm bg-white hover:bg-gray-50",children:(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"▾"})})}),(0,t.jsxs)(c.DropdownMenuContent,{align:"start",className:"w-64 p-2",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Change status"}),(0,t.jsx)("div",{className:"space-y-1",children:y.map(e=>(0,t.jsx)("button",{onClick:()=>tu(v.id,e),className:"w-full text-left px-3 py-2 rounded text-sm hover:bg-gray-50 ".concat(e===v.projectStatus?"font-medium":""),children:e},e))}),(0,t.jsx)(c.DropdownMenuSeparator,{}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-2 mb-1",children:"Adjust progress"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"range",min:0,max:100,value:null!=(j=v.progressPercent)?j:0,onChange:e=>{let t=Number(e.target.value);h(e=>e.map(e=>e.id===v.id?{...e,progressPercent:t}:e))},onMouseUp:async e=>{let t=Number(e.target.value);await th(v.id,t)},onTouchEnd:async e=>{let t=Number(e.target.value);await th(v.id,t)},className:"w-full"}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,t.jsx)("span",{children:"0%"}),(0,t.jsxs)("span",{children:[null!=(g=v.progressPercent)?g:0,"%"]}),(0,t.jsx)("span",{children:"100%"})]})]}),(0,t.jsx)("div",{className:"flex justify-end mt-2",children:(0,t.jsx)(l.Button,{size:"sm",variant:"ghost",onClick:()=>tn(null!=S?S:null),children:"Refresh"})})]})]})})]})]})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top text-right",children:(0,t.jsxs)(c.DropdownMenu,{children:[(0,t.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>window.location.assign("/work/roadmap/".concat(v.id)),children:[(0,t.jsx)(o.Eye,{className:"h-4 w-4 mr-2"})," "]}),(0,t.jsx)(c.DropdownMenuContent,{align:"end",className:"w-48",children:(0,t.jsxs)(c.DropdownMenuItem,{onClick:()=>window.location.assign("/work/roadmap/".concat(v.id)),children:[(0,t.jsx)(o.Eye,{className:"h-4 w-4 mr-2"})," View"]})})]})})]},v.id)};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("main",{className:"w-full",children:(0,t.jsxs)("div",{className:"max-w-[1200px] mx-auto p-6  overflow-y-auto overflow-x-hidden",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-3 mb-4 flex items-center gap-4 overflow-y-auto overflow-x-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,t.jsx)(s.Input,{type:"date",value:null!=P?P:"",onChange:e=>{E(e.target.value||null),Y(1)},className:"w-40"}),(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:"to"}),(0,t.jsx)(s.Input,{type:"date",value:null!=F?F:"",onChange:e=>{B(e.target.value||null),Y(1)},className:"w-40"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Status"}),(0,t.jsxs)(n.Select,{value:k,onValueChange:e=>{I(e),Y(1)},children:[(0,t.jsx)(n.SelectTrigger,{className:"w-40",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),(0,t.jsx)(n.SelectItem,{value:"IN_PROGRESS",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"NOT_STARTED",children:"Not Started"}),(0,t.jsx)(n.SelectItem,{value:"ON_HOLD",children:"On Hold"}),(0,t.jsx)(n.SelectItem,{value:"CANCELLED",children:"Cancelled"}),(0,t.jsx)(n.SelectItem,{value:"FINISHED",children:"Finished"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Progress"}),(0,t.jsxs)(n.Select,{value:T,onValueChange:e=>{A(e),Y(1)},children:[(0,t.jsx)(n.SelectTrigger,{className:"w-40",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),(0,t.jsx)(n.SelectItem,{value:"0-33",children:"0 - 33%"}),(0,t.jsx)(n.SelectItem,{value:"34-66",children:"34 - 66%"}),(0,t.jsx)(n.SelectItem,{value:"67-100",children:"67 - 100%"})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-blue-50 px-6 py-3 border-b flex items-center justify-between",children:[(0,t.jsxs)("h2",{className:"font-semibold text-gray-900",children:["Projects (",tS.length,")"]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:e4?"Viewing: Archived":e2?"Viewing: Pinned":"All active"})]}),(0,t.jsx)("div",{className:"overflow-auto p-4",children:"calendar"===e0||e5?(0,t.jsx)(g,{}):"list"===e0?(0,t.jsx)("div",{children:0===tS.length?(0,t.jsx)("div",{className:"p-6 text-center text-gray-500",children:"No projects found"}):(0,t.jsx)("div",{className:"space-y-3",children:tS.map(e=>{var a,s,n;return(0,t.jsxs)("div",{className:"flex items-center justify-between border rounded p-3 bg-white",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"text-sm font-medium w-28",children:tg(e)}),(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:null!=(s=null==(a=e.client)?void 0:a.name)?s:"Client"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"text-sm",children:[null!=(n=e.progressPercent)?n:0,"%"]}),(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>window.location.assign("/work/roadmap/".concat(e.id)),children:"View"})]})]},e.id)})})}):(0,t.jsx)("div",{children:(0,t.jsxs)(r.Table,{children:[(0,t.jsx)(r.TableHeader,{children:(0,t.jsxs)(r.TableRow,{className:"bg-blue-50",children:[(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Code"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Project Name"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Members"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Start Date"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Deadline"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Client"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Status"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3 text-right",children:"Action"})]})}),(0,t.jsx)(r.TableBody,{children:0===tS.length?(0,t.jsx)(r.TableRow,{children:(0,t.jsx)(r.TableCell,{colSpan:8,className:"py-8 text-center text-gray-500",children:"No projects found"})}):tS.map(e=>(0,t.jsx)(tf,{p:e},e.id))})]})})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Result per page -",tS.length?tS.length:0]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>{Y(e=>Math.max(1,e-1))},disabled:1===_,children:[(0,t.jsx)(i.ChevronLeft,{})," Prev"]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Page ",_," of ",J]}),(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>{Y(e=>Math.min(J,e+1))},disabled:_===J,children:["Next ",(0,t.jsx)(d.ChevronRight,{})]})]})]})]})}),(0,t.jsx)("div",{"aria-hidden":!M,onClick:tv,className:"fixed inset-0 transition-opacity duration-300 z-[9990] ".concat(M?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),style:{backgroundColor:"rgba(0,0,0,0.3)"}}),(0,t.jsxs)("aside",{"aria-hidden":!M,className:"fixed right-0 top-0 h-full w-[360px] bg-white shadow-xl transform transition-transform duration-300 z-[9999] ".concat(M?"translate-x-0":"translate-x-full"),role:"dialog","aria-modal":"true",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Filter,{className:"w-5 h-5"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Filters"})]}),(0,t.jsx)("button",{onClick:tv,className:"p-2 rounded hover:bg-gray-100",children:(0,t.jsx)(u.X,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4 overflow-auto h-[calc(100%-140px)]",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Project"}),(0,t.jsxs)(n.Select,{value:V,onValueChange:e=>O(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),e8.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Project Members"}),(0,t.jsxs)(n.Select,{value:R,onValueChange:e=>L(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),e9.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Client"}),(0,t.jsxs)(n.Select,{value:z,onValueChange:e=>H(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),tt.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]})]}),(0,t.jsxs)("div",{className:"p-4 border-t flex items-center justify-between gap-2",children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:tN,children:"Reset"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.Button,{variant:"ghost",onClick:tv,children:"Close"}),(0,t.jsx)(l.Button,{className:"bg-blue-600 text-white",onClick:ty,children:"Apply"})]})]})]}),G&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-start justify-center pt-12 px-4 overflow-y-auto",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{X(!1),tp()}}),(0,t.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Add Project"}),(0,t.jsx)("button",{onClick:()=>{X(!1),tp()},className:"p-2 rounded hover:bg-gray-100",children:(0,t.jsx)(u.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,t.jsx)(s.Input,{value:K,onChange:e=>$(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name *"}),(0,t.jsx)(s.Input,{value:W,onChange:e=>Q(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,t.jsx)(s.Input,{type:"date",value:Z,onChange:e=>ee(e.target.value)})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,t.jsx)(s.Input,{type:"date",value:et,onChange:e=>ea(e.target.value),disabled:el})]}),(0,t.jsx)("div",{className:"pt-6",children:(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)("input",{type:"checkbox",checked:el,onChange:e=>es(e.target.checked)}),(0,t.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.Select,{value:en,onValueChange:e=>er(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),te.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsx)(l.Button,{variant:"outline",onClick:tc,children:"Add"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,t.jsxs)(n.Select,{value:ec,onValueChange:e=>ei(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),ta.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,t.jsxs)(n.Select,{value:ed,onValueChange:e=>eo(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),tt.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,t.jsx)("textarea",{rows:4,value:ex,onChange:e=>em(e.target.value),className:"w-full p-2 border rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"approval",checked:!0===eu,onChange:()=>eh(!0)}),(0,t.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"approval",checked:!1===eu,onChange:()=>eh(!1)}),(0,t.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Add Project Members *"}),(0,t.jsx)(s.Input,{placeholder:"Comma separated names",value:Array.isArray(ep)?ep.join(","):ep,onChange:e=>ej(e.target.value)})]})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,t.jsxs)("div",{onClick:()=>{var e;return null==(e=ek.current)?void 0:e.click()},className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[eg?(0,t.jsx)("div",{children:eg.name}):(0,t.jsx)("div",{children:"Choose File"}),(0,t.jsx)("input",{ref:ek,type:"file",className:"hidden",onChange:e=>{var t,a;return ev(null!=(a=null==(t=e.target.files)?void 0:t[0])?a:null)}})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,t.jsxs)(n.Select,{value:ey,onValueChange:e=>eN(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"USD"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"USD",children:"USD $"}),(0,t.jsx)(n.SelectItem,{value:"USD",children:"USD ₹"}),(0,t.jsx)(n.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,t.jsx)(s.Input,{value:eS,onChange:e=>ef(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,t.jsx)(s.Input,{value:eb,onChange:e=>ew(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:eC,onChange:e=>eD(e.target.checked)}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,t.jsxs)(n.Select,{value:eI,onValueChange:e=>eT(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-44",children:(0,t.jsx)(n.SelectValue,{placeholder:"You"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"you",children:"You"}),e9.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>{X(!1),tp()},children:"Cancel"}),(0,t.jsx)(l.Button,{className:"bg-blue-600 text-white",onClick:tj,disabled:eA,children:eA?"Saving...":"Save"})]})]})]})]}),eE&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[11000] flex items-center justify-center px-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>ti()}),(0,t.jsxs)("div",{className:"relative w-full max-w-2xl bg-white rounded-lg shadow-2xl z-20 overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Project Category"}),(0,t.jsx)("button",{onClick:()=>ti(),className:"p-2 rounded hover:bg-gray-100",children:(0,t.jsx)(u.X,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsx)("div",{className:"rounded border overflow-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left",children:[(0,t.jsx)("thead",{className:"bg-blue-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2 text-sm",children:"#"}),(0,t.jsx)("th",{className:"px-4 py-2 text-sm",children:"Category Name"}),(0,t.jsx)("th",{className:"px-4 py-2 text-sm",children:"Action"})]})}),(0,t.jsx)("tbody",{children:eU?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"Loading..."})}):0===eB.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"No categories"})}):eB.map((e,a)=>(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-sm",children:a+1}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm",children:e.name}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,t.jsx)("button",{className:"p-2 rounded hover:bg-gray-100 text-red-600",onClick:()=>to(e.id),title:"Delete",children:(0,t.jsx)(x.Trash2,{className:"w-4 h-4"})})})]},e.id))})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Category Name *"}),(0,t.jsx)(s.Input,{placeholder:"Enter category name",value:eO,onChange:e=>eR(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>ti(),children:"Cancel"}),(0,t.jsx)(l.Button,{className:"bg-blue-600 text-white",onClick:td,disabled:eL,children:eL?"Saving...":"Save"})]})]})]})]}),e$&&null!=eQ&&(0,t.jsx)(function(e){let{projectId:r,onClose:c,onSaved:i}=e,[d,o]=(0,a.useState)(!1),[x,m]=(0,a.useState)(!1),[p,j]=(0,a.useState)(""),[g,y]=(0,a.useState)(""),[N,f]=(0,a.useState)(""),[b,w]=(0,a.useState)(""),[C,D]=(0,a.useState)(!1),[k,I]=(0,a.useState)("none"),[T,A]=(0,a.useState)("none"),[P,E]=(0,a.useState)("none"),[F,B]=(0,a.useState)(""),[M,U]=(0,a.useState)(!0),[V,O]=(0,a.useState)(""),[R,L]=(0,a.useState)(null),z=(0,a.useRef)(null),[H,_]=(0,a.useState)("USD"),[Y,J]=(0,a.useState)(""),[q,G]=(0,a.useState)(""),[X,K]=(0,a.useState)(!1),[$,W]=(0,a.useState)("none"),[Q,Z]=(0,a.useState)(0),[ee,et]=(0,a.useState)(!1),[ea,el]=(0,a.useState)("you"),es=()=>{j(""),y(""),f(""),w(""),D(!1),I("none"),A("none"),E("none"),B(""),U(!0),O(""),L(null),_("USD"),J(""),G(""),K(!1),W("none"),Z(0),et(!1),el("you")};(0,a.useEffect)(()=>{if(!r)return;let e=!0;return(async()=>{o(!0);try{var t,a,l,s,n,c,i,d,x,m,u,h,p,g,N,b,C,k,T,P;let o=S||localStorage.getItem("accessToken"),F=await fetch("".concat(v,"/api/projects/").concat(r),{headers:o?{Authorization:"Bearer ".concat(o)}:void 0,cache:"no-store"});if(!F.ok){let t=await F.text().catch(()=>"");console.error("Failed to fetch project",F.status,t),e&&alert("Failed to load project details");return}let M=await F.json();if(!e)return;j(null!=(n=null!=(s=null!=(l=M.shortCode)?l:M.code)?s:M.projectCode)?n:""),y(null!=(c=M.name)?c:""),f(M.startDate?M.startDate.split("T")[0]:null!=(i=M.startDate)?i:""),w(M.deadline?M.deadline.split("T")[0]:null!=(d=M.deadline)?d:""),D(!!M.noDeadline),I(M.category?String(M.category):"none"),A(null!=(x=M.department)?x:"none"),E((null==(t=M.client)?void 0:t.clientId)?String(M.client.clientId):null!=(u=null!=(m=null==(a=M.client)?void 0:a.name)?m:M.client)?u:"none"),B(null!=(h=M.summary)?h:""),U(!!(null==(p=M.tasksNeedAdminApproval)||p)),O(Array.isArray(M.assignedEmployees)?M.assignedEmployees.map(e=>e.name).join(","):null!=(g=M.members)?g:""),_(null!=(N=M.currency)?N:"USD"),J(null!=M.budget?String(M.budget):""),G(null!=M.hoursEstimate?String(M.hoursEstimate):""),K(!!(null!=(b=M.allowManualTimeLogs)&&b)),W(null!=(C=M.projectStatus)?C:"none"),Z(Number(null!=(k=M.progressPercent)?k:0)),et(!!(null!=(T=M.calculateProgressThroughTasks)&&T)),el(null!=(P=M.addedBy)?P:"you")}catch(t){console.error("Error loading project:",t),e&&alert("Failed to load project details")}finally{e&&o(!1)}})(),()=>{e=!1}},[r,S]);let en=async()=>{if(r){if(!g.trim())return alert("Project name required");m(!0);try{let e=new FormData;p&&e.append("shortCode",p),e.append("name",g),N&&e.append("startDate",N),C?e.append("deadline",""):e.append("deadline",b||""),e.append("noDeadline",String(!!C)),e.append("category","none"===k?"":k),e.append("department","none"===T?"":T),e.append("clientId","none"===P?"":P),e.append("summary",F||""),e.append("tasksNeedAdminApproval",String(!!M));let t=Array.isArray(V)?V:String(V||"").split(",").map(e=>e.trim()).filter(Boolean);e.append("assignedEmployeeIds",JSON.stringify(t)),R&&e.append("companyFile",R),e.append("currency",H||""),e.append("budget",Y||"0"),e.append("hoursEstimate",q||"0"),e.append("allowManualTimeLogs",String(!!X)),$&&"none"!==$&&e.append("projectStatus",String($)),null==Q||Number.isNaN(Number(Q))||e.append("progressPercent",String(Math.max(0,Math.min(100,Math.round(Q||0))))),e.append("calculateProgressThroughTasks",String(!!ee)),e.append("addedBy",String(ea||""));let a=S||localStorage.getItem("accessToken"),l=await fetch("".concat(v,"/api/projects/").concat(r),{method:"PUT",body:e,headers:a?{Authorization:"Bearer ".concat(a)}:void 0});if(!l.ok){let e=await l.text().catch(()=>"");console.error("Update failed",l.status,e),alert("Failed to update project");return}let s=null;try{s=await l.json()}catch(e){s=null}s&&s.id?h(e=>e.map(e=>e.id===s.id?{...e,...s}:e)):await tn(a),i(),c(),es()}catch(e){console.error("Update error:",e),alert("Failed to update project")}finally{m(!1)}}};return(0,t.jsxs)("div",{className:"fixed inset-0 z-[12000] flex items-start justify-center pt-12 px-4 overflow-y-auto; ",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{c(),es()}}),(0,t.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Update Project"}),(0,t.jsx)("button",{onClick:()=>{c(),es()},className:"p-2 rounded hover:bg-gray-100",children:(0,t.jsx)(u.X,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{className:"p-6 space-y-6",children:d?(0,t.jsx)("p",{className:"p-4 text-center",children:"Loading project..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,t.jsx)(s.Input,{value:p,onChange:e=>j(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name  *"}),(0,t.jsx)(s.Input,{value:g,onChange:e=>y(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,t.jsx)(s.Input,{type:"date",value:N,onChange:e=>f(e.target.value)})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,t.jsx)(s.Input,{type:"date",value:b,onChange:e=>w(e.target.value),disabled:C})]}),(0,t.jsx)("div",{className:"pt-6",children:(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)("input",{type:"checkbox",checked:C,onChange:e=>D(e.target.checked)}),(0,t.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.Select,{value:k,onValueChange:e=>I(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),te.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsx)(l.Button,{variant:"outline",onClick:tc,children:"Add"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,t.jsxs)(n.Select,{value:T,onValueChange:e=>A(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),ta.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,t.jsxs)(n.Select,{value:P,onValueChange:e=>E(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),tt.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,t.jsx)("textarea",{rows:4,value:F,onChange:e=>B(e.target.value),className:"w-full p-2 border rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"ucApproval",checked:!0===M,onChange:()=>U(!0)}),(0,t.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"ucApproval",checked:!1===M,onChange:()=>U(!1)}),(0,t.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Assigned to *"}),(0,t.jsx)(s.Input,{placeholder:"Comma separated names or ids",value:Array.isArray(V)?V.join(","):V,onChange:e=>O(e.target.value)})]}),(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Status"}),(0,t.jsxs)(n.Select,{value:$,onValueChange:e=>W(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select status"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),(0,t.jsx)(n.SelectItem,{value:"IN_PROGRESS",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"NOT_STARTED",children:"Not Started"}),(0,t.jsx)(n.SelectItem,{value:"ON_HOLD",children:"On Hold"}),(0,t.jsx)(n.SelectItem,{value:"CANCELLED",children:"Cancelled"}),(0,t.jsx)(n.SelectItem,{value:"FINISHED",children:"Finished"})]})]})]}),(0,t.jsxs)("div",{className:"w-1/2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Progress Status"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,t.jsx)("div",{className:"h-4 rounded-full ".concat(null==Q?"bg-gray-300":Q<33?"bg-red-500":Q<66?"bg-yellow-400":"bg-green-500"),style:{width:"".concat(Math.max(0,Math.min(100,Q)),"%")}}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[Math.round(Q),"%"]})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,t.jsx)("input",{type:"range",min:0,max:100,value:Q,onChange:e=>Z(Number(e.target.value)),className:"flex-1"}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:ee,onChange:e=>et(e.target.checked)}),(0,t.jsx)("span",{className:"text-xs",children:"Calculate Progress through tasks"})]})]})]})]})]})})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,t.jsxs)("div",{onClick:()=>{var e;return null==(e=z.current)?void 0:e.click()},className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[R?(0,t.jsx)("div",{children:R.name}):(0,t.jsx)("div",{children:"Choose File"}),(0,t.jsx)("input",{ref:z,type:"file",className:"hidden",onChange:e=>{var t,a;return L(null!=(a=null==(t=e.target.files)?void 0:t[0])?a:null)}})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,t.jsxs)(n.Select,{value:H,onValueChange:e=>_(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"USD"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"USD",children:"USD $"}),(0,t.jsx)(n.SelectItem,{value:"USD",children:"USD ₹"}),(0,t.jsx)(n.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,t.jsx)(s.Input,{value:Y,onChange:e=>J(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,t.jsx)(s.Input,{value:q,onChange:e=>G(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:X,onChange:e=>K(e.target.checked)}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs "})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,t.jsxs)(n.Select,{value:ea,onValueChange:e=>el(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-44",children:(0,t.jsx)(n.SelectValue,{placeholder:"You"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"you",children:"You"}),e9.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>{c(),es()},children:"Cancel"}),(0,t.jsx)(l.Button,{className:"bg-blue-600 text-white",onClick:en,disabled:x,children:x?"Updating...":"Update"})]})]})})]})]})},{projectId:eQ,onClose:()=>{eW(!1),eZ(null)},onSaved:()=>{tn(null!=S?S:null)}})]})}}]);