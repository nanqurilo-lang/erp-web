(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,302143,e=>{"use strict";e.s(["default",()=>E],302143);var t=e.i(843476);e.i(247167);var a=e.i(271645),s=e.i(519455),l=e.i(793479),n=e.i(967489),r=e.i(784774),i=e.i(755146),c=e.i(373375),d=e.i(463059),o=e.i(323585),x=e.i(286536),m=e.i(592930),u=e.i(727612),p=e.i(687130),h=e.i(37727);let g="https://6jnqmj85-80.inc1.devtunnels.ms",j=["IN_PROGRESS","NOT_STARTED","ON_HOLD","CANCELLED","FINISHED"],y="projectProgressOverrides";function v(e){let{employeeId:v}=e,[N,b]=(0,a.useState)([]),[f,S]=(0,a.useState)(!0),[w,C]=(0,a.useState)(null),[k,I]=(0,a.useState)(""),[D,T]=(0,a.useState)(""),[E,A]=(0,a.useState)("all"),[P,M]=(0,a.useState)("all"),[F,L]=(0,a.useState)(null),[U,O]=(0,a.useState)(null),[B,H]=(0,a.useState)(!1),[R,z]=(0,a.useState)("all"),[V,J]=(0,a.useState)("all"),[_,G]=(0,a.useState)("all"),[W,q]=(0,a.useState)(1),[Y,X]=(0,a.useState)(1),[$,K]=(0,a.useState)(!1),[Q,Z]=(0,a.useState)(""),[ee,et]=(0,a.useState)(""),[ea,es]=(0,a.useState)(""),[el,en]=(0,a.useState)(""),[er,ei]=(0,a.useState)(!1),[ec,ed]=(0,a.useState)("none"),[eo,ex]=(0,a.useState)("none"),[em,eu]=(0,a.useState)("none"),[ep,eh]=(0,a.useState)(""),[eg,ej]=(0,a.useState)(!0),[ey,ev]=(0,a.useState)(""),[eN,eb]=(0,a.useState)(null),[ef,eS]=(0,a.useState)("USD"),[ew,eC]=(0,a.useState)(""),[ek,eI]=(0,a.useState)(""),[eD,eT]=(0,a.useState)(!1),eE=(0,a.useRef)(null),[eA,eP]=(0,a.useState)("you"),[eM,eF]=(0,a.useState)(!1),[eL,eU]=(0,a.useState)(!1),[eO,eB]=(0,a.useState)([]),[eH,eR]=(0,a.useState)(!1),[ez,eV]=(0,a.useState)(""),[eJ,e_]=(0,a.useState)(!1),[eG,eW]=(0,a.useState)([]),[eq,eY]=(0,a.useState)(!1),[eX,e$]=(0,a.useState)([]),[eK,eQ]=(0,a.useState)(!1),[eZ,e0]=(0,a.useState)(!1),[e4,e1]=(0,a.useState)(null),[e2,e6]=(0,a.useState)("grid"),[e3,e5]=(0,a.useState)(!1),[e7,e8]=(0,a.useState)(!1),[e9,te]=(0,a.useState)(!1);(0,a.useEffect)(()=>{document.body.style.overflow=B||$||eL||eZ||e9?"hidden":"auto"},[B,$,eL,eZ,e9]);let tt=Array.from(new Set(N.map(e=>e.name))).filter(Boolean),ta=Array.from(new Set(N.flatMap(e=>(e.assignedEmployees||[]).map(e=>e.name)))).filter(Boolean),ts=eO.map(e=>({id:String(e.id),name:e.name})),tl=eG.map(e=>({id:String(e.id),name:e.name})),tn=eX.map(e=>({id:String(e.id),name:e.departmentName})),tr=()=>{try{let e=localStorage.getItem(y);if(!e)return{};return JSON.parse(e)}catch(e){return{}}},ti=(e,t)=>{let a=tr(),s=String(e);null==t?delete a[s]:a[s]=t;try{localStorage.setItem(y,JSON.stringify(a))}catch(e){}},tc=(0,a.useCallback)(async e=>{S(!0);try{let t=e||localStorage.getItem("accessToken")||w||null;if(!t){b([]),X(1),S(!1);return}new URLSearchParams({page:String(W),limit:String(9),search:D||"",status:"all"!==E?E:"",progress:"all"!==P?P:"",project:"all"!==R?R:"",member:"all"!==V?V:"",client:"all"!==_?_:""});let a=await fetch("".concat(g,"/api/projects/employee/").concat(v),{headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"});if(401===a.status){try{localStorage.removeItem("accessToken")}catch(e){}C(null),b([]),X(1),S(!1);return}if(!a.ok){let e=await a.text().catch(()=>"");throw console.error("getProjects failed",a.status,e),Error("Failed to load projects")}let s=await a.json(),l=[];Array.isArray(s)?l=s:(l=s.projects||s.items||[],X(s.totalPages||Math.max(1,Math.ceil((s.total||9)/9))));let n=tr();Object.keys(n).length>0&&(l=l.map(e=>{let t=n[String(e.id)];return null!=t?{...e,progressPercent:t}:e})),b(l)}catch(e){console.error("Error loading projects:",e),b([]),X(1)}finally{S(!1)}},[W,D,E,P,R,V,_,w]),td=(0,a.useCallback)(async e=>{eR(!0);try{let t=e||w||localStorage.getItem("accessToken"),a=await fetch("".concat(g,"/api/projects/category"),{headers:t?{Authorization:"Bearer ".concat(t)}:void 0,cache:"no-store"});if(!a.ok){console.warn("Failed to load categories, status:",a.status),eB([]),eR(!1);return}let s=await a.json();Array.isArray(s)?s.length>0&&"string"==typeof s[0]?eB(s.map((e,t)=>({id:t+1,name:String(e)}))):eB(s.map(e=>{var t,a,s;return{id:null!=(a=null!=(t=e.id)?t:e.name)?a:Math.random(),name:null!=(s=e.name)?s:String(e)}})):eB([])}catch(e){console.error("Error loading categories:",e),eB([])}finally{eR(!1)}},[w]),to=async()=>{eU(!0),await td()},tx=()=>{eU(!1),eV("")},tm=async()=>{let e=ez.trim();if(!e)return alert("Category name required");e_(!0);let t=eO.slice(),a={id:"temp-".concat(Date.now()),name:e};eB(e=>[...e,a]);try{let n=w||localStorage.getItem("accessToken"),r=await fetch("".concat(g,"/api/projects/category"),{method:"POST",headers:{"Content-Type":"application/json",...n?{Authorization:"Bearer ".concat(n)}:{}},body:JSON.stringify({name:e}),cache:"no-store"});if(!r.ok){let e=await r.text().catch(()=>"");console.error("Add category failed",r.status,e),eB(t),alert("Failed to add category");return}let i=await r.json().catch(()=>null);if(i&&(i.id||i.name)){var s,l;eB(t=>t.map(t=>{var s,l,n;return t.id===a.id?{id:null!=(l=null!=(s=i.id)?s:i.name)?l:Math.random(),name:null!=(n=i.name)?n:e}:t})),ed(String(null!=(l=null!=(s=i.id)?s:i.name)?l:e))}else{await td();let t=eO.find(t=>t.name===e);t&&ed(String(t.id))}eV("")}catch(e){console.error("Add category error:",e),eB(t),alert("Failed to add category")}finally{e_(!1)}},tu=async e=>{if(!confirm("Delete this category?"))return;let t=eO.slice();eB(t=>t.filter(t=>t.id!==e));try{let t=w||localStorage.getItem("accessToken");if(!(await fetch("".concat(g,"/api/projects/category/").concat(encodeURIComponent(String(e))),{method:"DELETE",headers:t?{Authorization:"Bearer ".concat(t)}:void 0,cache:"no-store"})).ok)throw Error("Delete failed")}catch(e){console.error("Delete category failed:",e),eB(t),alert("Failed to delete category")}},tp=(0,a.useCallback)(async e=>{eY(!0);try{let t=e||w||localStorage.getItem("accessToken"),a=await fetch("".concat(g,"/clients"),{headers:t?{Authorization:"Bearer ".concat(t)}:void 0,cache:"no-store"});if(!a.ok){console.warn("Failed to load clients, status:",a.status),eW([]),eY(!1);return}let s=await a.json();Array.isArray(s)?eW(s):Array.isArray(s.items)?eW(s.items):eW([])}catch(e){console.error("Error loading clients:",e),eW([])}finally{eY(!1)}},[w]),th=(0,a.useCallback)(async e=>{eQ(!0);try{let t=e||w||localStorage.getItem("accessToken"),a=await fetch("".concat(g,"/admin/departments"),{headers:t?{Authorization:"Bearer ".concat(t)}:void 0,cache:"no-store"});if(!a.ok){console.warn("Failed to load departments, status:",a.status),e$([]),eQ(!1);return}let s=await a.json();Array.isArray(s)?e$(s):Array.isArray(s.items)?e$(s.items):e$([])}catch(e){console.error("Error loading departments:",e),e$([])}finally{eQ(!1)}},[w]);async function tg(e,t){if(!w)return alert("Not authenticated");b(a=>a.map(a=>a.id===e?{...a,projectStatus:t}:a));try{let a=new FormData;a.append("status",t);let s=await fetch("".concat(g,"/api/projects/").concat(e,"/status"),{method:"PUT",body:a,headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}),l=null;try{l=await s.json()}catch(e){l=null}l&&l.id?(b(e=>e.map(e=>e.id===l.id?{...e,...l}:e)),null!=l.progressPercent&&ti(l.id,null)):await tc(w)}catch(e){console.error("Status update failed",e),b(N),alert("Failed to update status on server")}}async function tj(e,t){if(!w)return alert("Not authenticated");let a=Math.max(0,Math.min(100,Math.round(t)));b(t=>t.map(t=>t.id===e?{...t,progressPercent:a}:t)),ti(e,a);try{let t=new FormData;t.append("percent",String(a));let s=await fetch("".concat(g,"/api/projects/").concat(e,"/progress"),{method:"PUT",body:t,headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}});if(401===s.status){console.error("patchProgress 401 unauthorized"),b(N),ti(e,null),localStorage.removeItem("accessToken"),C(null),alert("Session expired. Please login again.");return}if(!s.ok){let t=await s.text().catch(()=>"");console.error("patchProgress failed:",s.status,t),b(N),ti(e,null),alert("Failed to update progress on server");return}let l=null;try{l=204!==s.status?await s.json():null}catch(e){l=null}l&&l.id?(b(e=>e.map(e=>e.id===l.id?{...e,...l}:e)),null!=l.progressPercent&&ti(l.id,null)):await tc(w)}catch(t){console.error("Progress update failed:",t),b(N),ti(e,null),alert("Failed to update progress on server")}}(0,a.useEffect)(()=>{let e=setTimeout(()=>{T(e=>e!==k?(q(1),k):e)},500);return()=>clearTimeout(e)},[k]),(0,a.useEffect)(()=>{{let e=localStorage.getItem("accessToken");C(e),td(e||null),tp(e||null),th(e||null),e?tc(e):S(!1)}},[]),(0,a.useEffect)(()=>{if(!w){let e=localStorage.getItem("accessToken");e&&(C(e),tc(e),td(e),tp(e),th(e));return}w&&tc(w)},[tc,w,W,D,E,P,R,V,_]);let ty=async e=>{if(confirm("Delete this project?")){b(t=>t.filter(t=>t.id!==e));try{if(!(await fetch("".concat(g,"/api/projects/").concat(e),{method:"DELETE",headers:{Authorization:w?"Bearer ".concat(w):""},cache:"no-store"})).ok)throw Error("Delete failed");ti(e,null)}catch(e){console.error(e),b(N),alert("Failed to delete project")}}},tv=()=>{Z(""),et(""),es(""),en(""),ei(!1),ed("none"),ex("none"),eu("none"),eh(""),ej(!0),ev(""),eb(null),eS("USD"),eC(""),eI(""),eT(!1),eP("you"),eF(!1)},tN=async()=>{if(!ee.trim())return alert("Project Name is required");eF(!0);try{let e=Q.trim();if(!e){let t=ee.toString().normalize("NFKD").replace(/[\u0300-\u036F]/g,"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"");e=t?t.toUpperCase().replace(/-/g,"").slice(0,10):"PRJ".concat(Date.now().toString().slice(-6))}let t=new FormData;t.append("shortCode",e),t.append("name",ee),t.append("projectName",ee),t.append("startDate",ea||""),er?t.append("deadline",""):t.append("deadline",el||""),t.append("noDeadline",String(!!er)),t.append("category","none"===ec?"":String(ec)),t.append("department","none"===eo?"":String(eo)),t.append("clientId","none"===em?"":String(em)),t.append("summary",ep||""),t.append("tasksNeedAdminApproval",String(!!eg));let a=Array.isArray(ey)?ey:String(ey||"").split(",").map(e=>e.trim()).filter(Boolean);t.append("assignedEmployeeIds",JSON.stringify(a)),eN&&t.append("companyFile",eN),t.append("currency",ef||""),t.append("budget",""!==ew?String(ew):"0"),t.append("hoursEstimate",""!==ek?String(ek):"0"),t.append("allowManualTimeLogs",String(!!eD)),t.append("addedBy",String(eA||""));let s=w||localStorage.getItem("accessToken"),l=await fetch("".concat(g,"/api/projects"),{method:"POST",body:t,headers:s?{Authorization:"Bearer ".concat(s)}:void 0});if(!l.ok){let e=await l.text().catch(()=>"");console.error("Create project failed",l.status,e);let t="Failed to create project (status ".concat(l.status,")");try{let a=JSON.parse(e||"{}");a&&a.message&&(t=a.message)}catch(e){}alert(t),eF(!1);return}try{await l.json()}catch(e){}await tc(s),K(!1),tv()}catch(e){console.error("Create project error",e),alert("Failed to create project")}finally{eF(!1)}},tb=()=>H(!1),tf=async()=>{q(1),await tc(null!=w?w:null),H(!1)},tS=async()=>{z("all"),J("all"),G("all"),q(1),await tc(null!=w?w:null),H(!1)},tw=(0,a.useMemo)(()=>N.filter(e=>{if("all"!==E&&(!e.projectStatus||e.projectStatus!==E))return!1;if("all"!==P){if("number"!=typeof e.progressPercent)return!1;let t=e.progressPercent;if("0-33"===P&&!(t>=0&&t<=33)||"34-66"===P&&!(t>=34&&t<=66)||"67-100"===P&&!(t>=67&&t<=100))return!1}if(F||U){let t=e.startDate?new Date(e.startDate):null,a=e.deadline?new Date(e.deadline):null;if(!t||!a||F&&t<new Date(F)||U&&a>new Date(U))return!1}return!0}),[N,E,P,F,U]);if(f)return(0,t.jsx)("p",{className:"p-8 text-center",children:"Loading projects..."});let tC=e=>{var a,l,n,c,d,p,h,g,y,v,N;let{p:f}=e,S=f.startDate?new Date(f.startDate).toLocaleDateString():"-",C=f.noDeadline?"No Deadline":f.deadline?new Date(f.deadline).toLocaleDateString():"-",k=Math.max(0,Math.min(100,null!=(p=f.progressPercent)?p:0)),I=null==k?"bg-gray-300":k<33?"bg-red-500":k<66?"bg-yellow-400":"bg-green-500";return(0,t.jsxs)(r.TableRow,{className:"bg-white hover:bg-gray-50",children:[(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top w-28",children:(0,t.jsx)("div",{className:"text-sm font-medium",children:f.shortCode||f.code||f.projectCode||"RTA-".concat(String(f.id).padStart(2,"0"))})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top",children:(0,t.jsx)("div",{className:"font-medium",children:f.name})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top",children:(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)("div",{className:"flex -space-x-2",children:[(f.assignedEmployees||[]).slice(0,3).map(e=>(0,t.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white overflow-hidden bg-gray-100",title:e.name,children:e.profileUrl?(0,t.jsx)("img",{src:e.profileUrl,alt:e.name,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center text-xs text-white bg-gray-400",children:(e.name||"U").charAt(0)})},e.employeeId)),(f.assignedEmployees||[]).length>3&&(0,t.jsxs)("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-gray-200 text-xs text-gray-700 flex items-center justify-center",children:["+",(f.assignedEmployees||[]).length-3]})]})})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top text-sm",children:S}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top text-sm",children:C}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:(null==(a=f.client)?void 0:a.profilePictureUrl)?(0,t.jsx)("img",{src:f.client.profilePictureUrl,alt:null==(l=f.client)?void 0:l.name,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"text-xs text-gray-500",children:((null==(n=f.client)?void 0:n.name)||"C").charAt(0)})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:null!=(h=null==(c=f.client)?void 0:c.name)?h:"Client"}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:null!=(g=null==(d=f.client)?void 0:d.company)?g:""})]})]})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"w-44 cursor-pointer",title:"Click to filter by this progress bucket",onClick:()=>{var e,t;null==(t=null!=(e=f.progressPercent)?e:null)?M("all"):t<=33?M("0-33"):t<=66?M("34-66"):M("67-100"),q(1)},children:(0,t.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,t.jsx)("div",{className:"h-4 rounded-full ".concat(I),style:{width:"".concat(k,"%")}}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[k,"%"]})})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("button",{className:"inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs ".concat(function(e){switch(e){case"IN_PROGRESS":return"bg-green-600 text-white";case"NOT_STARTED":default:return"bg-gray-400 text-white";case"ON_HOLD":return"bg-yellow-500 text-white";case"CANCELLED":return"bg-red-600 text-white";case"FINISHED":return"bg-blue-600 text-white"}}(f.projectStatus)),title:"Click to filter by this status",onClick:()=>{var e;A(null!=(e=f.projectStatus)?e:"all"),q(1)},children:[(0,t.jsx)("span",{className:"w-2 h-2 rounded-full",style:{background:function(e){switch(e){case"IN_PROGRESS":return"#10B981";case"NOT_STARTED":default:return"#9CA3AF";case"ON_HOLD":return"#F59E0B";case"CANCELLED":return"#EF4444";case"FINISHED":return"#3B82F6"}}(f.projectStatus)}}),(0,t.jsx)("span",{children:null!=(y=f.projectStatus)?y:"N/A"})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)(i.DropdownMenu,{children:[(0,t.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)("button",{className:"inline-flex items-center gap-1 px-2 py-1 border rounded text-sm bg-white hover:bg-gray-50",children:(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"▾"})})}),(0,t.jsxs)(i.DropdownMenuContent,{align:"start",className:"w-64 p-2",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Change status"}),(0,t.jsx)("div",{className:"space-y-1",children:j.map(e=>(0,t.jsx)("button",{onClick:()=>tg(f.id,e),className:"w-full text-left px-3 py-2 rounded text-sm hover:bg-gray-50 ".concat(e===f.projectStatus?"font-medium":""),children:e},e))}),(0,t.jsx)(i.DropdownMenuSeparator,{}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-2 mb-1",children:"Adjust progress"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"range",min:0,max:100,value:null!=(v=f.progressPercent)?v:0,onChange:e=>{let t=Number(e.target.value);b(e=>e.map(e=>e.id===f.id?{...e,progressPercent:t}:e))},onMouseUp:async e=>{let t=Number(e.target.value);await tj(f.id,t)},onTouchEnd:async e=>{let t=Number(e.target.value);await tj(f.id,t)},className:"w-full"}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,t.jsx)("span",{children:"0%"}),(0,t.jsxs)("span",{children:[null!=(N=f.progressPercent)?N:0,"%"]}),(0,t.jsx)("span",{children:"100%"})]})]}),(0,t.jsx)("div",{className:"flex justify-end mt-2",children:(0,t.jsx)(s.Button,{size:"sm",variant:"ghost",onClick:()=>tc(null!=w?w:null),children:"Refresh"})})]})]})})]})]})}),(0,t.jsx)(r.TableCell,{className:"py-4 px-4 align-top text-right",children:(0,t.jsxs)(i.DropdownMenu,{children:[(0,t.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(s.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,t.jsx)(o.MoreVertical,{className:"h-4 w-4"})})}),(0,t.jsxs)(i.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,t.jsxs)(i.DropdownMenuItem,{onClick:()=>window.location.assign("/work/project/".concat(f.id)),children:[(0,t.jsx)(x.Eye,{className:"h-4 w-4 mr-2"})," View"]}),(0,t.jsxs)(i.DropdownMenuItem,{onClick:()=>{e1(f.id),e0(!0)},children:[(0,t.jsx)(m.Edit2,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,t.jsx)(i.DropdownMenuSeparator,{}),(0,t.jsxs)(i.DropdownMenuItem,{onClick:()=>ty(f.id),className:"text-red-600",children:[(0,t.jsx)(u.Trash2,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})})]},f.id)};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("main",{className:"p-2",children:(0,t.jsxs)("div",{className:" p-6  overflow-y-auto overflow-x-hidden",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-3 mb-4 flex items-center gap-4 overflow-y-auto overflow-x-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,t.jsx)(l.Input,{type:"date",value:null!=F?F:"",onChange:e=>{L(e.target.value||null),q(1)},className:"w-40"}),(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:"to"}),(0,t.jsx)(l.Input,{type:"date",value:null!=U?U:"",onChange:e=>{O(e.target.value||null),q(1)},className:"w-40"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Status"}),(0,t.jsxs)(n.Select,{value:E,onValueChange:e=>{A(e),q(1)},children:[(0,t.jsx)(n.SelectTrigger,{className:"w-40",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),(0,t.jsx)(n.SelectItem,{value:"IN_PROGRESS",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"NOT_STARTED",children:"Not Started"}),(0,t.jsx)(n.SelectItem,{value:"ON_HOLD",children:"On Hold"}),(0,t.jsx)(n.SelectItem,{value:"CANCELLED",children:"Cancelled"}),(0,t.jsx)(n.SelectItem,{value:"FINISHED",children:"Finished"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Progress"}),(0,t.jsxs)(n.Select,{value:P,onValueChange:e=>{M(e),q(1)},children:[(0,t.jsx)(n.SelectTrigger,{className:"w-40",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),(0,t.jsx)(n.SelectItem,{value:"0-33",children:"0 - 33%"}),(0,t.jsx)(n.SelectItem,{value:"34-66",children:"34 - 66%"}),(0,t.jsx)(n.SelectItem,{value:"67-100",children:"67 - 100%"})]})]})]})]}),(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsx)("div",{children:(0,t.jsx)(s.Button,{className:"bg-blue-600 text-white",onClick:()=>K(!0),children:"+ Add Project"})})}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-blue-50 px-6 py-3 border-b flex items-center justify-between",children:[(0,t.jsxs)("h2",{className:"font-semibold text-gray-900",children:["Projects (",tw.length,")"]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:e3?"Viewing: Archived":e7?"Viewing: Pinned":"All active"})]}),(0,t.jsx)("div",{className:"overflow-auto p-4",children:(0,t.jsx)("div",{children:(0,t.jsxs)(r.Table,{children:[(0,t.jsx)(r.TableHeader,{children:(0,t.jsxs)(r.TableRow,{className:"bg-blue-50",children:[(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Code"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Project Name"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Members"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Start Date"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Deadline"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Client"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3",children:"Status"}),(0,t.jsx)(r.TableHead,{className:"px-4 py-3 text-right",children:"Action"})]})}),(0,t.jsx)(r.TableBody,{children:0===tw.length?(0,t.jsx)(r.TableRow,{children:(0,t.jsx)(r.TableCell,{colSpan:8,className:"py-8 text-center text-gray-500",children:"No projects found"})}):tw.map(e=>(0,t.jsx)(tC,{p:e},e.id))})]})})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Result per page -",tw.length?tw.length:0]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(s.Button,{variant:"outline",size:"sm",onClick:()=>{q(e=>Math.max(1,e-1))},disabled:1===W,children:[(0,t.jsx)(c.ChevronLeft,{})," Prev"]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Page ",W," of ",Y]}),(0,t.jsxs)(s.Button,{variant:"outline",size:"sm",onClick:()=>{q(e=>Math.min(Y,e+1))},disabled:W===Y,children:["Next ",(0,t.jsx)(d.ChevronRight,{})]})]})]})]})}),(0,t.jsx)("div",{"aria-hidden":!B,onClick:tb,className:"fixed inset-0 transition-opacity duration-300 z-[9990] ".concat(B?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),style:{backgroundColor:"rgba(0,0,0,0.3)"}}),(0,t.jsxs)("aside",{"aria-hidden":!B,className:"fixed right-0 top-0 h-full w-[360px] bg-white shadow-xl transform transition-transform duration-300 z-[9999] ".concat(B?"translate-x-0":"translate-x-full"),role:"dialog","aria-modal":"true",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Filter,{className:"w-5 h-5"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Filters"})]}),(0,t.jsx)("button",{onClick:tb,className:"p-2 rounded hover:bg-gray-100",children:(0,t.jsx)(h.X,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4 overflow-auto h-[calc(100%-140px)]",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Project"}),(0,t.jsxs)(n.Select,{value:R,onValueChange:e=>z(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),tt.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Project Members"}),(0,t.jsxs)(n.Select,{value:V,onValueChange:e=>J(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),ta.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Client"}),(0,t.jsxs)(n.Select,{value:_,onValueChange:e=>G(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full rounded border px-3 py-2",children:(0,t.jsx)(n.SelectValue,{placeholder:"All"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All"}),tl.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]})]}),(0,t.jsxs)("div",{className:"p-4 border-t flex items-center justify-between gap-2",children:[(0,t.jsx)(s.Button,{variant:"outline",onClick:tS,children:"Reset"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(s.Button,{variant:"ghost",onClick:tb,children:"Close"}),(0,t.jsx)(s.Button,{className:"bg-blue-600 text-white",onClick:tf,children:"Apply"})]})]})]}),$&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-start justify-center pt-12 px-4 overflow-y-auto",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{K(!1),tv()}}),(0,t.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Add Project"}),(0,t.jsx)("button",{onClick:()=>{K(!1),tv()},className:"p-2 rounded hover:bg-gray-100",children:(0,t.jsx)(h.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,t.jsx)(l.Input,{value:Q,onChange:e=>Z(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name *"}),(0,t.jsx)(l.Input,{value:ee,onChange:e=>et(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,t.jsx)(l.Input,{type:"date",value:ea,onChange:e=>es(e.target.value)})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,t.jsx)(l.Input,{type:"date",value:el,onChange:e=>en(e.target.value),disabled:er})]}),(0,t.jsx)("div",{className:"pt-6",children:(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)("input",{type:"checkbox",checked:er,onChange:e=>ei(e.target.checked)}),(0,t.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.Select,{value:ec,onValueChange:e=>ed(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),ts.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsx)(s.Button,{variant:"outline",onClick:to,children:"Add"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,t.jsxs)(n.Select,{value:eo,onValueChange:e=>ex(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),tn.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,t.jsxs)(n.Select,{value:em,onValueChange:e=>eu(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),tl.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,t.jsx)("textarea",{rows:4,value:ep,onChange:e=>eh(e.target.value),className:"w-full p-2 border rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"approval",checked:!0===eg,onChange:()=>ej(!0)}),(0,t.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"approval",checked:!1===eg,onChange:()=>ej(!1)}),(0,t.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Add Project Members *"}),(0,t.jsx)(l.Input,{placeholder:"Comma separated names",value:Array.isArray(ey)?ey.join(","):ey,onChange:e=>ev(e.target.value)})]})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,t.jsxs)("div",{onClick:()=>{var e;return null==(e=eE.current)?void 0:e.click()},className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[eN?(0,t.jsx)("div",{children:eN.name}):(0,t.jsx)("div",{children:"Choose File"}),(0,t.jsx)("input",{ref:eE,type:"file",className:"hidden",onChange:e=>{var t,a;return eb(null!=(a=null==(t=e.target.files)?void 0:t[0])?a:null)}})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,t.jsxs)(n.Select,{value:ef,onValueChange:e=>eS(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"USD"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"USD",children:"USD $"}),(0,t.jsx)(n.SelectItem,{value:"USD",children:"USD ₹"}),(0,t.jsx)(n.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,t.jsx)(l.Input,{value:ew,onChange:e=>eC(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,t.jsx)(l.Input,{value:ek,onChange:e=>eI(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:eD,onChange:e=>eT(e.target.checked)}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,t.jsxs)(n.Select,{value:eA,onValueChange:e=>eP(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-44",children:(0,t.jsx)(n.SelectValue,{placeholder:"You"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"you",children:"You"}),ta.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>{K(!1),tv()},children:"Cancel"}),(0,t.jsx)(s.Button,{className:"bg-blue-600 text-white",onClick:tN,disabled:eM,children:eM?"Saving...":"Save"})]})]})]})]}),eL&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[11000] flex items-center justify-center px-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>tx()}),(0,t.jsxs)("div",{className:"relative w-full max-w-2xl bg-white rounded-lg shadow-2xl z-20 overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Project Category"}),(0,t.jsx)("button",{onClick:()=>tx(),className:"p-2 rounded hover:bg-gray-100",children:(0,t.jsx)(h.X,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsx)("div",{className:"rounded border overflow-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left",children:[(0,t.jsx)("thead",{className:"bg-blue-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2 text-sm",children:"#"}),(0,t.jsx)("th",{className:"px-4 py-2 text-sm",children:"Category Name"}),(0,t.jsx)("th",{className:"px-4 py-2 text-sm",children:"Action"})]})}),(0,t.jsx)("tbody",{children:eH?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"Loading..."})}):0===eO.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"No categories"})}):eO.map((e,a)=>(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-sm",children:a+1}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm",children:e.name}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,t.jsx)("button",{className:"p-2 rounded hover:bg-gray-100 text-red-600",onClick:()=>tu(e.id),title:"Delete",children:(0,t.jsx)(u.Trash2,{className:"w-4 h-4"})})})]},e.id))})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Category Name *"}),(0,t.jsx)(l.Input,{placeholder:"Enter category name",value:ez,onChange:e=>eV(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>tx(),children:"Cancel"}),(0,t.jsx)(s.Button,{className:"bg-blue-600 text-white",onClick:tm,disabled:eJ,children:eJ?"Saving...":"Save"})]})]})]})]}),eZ&&null!=e4&&(0,t.jsx)(function(e){let{projectId:r,onClose:i,onSaved:c}=e,[d,o]=(0,a.useState)(!1),[x,m]=(0,a.useState)(!1),[u,p]=(0,a.useState)(""),[j,y]=(0,a.useState)(""),[v,N]=(0,a.useState)(""),[f,S]=(0,a.useState)(""),[C,k]=(0,a.useState)(!1),[I,D]=(0,a.useState)("none"),[T,E]=(0,a.useState)("none"),[A,P]=(0,a.useState)("none"),[M,F]=(0,a.useState)(""),[L,U]=(0,a.useState)(!0),[O,B]=(0,a.useState)(""),[H,R]=(0,a.useState)(null),z=(0,a.useRef)(null),[V,J]=(0,a.useState)("USD"),[_,G]=(0,a.useState)(""),[W,q]=(0,a.useState)(""),[Y,X]=(0,a.useState)(!1),[$,K]=(0,a.useState)("none"),[Q,Z]=(0,a.useState)(0),[ee,et]=(0,a.useState)(!1),[ea,es]=(0,a.useState)("you"),el=()=>{p(""),y(""),N(""),S(""),k(!1),D("none"),E("none"),P("none"),F(""),U(!0),B(""),R(null),J("USD"),G(""),q(""),X(!1),K("none"),Z(0),et(!1),es("you")};(0,a.useEffect)(()=>{if(!r)return;let e=!0;return(async()=>{o(!0);try{var t,a,s,l,n,i,c,d,x,m,u,h,j,v,b,f,C,I,T,A;let o=w||localStorage.getItem("accessToken"),M=await fetch("".concat(g,"/api/projects/").concat(r),{headers:o?{Authorization:"Bearer ".concat(o)}:void 0,cache:"no-store"});if(!M.ok){let t=await M.text().catch(()=>"");console.error("Failed to fetch project",M.status,t),e&&alert("Failed to load project details");return}let L=await M.json();if(!e)return;p(null!=(n=null!=(l=null!=(s=L.shortCode)?s:L.code)?l:L.projectCode)?n:""),y(null!=(i=L.name)?i:""),N(L.startDate?L.startDate.split("T")[0]:null!=(c=L.startDate)?c:""),S(L.deadline?L.deadline.split("T")[0]:null!=(d=L.deadline)?d:""),k(!!L.noDeadline),D(L.category?String(L.category):"none"),E(null!=(x=L.department)?x:"none"),P((null==(t=L.client)?void 0:t.clientId)?String(L.client.clientId):null!=(u=null!=(m=null==(a=L.client)?void 0:a.name)?m:L.client)?u:"none"),F(null!=(h=L.summary)?h:""),U(!!(null==(j=L.tasksNeedAdminApproval)||j)),B(Array.isArray(L.assignedEmployees)?L.assignedEmployees.map(e=>e.name).join(","):null!=(v=L.members)?v:""),J(null!=(b=L.currency)?b:"USD"),G(null!=L.budget?String(L.budget):""),q(null!=L.hoursEstimate?String(L.hoursEstimate):""),X(!!(null!=(f=L.allowManualTimeLogs)&&f)),K(null!=(C=L.projectStatus)?C:"none"),Z(Number(null!=(I=L.progressPercent)?I:0)),et(!!(null!=(T=L.calculateProgressThroughTasks)&&T)),es(null!=(A=L.addedBy)?A:"you")}catch(t){console.error("Error loading project:",t),e&&alert("Failed to load project details")}finally{e&&o(!1)}})(),()=>{e=!1}},[r,w]);let en=async()=>{if(r){if(!j.trim())return alert("Project name required");m(!0);try{let e=new FormData;u&&e.append("shortCode",u),e.append("name",j),v&&e.append("startDate",v),C?e.append("deadline",""):e.append("deadline",f||""),e.append("noDeadline",String(!!C)),e.append("category","none"===I?"":I),e.append("department","none"===T?"":T),e.append("clientId","none"===A?"":A),e.append("summary",M||""),e.append("tasksNeedAdminApproval",String(!!L));let t=Array.isArray(O)?O:String(O||"").split(",").map(e=>e.trim()).filter(Boolean);e.append("assignedEmployeeIds",JSON.stringify(t)),H&&e.append("companyFile",H),e.append("currency",V||""),e.append("budget",_||"0"),e.append("hoursEstimate",W||"0"),e.append("allowManualTimeLogs",String(!!Y)),$&&"none"!==$&&e.append("projectStatus",String($)),null==Q||Number.isNaN(Number(Q))||e.append("progressPercent",String(Math.max(0,Math.min(100,Math.round(Q||0))))),e.append("calculateProgressThroughTasks",String(!!ee)),e.append("addedBy",String(ea||""));let a=w||localStorage.getItem("accessToken"),s=await fetch("".concat(g,"/api/projects/").concat(r),{method:"PUT",body:e,headers:a?{Authorization:"Bearer ".concat(a)}:void 0});if(!s.ok){let e=await s.text().catch(()=>"");console.error("Update failed",s.status,e),alert("Failed to update project");return}let l=null;try{l=await s.json()}catch(e){l=null}l&&l.id?b(e=>e.map(e=>e.id===l.id?{...e,...l}:e)):await tc(a),c(),i(),el()}catch(e){console.error("Update error:",e),alert("Failed to update project")}finally{m(!1)}}};return(0,t.jsxs)("div",{className:"fixed inset-0 z-[12000] flex items-start justify-center pt-12 px-4 overflow-y-auto; ",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{i(),el()}}),(0,t.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Update Project"}),(0,t.jsx)("button",{onClick:()=>{i(),el()},className:"p-2 rounded hover:bg-gray-100",children:(0,t.jsx)(h.X,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{className:"p-6 space-y-6",children:d?(0,t.jsx)("p",{className:"p-4 text-center",children:"Loading project..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,t.jsx)(l.Input,{value:u,onChange:e=>p(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name  *"}),(0,t.jsx)(l.Input,{value:j,onChange:e=>y(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,t.jsx)(l.Input,{type:"date",value:v,onChange:e=>N(e.target.value)})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,t.jsx)(l.Input,{type:"date",value:f,onChange:e=>S(e.target.value),disabled:C})]}),(0,t.jsx)("div",{className:"pt-6",children:(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)("input",{type:"checkbox",checked:C,onChange:e=>k(e.target.checked)}),(0,t.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.Select,{value:I,onValueChange:e=>D(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),ts.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsx)(s.Button,{variant:"outline",onClick:to,children:"Add"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,t.jsxs)(n.Select,{value:T,onValueChange:e=>E(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),tn.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,t.jsxs)(n.Select,{value:A,onValueChange:e=>P(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"--"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),tl.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,t.jsx)("textarea",{rows:4,value:M,onChange:e=>F(e.target.value),className:"w-full p-2 border rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"ucApproval",checked:!0===L,onChange:()=>U(!0)}),(0,t.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"ucApproval",checked:!1===L,onChange:()=>U(!1)}),(0,t.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Assigned to *"}),(0,t.jsx)(l.Input,{placeholder:"Comma separated names or ids",value:Array.isArray(O)?O.join(","):O,onChange:e=>B(e.target.value)})]}),(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Status"}),(0,t.jsxs)(n.Select,{value:$,onValueChange:e=>K(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select status"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"none",children:"--"}),(0,t.jsx)(n.SelectItem,{value:"IN_PROGRESS",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"NOT_STARTED",children:"Not Started"}),(0,t.jsx)(n.SelectItem,{value:"ON_HOLD",children:"On Hold"}),(0,t.jsx)(n.SelectItem,{value:"CANCELLED",children:"Cancelled"}),(0,t.jsx)(n.SelectItem,{value:"FINISHED",children:"Finished"})]})]})]}),(0,t.jsxs)("div",{className:"w-1/2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Progress Status"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,t.jsx)("div",{className:"h-4 rounded-full ".concat(null==Q?"bg-gray-300":Q<33?"bg-red-500":Q<66?"bg-yellow-400":"bg-green-500"),style:{width:"".concat(Math.max(0,Math.min(100,Q)),"%")}}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[Math.round(Q),"%"]})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,t.jsx)("input",{type:"range",min:0,max:100,value:Q,onChange:e=>Z(Number(e.target.value)),className:"flex-1"}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:ee,onChange:e=>et(e.target.checked)}),(0,t.jsx)("span",{className:"text-xs",children:"Calculate Progress through tasks"})]})]})]})]})]})})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,t.jsxs)("div",{onClick:()=>{var e;return null==(e=z.current)?void 0:e.click()},className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[H?(0,t.jsx)("div",{children:H.name}):(0,t.jsx)("div",{children:"Choose File"}),(0,t.jsx)("input",{ref:z,type:"file",className:"hidden",onChange:e=>{var t,a;return R(null!=(a=null==(t=e.target.files)?void 0:t[0])?a:null)}})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,t.jsxs)(n.Select,{value:V,onValueChange:e=>J(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full",children:(0,t.jsx)(n.SelectValue,{placeholder:"USD"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"USD",children:"USD $"}),(0,t.jsx)(n.SelectItem,{value:"USD",children:"USD ₹"}),(0,t.jsx)(n.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,t.jsx)(l.Input,{value:_,onChange:e=>G(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,t.jsx)(l.Input,{value:W,onChange:e=>q(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:Y,onChange:e=>X(e.target.checked)}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs "})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,t.jsxs)(n.Select,{value:ea,onValueChange:e=>es(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-44",children:(0,t.jsx)(n.SelectValue,{placeholder:"You"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"you",children:"You"}),ta.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>{i(),el()},children:"Cancel"}),(0,t.jsx)(s.Button,{className:"bg-blue-600 text-white",onClick:en,disabled:x,children:x?"Updating...":"Update"})]})]})})]})]})},{projectId:e4,onClose:()=>{e0(!1),e1(null)},onSaved:()=>{tc(null!=w?w:null)}})]})}var N=e.i(581949),b=e.i(927591),f=e.i(288683),S=e.i(93609);let w="https://6jnqmj85-80.inc1.devtunnels.ms";function C(e){let{employeeId:s}=e,[l,n]=(0,a.useState)([]),[r,i]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null),[o,x]=(0,a.useState)(""),[m,u]=(0,a.useState)([]),[p,h]=(0,a.useState)(!1),[g,j]=(0,a.useState)(!1),[y,v]=(0,a.useState)(null),[C,k]=(0,a.useState)(!1),[I,D]=(0,a.useState)(null),[T,E]=(0,a.useState)(null),[A,P]=(0,a.useState)(null),M={title:"",category:"",startDate:"",dueDate:"",noDueDate:!1,taskStageId:"",assignedEmployeeIds:[],description:"",labelIds:[],milestoneId:"",priority:"LOW",isPrivate:!1,timeEstimateMinutes:"",isDependent:!1,projectId:o,taskFile:null},[F,L]=(0,a.useState)(M),U=e=>"".concat(w).concat(e),O=async()=>{try{let e=localStorage.getItem("accessToken"),t=await N.default.get("".concat(w,"/status"),{headers:{Authorization:e?"Bearer ".concat(e):""}});Array.isArray(t.data)?u(t.data):u([])}catch(e){console.warn("Failed to fetch statuses:",e),u([])}},B=async()=>{i(!0),d(null);try{let e=localStorage.getItem("accessToken"),t="".concat(w,"/api/projects/tasks/employee/").concat(s),a=await N.default.get(t,{headers:{"Content-Type":"application/json",Authorization:e?"Bearer ".concat(e):""}});n(Array.isArray(a.data)?a.data:[])}catch(a){var e,t;d((null==a||null==(t=a.response)||null==(e=t.data)?void 0:e.message)||(null==a?void 0:a.message)||"Failed to load tasks")}finally{i(!1)}};(0,a.useEffect)(()=>{O(),B()},[o]);let H=e=>L(t=>({...t,...e})),R=async e=>{e.preventDefault();try{let e=new FormData;e.append("title",F.title),e.append("category",F.category||""),e.append("startDate",F.startDate||""),e.append("dueDate",F.dueDate||""),e.append("noDueDate",String(F.noDueDate)),e.append("taskStageId",F.taskStageId||""),e.append("assignedEmployeeIds",JSON.stringify(F.assignedEmployeeIds)),e.append("description",F.description||""),e.append("labelIds",JSON.stringify(F.labelIds)),e.append("milestoneId",F.milestoneId||""),e.append("priority",F.priority||""),e.append("isPrivate",String(F.isPrivate)),e.append("timeEstimateMinutes",String(F.timeEstimateMinutes||"")),e.append("isDependent",String(F.isDependent)),e.append("projectId",String(o)),F.taskFile&&e.append("taskFile",F.taskFile),await (0,f.postAPI)(U("/api/projects/tasks"),e,{headers:{"Content-Type":"multipart/form-data"}}),h(!1),L(M),await B()}catch(e){var t,a;alert("Create task failed: "+((null==e||null==(a=e.response)||null==(t=a.data)?void 0:t.message)||(null==e?void 0:e.message)||"unknown"))}},z=async e=>{if(e.preventDefault(),y)try{let e=new FormData;e.append("title",F.title),e.append("category",F.category||""),e.append("noDueDate",String(F.noDueDate)),e.append("description",F.description||""),e.append("labelIds",JSON.stringify(F.labelIds)),e.append("priority",F.priority||""),e.append("isPrivate",String(F.isPrivate)),e.append("timeEstimateMinutes",String(F.timeEstimateMinutes||"")),e.append("isDependent",String(F.isDependent)),e.append("projectId",String(o)),e.append("assignedEmployeeIds",JSON.stringify(F.assignedEmployeeIds)),F.taskFile&&e.append("taskFile",F.taskFile),await (0,f.putAPI)(U("/api/projects/tasks/".concat(y.id)),e,{headers:{"Content-Type":"multipart/form-data"}}),j(!1),v(null),L(M),await B()}catch(e){var t,a;alert("Update task failed: "+((null==e||null==(a=e.response)||null==(t=a.data)?void 0:t.message)||(null==e?void 0:e.message)||"unknown"))}},V=async e=>{if(confirm("Are you sure to delete this task?"))try{await (0,f.deleteAPI)(U("/api/projects/".concat(o,"/tasks/").concat(e))),E(null),await B()}catch(e){var t,a;alert("Delete failed: "+((null==e||null==(a=e.response)||null==(t=a.data)?void 0:t.message)||(null==e?void 0:e.message)||"unknown"))}},J=e=>{var t;switch(("string"==typeof e?e:null!=(t=null==e?void 0:e.name)?t:"").toLowerCase()){case"complete":case"completed":case"complete":case"complete":return"bg-green-600";case"to-do":case"to do":case"todo":return"bg-yellow-500";case"doing":return"bg-blue-600";case"incomplete":return"bg-red-600";case"waiting":case"waiting for approval":return"bg-gray-600";default:return"bg-gray-400"}},_=async(e,t)=>{n(a=>a.map(a=>a.id===e.id?{...a,taskStage:{id:t.id,name:t.name},taskStageId:t.id}:a));let a=localStorage.getItem("accessToken");try{let s="".concat(w,"/api/projects/tasks/").concat(e.id,"/status?statusId=").concat(t.id);await N.default.patch(s,{},{headers:{"Content-Type":"application/json",Authorization:a?"Bearer ".concat(a):""}}),P(null)}catch(e){console.error("Failed to update status:",e),alert("Failed to update status on server. Refreshing tasks."),await B(),P(null)}},G=e=>{if(!e&&0!==e)return"--";let t=Math.floor((e||0)/60),a=(e||0)%60;return t&&a?"".concat(t,"h ").concat(a,"m"):t?"".concat(t,"h"):"".concat(a,"m")};return(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Tasks"}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsx)("button",{onClick:()=>{L({...M,projectId:o}),h(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded shadow-sm hover:bg-blue-700",children:"+ Add Task"})}),(0,t.jsx)("div",{className:"flex items-center gap-3",children:(0,t.jsx)("input",{type:"search",placeholder:"Search",onChange:e=>{let t=e.target.value.toLowerCase();t?n(e=>e.filter(e=>(e.title||"").toLowerCase().includes(t)||(e.projectName||"").toLowerCase().includes(t))):B()},className:"border px-3 py-2 rounded-md text-sm"})})]}),r?(0,t.jsx)("div",{className:"py-6 text-center text-gray-500",children:"Loading tasks..."}):c?(0,t.jsx)("div",{className:"py-6 text-center text-red-500",children:c}):(0,t.jsxs)("div",{className:"overflow-x-auto",children:[(0,t.jsxs)("table",{className:"min-w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-blue-50 text-left text-gray-600",children:[(0,t.jsx)("th",{className:"px-4 py-3",children:"Code"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Task"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Completed On"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Start Date"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Due Date"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Hours Logged"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Estimated Time"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Milestones"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Assigned to"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Status"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Action"})]})}),(0,t.jsx)("tbody",{children:0===l.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:11,className:"py-6 text-center text-gray-500",children:"No tasks found"})}):l.map(e=>{var a,s,l,n,r,i,c;let d=e.dueDate&&!e.noDueDate&&new Date(e.dueDate)<new Date,o=(e=>{var t,a,s,l;if(e.taskStage&&e.taskStage.name)return e.taskStage;if(e.taskStageId){let t=m.find(t=>t.id===e.taskStageId);if(t)return t}let n=(e=>{if(m&&m.length)return m.find(t=>String(t.name).toLowerCase().includes(String(e).toLowerCase()))})(String((null==(t=e.taskStage)?void 0:t.name)||""));return null!=n?n:{id:null!=(s=e.taskStageId)?s:0,name:null!=(l=null==(a=e.taskStage)?void 0:a.name)?l:"Doing"}})(e),x=null!=(s=null==o?void 0:o.name)?s:"Doing";return(0,t.jsxs)("tr",{className:"border-b last:border-b-0 bg-white hover:bg-gray-50",children:[(0,t.jsxs)("td",{className:"px-4 py-4 align-top",children:["RTA-",String(e.id).padStart(2,"0")]}),(0,t.jsxs)("td",{className:"px-4 py-4 align-top",children:[(0,t.jsx)("div",{className:"font-medium",children:e.title}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:null!=(l=e.projectName)?l:"Project ".concat(e.projectId)})]}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:"--"}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:e.startDate?new Date(e.startDate).toLocaleDateString():"--"}),(0,t.jsx)("td",{className:"px-4 py-4 align-top ".concat(d?"text-red-600":""),children:e.noDueDate?"--":e.dueDate?new Date(e.dueDate).toLocaleDateString():"--"}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:G(null!=(n=e.hoursLoggedMinutes)?n:null)}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:G(null!=(r=e.timeEstimateMinutes)?r:null)}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:null!=(i=null==(a=e.milestone)?void 0:a.title)?i:"--"}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:(0,t.jsx)("div",{className:"flex -space-x-2",children:(e.assignedEmployees||[]).slice(0,3).map(e=>(0,t.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-white overflow-hidden bg-gray-100",children:e.profileUrl?(0,t.jsx)("img",{src:e.profileUrl,alt:e.name,className:"w-full h-full object-cover"}):(0,t.jsx)(b.UserIcon,{className:"w-full h-full text-gray-400 p-1"})},e.employeeId))})}),(0,t.jsx)("td",{className:"px-4 py-4 align-top relative",children:(0,t.jsxs)("div",{className:"relative inline-block",children:[(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),E(null),P(t=>t===e.id?null:e.id)},className:"inline-flex items-center gap-2 px-3 py-1 rounded-full border text-xs bg-white hover:bg-gray-50",title:"Change status",children:[o&&o.labelColor?(0,t.jsx)("span",{style:{width:8,height:8,borderRadius:9999,display:"inline-block",background:"#".concat(String(o.labelColor).replace(/[^0-9a-fA-F]/g,"").slice(0,6))}}):(0,t.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(J(null!=(c=null==o?void 0:o.name)?c:"Doing"))}),(0,t.jsx)("span",{children:String(x)}),(0,t.jsx)("span",{className:"text-xs",children:"▾"})]}),A===e.id&&(0,t.jsx)("div",{onClick:e=>e.stopPropagation(),className:"absolute right-0 mt-2 z-30 w-44 bg-white border rounded-md shadow-lg text-sm",children:m.length>0?m.map(a=>(0,t.jsxs)("button",{onClick:()=>_(e,a),className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-2 ".concat(a.id===(null==o?void 0:o.id)?"font-medium":""),children:[a.labelColor?(0,t.jsx)("span",{style:{width:8,height:8,borderRadius:9999,background:"#".concat(String(a.labelColor).replace(/[^0-9a-fA-F]/g,"").slice(0,6))}}):(0,t.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(J(a.name))}),(0,t.jsx)("span",{children:a.name})]},a.id)):["To Do","Doing","Completed","Incomplete","Waiting for Approval"].map(a=>(0,t.jsxs)("button",{onClick:()=>{_(e,{id:0,name:a})},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:[(0,t.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(J(a))})," ",(0,t.jsx)("span",{children:a})]},a))})]})}),(0,t.jsxs)("td",{className:"px-4 py-4 align-top relative",children:[(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),P(null),E(t=>t===e.id?null:e.id)},className:"p-1 rounded hover:bg-gray-100","aria-haspopup":"true","aria-expanded":T===e.id,title:"More",children:"⋮"}),T===e.id&&(0,t.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"absolute right-2 top-10 z-20 w-48 bg-white border rounded-md shadow-md",children:[(0,t.jsx)("button",{onClick:()=>{D(e),k(!0),E(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"View"}),(0,t.jsx)("button",{onClick:()=>{var t;v(e),L({title:e.title||"",category:(null==(t=e.categoryId)?void 0:t.id)?String(e.categoryId.id):"",startDate:e.startDate?e.startDate:"",dueDate:e.dueDate?e.dueDate:"",noDueDate:!!e.noDueDate,taskStageId:e.taskStageId?String(e.taskStageId):"",assignedEmployeeIds:e.assignedEmployeeIds||[],description:e.description||"",labelIds:(e.labels||[]).map(e=>String(e.id)),milestoneId:e.milestoneId?String(e.milestoneId):"",priority:e.priority||"LOW",isPrivate:!!e.isPrivate,timeEstimateMinutes:e.timeEstimateMinutes?String(e.timeEstimateMinutes):"",isDependent:!!e.isDependent,projectId:e.projectId,taskFile:null}),j(!0),E(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>{E(null),V(e.id)},className:"w-full text-left px-4 py-2 text-red-600 hover:bg-gray-50",children:"Delete"})]})]})]},e.id)})})]}),(0,t.jsxs)("div",{className:"px-4 py-3 border-t bg-gray-50 flex items-center justify-between text-sm text-gray-600 rounded-b-md mt-4",children:[(0,t.jsxs)("div",{children:["Result per page - ",l.length?l.length:0]}),(0,t.jsx)("div",{children:"Page 1 of 1"})]})]}),p&&(0,t.jsx)("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 p-4",children:(0,t.jsxs)("form",{onSubmit:R,className:"bg-white w-full max-w-3xl rounded-lg p-6 shadow-lg overflow-auto max-h-[90vh]",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Add Task"}),(0,t.jsx)("button",{type:"button",onClick:()=>h(!1),className:"text-gray-500",children:"Close"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Title"}),(0,t.jsx)("input",{required:!0,value:F.title,onChange:e=>H({title:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Category (id)"}),(0,t.jsx)("input",{value:F.category,onChange:e=>H({category:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Start Date"}),(0,t.jsx)("input",{type:"date",value:F.startDate,onChange:e=>H({startDate:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Due Date"}),(0,t.jsx)("input",{type:"date",value:F.dueDate,onChange:e=>H({dueDate:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:F.noDueDate,onChange:e=>H({noDueDate:e.target.checked})}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"No Due Date"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Task Stage ID"}),(0,t.jsx)("input",{value:F.taskStageId,onChange:e=>H({taskStageId:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Description"}),(0,t.jsx)("textarea",{value:F.description,onChange:e=>H({description:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Assigned Employee IDs (comma separated)"}),(0,t.jsx)("input",{value:F.assignedEmployeeIds.join(","),onChange:e=>H({assignedEmployeeIds:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Label IDs (comma separated)"}),(0,t.jsx)("input",{value:F.labelIds.join(","),onChange:e=>H({labelIds:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Milestone ID"}),(0,t.jsx)("input",{value:F.milestoneId,onChange:e=>H({milestoneId:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Priority"}),(0,t.jsxs)("select",{value:F.priority,onChange:e=>H({priority:e.target.value}),className:"border px-3 py-2 rounded",children:[(0,t.jsx)("option",{value:"LOW",children:"LOW"}),(0,t.jsx)("option",{value:"MEDIUM",children:"MEDIUM"}),(0,t.jsx)("option",{value:"HIGH",children:"HIGH"}),(0,t.jsx)("option",{value:"URGENT",children:"URGENT"})]})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Time Estimate (minutes)"}),(0,t.jsx)("input",{type:"number",value:F.timeEstimateMinutes,onChange:e=>H({timeEstimateMinutes:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:F.isPrivate,onChange:e=>H({isPrivate:e.target.checked})}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Private"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:F.isDependent,onChange:e=>H({isDependent:e.target.checked})}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Is Dependent"})]}),(0,t.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Attach file (optional)"}),(0,t.jsx)("input",{type:"file",onChange:e=>{var t;return H({taskFile:(null==(t=e.target.files)?void 0:t[0])||null})}})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 rounded border",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 rounded bg-blue-600 text-white",children:"Save"})]})]})}),g&&y&&(0,t.jsx)("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 p-4",children:(0,t.jsxs)("form",{onSubmit:z,className:"bg-white w-full max-w-3xl rounded-lg p-6 shadow-lg overflow-auto max-h-[90vh]",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Task"}),(0,t.jsx)("button",{type:"button",onClick:()=>{j(!1),v(null)},className:"text-gray-500",children:"Close"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Title"}),(0,t.jsx)("input",{required:!0,value:F.title,onChange:e=>H({title:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Category (id)"}),(0,t.jsx)("input",{value:F.category,onChange:e=>H({category:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Description"}),(0,t.jsx)("textarea",{value:F.description,onChange:e=>H({description:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Assigned Employee IDs (comma separated)"}),(0,t.jsx)("input",{value:F.assignedEmployeeIds.join(","),onChange:e=>H({assignedEmployeeIds:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Label IDs (comma separated)"}),(0,t.jsx)("input",{value:F.labelIds.join(","),onChange:e=>H({labelIds:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Priority"}),(0,t.jsxs)("select",{value:F.priority,onChange:e=>H({priority:e.target.value}),className:"border px-3 py-2 rounded",children:[(0,t.jsx)("option",{value:"LOW",children:"LOW"}),(0,t.jsx)("option",{value:"MEDIUM",children:"MEDIUM"}),(0,t.jsx)("option",{value:"HIGH",children:"HIGH"}),(0,t.jsx)("option",{value:"URGENT",children:"URGENT"})]})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Time Estimate (minutes)"}),(0,t.jsx)("input",{type:"number",value:F.timeEstimateMinutes,onChange:e=>H({timeEstimateMinutes:e.target.value}),className:"border px-3 py-2 rounded"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:F.isPrivate,onChange:e=>H({isPrivate:e.target.checked})}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Private"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:F.isDependent,onChange:e=>H({isDependent:e.target.checked})}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Is Dependent"})]}),(0,t.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Attach file (optional)"}),(0,t.jsx)("input",{type:"file",onChange:e=>{var t;return H({taskFile:(null==(t=e.target.files)?void 0:t[0])||null})}})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{j(!1),v(null)},className:"px-4 py-2 rounded border",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 rounded bg-blue-600 text-white",children:"Update"})]})]})}),(0,t.jsx)(S.default,{open:C,task:I,onClose:()=>{k(!1),D(null)}})]})}var k=e.i(427217);let I="https://6jnqmj85-80.inc1.devtunnels.ms",D=localStorage.getItem("accessToken");function T(e){var s,l,n,r,i,c,d,o;let{gatewayPath:x,mainBase:m,employeeId:u,authToken:p=D}=e,h=(m||I).replace(/\/$/,""),[g,j]=(0,a.useState)([]),[y,v]=(0,a.useState)(!1),[N,f]=(0,a.useState)(null),[S,w]=(0,a.useState)(0),[C,T]=(0,a.useState)(""),[E,A]=(0,a.useState)("All"),[P,M]=(0,a.useState)(!1),[F,L]=(0,a.useState)(!1),[U,O]=(0,a.useState)(null),[B,H]=(0,a.useState)(null),[R,z]=(0,a.useState)({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""}),[V,J]=(0,a.useState)(null),[_,G]=(0,a.useState)(!1),[W,q]=(0,a.useState)(null),[Y,X]=(0,a.useState)(!1),$=e=>{let t=String(e||"");return t.startsWith("http://")||t.startsWith("https://")?t:t.startsWith("/")?"".concat(h).concat(t):"".concat(h,"/").concat(t)},K=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={...e};return p&&(t.Authorization="Bearer ".concat(p)),t},Q=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3,s=new AbortController,l=setTimeout(()=>s.abort(),a);try{let a={...t,signal:s.signal},n=await fetch(e,a);clearTimeout(l);let r=n.headers.get("content-type")||"",i=await n.text().catch(()=>"");if(!n.ok){if(r.includes("application/json"))try{let e=JSON.parse(i||"{}"),t=(null==e?void 0:e.message)||JSON.stringify(e);throw Error("HTTP ".concat(n.status," ").concat(n.statusText," — ").concat(t))}catch(e){throw Error("HTTP ".concat(n.status," ").concat(n.statusText," — ").concat(i.slice(0,300)))}if(r.includes("text/html")||i.trim().startsWith("<!DOCTYPE html"))throw Error("HTTP ".concat(n.status," ").concat(n.statusText," — server returned HTML (likely auth)."));throw Error("HTTP ".concat(n.status," ").concat(n.statusText," ").concat(i?"- "+i.slice(0,300):""))}if(r.includes("application/json"))return JSON.parse(i||"[]");return i}catch(e){if("AbortError"===e.name)throw Error("Request timed out");if("Failed to fetch"===e.message)throw Error("Network Error - check CORS / server availability");throw e}finally{clearTimeout(l)}},Z=async()=>{v(!0),f(null);try{let e=$("".concat(I,"/timesheets/employee/").concat(u)),t=await Q(e,{method:"GET",headers:K({"Content-Type":"application/json"}),credentials:"same-origin"});Array.isArray(t)?j(t):(null==t?void 0:t.data)&&Array.isArray(t.data)?j(t.data):(console.warn("Unexpected timesheets response:",t),j([]),f("Unexpected response shape from server. See console."))}catch(e){console.error("fetchTimesheets error:",e),j([]),f((null==e?void 0:e.message)||"Failed to load timesheets")}finally{v(!1)}};(0,a.useEffect)(()=>{Z()},[S]);let ee=(0,a.useMemo)(()=>{let e=new Map;return g.forEach(t=>{let a=t.employees&&t.employees[0];a&&a.employeeId?e.set(a.employeeId,a):t.employeeId&&e.set(t.employeeId,{employeeId:t.employeeId})}),Array.from(e.values())},[g]),et=g.filter(e=>{if("All"!==E&&e.employeeId!==E)return!1;if(!C)return!0;let t=C.toLowerCase(),a=e.employees&&e.employees[0];return String(e.employeeId||"").toLowerCase().includes(t)||String(e.projectId||"").toLowerCase().includes(t)||String(e.taskId||"").toLowerCase().includes(t)||String(e.memo||"").toLowerCase().includes(t)||String((null==a?void 0:a.name)||"").toLowerCase().includes(t)}),ea=e=>e<10?"0".concat(e):"".concat(e),es=(e,t)=>((e,t)=>{if(!e)return"-";try{let[l,n,r]=e.split("-").map(Number),i=0,c=0;if(t){var a,s;let e=t.split(":").map(Number);i=null!=(a=e[0])?a:0,c=null!=(s=e[1])?s:0}let d=new Date(l,n-1,r,i,c),o=ea(d.getDate()),x=ea(d.getMonth()+1),m=d.getFullYear(),u=d.getHours(),p=ea(d.getMinutes()),h=u>=12?"PM":"AM";u=u%12||12;let g=ea(u);return"".concat(o,"/").concat(x,"/").concat(m," ").concat(g,":").concat(p," ").concat(h)}catch(a){return e+(t?" ".concat(t):"")}})(e,t),el=(e,t,a,s)=>{if(!e||!a)return 0;try{let l=e.split("-").map(Number),n=a.split("-").map(Number),r=0,i=0,c=0,d=0;t&&([r,i]=t.split(":").map(e=>Number(e))),s&&([c,d]=s.split(":").map(e=>Number(e)));let o=new Date(l[0],l[1]-1,l[2],r,i),x=new Date(n[0],n[1]-1,n[2],c,d).getTime()-o.getTime();if(isNaN(x)||x<=0)return 0;return Math.round(x/36e5)}catch(e){return 0}},en=el(R.startDate,R.startTime,R.endDate,R.endTime),er=e=>{if(e){var t,a,s,l,n,r,i,c;H(e.id),z({projectId:String(null!=(t=e.projectId)?t:""),taskId:String(null!=(a=e.taskId)?a:""),employeeId:null!=(s=e.employeeId)?s:"",startDate:null!=(l=e.startDate)?l:"",startTime:null!=(n=e.startTime)?n:"",endDate:null!=(r=e.endDate)?r:"",endTime:null!=(i=e.endTime)?i:"",memo:null!=(c=e.memo)?c:""})}else H(null),z({projectId:"",taskId:"",employeeId:"",startDate:"",startTime:"",endDate:"",endTime:"",memo:""});O(null),M(!0)},ei=async()=>{if(W){L(!0),O(null);try{let e=$("".concat(x,"/").concat(W.id));await Q(e,{method:"DELETE",headers:K({"Content-Type":"application/json"}),credentials:"same-origin"}),X(!1),q(null),w(e=>e+1)}catch(e){console.error("deleteTimesheet error:",e),O((null==e?void 0:e.message)||"Failed to delete timesheet")}finally{L(!1)}}},ec=async()=>{L(!0),O(null);try{if(!R.projectId||!R.taskId||!R.employeeId||!R.startDate||!R.startTime||!R.endDate||!R.endTime||!R.memo){O("Please fill all required fields."),L(!1);return}let e={projectId:Number(R.projectId),taskId:Number(R.taskId),employeeId:R.employeeId,startDate:R.startDate,startTime:R.startTime,endDate:R.endDate,endTime:R.endTime,memo:R.memo,durationHours:el(R.startDate,R.startTime,R.endDate,R.endTime)},t=$(x)+(B?"/".concat(B):"");await Q(t,{method:B?"PUT":"POST",headers:K({"Content-Type":"application/json"}),credentials:"same-origin",body:JSON.stringify(e)}),M(!1),w(e=>e+1)}catch(e){console.error("saveEntry error:",e),O((null==e?void 0:e.message)||"Failed to save entry")}finally{L(!1)}};return(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Timesheet"}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("label",{className:"text-sm",children:"Employee"}),(0,t.jsxs)("select",{value:E,onChange:e=>A(e.target.value),className:"border rounded px-3 py-2 text-sm",children:[(0,t.jsx)("option",{value:"All",children:"All"}),ee.map(e=>(0,t.jsx)("option",{value:e.employeeId,children:e.name?"".concat(e.name," (").concat(e.employeeId,")"):e.employeeId},e.employeeId))]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{children:(0,t.jsx)("button",{onClick:()=>er(),className:"bg-blue-600 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-700",children:"+ Log Time"})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{onClick:()=>w(e=>e+1),className:"bg-gray-100 px-3 py-2 rounded text-sm border hover:bg-gray-200",children:"Refresh"}),(0,t.jsx)("input",{type:"search",placeholder:"Search employee, memo, project...",value:C,onChange:e=>T(e.target.value),className:"border px-3 py-2 rounded-md text-sm"})]})]}),y?(0,t.jsx)("div",{className:"py-6 text-center text-gray-500",children:"Loading timesheets..."}):(0,t.jsxs)(t.Fragment,{children:[N&&(0,t.jsxs)("div",{className:"mb-4 p-3 rounded bg-red-50 text-red-700",children:[(0,t.jsx)("strong",{children:"Error:"})," ",N]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-blue-50 text-left text-gray-600",children:[(0,t.jsx)("th",{className:"px-4 py-3",children:"Code"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Task"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Employee"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Start Time"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"End Time"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Total Hours"}),(0,t.jsx)("th",{className:"px-4 py-3",children:"Action"})]})}),(0,t.jsx)("tbody",{children:0===et.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,className:"py-6 text-center text-gray-500",children:"No timesheets found"})}):et.map(e=>{var a,s,l,n;let r=e.employees&&e.employees[0],i="RTA-".concat(String(e.id).padStart(2,"0")),c="Task ".concat(null!=(a=e.taskId)?a:"-"," · Project ").concat(null!=(s=e.projectId)?s:"-");return(0,t.jsxs)("tr",{className:"border-b last:border-b-0 bg-white hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:i}),(0,t.jsxs)("td",{className:"px-4 py-4 align-top",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:c}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:null!=(l=e.memo)?l:""})]}),(0,t.jsxs)("td",{className:"px-4 py-4 align-top flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:(null==r?void 0:r.profileUrl)?(0,t.jsx)("img",{src:r.profileUrl,alt:null!=(n=null==r?void 0:r.name)?n:"",className:"w-full h-full object-cover"}):(0,t.jsx)(b.UserIcon,{className:"w-6 h-6 text-gray-400 p-1"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:(null==r?void 0:r.name)||e.employeeId}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:(null==r?void 0:r.designation)||(null==r?void 0:r.department)||e.employeeId})]})]}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:es(e.startDate,e.startTime)}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:es(e.endDate,e.endTime)}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:"number"==typeof e.durationHours?"".concat(e.durationHours,"h"):"-"}),(0,t.jsx)("td",{className:"px-4 py-4 align-top",children:(0,t.jsxs)("div",{className:"relative inline-block text-left",children:[(0,t.jsx)("button",{onClick:()=>J(V===e.id?null:e.id),className:"px-2 py-1 border rounded text-sm","aria-haspopup":"true","aria-expanded":V===e.id,title:"More",children:"⋮"}),V===e.id&&(0,t.jsxs)("div",{className:"absolute right-0 mt-2 z-30 w-40 bg-white border rounded-md shadow-lg text-sm",children:[(0,t.jsx)("button",{onClick:()=>{q(e),G(!0),J(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"View"}),(0,t.jsx)("button",{onClick:()=>{er(e),J(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>{q(e),X(!0),J(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 text-red-600",children:"Delete"})]})]})})]},e.id)})})]})})]}),P&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12 px-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>M(!1)}),(0,t.jsxs)("div",{className:"relative bg-white w-full max-w-4xl rounded-xl shadow-xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:B?"Edit TimeLog":"Log Time"}),(0,t.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>M(!1),"aria-label":"Close",children:(0,t.jsx)(k.XMarkIcon,{className:"w-6 h-6 text-gray-500"})})]}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-md border p-6",children:[(0,t.jsx)("h4",{className:"text-md font-medium mb-4",children:"TimeLog Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Project *"}),(0,t.jsx)("input",{value:R.projectId,onChange:e=>z(t=>({...t,projectId:e.target.value})),className:"w-full border rounded px-3 py-2",placeholder:"Project ID",type:"text"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Task *"}),(0,t.jsx)("input",{value:R.taskId,onChange:e=>z(t=>({...t,taskId:e.target.value})),className:"w-full border rounded px-3 py-2",placeholder:"Task ID",type:"text"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Employee *"}),(0,t.jsxs)("select",{value:R.employeeId,onChange:e=>z(t=>({...t,employeeId:e.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,t.jsx)("option",{value:"",children:"--"}),ee.map(e=>(0,t.jsx)("option",{value:e.employeeId,children:e.name?"".concat(e.name," (").concat(e.employeeId,")"):e.employeeId},e.employeeId))]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Date *"}),(0,t.jsx)("input",{type:"date",value:R.startDate,onChange:e=>z(t=>({...t,startDate:e.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Start Time *"}),(0,t.jsx)("input",{type:"time",value:R.startTime,onChange:e=>z(t=>({...t,startTime:e.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Date *"}),(0,t.jsx)("input",{type:"date",value:R.endDate,onChange:e=>z(t=>({...t,endDate:e.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"End Time *"}),(0,t.jsx)("input",{type:"time",value:R.endTime,onChange:e=>z(t=>({...t,endTime:e.target.value})),className:"w-full border rounded px-3 py-2"})]})]}),(0,t.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-700 mb-2",children:"Memo *"}),(0,t.jsx)("input",{type:"text",value:R.memo,onChange:e=>z(t=>({...t,memo:e.target.value})),className:"w-full border rounded px-3 py-2",placeholder:"Memo"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"Total Hours"}),(0,t.jsxs)("div",{className:"text-2xl font-semibold text-blue-600",children:[en,"h"]})]})]}),U&&(0,t.jsx)("div",{className:"mt-4 text-sm text-red-600",children:U})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,t.jsx)("button",{onClick:()=>M(!1),className:"px-6 py-2 rounded-md border text-blue-600",disabled:F,children:"Cancel"}),(0,t.jsx)("button",{onClick:ec,className:"px-6 py-2 rounded-md bg-blue-600 text-white shadow",disabled:F,children:F?"Saving...":B?"Update":"Save"})]})]})]})]}),_&&W&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-8 px-6",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>G(!1)}),(0,t.jsxs)("div",{className:"relative bg-white w-full max-w-6xl rounded-xl shadow-xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold",children:"Timesheet"}),(0,t.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>G(!1),"aria-label":"Close",children:(0,t.jsx)(k.XMarkIcon,{className:"w-6 h-6 text-gray-500"})})]}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 relative bg-white rounded-xl border p-6",children:[(0,t.jsx)("div",{className:"absolute top-4 right-4 text-gray-500",children:"⋮"}),(0,t.jsx)("h4",{className:"text-lg font-medium mb-4",children:"TimeLog Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-y-4 gap-x-6 items-center text-sm",children:[(0,t.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,t.jsx)("div",{className:"col-span-2",children:es(W.startDate,W.startTime)}),(0,t.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,t.jsx)("div",{className:"col-span-2",children:es(W.endDate,W.endTime)}),(0,t.jsx)("div",{className:"text-gray-500",children:"Total Hours"}),(0,t.jsx)("div",{className:"col-span-2",children:"number"==typeof W.durationHours?"".concat(W.durationHours,"h"):"-"}),(0,t.jsx)("div",{className:"text-gray-500",children:"Memo"}),(0,t.jsx)("div",{className:"col-span-2",children:null!=(r=W.memo)?r:"-"}),(0,t.jsx)("div",{className:"text-gray-500",children:"Project"}),(0,t.jsxs)("div",{className:"col-span-2",children:["Project ",null!=(i=W.projectId)?i:"-"]}),(0,t.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,t.jsxs)("div",{className:"col-span-2",children:["Task ",null!=(c=W.taskId)?c:"-"]}),(0,t.jsx)("div",{className:"text-gray-500",children:"Employee"}),(0,t.jsxs)("div",{className:"col-span-2 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:W.employees&&(null==(s=W.employees[0])?void 0:s.profileUrl)?(0,t.jsx)("img",{src:W.employees[0].profileUrl,alt:null!=(d=W.employees[0].name)?d:"",className:"w-full h-full object-cover"}):(0,t.jsx)(b.UserIcon,{className:"w-6 h-6 text-gray-400 p-1"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:W.employees&&(null==(l=W.employees[0])?void 0:l.name)?W.employees[0].name:W.employeeId}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:W.employees&&(null==(n=W.employees[0])?void 0:n.designation)?W.employees[0].designation:""})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border p-5",children:[(0,t.jsx)("h5",{className:"font-medium mb-3",children:"History"}),(0,t.jsxs)("div",{className:"space-y-4 text-sm text-gray-700",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"text-gray-500",children:"Start Time"}),(0,t.jsx)("div",{children:es(W.startDate,W.startTime)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"text-gray-500",children:"Task"}),(0,t.jsxs)("div",{children:["Task ",null!=(o=W.taskId)?o:"-"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"text-gray-500",children:"End Time"}),(0,t.jsx)("div",{children:es(W.endDate,W.endTime)})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-8 pb-6",children:[(0,t.jsx)("button",{onClick:()=>G(!1),className:"px-6 py-2 rounded-md border text-blue-600",children:"Close"}),(0,t.jsx)("button",{onClick:()=>{er(W),G(!1)},className:"px-6 py-2 rounded-md bg-blue-600 text-white",children:"Edit"})]})]})]})]}),Y&&W&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12 px-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>X(!1)}),(0,t.jsx)("div",{className:"relative bg-white w-full max-w-md rounded-lg shadow-xl overflow-hidden",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Delete TimeLog"}),(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:["Are you sure you want to delete timesheet ",(0,t.jsxs)("strong",{children:["RTA-",String(W.id).padStart(2,"0")]}),"? This action cannot be undone."]}),U&&(0,t.jsx)("div",{className:"mt-4 text-sm text-red-600",children:U}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-4 mt-6",children:[(0,t.jsx)("button",{className:"px-4 py-2 rounded border",onClick:()=>X(!1),disabled:F,children:"Cancel"}),(0,t.jsx)("button",{className:"px-4 py-2 rounded bg-red-600 text-white",onClick:ei,disabled:F,children:F?"Deleting...":"Delete"})]})]})})]})]})}function E(e){let{employeeId:a}=e;return(0,t.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,t.jsx)("h2",{className:"font-semibold mb-4",children:"Assigned Tasks"}),(0,t.jsx)(C,{employeeId:a}),(0,t.jsx)(T,{employeeId:a}),(0,t.jsx)(v,{employeeId:a})]})}}]);