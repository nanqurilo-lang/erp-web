(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,771312,e=>{"use strict";e.s(["default",()=>ec],771312),e.i(247167);var l=e.i(843476),t=e.i(271645),a=e.i(618566);let s=e=>{let{label:t,value:a}=e;return(0,l.jsxs)("div",{className:"flex items-start gap-6 py-2 border-b border-transparent last:border-b-0",children:[(0,l.jsx)("div",{className:"w-40 text-sm text-slate-600",children:t}),(0,l.jsx)("div",{className:"text-sm text-slate-800",children:null!=a?a:"—"})]})};var n=e.i(519455),r=e.i(871689),i=e.i(178583),c=e.i(475254);let d=(0,c.default)("sticky-note",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);var o=e.i(522016);let u=e=>{let{clientName:t,clientId:a,onBack:s,onOpenTab:c,activeTab:u="profile"}=e;return(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-semibold",children:t}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Client ID: ",a]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)(n.Button,{variant:"ghost",className:"hidden sm:inline-flex items-center gap-2",onClick:s,children:[(0,l.jsx)(r.ArrowLeft,{className:"mr-1 h-4 w-4"})," Back to Clients"]}),(0,l.jsx)(o.default,{href:"/clients/".concat(a,"/documents"),children:(0,l.jsxs)(n.Button,{variant:"outline",className:"flex items-center gap-2",children:[(0,l.jsx)(i.FileText,{className:"h-4 w-4"})," Documents"]})}),(0,l.jsx)(o.default,{href:"/clients/".concat(a,"/notes"),children:(0,l.jsxs)(n.Button,{variant:"outline",className:"flex items-center gap-2",children:[(0,l.jsx)(d,{className:"h-4 w-4"})," Notes"]})})]})]}),(0,l.jsx)("div",{className:"mt-6 border-b",children:(0,l.jsx)("nav",{className:"flex gap-6 text-sm text-slate-600",children:[{key:"profile",label:"Profile"},{key:"projects",label:"Projects"},{key:"invoices",label:"Invoices"},{key:"creditnotes",label:"Credit Notes "},{key:"payments",label:"Payments"},{key:"documents",label:"Documents"},{key:"notes",label:"Notes"}].map(e=>(0,l.jsx)("button",{onClick:()=>null==c?void 0:c(e.key),className:"pb-3 ".concat(u===e.key?"border-b-2 border-primary text-primary font-medium":""),children:e.label},e.key))})})]})};var m=e.i(515288),x=e.i(799676);let h=e=>{let{projectCount:t,totalEarning:a,unpaidInvoiceCount:s,totalUnpaidAmount:n}=e;return(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6",children:[(0,l.jsx)("div",{className:"col-span-1",children:(0,l.jsx)(m.Card,{children:(0,l.jsxs)(m.CardContent,{className:"flex items-center gap-4",children:[(0,l.jsxs)(x.Avatar,{className:"h-16 w-16",children:[(0,l.jsx)(x.AvatarImage,{src:"/mnt/data/Screenshot 2025-11-25 124734.png",alt:"client"}),(0,l.jsx)(x.AvatarFallback,{children:"NA"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-medium",children:"Client"}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground"})]})]})})}),(0,l.jsxs)("div",{className:"lg:col-span-3 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,l.jsx)(m.Card,{children:(0,l.jsxs)(m.CardContent,{children:[(0,l.jsx)("div",{className:"text-sm text-slate-600",children:"Total Projects"}),(0,l.jsx)("div",{className:"text-2xl font-semibold text-blue-600 mt-2",children:null!=t?t:"—"})]})}),(0,l.jsx)(m.Card,{children:(0,l.jsxs)(m.CardContent,{children:[(0,l.jsx)("div",{className:"text-sm text-slate-600",children:"Total Earnings"}),(0,l.jsx)("div",{className:"text-2xl font-semibold text-blue-600 mt-2",children:null!==a?a.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"—"})]})}),(0,l.jsx)(m.Card,{children:(0,l.jsxs)(m.CardContent,{children:[(0,l.jsx)("div",{className:"text-sm text-slate-600",children:"Due Invoices"}),(0,l.jsx)("div",{className:"text-2xl font-semibold text-blue-600 mt-2",children:null!=s?s:"—"}),null!==n&&(0,l.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:n.toLocaleString(void 0,{style:"currency",currency:"USD",minimumFractionDigits:2})})]})})]})]})},p=[{key:"FINISHED",label:"Finished",color:"#16A34A"},{key:"ON_HOLD",label:"To Do",color:"#F59E0B"},{key:"IN_PROGRESS",label:"In Progress",color:"#2563EB"},{key:"CANCELLED",label:"Cancelled",color:"#EF4444"},{key:"NOT_STARTED",label:"Not Started",color:"#9CA3AF"}],j=e=>{var a,n,r,i,c,d;let{client:o,projects:u=[]}=e,x=(0,t.useMemo)(()=>{let e=Array.isArray(u)?u.length:0,l={};return p.forEach(e=>l[e.key]=0),(u||[]).forEach(e=>{let t=function(e){var l,t,a,s;if(!e)return"NOT_STARTED";let n=(null!=(s=null!=(a=null!=(t=null!=(l=e.projectStatus)?l:e.status)?t:e.state)?a:e.project_state)?s:"").toString().trim().toUpperCase().replace(/ /g,"_");return["FINISHED","COMPLETED","DONE"].includes(n)?"FINISHED":["IN_PROGRESS","INPROGRESS","IN-PROGRESS","ONGOING","RUNNING"].includes(n)?"IN_PROGRESS":["ON_HOLD","HOLD","PAUSED","TODO","TO_DO","TO-DO"].includes(n)?"ON_HOLD":["CANCELLED","CANCELED","CANCEL"].includes(n)?"CANCELLED":["NOT_STARTED","NOTSTARTED","PENDING","PLANNED"].includes(n)?"NOT_STARTED":p.some(e=>e.key===n)?n:"NOT_STARTED"}(e);l[t]=(l[t]||0)+1}),{total:e,items:p.map(t=>{var a;let s=null!=(a=l[t.key])?a:0;return{key:t.key,label:t.label,color:t.color,count:s,pct:e>0?s/e*100:0}})}},[u]),h=(0,t.useMemo)(()=>{let e=[],l=0;return x.items.forEach(t=>{let a=l,s=l+Math.max(0,Math.round(100*t.pct)/100);e.push("".concat(t.color," ").concat(a,"% ").concat(s,"%")),l=s}),l<100&&e.push("#ffffff ".concat(l,"% 100%")),e.join(", ")},[x.items]);return(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,l.jsx)("div",{className:"lg:col-span-2",children:(0,l.jsxs)(m.Card,{children:[(0,l.jsxs)(m.CardHeader,{children:[(0,l.jsx)(m.CardTitle,{children:"Profile Information "}),(0,l.jsx)(m.CardDescription,{children:"Details about client"})]}),(0,l.jsx)(m.CardContent,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-0",children:[(0,l.jsx)(s,{label:"Name",value:o.name}),(0,l.jsx)(s,{label:"Email",value:o.email}),(0,l.jsx)(s,{label:"Gender",value:"—"}),(0,l.jsx)(s,{label:"Company Name",value:null!=(r=null==(a=o.company)?void 0:a.companyName)?r:"—"}),(0,l.jsx)(s,{label:"Company Logo",value:o.companyLogoUrl?"Uploaded":"—"}),(0,l.jsx)(s,{label:"Mobile",value:null!=(i=o.mobile)?i:"—"}),(0,l.jsx)(s,{label:"Office Phone No.",value:"—"}),(0,l.jsx)(s,{label:"Official Website",value:"—"}),(0,l.jsx)(s,{label:"Tax No.",value:"—"}),(0,l.jsx)(s,{label:"Address",value:"—"}),(0,l.jsx)(s,{label:"State",value:null!=(c=null==(n=o.company)?void 0:n.state)?c:"—"}),(0,l.jsx)(s,{label:"Country",value:null!=(d=o.country)?d:"usa"}),(0,l.jsx)(s,{label:"Postal Code",value:"—"}),(0,l.jsx)(s,{label:"Language",value:"English"})]})})]})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(m.Card,{children:[(0,l.jsxs)(m.CardHeader,{children:[(0,l.jsx)(m.CardTitle,{children:"Projects"}),(0,l.jsx)(m.CardDescription,{children:x.total>0?"".concat(x.total," project").concat(x.total>1?"s":""):"No projects yet"})]}),(0,l.jsx)(m.CardContent,{children:0===x.total?(0,l.jsx)("div",{className:"h-40 flex items-center justify-center",children:(0,l.jsx)("div",{className:"w-28 h-28 rounded-full bg-blue-500/90"})}):(0,l.jsxs)("div",{className:"flex items-center gap-6",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsxs)("div",{className:"relative",style:{width:140,height:140},children:[(0,l.jsx)("div",{"aria-hidden":!0,className:"rounded-full",style:{width:140,height:140,background:"conic-gradient(".concat(h,")"),boxShadow:"0 1px 4px rgba(0,0,0,0.06)"}}),(0,l.jsx)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{width:90,height:90,background:"#ffffff",boxShadow:"inset 0 1px 0 rgba(255,255,255,0.6)"}}),(0,l.jsx)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex flex-col items-center justify-center pointer-events-none",children:(()=>{var e,t;let a=[...x.items].sort((e,l)=>l.pct-e.pct)[0];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"text-sm font-semibold",style:{color:null!=(e=null==a?void 0:a.color)?e:"#111"},children:[Math.round(null!=(t=null==a?void 0:a.pct)?t:0),"%"]}),(0,l.jsx)("div",{className:"text-xs text-gray-500 -mt-0.5",children:null==a?void 0:a.label})]})})()})]})}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("div",{className:"flex flex-col gap-3",children:x.items.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-6 h-6 rounded-sm flex-shrink-0",style:{background:e.color}}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"text-sm font-medium",children:e.label}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[e.count," project",1!==e.count?"s":""]})]})]},e.key))})})]})})]}),(0,l.jsxs)(m.Card,{children:[(0,l.jsx)(m.CardHeader,{children:(0,l.jsx)(m.CardTitle,{children:"Invoices "})}),(0,l.jsx)(m.CardContent,{children:(0,l.jsx)("div",{className:"h-40 flex items-center justify-center",children:(0,l.jsx)("div",{className:"w-32 h-32 rounded-full bg-green-600/90"})})})]})]})]})};var v=e.i(487486),y=e.i(755146),N=e.i(541071),g=e.i(107233),f=e.i(269638),b=e.i(116019),w=e.i(569074),C=e.i(174886),S=e.i(592930),k=e.i(286536);let A=(0,c.default)("circle-dollar-sign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]);var D=e.i(245423);let I=(0,c.default)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var T=e.i(440160),P=e.i(37727);let E=(0,c.default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),U="".concat("https://6jnqmj85-80.inc1.devtunnels.ms"),B=async e=>{try{return{parsed:await e.clone().json(),raw:null}}catch(l){try{let l=await e.clone().text();return{parsed:JSON.parse(l),raw:l}}catch(e){return{parsed:null,raw:null}}}};function O(e){var a,s,r,c,d,o,u,x,h,p,j,y,O,L,F,R,z,M,V,H,_,J,G,q,W,X,$,Y,K,Z,Q,ee,el,et,ea,es,en,er,ei,ec,ed;let{clientId:eo,invoicesProp:eu,onInvoiceCreated:em}=e,[ex,eh]=(0,t.useState)(null!=eu?eu:[]),[ep,ej]=(0,t.useState)(!eu),[ev,ey]=(0,t.useState)(null),[eN,eg]=(0,t.useState)(null),[ef,eb]=(0,t.useState)(""),[ew,eC]=(0,t.useState)(null),[eS,ek]=(0,t.useState)(!1),[eA,eD]=(0,t.useState)(!1),[eI,eT]=(0,t.useState)(!1),[eP,eE]=(0,t.useState)({invoiceNumber:"",invoiceDate:"",currency:"USD",projectId:"",clientId:eo?String(eo):eu&&(null==(s=eu[0])||null==(a=s.client)?void 0:a.clientId)?String(eu[0].client.clientId):"",amount:0,taxPercent:10,discountValue:0,discountIsPercent:!0,notes:""}),[eU,eB]=(0,t.useState)(!1),[eO,eL]=(0,t.useState)(!1),[eF,eR]=(0,t.useState)(null),[ez,eM]=(0,t.useState)(!1),[eV,eH]=(0,t.useState)(!1),[e_,eJ]=(0,t.useState)({invoiceNumber:"",issueDate:"",currency:"USD",sellerCompanyName:"",sellerCompanyAddress:"",sellerCompanyCode:"",sellerCompanyTaxNumber:"",sellerCompanyEmail:"",sellerCompanyPhoneNumber:"",sellerCompanyBankName:"",sellerCompanyBankAccountNumber:"",buyerCompanyName:"",buyerCompanyAddress:"",buyerCompanyCode:"",buyerCompanyTaxNumber:"",buyerCleintName:"",buyerCompanyEmail:"",buyerCompanyPhoneNumber:"",buyerCompanyBankName:"",buyerCompanyBankAccountNumber:"",productName:"",tax:0,priceWithOutTax:0,quantity:1,description:""}),[eG,eq]=(0,t.useState)(!1),[eW,eX]=(0,t.useState)(!1),[e$,eY]=(0,t.useState)(null),[eK,eZ]=(0,t.useState)([]),[eQ,e0]=(0,t.useState)(null),[e1,e2]=(0,t.useState)(null),[e4,e3]=(0,t.useState)(null),e6=(0,t.useRef)(null),[e5,e8]=(0,t.useState)([]),[e7,e9]=(0,t.useState)(!1),[le,ll]=(0,t.useState)([]),[lt,la]=(0,t.useState)(!1),ls=(0,t.useRef)(null),[ln,lr]=(0,t.useState)(null),li=(0,t.useRef)(null),[lc,ld]=(0,t.useState)(!1),[lo,lu]=(0,t.useState)(!1),[lm,lx]=(0,t.useState)(null),[lh,lp]=(0,t.useState)(null),[lj,lv]=(0,t.useState)(null),[ly,lN]=(0,t.useState)(null),lg=(0,t.useRef)(null);(0,t.useEffect)(()=>{eE(e=>{var l;return{...e,clientId:eo?String(eo):null!=(l=e.clientId)?l:""}})},[eo,eu]);let lf=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=localStorage.getItem("accessToken")||"";return l?{Authorization:"Bearer ".concat(l),...e}:e},lb=e=>{let l=[];return e&&(e.invoiceNumber&&l.push("".concat(U,"/api/invoices/").concat(encodeURIComponent(String(e.invoiceNumber)))),void 0!==e.id&&null!==e.id&&l.push("".concat(U,"/api/invoices/").concat(encodeURIComponent(String(e.id))))),l},lw=async e=>{var l,t,a;ej(!0),ey(null),eg(null);try{let a=null!=(l=null!=e?e:eo)?l:null;if(!a){eh([]),ey("No client specified (pass invoicesProp or clientId)"),ej(!1);return}let s=["".concat(U,"/api/invoices/client/").concat(encodeURIComponent(String(a))),"/api/invoices/client/".concat(encodeURIComponent(String(a))),"".concat(U,"/api/finance/invoices?clientId=").concat(encodeURIComponent(String(a))),"/api/finance/invoices?clientId=".concat(encodeURIComponent(String(a)))],n=null;for(let e of s)try{let l=await fetch(e,{headers:lf(),cache:"no-store"});if(401===l.status||403===l.status){let e=await l.text().catch(()=>"");ey("Auth error ".concat(l.status,". Check access token.")),eh([]),eg(e||null),ej(!1);return}if(!l.ok){n={url:e,status:l.status,text:await l.text().catch(()=>"")};continue}let a=await B(l);if(Array.isArray(a.parsed)){eh(a.parsed),ej(!1);return}if("string"==typeof a.raw)try{let e=JSON.parse(a.raw);if(Array.isArray(e)){eh(e),ej(!1);return}}catch(e){}if(a.parsed&&"object"==typeof a.parsed){let e=a.parsed;if(Array.isArray(e.invoices)){eh(e.invoices),ej(!1);return}if(Array.isArray(e.items)){eh(e.items),ej(!1);return}}eg(null!=(t=a.raw)?t:null),eh([]),ey("Server returned unexpected payload. See rawResponse for details."),ej(!1);return}catch(e){n=e;continue}eh([]),ey("All fetch attempts failed. Last error: ".concat(JSON.stringify(n)))}catch(e){eh([]),ey(null!=(a=null==e?void 0:e.message)?a:"Failed to fetch invoices")}finally{ej(!1)}};(0,t.useEffect)(()=>{if(eu&&Array.isArray(eu)){eh(eu),ej(!1),ey(null);return}if(eo)return void lw(eo);eh([]),ej(!1),ey("No client specified (pass invoicesProp or clientId)")},[eo,eu]);let lC=async()=>{e9(!0);try{let e=await fetch("".concat(U,"/projects/AllProject"),{headers:lf()});if(!e.ok){e8([]),e9(!1);return}let l=await e.text(),t=null;try{t=JSON.parse(l)}catch(e){t=null}if(Array.isArray(t))e8(t);else try{let e=JSON.parse(String(null!=t?t:l));Array.isArray(e)?e8(e):e8([])}catch(e){e8([])}}catch(e){console.error("fetchProjectsList",e),e8([])}finally{e9(!1)}},lS=async()=>{la(!0);try{let e=await fetch("".concat(U,"/clients"),{headers:lf()});if(!e.ok){ll([]),la(!1);return}let l=await e.text(),t=null;try{t=JSON.parse(l)}catch(e){t=null}if(Array.isArray(t))ll(t);else try{let e=JSON.parse(String(null!=t?t:l));Array.isArray(e)?ll(e):ll([])}catch(e){ll([])}}catch(e){console.error("fetchClientsList",e),ll([])}finally{la(!1)}};(0,t.useEffect)(()=>{lC(),lS()},[]),(0,t.useEffect)(()=>{let e=e=>{let l=e.target;!(!l||lg.current&&lg.current.contains(l)||e6.current&&e6.current.contains(l)||l.closest(".invoice-action-button"))&&(l.closest(".receipt-action-button")||(lv(null),lN(null),e2(null),e3(null)))},l=()=>{lv(null),lN(null),e2(null),e3(null)};return document.addEventListener("click",e),window.addEventListener("scroll",l,!0),window.addEventListener("resize",l),()=>{document.removeEventListener("click",e),window.removeEventListener("scroll",l,!0),window.removeEventListener("resize",l)}},[]);let lk=async()=>{var e,l,t,a;if(!lm)return void lp("Please choose a file first");let s=li.current;if(!s)return void lp("Upload target not set");ld(!0),lp(null);try{let t=null!=(l=null!=(e=s.invoiceNumber)?e:s.id)?l:null;if(!t)throw Error("Invoice number not available for upload");let a="".concat(U,"/api/invoices/").concat(encodeURIComponent(String(t)),"/files"),n=new FormData;n.append("file",lm);let r=await fetch(a,{method:"POST",headers:lf(),body:n});if(!r.ok){let e=await r.text().catch(()=>"");throw Error("Upload failed ".concat(r.status," ").concat(e))}let i=await r.text().catch(()=>""),c=null;try{let e=JSON.parse(i);"string"==typeof e?c=e:e&&"string"==typeof e.url&&(c=e.url)}catch(e){"string"==typeof i&&i.trim().length>0&&(c=i.trim())}eu&&"function"==typeof em?em(null):await lw(eo),eG&&eQ&&((e,l)=>{var t,a,s,n,r,i;if(!e||!l)return!1;let c=null!=(s=null!=(a=null!=(t=e.id)?t:e.invoiceId)?a:e.invoiceNumber)?s:null,d=null!=(i=null!=(r=null!=(n=l.id)?n:l.invoiceId)?r:l.invoiceNumber)?i:null;return null!=c&&null!=d&&String(c)===String(d)})(eQ,s)&&await lM(eQ),c&&eh(e=>e.map(e=>{var l,t,a,n;let r=null!=(t=null!=(l=e.id)?l:e.invoiceNumber)?t:null,i=null!=(n=null!=(a=s.id)?a:s.invoiceNumber)?n:null;if(null!=r&&null!=i&&String(r)===String(i)){let l=Array.isArray(e.files)?[...e.files]:[];l.unshift({url:c,name:lm.name});let t=Array.isArray(e.fileUrls)?[...e.fileUrls]:[];return t.includes(c)||t.unshift(c),{...e,files:l,fileUrls:t}}return e})),alert("Upload successful"),lu(!1),li.current=null,lx(null)}catch(e){lp(null!=(t=null==e?void 0:e.message)?t:"Upload failed"),alert(null!=(a=null==e?void 0:e.message)?a:"Upload failed")}finally{ld(!1)}};(0,t.useEffect)(()=>{ln&&(async()=>{let e=li.current;if(!e){alert("Upload target not set"),lr(null);return}ld(!0);try{let l=lb(e)[0];if(!l)throw Error("Cannot determine invoice resource for upload");let t=new FormData;t.append("file",ln);let a=await fetch("".concat(l,"/files"),{method:"POST",headers:lf(),body:t});if(!a.ok){let e=await a.text().catch(()=>"");throw Error("Upload failed ".concat(a.status," ").concat(e))}eu&&"function"==typeof em?em(null):await lw(eo),alert("Upload successful")}catch(e){var l;alert(null!=(l=null==e?void 0:e.message)?l:"Upload failed")}finally{lr(null),ld(!1),li.current=null,lv(null),lN(null)}})()},[ln]);let lA=async e=>{if(!e)return e;for(let a of lb(e))try{var l,t;let s=await fetch(a,{headers:lf(),cache:"no-store"});if(!s.ok)continue;let n=await B(s);return null!=(t=null!=(l=n.parsed)?l:n.raw)?t:e}catch(e){}return e},lD=async e=>{eC(await lA(e)),ek(!0),lv(null),lN(null)},lI=async()=>{var e,l,t;eT(!0);try{let t={invoiceNumber:eP.invoiceNumber||void 0,invoiceDate:eP.invoiceDate||void 0,currency:eP.currency,projectId:eP.projectId||void 0,clientId:eP.clientId||String(null!=(e=null!=eo?eo:eP.clientId)?e:""),amount:Number(eP.amount||0),tax:Number(eP.taxPercent||0),discount:Number(eP.discountValue||0),discountIsPercent:!!eP.discountIsPercent,notes:eP.notes||void 0},a=await fetch("".concat(U,"/api/invoices"),{method:"POST",headers:lf({"Content-Type":"application/json"}),body:JSON.stringify(t)});if(!a.ok){let e=await a.text().catch(()=>"");throw Error("Create failed: ".concat(a.status," ").concat(e))}let s=null!=(l=(await B(a)).parsed)?l:null;if(eu&&"function"==typeof em?em(s):await lw(eo),eD(!1),eE(e=>({...e,invoiceNumber:"",invoiceDate:"",projectId:"",amount:0,taxPercent:10,discountValue:0,discountIsPercent:!0,notes:""})),(null==s?void 0:s.id)||(null==s?void 0:s.invoiceNumber)){let e=await lA(s);eC(e),ek(!0)}}catch(e){alert(null!=(t=null==e?void 0:e.message)?t:"Create failed")}finally{eT(!1),lv(null),lN(null)}},lT=async e=>{var l,t,a,s,n,r,i,c,d,o,u,m,x;let h=await lA(e);eR({id:null!=(a=null!=(t=h.id)?t:h.invoiceNumber)?a:null,invoiceNumber:null!=(s=h.invoiceNumber)?s:"",invoiceDate:null!=(n=h.invoiceDate)?n:"",currency:null!=(r=h.currency)?r:"USD",projectId:null!=(c=null!=(i=null==(l=h.project)?void 0:l.projectId)?i:h.projectId)?c:"",amount:null!=(o=null!=(d=h.amount)?d:h.total)?o:0,tax:null!=(u=h.tax)?u:0,discount:null!=(m=h.discount)?m:0,notes:null!=(x=h.notes)?x:""}),eB(!0),lv(null),lN(null)},lP=async()=>{if(eF){eL(!0);try{let e=[];eF.id&&e.push("".concat(U,"/api/invoices/").concat(encodeURIComponent(String(eF.id)))),eF.invoiceNumber&&e.push("".concat(U,"/api/invoices/").concat(encodeURIComponent(String(eF.invoiceNumber))));let l=!1;for(let t of e)try{if(!(await fetch(t,{method:"PUT",headers:lf({"Content-Type":"application/json"}),body:JSON.stringify({invoiceNumber:eF.invoiceNumber,invoiceDate:eF.invoiceDate,currency:eF.currency,projectId:eF.projectId,amount:Number(eF.amount||0),tax:Number(eF.tax||0),discount:Number(eF.discount||0),notes:eF.notes||void 0})})).ok)continue;l=!0;break}catch(e){}if(!l)throw Error("Edit/save failed (no supported endpoint)");eu&&"function"==typeof em?em(null):await lw(eo),eB(!1)}catch(l){var e;alert(null!=(e=null==l?void 0:l.message)?e:"Save failed")}finally{eL(!1),lv(null),lN(null)}}},lE=e=>{eC(e),lv(null),lN(null);let l=prompt("Credit amount:");if(!l)return;let t=Number(l);if(isNaN(t)||t<=0)return alert("Invalid amount");(async()=>{try{let l=lb(e)[0];if(l&&!(await fetch("".concat(l,"/credit-note"),{method:"POST",headers:lf({"Content-Type":"application/json"}),body:JSON.stringify({amount:t})})).ok)throw Error("Credit creation failed");eu&&"function"==typeof em?em(null):await lw(eo),alert("Credit created")}catch(e){var l;alert(null!=(l=null==e?void 0:e.message)?l:"Credit failed")}})()},lU=async e=>{if(!e||!confirm("Mark this invoice as paid?"))return;let l=!1;for(let t of lb(e))try{if((await fetch("".concat(t,"/mark-paid"),{method:"POST",headers:lf()})).ok){l=!0;break}}catch(e){}if(!l)return alert("Mark paid failed (endpoint not supported?)");eu&&"function"==typeof em?em(null):await lw(eo),lv(null),lN(null)},lB=async e=>{if(!e||!confirm("Delete this invoice?"))return;let l=!1;for(let t of lb(e))try{if((await fetch(t,{method:"DELETE",headers:lf()})).ok){l=!0;break}}catch(e){}if(!l)return alert("Delete failed (endpoint missing?)");eu&&"function"==typeof em?em(null):await lw(eo),lv(null),lN(null)},lO=e=>{var l,t,a,s,n,r,i,c,d,o,u;eE({invoiceNumber:"",invoiceDate:null!=(a=null==e?void 0:e.invoiceDate)?a:"",currency:null!=(s=null==e?void 0:e.currency)?s:"USD",projectId:null!=(n=null==e||null==(l=e.project)?void 0:l.projectId)?n:"",clientId:null!=(r=null==e||null==(t=e.client)?void 0:t.clientId)?r:eo?String(eo):"",amount:null!=(c=null!=(i=null==e?void 0:e.amount)?i:null==e?void 0:e.total)?c:0,taxPercent:null!=(d=null==e?void 0:e.tax)?d:0,discountValue:null!=(o=null==e?void 0:e.discount)?o:0,discountIsPercent:!0,notes:null!=(u=null==e?void 0:e.notes)?u:""}),eD(!0),lv(null),lN(null)},lL=e=>{let l=prompt("Payment amount:");if(!l)return;let t=Number(l);if(isNaN(t)||t<=0)return alert("Invalid amount");(async()=>{var l,a,s;try{let s=lb(e)[0];if(!s)throw Error("Cannot determine invoice endpoint for payment");if(!(await fetch("".concat(s,"/payments"),{method:"POST",headers:lf({"Content-Type":"application/json"}),body:JSON.stringify({amount:t,note:"Manual payment added via UI"})})).ok&&!(await fetch("".concat(U,"/api/payments"),{method:"POST",headers:lf({"Content-Type":"application/json"}),body:JSON.stringify({invoiceId:null!=(l=e.id)?l:null,invoiceNumber:null!=(a=e.invoiceNumber)?a:null,amount:t})})).ok)throw Error("Payment creation failed");eu&&"function"==typeof em?em(null):await lw(eo),alert("Payment added")}catch(e){alert(null!=(s=null==e?void 0:e.message)?s:"Add payment failed")}finally{lv(null),lN(null)}})()},lF=async e=>{var l,t;try{let t=lb(e)[0];if(!t)throw Error("Cannot determine invoice endpoint for payments");let a=await fetch("".concat(t,"/payments"),{headers:lf()});if(!a.ok)return void alert("Payments not available");let s=null!=(l=(await B(a)).parsed)?l:[];alert("Payments:\n"+JSON.stringify(s,null,2))}catch(e){alert(null!=(t=null==e?void 0:e.message)?t:"View payments failed")}finally{lv(null),lN(null)}},lR=async e=>{if(e&&confirm("Send payment reminder?"))try{let l=lb(e)[0];if(!l)throw Error("Cannot determine invoice endpoint for reminder");if(!(await fetch("".concat(l,"/reminder"),{method:"POST",headers:lf()})).ok)throw Error("Reminder send failed");alert("Reminder sent")}catch(e){var l;alert(null!=(l=null==e?void 0:e.message)?l:"Send reminder failed")}finally{lv(null),lN(null)}},lz=e=>{li.current=e,eJ(l=>{var t,a,s,n,r,i,c,d,o,u,m,x,h,p;return{...l,invoiceNumber:null!=(r=null==e?void 0:e.invoiceNumber)?r:l.invoiceNumber,issueDate:l.issueDate,currency:null!=(i=null==e?void 0:e.currency)?i:l.currency,sellerCompanyName:l.sellerCompanyName,sellerCompanyAddress:l.sellerCompanyAddress,productName:null!=(c=null==e||null==(t=e.project)?void 0:t.projectName)?c:l.productName,priceWithOutTax:null!=(o=null!=(d=null==e?void 0:e.amount)?d:null==e?void 0:e.total)?o:l.priceWithOutTax,tax:null!=(u=null==e?void 0:e.tax)?u:l.tax,quantity:l.quantity,description:null!=(m=null==e?void 0:e.notes)?m:l.description,buyerCleintName:null!=(x=null==e||null==(a=e.client)?void 0:a.name)?x:l.buyerCleintName,buyerCompanyEmail:null!=(h=null==e||null==(s=e.client)?void 0:s.email)?h:l.buyerCompanyEmail,buyerCompanyPhoneNumber:null!=(p=null==e||null==(n=e.client)?void 0:n.mobile)?p:l.buyerCompanyPhoneNumber}}),eM(!0),lv(null),lN(null)},lM=async e=>{var l,t,a,s,n,r;eY(null),eZ([]),eX(!0);try{if(!(null!=(s=null!=(a=null!=(t=null==e?void 0:e.id)?t:null==e?void 0:e.invoiceId)?a:null==e?void 0:e.invoiceNumber)?s:null))throw Error("Invoice id not available");let n="".concat(U,"/api/invoice/receipt/").concat(e.invoiceNumber),r=await fetch(n,{headers:lf()});if(!r.ok){let e=await r.text().catch(()=>"");throw Error("Receipts fetch failed ".concat(r.status," ").concat(e))}let i=await B(r),c=[];if(Array.isArray(i.parsed))c=i.parsed;else if(Array.isArray(null==(l=i.parsed)?void 0:l.data))c=i.parsed.data;else if(Array.isArray(i.raw))c=i.raw;else if("string"==typeof i.raw)try{let e=JSON.parse(i.raw);Array.isArray(e)&&(c=e)}catch(e){}eZ(c),e0(e),eq(!0)}catch(e){eY(null!=(n=null==e?void 0:e.message)?n:"Failed to fetch receipts"),alert(null!=(r=null==e?void 0:e.message)?r:"Failed to fetch receipts")}finally{eX(!1),lv(null),lN(null)}},lV=async e=>{var l,t;try{let t=lb(e)[0];if(!t)throw Error("Cannot determine invoice endpoint for credits");let a=await fetch("".concat(t,"/credit-notes"),{headers:lf()});if(!a.ok)return void alert("Credits not available");let s=null!=(l=(await B(a)).parsed)?l:[];alert("Credit notes:\n"+JSON.stringify(s,null,2))}catch(e){alert(null!=(t=null==e?void 0:e.message)?t:"View credits failed")}finally{lv(null),lN(null)}},lH=(0,t.useMemo)(()=>{let e=ef.trim().toLowerCase();return e?ex.filter(l=>{var t,a,s,n,r,i,c;return!!l&&(String(null!=(n=l.invoiceNumber)?n:"").toLowerCase().includes(e)||String(null!=(i=null!=(r=null==(t=l.project)?void 0:t.projectName)?r:null==(a=l.project)?void 0:a.projectCode)?i:"").toLowerCase().includes(e)||String(null!=(c=null==(s=l.client)?void 0:s.name)?c:"").toLowerCase().includes(e))}):ex},[ex,ef]),l_=Number(eP.amount||0),lJ=eP.discountIsPercent?l_*(Number(eP.discountValue||0)/100):Number(eP.discountValue||0),lG=(l_-lJ)*(Number(eP.taxPercent||0)/100),lq=Math.max(0,l_-lJ+lG),lW=e=>{var l,t;if(!e)return null;let a=e=>{var l,t,a,s;return e?"string"==typeof e?e:null!=(s=null!=(a=null!=(t=null!=(l=e.url)?l:e.fileUrl)?t:e.path)?a:e.downloadUrl)?s:null:null};return a(Array.isArray(e.fileUrls)&&e.fileUrls.length>0?e.fileUrls[e.fileUrls.length-1]:Array.isArray(e.files)&&e.files.length>0?e.files[e.files.length-1]:Array.isArray(e.attachments)&&e.attachments.length>0?e.attachments[e.attachments.length-1]:Array.isArray(e.filesList)&&e.filesList.length>0?e.filesList[e.filesList.length-1]:null!=(t=null!=(l=e.fileUrl)?l:e.downloadUrl)?t:null)},lX=async()=>{var e,l,t,a,s;eH(!0);try{let s={invoiceId:e_.invoiceNumber||(null!=(l=null==(e=li.current)?void 0:e.invoiceNumber)?l:void 0),issueDate:e_.issueDate||void 0,currency:e_.currency||void 0,sellerCompanyName:e_.sellerCompanyName,sellerCompanyAddress:e_.sellerCompanyAddress,sellerCompanyCode:e_.sellerCompanyCode,sellerCompanyTaxNumber:e_.sellerCompanyTaxNumber,sellerCompanyEmail:e_.sellerCompanyEmail,sellerCompanyPhoneNumber:e_.sellerCompanyPhoneNumber,sellerCompanyBankName:e_.sellerCompanyBankName,sellerCompanyBankAccountNumber:e_.sellerCompanyBankAccountNumber,buyerCompanyName:e_.buyerCompanyName,buyerCompanyAddress:e_.buyerCompanyAddress,buyerCompanyCode:e_.buyerCompanyCode,buyerCompanyTaxNumber:e_.buyerCompanyTaxNumber,buyerCleintName:e_.buyerCleintName,buyerCompanyEmail:e_.buyerCompanyEmail,buyerCompanyPhoneNumber:e_.buyerCompanyPhoneNumber,buyerCompanyBankName:e_.buyerCompanyBankName,buyerCompanyBankAccountNumber:e_.buyerCompanyBankAccountNumber,productName:e_.productName,tax:Number(e_.tax||0),priceWithOutTax:Number(e_.priceWithOutTax||0),quantity:Number(e_.quantity||1),description:e_.description},n=await fetch("".concat(U,"/api/invoice"),{method:"POST",headers:lf({"Content-Type":"application/json"}),body:JSON.stringify(s)});if(!n.ok){let e=await n.text().catch(()=>"");throw Error("Save failed: ".concat(n.status," ").concat(e))}let r=await B(n),i=null!=(t=r.parsed)?t:null;if(!i&&"string"==typeof r.raw)try{i=JSON.parse(r.raw)}catch(e){i=null}eu&&"function"==typeof em?em(null):await lw(eo);let c=li.current;i&&(eG&&eQ&&((e,l)=>{var t,a,s,n,r,i;if(!e||!l)return!1;let c=null!=(s=null!=(a=null!=(t=e.id)?t:e.invoiceId)?a:e.invoiceNumber)?s:null,d=null!=(i=null!=(r=null!=(n=l.id)?n:l.invoiceId)?r:l.invoiceNumber)?i:null;return null!=c&&null!=d&&String(c)===String(d)})(eQ,null!=(a=li.current)?a:i)?eZ(e=>[i,...e]):c&&(e0(c),eZ(e=>[i,...e]),eq(!0))),eM(!1),alert("Receipt created")}catch(e){alert(null!=(s=null==e?void 0:e.message)?s:"Save receipt failed")}finally{li.current=null,eH(!1),lv(null),lN(null)}},l$=async e=>{var l,t,a;if(e&&confirm("Delete this receipt?"))try{let a=null!=(t=null!=(l=e.id)?l:e.invoiceId)?t:null;if(!a)throw Error("Receipt id not available for delete");let s="".concat(U,"/api/invoice/").concat(encodeURIComponent(String(a))),n=await fetch(s,{method:"DELETE",headers:lf()});if(!n.ok){let e=await n.text().catch(()=>"");throw Error("Delete failed ".concat(n.status," ").concat(e))}eZ(e=>e.filter(e=>{var l,t,s;let n=null!=(s=null!=(t=null!=(l=e.id)?l:e.invoiceId)?t:e.invoiceNumber)?s:null;return String(n)!==String(a)})),e2(null),e3(null),alert("Receipt deleted")}catch(e){alert(null!=(a=null==e?void 0:e.message)?a:"Delete failed")}},lY=e=>{var l,t,a;return null!=(a=null!=(t=null!=(l=e._downloadUrl)?l:e.downloadUrl)?t:e.fileUrl)?a:null};return(0,l.jsxs)(m.Card,{children:[(0,l.jsxs)(m.CardHeader,{className:"flex items-center justify-between",children:[(0,l.jsx)(m.CardTitle,{children:"Client Invoices"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(n.Button,{onClick:()=>{eD(!0),eE(e=>{var l;return{...e,clientId:String(null!=(l=null!=eo?eo:e.clientId)?l:"")}})},className:"flex items-center",children:[(0,l.jsx)(g.Plus,{className:"mr-2 h-4 w-4"})," Create Invoice"]}),(0,l.jsx)(n.Button,{variant:"ghost",onClick:async()=>{eu&&"function"==typeof em?em(null):await lw(eo),eG&&eQ&&await lM(eQ)},children:"Refresh"})]})]}),(0,l.jsxs)(m.CardContent,{children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,l.jsx)("div",{children:(0,l.jsx)("input",{placeholder:"Search invoice number / project / client",className:"w-64 px-3 py-2 border rounded",value:ef,onChange:e=>eb(e.target.value)})}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:ep?"Loading...":"".concat(ex.length," invoices")})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-blue-50 text-left text-xs",children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"Invoice #"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Date"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Project"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Currency"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Total"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Unpaid"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Status"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Action"})]})}),(0,l.jsx)("tbody",{children:ep?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:8,className:"text-center py-8",children:"Loading invoices..."})}):ev?(0,l.jsx)("tr",{children:(0,l.jsxs)("td",{colSpan:8,className:"text-center py-8 text-red-600",children:[ev,eN&&(0,l.jsx)("div",{className:"mt-2 text-xs text-gray-600",children:(0,l.jsx)("pre",{className:"whitespace-pre-wrap",children:eN})})]})}):0===lH.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:8,className:"text-center py-8",children:"No invoices found"})}):lH.map(e=>{var t,a,s,n,r,i,c,d,o,u,m;let x=null!=(n=null!=(s=e.id)?s:e.invoiceNumber)?n:Math.random();return(0,l.jsxs)("tr",{className:"border-t hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-4 py-3",children:null!=(r=e.invoiceNumber)?r:"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:e.invoiceDate?new Date(e.invoiceDate).toLocaleDateString():"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:null!=(c=null!=(i=null==(t=e.project)?void 0:t.projectName)?i:null==(a=e.project)?void 0:a.projectCode)?c:"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:null!=(d=e.currency)?d:"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:"number"==typeof e.total?e.total.toLocaleString(void 0,{minimumFractionDigits:2}):e.total?String(e.total):"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:"number"==typeof e.unpaidAmount?e.unpaidAmount.toLocaleString(void 0,{minimumFractionDigits:2}):e.unpaidAmount?String(e.unpaidAmount):"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsx)(v.Badge,{variant:"secondary",children:null!=(o=e.status)?o:"—"})}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsx)("div",{className:"flex items-center gap-2 relative",children:(0,l.jsx)("button",{className:"invoice-action-button inline-flex items-center px-2 py-1 border rounded",onClick:l=>{var t,a;l.stopPropagation();let s=l.currentTarget;lj&&(null!=(t=lj.id)?t:lj.invoiceNumber)===(null!=(a=e.id)?a:e.invoiceNumber)?(lv(null),lN(null)):((e,l)=>{if(!l)return;let t=l.getBoundingClientRect(),a=t.right-260;a<8&&(a=t.left);let s=t.bottom+window.scrollY+6,n=window.scrollX+window.innerWidth-260-8;a+window.scrollX>n&&(a=Math.max(window.scrollX+8,n)),lN({left:Math.max(a,window.scrollX+8),top:s}),lv(e)})(e,s)},title:"Actions","aria-expanded":lj&&(null!=(u=lj.id)?u:lj.invoiceNumber)===(null!=(m=e.id)?m:e.invoiceNumber),children:(0,l.jsx)(N.MoreHorizontal,{className:"h-4 w-4"})})})})]},x)})})]})})]}),lj&&ly&&(0,l.jsx)("div",{ref:lg,style:{position:"fixed",left:"".concat(ly.left,"px"),top:"".concat(ly.top,"px"),width:260,zIndex:10050,boxShadow:"0 8px 24px rgba(0,0,0,0.12)"},className:"bg-white border rounded overflow-hidden",onClick:e=>e.stopPropagation(),children:(0,l.jsx)("ul",{children:(e=>{var t,a;return(e=>{var l;if(!e)return!1;let t=String(null!=(l=null==e?void 0:e.status)?l:"").toLowerCase();return!!(t.includes("credit")||t.includes("creditnote")||t.includes("credit-note")||e.isCreditNote||Array.isArray(e.creditNotes)&&e.creditNotes.length>0)})(e)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lD(e),children:[(0,l.jsx)(k.Eye,{className:"inline mr-2 -mt-1"})," View"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lL(e),children:[(0,l.jsx)(I,{className:"inline mr-2 -mt-1"})," Add Payment"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lF(e),children:[(0,l.jsx)(A,{className:"inline mr-2 -mt-1"})," View Payment(s)"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>(e=>{var l,t;let a=prompt("Credit amount for duplicate:",String(null!=(t=null!=(l=e.unpaidAmount)?l:e.total)?t:0));if(!a)return;let s=Number(a);if(isNaN(s)||s<=0)return alert("Invalid amount");(async()=>{try{let l=lb(e)[0];if(!l)throw Error("Cannot determine credit endpoint");if(!(await fetch("".concat(l,"/credit-note"),{method:"POST",headers:lf({"Content-Type":"application/json"}),body:JSON.stringify({amount:s})})).ok)throw Error("Credit duplicate failed");eu&&"function"==typeof em?em(null):await lw(eo),alert("Credit created")}catch(e){var l;alert(null!=(l=null==e?void 0:e.message)?l:"Credit failed")}finally{lv(null),lN(null)}})()})(e),children:[(0,l.jsx)(C.Copy,{className:"inline mr-2 -mt-1"})," Credit Duplicate"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>lB(e),children:[(0,l.jsx)(b.Trash,{className:"inline mr-2 -mt-1"})," Delete"]})})]}):e&&(String(null!=(t=null==e?void 0:e.status)?t:"").toLowerCase().includes("paid")||"number"==typeof e.unpaidAmount&&0===e.unpaidAmount||"number"==typeof e.total&&"number"==typeof e.paidAmount&&e.total<=(null!=(a=e.paidAmount)?a:0))?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lD(e),children:[(0,l.jsx)(k.Eye,{className:"inline mr-2 -mt-1"})," View"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lz(e),children:[(0,l.jsx)(I,{className:"inline mr-2 -mt-1"})," Add Receipt"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lM(e),children:[(0,l.jsx)(i.FileText,{className:"inline mr-2 -mt-1"})," View Receipt(s)"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>{li.current=e,lx(null),lp(null),lu(!0),lv(null),lN(null)},children:[(0,l.jsx)(w.Upload,{className:"inline mr-2 -mt-1"})," Upload File"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lF(e),children:[(0,l.jsx)(A,{className:"inline mr-2 -mt-1"})," View Payment(s)"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lE(e),children:[(0,l.jsx)(i.FileText,{className:"inline mr-2 -mt-1"})," Add Credit"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lV(e),children:[(0,l.jsx)(i.FileText,{className:"inline mr-2 -mt-1"})," View Credit(s)"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>lB(e),children:[(0,l.jsx)(b.Trash,{className:"inline mr-2 -mt-1"})," Delete"]})})]}):(e=>{var l;if(!e)return!1;let t=String(null!=(l=null==e?void 0:e.status)?l:"").toLowerCase();return!!(t.includes("unpaid")||t.includes("partial")||t.includes("partially"))||"number"==typeof e.unpaidAmount&&!!(e.unpaidAmount>0)})(e)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lD(e),children:[(0,l.jsx)(k.Eye,{className:"inline mr-2 -mt-1"})," View"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lT(e),children:[(0,l.jsx)(S.Edit2,{className:"inline mr-2 -mt-1"})," Edit"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lU(e),children:[(0,l.jsx)(f.CheckCircle,{className:"inline mr-2 -mt-1"})," Mark as Paid"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lL(e),children:[(0,l.jsx)(I,{className:"inline mr-2 -mt-1"})," Add Payment"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lR(e),children:[(0,l.jsx)(D.Bell,{className:"inline mr-2 -mt-1"})," Payment Reminder"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lE(e),children:[(0,l.jsx)(i.FileText,{className:"inline mr-2 -mt-1"})," Credit"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lO(e),children:[(0,l.jsx)(C.Copy,{className:"inline mr-2 -mt-1"})," Duplicate"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>lB(e),children:[(0,l.jsx)(b.Trash,{className:"inline mr-2 -mt-1"})," Delete"]})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lD(e),children:[(0,l.jsx)(k.Eye,{className:"inline mr-2 -mt-1"})," View"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lT(e),children:[(0,l.jsx)(S.Edit2,{className:"inline mr-2 -mt-1"})," Edit"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>lO(e),children:[(0,l.jsx)(C.Copy,{className:"inline mr-2 -mt-1"})," Duplicate"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>lB(e),children:[(0,l.jsx)(b.Trash,{className:"inline mr-2 -mt-1"})," Delete"]})})]})})(lj)})}),(0,l.jsx)("input",{ref:ls,type:"file",style:{display:"none"},onChange:e=>{var l,t;let a=null!=(t=null==(l=e.target.files)?void 0:l[0])?t:null;a&&(lx(a),lp(null)),e.currentTarget.value=""}}),eS&&ew&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-auto p-6",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{ek(!1),eC(null)}}),(0,l.jsxs)("div",{className:"relative z-10 w-full max-w-4xl bg-white rounded shadow-lg overflow-auto",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Invoice Details"}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>{ek(!1),eC(null)},children:(0,l.jsx)(P.X,{className:"h-4 w-4"})})})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("div",{className:"text-sm font-semibold mb-2",children:"Client Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm text-gray-700",children:[(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-28 text-gray-500",children:"Name"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(H=null==(r=ew.client)?void 0:r.name)?H:"—"})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-28 text-gray-500",children:"Email"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(J=null!=(_=null==(c=ew.client)?void 0:c.email)?_:null==(d=ew.client)?void 0:d.contactEmail)?J:"—"})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-28 text-gray-500",children:"Company Name"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(q=null!=(G=null==(u=ew.client)||null==(o=u.company)?void 0:o.companyName)?G:null==(x=ew.client)?void 0:x.companyName)?q:"—"})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-28 text-gray-500",children:"Mobile"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(X=null!=(W=null==(h=ew.client)?void 0:h.mobile)?W:null==(p=ew.client)?void 0:p.phone)?X:"—"})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-28 text-gray-500",children:"Address"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(Y=null!=($=null==(j=ew.client)?void 0:j.address)?$:null==(y=ew.client)?void 0:y.street)?Y:"—"})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-28 text-gray-500",children:"Country"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(K=null==(O=ew.client)?void 0:O.country)?K:"—"})]})]})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("div",{className:"text-sm font-semibold mb-2",children:"Project Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm text-gray-700",children:[(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-32 text-gray-500",children:"Project Name"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(Q=null!=(Z=null==(L=ew.project)?void 0:L.projectName)?Z:null==(F=ew.project)?void 0:F.name)?Q:"—"})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-32 text-gray-500",children:"Project Code"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(el=null!=(ee=null==(R=ew.project)?void 0:R.projectCode)?ee:null==(z=ew.project)?void 0:z.code)?el:"—"})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-32 text-gray-500",children:"Start Date"}),(0,l.jsx)("div",{className:"font-medium",children:(null==(M=ew.project)?void 0:M.startDate)?new Date(ew.project.startDate).toLocaleDateString():ew.startDate?new Date(ew.startDate).toLocaleDateString():"—"})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{className:"w-32 text-gray-500",children:"End Date"}),(0,l.jsx)("div",{className:"font-medium",children:(null==(V=ew.project)?void 0:V.endDate)?new Date(ew.project.endDate).toLocaleDateString():ew.endDate?new Date(ew.endDate).toLocaleDateString():"—"})]})]})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("div",{className:"text-sm font-semibold mb-3",children:"Invoice Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-700",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Invoice No."}),(0,l.jsx)("div",{className:"font-medium",children:null!=(ea=null!=(et=ew.invoiceNumber)?et:ew.id)?ea:"—"})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Invoice Date"}),(0,l.jsx)("div",{className:"font-medium",children:ew.invoiceDate?new Date(ew.invoiceDate).toLocaleDateString():"—"})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Currency"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(es=ew.currency)?es:"—"})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Amount"}),(0,l.jsx)("div",{className:"font-medium",children:"number"==typeof ew.amount?(ew.currency?"".concat(ew.currency," "):"")+Number(ew.amount).toLocaleString():null!=(en=ew.total)?en:"—"})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Tax"}),(0,l.jsx)("div",{className:"font-medium",children:(null!=(er=ew.tax)?er:ew.taxPercent)?"".concat(null!=(ei=ew.tax)?ei:ew.taxPercent,"%"):"—"})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Subtotal"}),(0,l.jsx)("div",{className:"font-medium",children:"number"==typeof ew.subtotal?ew.subtotal:ew.amount?Number(ew.amount).toLocaleString():"—"})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Discount"}),(0,l.jsx)("div",{className:"font-medium",children:null!=(ec=ew.discount)?ec:"0.00"})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Total Amount"}),(0,l.jsx)("div",{className:"font-medium",children:"number"==typeof ew.total?ew.total:ew.amount?Number(ew.amount).toLocaleString():"—"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Status"}),(0,l.jsx)("div",{children:ew.status?(0,l.jsx)(v.Badge,{children:ew.status}):"—"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:"Files"}),(0,l.jsx)("div",{className:"w-full h-40 bg-gray-50 rounded overflow-hidden border relative flex items-center justify-center",children:lW(ew)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("img",{src:lW(ew),alt:"file",className:"object-cover w-full h-full"}),(0,l.jsx)("a",{href:lW(ew),target:"_blank",rel:"noreferrer",className:"absolute top-2 right-2 bg-white rounded p-1 shadow",title:"Download",children:(0,l.jsx)(T.Download,{className:"h-4 w-4"})})]}):(0,l.jsx)("div",{className:"text-xs text-gray-400",children:"No files attached"})}),(ew.files&&ew.files.length>0||ew.attachments&&ew.attachments.length>0||ew.filesList&&ew.filesList.length>0||ew.fileUrls&&ew.fileUrls.length>0)&&(0,l.jsx)("div",{className:"mt-3 space-y-2 text-sm",children:(()=>{var e,t,a,s;let n=[],r=e=>{var l,t,a,s,r,i,c;if(!e)return;if("string"==typeof e)return void n.push({url:e,name:e.split("/").pop()});let d=null!=(s=null!=(a=null!=(t=null!=(l=e.url)?l:e.fileUrl)?t:e.path)?a:e.downloadUrl)?s:null,o=null!=(c=null!=(i=null!=(r=e.name)?r:e.filename)?i:e.fileName)?c:"string"==typeof d?d.split("/").pop():void 0;n.push({url:d,name:o})};return(null!=(e=ew.files)?e:[]).forEach(r),(null!=(t=ew.attachments)?t:[]).forEach(r),(null!=(a=ew.filesList)?a:[]).forEach(r),(null!=(s=ew.fileUrls)?s:[]).forEach(r),n.reverse().map((e,t)=>{var a;return e.url?(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)("div",{className:"text-gray-700 truncate",children:null!=(a=e.name)?a:"File ".concat(t+1)}),(0,l.jsxs)("a",{href:e.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center px-2 py-1 border rounded text-xs",children:[(0,l.jsx)(T.Download,{className:"h-3 w-3 mr-1"})," Download"]})]},t):null})})()})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"Notes"}),(0,l.jsx)("div",{className:"mt-2 text-sm text-gray-800",children:null!=(ed=ew.notes)?ed:"No notes"})]})]})]})]})]}),eG&&eQ&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-auto p-6",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{eq(!1),e0(null),eZ([])}}),(0,l.jsxs)("div",{className:"relative z-10 w-full max-w-4xl bg-white rounded shadow-lg overflow-auto",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Receipts"}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)(n.Button,{onClick:()=>lz(eQ),children:[(0,l.jsx)(g.Plus,{className:"mr-2 h-4 w-4"})," Add a Receipt"]}),(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>{eq(!1),e0(null),eZ([])},children:(0,l.jsx)(P.X,{className:"h-4 w-4"})})]})]}),(0,l.jsx)("div",{className:"p-6",children:eW?(0,l.jsx)("div",{className:"text-center py-8",children:"Loading receipts..."}):e$?(0,l.jsx)("div",{className:"text-red-600",children:e$}):(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-blue-50 text-left text-xs",children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"Invoice No."}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Project"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Client"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Amount"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Issue Date"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Action"})]})}),(0,l.jsx)("tbody",{children:0===eK.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:6,className:"text-center py-8",children:"No receipts found"})}):eK.map((e,t)=>{var a,s,n,r,i,c,d,o,u,m,x,h,p,j,v;let y=null!=(s=null!=(a=e.id)?a:e.invoiceId)?s:t,g=null!=(r=null!=(n=e.issueDate)?n:e.createdAt)?r:"—",f=null!=(o=null!=(d=null!=(c=null!=(i=e.totalAmount)?i:e.totalExcluidingTax)?c:e.subtotal)?d:e.priceWithOutTax)?o:0;return(0,l.jsxs)("tr",{className:"border-t hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-4 py-3",children:null!=(u=e.invoiceId)?u:"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:null!=(x=null!=(m=e.productName)?m:e.projectName)?x:"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:null!=(p=null!=(h=e.buyerCleintName)?h:e.buyerCompanyName)?p:"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:"number"==typeof f?(e.currency?"".concat(e.currency," "):"")+Number(f).toLocaleString(void 0,{minimumFractionDigits:2}):f}),(0,l.jsx)("td",{className:"px-4 py-3",children:g?new Date(g).toLocaleDateString():"—"}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2 relative",children:[lY(e)&&(0,l.jsx)("a",{href:lY(e),target:"_blank",rel:"noreferrer",className:"inline-flex items-center px-2 py-1 border rounded",title:"Download",children:(0,l.jsx)(T.Download,{className:"h-4 w-4"})}),(0,l.jsx)("button",{className:"receipt-action-button inline-flex items-center px-2 py-1 border rounded",onClick:l=>{var t,a;l.stopPropagation();let s=l.currentTarget;e1&&(null!=(t=e1.id)?t:e1.invoiceId)===(null!=(a=e.id)?a:e.invoiceId)?(e2(null),e3(null)):((e,l)=>{if(!l)return;let t=l.getBoundingClientRect(),a=t.right-220;a<8&&(a=t.left);let s=t.bottom+window.scrollY+6,n=window.scrollX+window.innerWidth-220-8;a+window.scrollX>n&&(a=Math.max(window.scrollX+8,n)),e3({left:Math.max(a,window.scrollX+8),top:s}),e2(e)})(e,s)},title:"Actions","aria-expanded":e1&&(null!=(j=e1.id)?j:e1.invoiceId)===(null!=(v=e.id)?v:e.invoiceId),children:(0,l.jsx)(N.MoreHorizontal,{className:"h-4 w-4"})})]})})]},y)})})]}),e1&&e4&&(0,l.jsx)("div",{ref:e6,style:{position:"fixed",left:"".concat(e4.left,"px"),top:"".concat(e4.top,"px"),width:220,zIndex:11e3,boxShadow:"0 8px 24px rgba(0,0,0,0.12)"},className:"bg-white border rounded overflow-hidden",onClick:e=>e.stopPropagation(),children:(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>{alert(JSON.stringify(e1,null,2)),e2(null),e3(null)},children:[(0,l.jsx)(k.Eye,{className:"inline mr-2 -mt-1"})," View"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>{let e=lY(e1);e?window.open(e,"_blank"):alert("No download URL available"),e2(null),e3(null)},children:[(0,l.jsx)(T.Download,{className:"inline mr-2 -mt-1"})," Download as PDF"]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>l$(e1),children:[(0,l.jsx)(b.Trash,{className:"inline mr-2 -mt-1"})," Delete"]})})]})})]})})]})]}),eA&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-auto p-6",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>eD(!1)}),(0,l.jsxs)("div",{className:"relative z-10 w-full max-w-3xl bg-white rounded shadow-lg overflow-auto",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Create Invoice"}),(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>eD(!1),children:"Close"})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Invoice Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Number"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:eP.invoiceNumber,onChange:e=>eE(l=>({...l,invoiceNumber:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Date"}),(0,l.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:eP.invoiceDate,onChange:e=>eE(l=>({...l,invoiceDate:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Currency"}),(0,l.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:eP.currency,onChange:e=>eE(l=>({...l,currency:e.target.value})),children:[(0,l.jsx)("option",{value:"USD",children:"USD $"}),(0,l.jsx)("option",{value:"USD",children:"USD ₹"}),(0,l.jsx)("option",{value:"EUR",children:"EUR €"})]})]})]})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project"}),(0,l.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:eP.projectId,onChange:e=>eE(l=>({...l,projectId:e.target.value})),children:[(0,l.jsx)("option",{value:"",children:"Select Project"}),e7?(0,l.jsx)("option",{children:"Loading..."}):e5.map(e=>{var t,a,s,n,r,i,c;let d=null!=(s=null!=(a=null!=(t=e.id)?t:e.projectId)?a:e._id)?s:e.id,o=null!=(c=null!=(i=null!=(r=null!=(n=e.projectName)?n:e.name)?r:e.title)?i:e.shortCode)?c:String(d);return(0,l.jsx)("option",{value:String(d),children:o},String(d))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Client"}),(0,l.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:eP.clientId,onChange:e=>eE(l=>({...l,clientId:e.target.value})),children:[(0,l.jsx)("option",{value:"",children:"Select Client"}),lt?(0,l.jsx)("option",{children:"Loading..."}):le.map(e=>{var t,a,s,n,r,i;let c=null!=(n=null!=(s=null!=(a=e.clientId)?a:e.id)?s:e.client_id)?n:e.clientId,d=null!=(i=null!=(r=e.name)?r:null==(t=e.company)?void 0:t.companyName)?i:String(c);return(0,l.jsx)("option",{value:String(c),children:d},String(c))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project Budget"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"px-2 py-2 bg-gray-100 rounded",children:" $ "}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:"",disabled:!0,placeholder:"$ 30,000"})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"px-2 py-2 bg-gray-100 rounded",children:"USD"===eP.currency?"₹":"$"}),(0,l.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:eP.amount,onChange:e=>eE(l=>({...l,amount:Number(e.target.value)}))})]})]}),(0,l.jsxs)("div",{className:"w-36",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Tax %"}),(0,l.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:eP.taxPercent,onChange:e=>eE(l=>({...l,taxPercent:Number(e.target.value)}))})]}),(0,l.jsxs)("div",{className:"w-36",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1 text-right",children:"Amount"}),(0,l.jsx)("div",{className:"bg-gray-100 rounded px-3 py-2 text-right font-medium",children:lq.toFixed(2)})]})]}),(0,l.jsx)("div",{className:"mt-4 border-t pt-3",children:(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[(0,l.jsx)("div",{}),(0,l.jsx)("div",{className:"text-right text-xs text-gray-500",children:"Sub Total"}),(0,l.jsx)("div",{className:"text-right font-medium",children:l_.toFixed(2)}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{className:"text-right text-xs text-gray-500",children:"Discount"}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,l.jsx)("input",{type:"number",className:"w-20 border rounded px-2 py-1",value:eP.discountValue,onChange:e=>eE(l=>({...l,discountValue:Number(e.target.value)}))}),(0,l.jsxs)("select",{className:"border rounded px-2 py-1",value:eP.discountIsPercent?"percent":"fixed",onChange:e=>eE(l=>({...l,discountIsPercent:"percent"===e.target.value})),children:[(0,l.jsx)("option",{value:"percent",children:"%"}),(0,l.jsx)("option",{value:"fixed",children:"₹ / $"})]}),(0,l.jsx)("div",{className:"w-20 text-right",children:lJ.toFixed(2)})]}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{className:"text-right text-xs text-gray-500",children:"Tax"}),(0,l.jsx)("div",{className:"text-right font-medium",children:lG.toFixed(2)}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{className:"text-right text-xs text-gray-500 font-medium",children:"Total"}),(0,l.jsx)("div",{className:"text-right font-semibold",children:lq.toFixed(2)})]})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount in words"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",placeholder:"Amount in words"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Note / Description for the recipient"}),(0,l.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:3,value:eP.notes,onChange:e=>eE(l=>({...l,notes:e.target.value}))})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>eD(!1),children:"Cancel"}),(0,l.jsx)(n.Button,{onClick:lI,disabled:eI,children:eI?"Creating...":"Save"})]})]})]})]}),ez&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-auto p-6",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{eM(!1),li.current=null}}),(0,l.jsxs)("div",{className:"relative z-10 w-full max-w-4xl bg-white rounded shadow-lg overflow-auto",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Create Receipt"}),(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>{eM(!1),li.current=null},children:(0,l.jsx)(P.X,{className:"h-4 w-4"})})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Invoice Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Number *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.invoiceNumber,onChange:e=>eJ(l=>({...l,invoiceNumber:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Issue Date *"}),(0,l.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:e_.issueDate,onChange:e=>eJ(l=>({...l,issueDate:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Currency *"}),(0,l.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:e_.currency,onChange:e=>eJ(l=>({...l,currency:e.target.value})),children:[(0,l.jsx)("option",{value:"USD",children:"USD $"}),(0,l.jsx)("option",{value:"USD",children:"USD ₹"}),(0,l.jsx)("option",{value:"EUR",children:"EUR €"})]})]})]})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Seller Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Company Name *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.sellerCompanyName,onChange:e=>eJ(l=>({...l,sellerCompanyName:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Email Id *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.sellerCompanyEmail,onChange:e=>eJ(l=>({...l,sellerCompanyEmail:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Contact No. *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.sellerCompanyPhoneNumber,onChange:e=>eJ(l=>({...l,sellerCompanyPhoneNumber:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Company Code *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.sellerCompanyCode,onChange:e=>eJ(l=>({...l,sellerCompanyCode:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Tax No. *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.sellerCompanyTaxNumber,onChange:e=>eJ(l=>({...l,sellerCompanyTaxNumber:e.target.value}))})]}),(0,l.jsx)("div",{})]}),(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Company Address *"}),(0,l.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:3,value:e_.sellerCompanyAddress,onChange:e=>eJ(l=>({...l,sellerCompanyAddress:e.target.value}))})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Bank Account No. *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.sellerCompanyBankAccountNumber,onChange:e=>eJ(l=>({...l,sellerCompanyBankAccountNumber:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Name of the Bank *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.sellerCompanyBankName,onChange:e=>eJ(l=>({...l,sellerCompanyBankName:e.target.value}))})]})]})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Buyer Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Client Name *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.buyerCleintName,onChange:e=>eJ(l=>({...l,buyerCleintName:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Company Name *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.buyerCompanyName,onChange:e=>eJ(l=>({...l,buyerCompanyName:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Email Id *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.buyerCompanyEmail,onChange:e=>eJ(l=>({...l,buyerCompanyEmail:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Contact No. *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.buyerCompanyPhoneNumber,onChange:e=>eJ(l=>({...l,buyerCompanyPhoneNumber:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Company Code *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.buyerCompanyCode,onChange:e=>eJ(l=>({...l,buyerCompanyCode:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Tax No. *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.buyerCompanyTaxNumber,onChange:e=>eJ(l=>({...l,buyerCompanyTaxNumber:e.target.value}))})]})]}),(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Company Address *"}),(0,l.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:3,value:e_.buyerCompanyAddress,onChange:e=>eJ(l=>({...l,buyerCompanyAddress:e.target.value}))})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Bank Account No. *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.buyerCompanyBankAccountNumber,onChange:e=>eJ(l=>({...l,buyerCompanyBankAccountNumber:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Name of the Bank *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.buyerCompanyBankName,onChange:e=>eJ(l=>({...l,buyerCompanyBankName:e.target.value}))})]})]})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Product / Project *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:e_.productName,onChange:e=>eJ(l=>({...l,productName:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Quantity *"}),(0,l.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:e_.quantity,onChange:e=>eJ(l=>({...l,quantity:Number(e.target.value)}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Price Without Tax *"}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("span",{className:"px-2 py-2 bg-gray-100 rounded-l border",children:[" ","USD"===e_.currency?"₹":"$"," "]}),(0,l.jsx)("input",{type:"number",className:"w-full border rounded-r px-3 py-2",value:e_.priceWithOutTax,onChange:e=>eJ(l=>({...l,priceWithOutTax:Number(e.target.value)}))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Tax *"}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"px-2 py-2 bg-gray-100 rounded-l border",children:" % "}),(0,l.jsx)("input",{type:"number",className:"w-full border rounded-r px-3 py-2",value:e_.tax,onChange:e=>eJ(l=>({...l,tax:Number(e.target.value)}))})]})]})]}),(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Note/ Description for the recipient *"}),(0,l.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:3,value:e_.description,onChange:e=>eJ(l=>({...l,description:e.target.value}))})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>{eM(!1),li.current=null},children:"Cancel"}),(0,l.jsx)(n.Button,{onClick:lX,disabled:eV,children:eV?"Saving...":"Save"})]})]})]})]}),eU&&eF&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-auto p-6",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>eB(!1)}),(0,l.jsxs)("div",{className:"relative z-10 w-full max-w-2xl bg-white rounded shadow-lg overflow-auto",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Invoice"}),(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>eB(!1),children:"Close"})]}),(0,l.jsxs)("div",{className:"p-4 space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Number"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:eF.invoiceNumber,onChange:e=>eR(l=>({...l,invoiceNumber:e.target.value}))})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Date"}),(0,l.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:eF.invoiceDate,onChange:e=>eR(l=>({...l,invoiceDate:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Currency"}),(0,l.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:eF.currency,onChange:e=>eR(l=>({...l,currency:e.target.value})),children:[(0,l.jsx)("option",{value:"USD",children:"USD"}),(0,l.jsx)("option",{value:"USD",children:"USD"}),(0,l.jsx)("option",{value:"EUR",children:"EUR"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount"}),(0,l.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:eF.amount,onChange:e=>eR(l=>({...l,amount:Number(e.target.value)}))})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>eB(!1),children:"Cancel"}),(0,l.jsx)(n.Button,{onClick:lP,disabled:eO,children:eO?"Saving...":"Save"})]})]})]})]}),lo&&(0,l.jsxs)("div",{className:"fixed inset-0 z-60 flex items-start justify-center overflow-auto p-6",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{lu(!1),li.current=null,lx(null),lp(null)}}),(0,l.jsxs)("div",{className:"relative z-10 w-full max-w-2xl bg-white rounded shadow-lg overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 border-b",children:[(0,l.jsx)("h3",{className:"text-base font-semibold ml-3",children:"Upload File"}),(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>{lu(!1),li.current=null,lx(null),lp(null)},children:(0,l.jsx)(P.X,{className:"h-4 w-4"})})]}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{onDrop:e=>{var l,t;e.preventDefault(),e.stopPropagation();let a=null!=(t=null==(l=e.dataTransfer.files)?void 0:l[0])?t:null;a&&(lx(a),lp(null))},onDragOver:e=>{e.preventDefault()},className:"w-full h-36 border-2 border-dashed rounded-md flex flex-col items-center justify-center gap-2 cursor-pointer",onClick:()=>{var e;null==(e=ls.current)||e.click()},children:[(0,l.jsx)(E,{className:"h-6 w-6 text-gray-400"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Choose a file"}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:"or drag & drop here"}),lm&&(0,l.jsx)("div",{className:"mt-2 text-sm text-gray-700",children:lm.name})]}),lh&&(0,l.jsx)("div",{className:"mt-3 text-sm text-red-600",children:lh}),(0,l.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,l.jsx)(n.Button,{variant:"ghost",onClick:()=>{lu(!1),li.current=null,lx(null),lp(null)},children:"Cancel"}),(0,l.jsx)(n.Button,{onClick:lk,disabled:lc,children:lc?"Uploading...":"Save"})]})]})]})]})]})}var L=e.i(793479),F=e.i(784774),R=e.i(967489),z=e.i(323585),M=e.i(840433),V=e.i(722915),H=e.i(727612),_=e.i(555436),J=e.i(657688);let G=(0,c.default)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);function q(e){var s,n,r,i,c,d,o,u,m,x,h,p,j,v,y;let{clientId:N}=e;(0,a.useRouter)();let[g,f]=(0,t.useState)(!1),[b,w]=(0,t.useState)([]),[C,S]=(0,t.useState)(null),[A,D]=(0,t.useState)(!1),[I,T]=(0,t.useState)(null);(0,t.useEffect)(()=>{if(!N&&0!==N){w([]),S("No client selected."),f(!1);return}let e=new AbortController,l=String(N),t="".concat("https://6jnqmj85-80.inc1.devtunnels.ms","/api/credit-notes/client/").concat(encodeURIComponent(l));f(!0),S(null);let a=localStorage.getItem("accessToken");return fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(a),Accept:"application/json"}}).then(async e=>{if(!e.ok){let l=await e.text().catch(()=>"");throw Error("HTTP ".concat(e.status," ").concat(l))}return e.json()}).then(e=>{Array.isArray(e)?w(e):e&&"object"==typeof e?Array.isArray(e.data)?w(e.data):Array.isArray(e.creditNotes)?w(e.creditNotes):w([]):w([])}).catch(e=>{"AbortError"!==e.name&&(console.error("Error fetching credit notes:",e),S("Failed to load credit notes."),w([]))}).finally(()=>f(!1)),()=>e.abort()},[N]);let P=e=>{if(!e)return"-";try{let l=new Date(e),t=String(l.getDate()).padStart(2,"0"),a=String(l.getMonth()+1).padStart(2,"0"),s=l.getFullYear();return"".concat(t,"/").concat(a,"/").concat(s)}catch(l){return e}},E=(e,l)=>{if(null==e||Number.isNaN(Number(e)))return"$ 0.00";let t=l||"USD";try{return new Intl.NumberFormat(void 0,{style:"currency",currency:t,maximumFractionDigits:2}).format(Number(e))}catch(l){return"".concat(t," ").concat(Number(e).toFixed(2))}},U=(0,t.useCallback)(e=>{T(e),D(!0)},[]),B=(0,t.useCallback)(()=>{D(!1),T(null)},[]);return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Credit Notes"}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground",children:[b.length," record",1!==b.length?"s":""]})]}),g?(0,l.jsx)("div",{className:"py-12 flex justify-center",children:(0,l.jsx)(G,{className:"animate-spin"})}):C?(0,l.jsx)("div",{className:"py-6 text-center text-red-600",children:C}):0===b.length?(0,l.jsx)("div",{className:"py-8 text-center text-gray-600",children:"No credit notes found for this client."}):(0,l.jsxs)("div",{className:"rounded-lg border overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-[#e8f3ff] px-6 py-3 flex text-sm text-gray-700 font-medium",children:[(0,l.jsx)("div",{className:"w-1/6",children:"Credit Note"}),(0,l.jsx)("div",{className:"w-1/6",children:"Invoice"}),(0,l.jsx)("div",{className:"w-2/6",children:"Client"}),(0,l.jsx)("div",{className:"w-1/6",children:"Total"}),(0,l.jsx)("div",{className:"w-1/6",children:"Credit Note Date"}),(0,l.jsx)("div",{className:"w-12 text-center",children:"Action"})]}),(0,l.jsx)("div",{className:"px-6 py-4",children:(0,l.jsx)("div",{className:"space-y-3",children:b.map(e=>{var t,a,s,n,r,i,c,d,o,u,m,x;return(0,l.jsxs)("div",{className:"flex items-center rounded-md border px-4 py-4 bg-white",style:{boxShadow:"0 0 0 1px rgba(0,0,0,0.02) inset"},children:[(0,l.jsx)("div",{className:"w-1/6 text-sm",children:(0,l.jsx)("div",{className:"font-medium",children:null!=(i=e.creditNoteNumber)?i:"CN#".concat(e.id)})}),(0,l.jsx)("div",{className:"w-1/6 text-sm",children:null!=(c=e.invoiceNumber)?c:"-"}),(0,l.jsxs)("div",{className:"w-2/6 flex items-center gap-3 text-sm",children:[(0,l.jsx)("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-100 relative flex-shrink-0",children:(null==(t=e.client)?void 0:t.profilePictureUrl)?(0,l.jsx)(J.default,{src:e.client.profilePictureUrl,alt:null!=(d=null==(a=e.client)?void 0:a.name)?d:"client",fill:!0,sizes:"32px",style:{objectFit:"cover"},unoptimized:!0}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full text-xs text-gray-500",children:(null==(s=e.client)?void 0:s.name)?e.client.name.charAt(0):"U"})}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"font-medium text-sm",children:null!=(o=null==(n=e.client)?void 0:n.name)?o:"-"}),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:null!=(u=null==(r=e.project)?void 0:r.projectName)?u:""})]})]}),(0,l.jsxs)("div",{className:"w-1/6 text-sm",children:[(0,l.jsx)("div",{className:"text-sm font-semibold",children:E(null!=(m=e.totalAmount)?m:e.amount,e.currency)}),(0,l.jsxs)("div",{className:"text-xs text-amber-600",children:["Adjustment : ",null!=e.adjustment?Number(e.adjustment).toFixed(2):"0.00"]})]}),(0,l.jsx)("div",{className:"w-1/6 text-sm",children:P(null!=(x=e.creditNoteDate)?x:e.createdAt)}),(0,l.jsx)("div",{className:"w-12 text-center",children:(0,l.jsx)("button",{type:"button",onClick:()=>U(e),className:"inline-flex items-center justify-center h-8 w-8 rounded-full hover:bg-gray-100",title:"View details",children:(0,l.jsx)(k.Eye,{size:16})})})]},e.id)})})})]})]}),A&&I&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-20 px-4",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:B}),(0,l.jsx)("div",{className:"relative z-10 w-[820px] max-w-full",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg border shadow",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-6 py-3 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Credit Note Details"}),(0,l.jsx)("button",{onClick:B,className:"text-gray-600 hover:text-gray-800","aria-label":"Close",children:"✕"})]}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsx)("div",{className:"rounded-md border p-5",children:(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Credit Note #"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Credit Note Date"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Client"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Project"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Invoice Amount"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Adjustment"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Tax"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Note"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"File"})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"text-sm font-medium",children:null!=(o=I.creditNoteNumber)?o:"CN#".concat(I.id)}),(0,l.jsx)("div",{className:"text-sm",children:P(null!=(u=I.creditNoteDate)?u:I.createdAt)}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-100 relative",children:(null==(s=I.client)?void 0:s.profilePictureUrl)?(0,l.jsx)(J.default,{src:I.client.profilePictureUrl,alt:null!=(m=null==(n=I.client)?void 0:n.name)?m:"client",fill:!0,sizes:"32px",style:{objectFit:"cover"},unoptimized:!0}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full text-xs text-gray-500",children:(null==(r=I.client)?void 0:r.name)?I.client.name.charAt(0):"U"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-medium",children:null!=(x=null==(i=I.client)?void 0:i.name)?x:"-"}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:null!=(h=null==(c=I.client)?void 0:c.companyName)?h:""})]})]}),(0,l.jsx)("div",{className:"text-sm",children:null!=(p=null==(d=I.project)?void 0:d.projectName)?p:"-"}),(0,l.jsx)("div",{className:"text-sm",children:E(null!=(j=I.totalAmount)?j:I.amount,I.currency)}),(0,l.jsxs)("div",{className:"text-sm",children:[null!=I.adjustment?E(I.adjustment,I.currency):E(0,I.currency)," ",I.adjustmentPositive?"(Add)":""]}),(0,l.jsx)("div",{className:"text-sm",children:null!=I.tax?"".concat(I.tax," %"):"-"}),(0,l.jsx)("div",{className:"text-sm text-gray-700",children:null!=(v=I.notes)?v:"-"}),(0,l.jsx)("div",{className:"text-sm",children:(0,l.jsx)(e=>{let{url:t,alt:a}=e;return t?(0,l.jsxs)("div",{className:"relative inline-block",children:[(0,l.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:(0,l.jsx)("img",{src:t,alt:null!=a?a:"file",style:{width:140,height:90,objectFit:"cover",borderRadius:4},className:"border"})}),(0,l.jsx)("a",{href:t,download:!0,target:"_blank",rel:"noreferrer",className:"absolute top-1 right-1 bg-white rounded-full p-1 shadow",title:"Download",onClick:e=>e.stopPropagation(),children:(0,l.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M12 3v12",stroke:"#333",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,l.jsx)("path",{d:"M8 11l4 4 4-4",stroke:"#333",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,l.jsx)("path",{d:"M21 21H3",stroke:"#333",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}):(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"No file attached"})},{url:I.fileUrl,alt:null!=(y=I.creditNoteNumber)?y:"CN#".concat(I.id)})})]})]})})}),(0,l.jsx)("div",{className:"flex items-center justify-end px-6 py-3 border-t",children:(0,l.jsx)("button",{onClick:B,className:"px-4 py-2 rounded border bg-white hover:bg-gray-50",children:"Close"})})]})})]})]})}let W="".concat("https://6jnqmj85-80.inc1.devtunnels.ms");function X(e){var a,s,n,r,i;let{clientId:c,onAdd:d,onSearch:o,onAction:u}=e,[m,x]=(0,t.useState)([]),[h,p]=(0,t.useState)(!1),[j,v]=(0,t.useState)(null),[y,g]=(0,t.useState)(""),[f,b]=(0,t.useState)(null),[w,C]=(0,t.useState)(!1),[S,k]=(0,t.useState)(!1),[A,D]=(0,t.useState)(null),[I,T]=(0,t.useState)("view"),[E,U]=(0,t.useState)(!1),[B,O]=(0,t.useState)("pre filled"),[L,F]=(0,t.useState)(()=>c?String(c):"pre filled"),[R,z]=(0,t.useState)("pre filled"),[M,V]=(0,t.useState)(""),[_,G]=(0,t.useState)("USD"),[q,X]=(0,t.useState)(""),[$,Y]=(0,t.useState)("Net Banking"),[K,Z]=(0,t.useState)(""),Q=(0,t.useRef)(null),[ee,el]=(0,t.useState)(null),[et,ea]=(0,t.useState)(!1),[es,en]=(0,t.useState)([]),[er,ei]=(0,t.useState)("");(0,t.useEffect)(()=>{if(!c&&0!==c){x([]),v("No client selected."),p(!1);return}let e=new AbortController,l=String(c),t="".concat(W,"/api/payments/client/").concat(encodeURIComponent(l));return p(!0),v(null),localStorage.getItem("accessToken"),fetch(t,{method:"GET",signal:e.signal,headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}).then(async e=>{if(!e.ok){let l=await e.text().catch(()=>"");throw Error("HTTP ".concat(e.status," ").concat(l))}return e.json()}).then(e=>{if(!Array.isArray(e))return void x([]);x(e.map(e=>{var l,t,a,s,n,r,i,c,d,o,u,m,x,h,p,j,v,y,N;return{id:e.id,code:null!=(d=null==(l=e.project)?void 0:l.projectCode)?d:void 0,project:null!=(o=null==(t=e.project)?void 0:t.projectName)?o:void 0,invoice:null!=(u=null==(a=e.invoice)?void 0:a.invoiceNumber)?u:void 0,client:{clientId:null==(s=e.client)?void 0:s.clientId,name:null!=(m=null==(n=e.client)?void 0:n.name)?m:void 0,companyName:null!=(x=null==(r=e.client)?void 0:r.companyName)?x:void 0,profilePictureUrl:null!=(h=null==(i=e.client)?void 0:i.profilePictureUrl)?h:void 0},orderNumber:null!=(p=e.orderNumber)?p:void 0,amount:"number"==typeof e.amount?e.amount:e.amount?Number(e.amount):void 0,currency:null!=(j=e.currency)?j:void 0,paidOn:null!=(v=e.paymentDate)?v:void 0,paymentGateway:null!=(y=null==(c=e.paymentGateway)?void 0:c.name)?y:void 0,status:e.status?"completed"===String(e.status).toLowerCase()?"Complete":e.status:void 0,receiptFileUrl:null!=(N=e.receiptFileUrl)?N:void 0}}))}).catch(e=>{"AbortError"!==e.name&&(console.error("Error fetching payments:",e),v("Failed to load payments."),x([]))}).finally(()=>{p(!1)}),()=>e.abort()},[c]);let ec=(0,t.useMemo)(()=>{let e=y.trim().toLowerCase();return e?m.filter(l=>{var t,a,s,n,r,i,c,d;return String(null!=(s=l.code)?s:"").toLowerCase().includes(e)||String(null!=(n=l.project)?n:"").toLowerCase().includes(e)||String(null!=(r=l.invoice)?r:"").toLowerCase().includes(e)||String(null!=(i=null==(t=l.client)?void 0:t.name)?i:"").toLowerCase().includes(e)||String(null!=(c=null==(a=l.client)?void 0:a.companyName)?c:"").toLowerCase().includes(e)||String(null!=(d=l.orderNumber)?d:"").toLowerCase().includes(e)}):m},[m,y]),ed=e=>{if(!e)return"--";try{let l=new Date(e),t=String(l.getDate()).padStart(2,"0"),a=String(l.getMonth()+1).padStart(2,"0"),s=l.getFullYear();return"".concat(t,"/").concat(a,"/").concat(s)}catch(l){return e}},eo=(e,l)=>{if(null==e)return"--";try{return new Intl.NumberFormat(void 0,{style:"currency",currency:l||"USD",maximumFractionDigits:2}).format(Number(e))}catch(t){return"".concat(null!=l?l:"$"," ").concat(Number(e).toFixed(2))}},eu=()=>{var e;return null==(e=Q.current)?void 0:e.click()},em=e=>{var l,t;return el(null!=(t=null==(l=e.target.files)?void 0:l[0])?t:null)},ex=()=>{null==ee||ee.name,U(!1)},eh=async()=>{try{let e=await fetch("".concat(W,"/api/payment-gateways"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")||""),Accept:"application/json"}});if(!e.ok){console.error("Failed to fetch gateways",e.status),en([]);return}let l=await e.json();Array.isArray(l)?en(l.map(e=>({id:e.id,name:e.name}))):en([])}catch(e){console.error("fetchGateways error",e),en([])}},ep=()=>{ei(""),ea(!0),eh()},ej=async()=>{let e=er.trim();if(!e)return void alert("Enter gateway name");try{localStorage.getItem("accessToken");let l=await fetch("".concat(W,"/api/payment-gateways"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:JSON.stringify({name:e})});if(!l.ok){let e=await l.text().catch(()=>"");console.error("POST gateway failed",l.status,e),alert("Failed to create gateway");return}let t=await l.json();en(e=>[...e,{id:t.id,name:t.name}]),Y(t.name),ea(!1)}catch(e){console.error("handleSaveGateway error",e),alert("Failed to create gateway")}},ev=async e=>{if(confirm("Delete this gateway?"))try{let a=localStorage.getItem("accessToken")||"",s=await fetch("".concat(W,"/api/payment-gateways/").concat(encodeURIComponent(String(e))),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}});if(!s.ok){console.error("Failed delete gateway",s.status),alert("Failed to delete gateway");return}if(en(l=>l.filter(l=>l.id!==e)),es.find(l=>l.id===e&&l.name===$)){var l,t;let a=es.filter(l=>l.id!==e);Y(null!=(t=null==(l=a[0])?void 0:l.name)?t:"")}}catch(e){console.error("handleDeleteGateway error",e),alert("Failed to delete gateway")}};return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg border p-5",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Payments"}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{children:(0,l.jsx)("button",{onClick:()=>{if(d)try{d()}catch(e){}F(c?String(c):L),U(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Add Payment"})}),(0,l.jsx)("div",{children:(0,l.jsx)("input",{type:"search",placeholder:"Search",value:y,onChange:e=>{g(e.target.value),o&&o(e.target.value)},className:"border rounded px-3 py-2 text-sm w-56"})})]})]}),h?(0,l.jsx)("div",{className:"py-6 text-center text-gray-600",children:"Loading payments..."}):j?(0,l.jsx)("div",{className:"py-6 text-center text-red-600",children:j}):(0,l.jsxs)("div",{className:"rounded-lg border overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-[#e8f3ff] px-4 py-3 flex text-sm text-gray-700 font-medium",children:[(0,l.jsx)("div",{className:"w-1/12",children:"Code"}),(0,l.jsx)("div",{className:"w-2/12",children:"Project"}),(0,l.jsx)("div",{className:"w-1/12",children:"Invoice"}),(0,l.jsx)("div",{className:"w-2/12",children:"Client"}),(0,l.jsx)("div",{className:"w-1/12",children:"Order#"}),(0,l.jsx)("div",{className:"w-1/12",children:"Amount"}),(0,l.jsx)("div",{className:"w-1/12",children:"Paid On"}),(0,l.jsx)("div",{className:"w-1/12",children:"Payment Gateway"}),(0,l.jsx)("div",{className:"w-1/12",children:"Status"}),(0,l.jsx)("div",{className:"w-10 text-center",children:"Action"})]}),(0,l.jsx)("div",{className:"px-4 py-4",children:0===ec.length?(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"No payments to display."}):(0,l.jsx)("div",{className:"space-y-3",children:ec.map(e=>{var t,a,s,n,r,i,c,d,o,u,m,x,h,p,j,v;return(0,l.jsxs)("div",{className:"flex items-center rounded-md border px-4 py-3 bg-white",style:{boxShadow:"0 0 0 1px rgba(0,0,0,0.02) inset"},children:[(0,l.jsx)("div",{className:"w-1/12 text-sm",children:null!=(c=e.code)?c:"--"}),(0,l.jsx)("div",{className:"w-2/12 text-sm",children:null!=(d=e.project)?d:"--"}),(0,l.jsx)("div",{className:"w-1/12 text-sm",children:null!=(o=e.invoice)?o:"--"}),(0,l.jsxs)("div",{className:"w-2/12 flex items-center gap-3 text-sm",children:[(0,l.jsx)("div",{className:"h-7 w-7 rounded-full overflow-hidden bg-gray-100 relative flex-shrink-0",children:(null==(t=e.client)?void 0:t.profilePictureUrl)?(0,l.jsx)(J.default,{src:e.client.profilePictureUrl,alt:null!=(u=null==(a=e.client)?void 0:a.name)?u:"client",fill:!0,sizes:"28px",style:{objectFit:"cover"},unoptimized:!0}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full text-xs text-gray-500",children:null!=(m=null==(n=e.client)||null==(s=n.name)?void 0:s.charAt(0))?m:"U"})}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:null!=(x=null==(r=e.client)?void 0:r.name)?x:"--"}),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:null!=(h=null==(i=e.client)?void 0:i.companyName)?h:""})]})]}),(0,l.jsx)("div",{className:"w-1/12 text-sm",children:null!=(p=e.orderNumber)?p:"--"}),(0,l.jsx)("div",{className:"w-1/12 text-sm",children:eo(e.amount,e.currency)}),(0,l.jsx)("div",{className:"w-1/12 text-sm",children:ed(e.paidOn)}),(0,l.jsx)("div",{className:"w-1/12 text-sm",children:null!=(j=e.paymentGateway)?j:"--"}),(0,l.jsx)("div",{className:"w-1/12 text-sm",children:"Complete"===e.status?(0,l.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)("span",{className:"h-2 w-2 rounded-full bg-emerald-600 block"}),(0,l.jsx)("span",{children:"Complete"})]}):"Pending"===e.status?(0,l.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)("span",{className:"h-2 w-2 rounded-full bg-yellow-500 block"}),(0,l.jsx)("span",{children:"Pending"})]}):(0,l.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)("span",{className:"h-2 w-2 rounded-full bg-red-500 block"}),(0,l.jsx)("span",{children:null!=(v=e.status)?v:"--"})]})}),(0,l.jsxs)("div",{className:"w-10 text-center relative",children:[(0,l.jsx)("button",{onClick:()=>b(f===e.id?null:e.id),className:"p-2 rounded hover:bg-gray-100 inline-flex items-center justify-center",title:"Actions",children:(0,l.jsx)(N.MoreHorizontal,{size:16})}),f===e.id&&(0,l.jsxs)("div",{className:"absolute right-0 top-9 bg-white border rounded-md shadow-lg w-32 z-20",children:[(0,l.jsx)("button",{onClick:()=>{D(e),T("view"),C(!0),b(null)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100",children:"View"}),(0,l.jsx)("button",{onClick:()=>{D(e),T("edit"),k(!0),b(null)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100",children:"Edit"})]})]})]},e.id)})})})]})]}),E&&(0,l.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-start justify-center pt-8 px-4 overflow-y-auto",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>U(!1)}),(0,l.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Add Payment Details"}),(0,l.jsx)("button",{onClick:()=>U(!1),className:"p-2 rounded hover:bg-gray-100","aria-label":"Close",children:(0,l.jsx)(P.X,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Payment Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Project *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:B,onChange:e=>O(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:L,onChange:e=>F(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Invoice *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:R,onChange:e=>z(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Amount *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:M,onChange:e=>V(e.target.value),placeholder:"---"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Currency *"}),(0,l.jsxs)("select",{value:_,onChange:e=>G(e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,l.jsx)("option",{value:"USD",children:"USD $"}),(0,l.jsx)("option",{value:"USD",children:"USD ₹"}),(0,l.jsx)("option",{value:"EUR",children:"EUR €"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Transaction Id"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:q,onChange:e=>X(e.target.value)})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Payment Gateway"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("select",{value:$,onChange:e=>Y(e.target.value),className:"w-full border rounded px-3 py-2",children:es.length>0?es.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e.id)):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{children:"Net Banking"}),(0,l.jsx)("option",{children:"Credit Card"}),(0,l.jsx)("option",{children:"PayPal"})]})}),(0,l.jsx)("button",{className:"px-3 py-2 bg-gray-100 rounded",type:"button",onClick:ep,title:"Add payment gateway",children:"Add"})]})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-2",children:"Receipt"}),(0,l.jsxs)("div",{onClick:eu,className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"mb-1",children:"Choose a file"}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:ee?ee.name:"Drag & drop or click"})]}),(0,l.jsx)("input",{ref:Q,type:"file",className:"hidden",onChange:em})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-2",children:"Remark"}),(0,l.jsx)("textarea",{rows:4,value:K,onChange:e=>Z(e.target.value),className:"w-full p-3 border rounded",placeholder:"Enter a summary of payment"})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,l.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>U(!1),children:"Cancel"}),(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:ex,children:"Save"})]})]})]})]}),S&&(0,l.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-start justify-center pt-8 px-4 overflow-y-auto",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>k(!1)}),(0,l.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Payment Details"}),(0,l.jsx)("button",{onClick:()=>k(!1),className:"p-2 rounded hover:bg-gray-100","aria-label":"Close",children:(0,l.jsx)(P.X,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Payment Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Project *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:B,onChange:e=>O(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:L,onChange:e=>F(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Invoice *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:R,onChange:e=>z(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Amount *"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:M,onChange:e=>V(e.target.value),placeholder:"---"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Currency *"}),(0,l.jsxs)("select",{value:_,onChange:e=>G(e.target.value),className:"w-full border rounded px-3 py-2",children:[(0,l.jsx)("option",{value:"USD",children:"USD $"}),(0,l.jsx)("option",{value:"USD",children:"USD ₹"}),(0,l.jsx)("option",{value:"EUR",children:"EUR €"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Transaction Id"}),(0,l.jsx)("input",{className:"w-full border rounded px-3 py-2",value:q,onChange:e=>X(e.target.value)})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Payment Gateway"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("select",{value:$,onChange:e=>Y(e.target.value),className:"w-full border rounded px-3 py-2",children:es.length>0?es.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e.id)):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{children:"Net Banking"}),(0,l.jsx)("option",{children:"Credit Card"}),(0,l.jsx)("option",{children:"PayPal"})]})}),(0,l.jsx)("button",{className:"px-3 py-2 bg-gray-100 rounded",type:"button",onClick:ep,title:"Add payment gateway",children:"Add"})]})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-2",children:"Receipt"}),(0,l.jsxs)("div",{onClick:eu,className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"mb-1",children:"Choose a file"}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:ee?ee.name:"Drag & drop or click"})]}),(0,l.jsx)("input",{ref:Q,type:"file",className:"hidden",onChange:em})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 block mb-2",children:"Remark"}),(0,l.jsx)("textarea",{rows:4,value:K,onChange:e=>Z(e.target.value),className:"w-full p-3 border rounded",placeholder:"Enter a summary of payment"})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,l.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>U(!1),children:"Cancel"}),(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:ex,children:"Save"})]})]})]})]}),et&&(0,l.jsxs)("div",{className:"fixed inset-0 z-[11000] flex items-start justify-center pt-12 px-4 overflow-y-auto",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>ea(!1)}),(0,l.jsxs)("div",{className:"relative w-full max-w-3xl bg-white rounded-xl shadow-2xl overflow-y-auto z-20",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Add Payment Gateway"}),(0,l.jsx)("button",{onClick:()=>ea(!1),className:"p-2 rounded hover:bg-gray-100","aria-label":"Close",children:(0,l.jsx)(P.X,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"p-6 space-y-4",children:[(0,l.jsxs)("div",{className:"rounded border overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-[#e8f3ff] px-4 py-2 flex text-sm text-gray-700 font-medium",children:[(0,l.jsx)("div",{className:"w-1/12",children:"#"}),(0,l.jsx)("div",{className:"w-11/12",children:"Gateway"}),(0,l.jsx)("div",{className:"w-12 text-center",children:"Action"})]}),(0,l.jsx)("div",{className:"px-4 py-2",children:0===es.length?(0,l.jsx)("div",{className:"text-sm text-gray-500 p-2",children:"No gateways"}):es.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center py-2 border-b last:border-b-0",children:[(0,l.jsx)("div",{className:"w-1/12 text-sm",children:t+1}),(0,l.jsx)("div",{className:"w-11/12 text-sm",children:e.name}),(0,l.jsx)("div",{className:"w-12 text-center",children:(0,l.jsx)("button",{onClick:()=>ev(e.id),className:"inline-flex items-center justify-center p-1 rounded hover:bg-red-50 text-red-600",title:"Delete gateway",children:(0,l.jsx)(H.Trash2,{size:16})})})]},e.id))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Payment Gateway Name *"}),(0,l.jsx)("input",{value:er,onChange:e=>ei(e.target.value),placeholder:"--",className:"w-full border rounded px-3 py-2 mt-2"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-2",children:[(0,l.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>ea(!1),children:"Cancel"}),(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:ej,children:"Save"})]})]})]})]}),w&&A&&(0,l.jsxs)("div",{className:"fixed inset-0 z-[12000] flex justify-center items-start pt-10",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>C(!1)}),(0,l.jsxs)("div",{className:"relative bg-white w-full max-w-3xl rounded-xl shadow-xl p-6 z-10",children:[(0,l.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Payment Details"}),(0,l.jsx)("button",{onClick:()=>C(!1),children:(0,l.jsx)(P.X,{})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-y-4 text-sm",children:[(0,l.jsx)("div",{children:"Amount"}),(0,l.jsx)("div",{children:eo(A.amount,A.currency)}),(0,l.jsx)("div",{children:"Payment On"}),(0,l.jsx)("div",{children:ed(A.paidOn)}),(0,l.jsx)("div",{children:"Invoice"}),(0,l.jsx)("div",{children:null!=(a=A.invoice)?a:"--"}),(0,l.jsx)("div",{children:"Project"}),(0,l.jsx)("div",{children:null!=(s=A.project)?s:"--"}),(0,l.jsx)("div",{children:"Gateway"}),(0,l.jsx)("div",{children:null!=(n=A.paymentGateway)?n:"--"}),(0,l.jsx)("div",{children:"Status"}),(0,l.jsx)("div",{children:null!=(r=A.status)?r:"--"}),(0,l.jsx)("div",{children:"Receipt"}),(0,l.jsx)("div",{children:null!=(i=A.receiptFileUrl)?i:"--"}),(0,l.jsx)("div",{children:"Remark"}),(0,l.jsx)("div",{children:"--"})]})]})]})]})}let $="".concat("https://6jnqmj85-80.inc1.devtunnels.ms");function Y(e){let{clientId:a,documents:s,onUpload:n,onDelete:r,onAction:i,authToken:c,extraHeaders:d,includeCredentials:o=!1,fileFieldName:u="file",onUnauthorized:m}=e,x=(0,t.useRef)(null),[h,p]=(0,t.useState)(s||[]),[j,v]=(0,t.useState)(null),[y,g]=(0,t.useState)(!1),[f,b]=(0,t.useState)({}),[w,C]=(0,t.useState)(null);(0,t.useEffect)(()=>{null!=s&&p(s)},[s]);let S=e=>{var l,t;let a={Accept:"application/json",...d||{},...e.headers||{}};return c&&(a.Authorization="Bearer ".concat(c)),{method:null!=(l=e.method)?l:"GET",headers:a,body:null!=(t=e.body)?t:void 0,credentials:o?"include":"same-origin"}};(0,t.useEffect)(()=>{if(null!=s||!a)return;let e=!0;return async function(){g(!0),C(null);try{let l=a.id,t=await fetch("".concat($,"/clients/").concat(l,"/documents"),S({method:"GET"}));if(401===t.status){C("Unauthorized: provide a valid token or enable credentials."),m&&m();return}if(!t.ok){let e=await t.text();throw Error("Failed to fetch documents: ".concat(t.status," ").concat(e))}let s=await t.json(),n=(Array.isArray(s)?s:[]).map(e=>{var l,t,a,s,n,r,i,c,d,o;return{id:e.id,name:null!=(t=null!=(l=e.filename)?l:e.name)?t:null,fileUrl:null!=(s=null!=(a=e.url)?a:e.fileUrl)?s:null,mimeType:null!=(r=null!=(n=e.mimeType)?n:e.type)?r:null,createdAt:null!=(c=null!=(i=e.uploadedAt)?i:e.createdAt)?c:null,size:null!=(d=e.size)?d:null,uploadedBy:null!=(o=e.uploadedBy)?o:null}});e&&p(n)}catch(t){var l;console.error(t),e&&C(null!=(l=null==t?void 0:t.message)?l:"Unable to load documents")}finally{e&&g(!1)}}(),()=>{e=!1}},[a,s,c,o,JSON.stringify(d)]);let k=async e=>{var l,t,s,r,i,c,d,o,h,j;let v=null==(l=e.target.files)?void 0:l[0];if(!v)return;n&&n(v);let y=v.type.startsWith("image/")?URL.createObjectURL(v):void 0,N="local-".concat(Date.now()),g={id:N,name:v.name,fileUrl:null!=y?y:null,mimeType:v.type,createdAt:new Date().toISOString()};p(e=>[g,...e]);try{b(e=>({...e,[N]:!0}));let e=new FormData;e.append(u,v);let l=a.id,n=await fetch("".concat($,"/clients/").concat(l,"/documents"),S({method:"POST",body:e}));if(401===n.status){p(e=>e.filter(e=>e.id!==N)),C("Unauthorized (401). Provide valid auth."),m&&m();return}if(!n.ok){p(e=>e.filter(e=>e.id!==N));let e=await n.text();throw Error("Upload failed: ".concat(n.status," ").concat(e))}let x=await n.json(),j={id:x.id,name:null!=(t=x.filename)?t:v.name,fileUrl:null!=(i=null!=(r=null!=(s=x.url)?s:x.fileUrl)?r:y)?i:null,mimeType:null!=(c=x.mimeType)?c:v.type,createdAt:null!=(d=x.uploadedAt)?d:new Date().toISOString(),size:null!=(o=x.size)?o:null,uploadedBy:null!=(h=x.uploadedBy)?h:null};p(e=>[j,...e.filter(e=>e.id!==N)])}catch(e){console.error("Upload error:",e),C(null!=(j=null==e?void 0:e.message)?j:"Upload failed")}finally{b(e=>{let l={...e};return delete l[N],l}),x.current&&(x.current.value="")}},A=async e=>{p(l=>l.filter(l=>l.id!==e)),r&&r(e);try{let l=a.id,t=await fetch("".concat($,"/clients/").concat(l,"/documents/").concat(e),S({method:"DELETE"}));if(401===t.status){C("Unauthorized (401). Provide valid auth."),m&&m();return}if(!t.ok){let e=await t.text();throw Error("Delete failed: ".concat(t.status," ").concat(e))}}catch(e){var l;console.error(e),C(null!=(l=null==e?void 0:e.message)?l:"Failed to delete document")}};return(0,l.jsx)("div",{className:"w-full",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg border p-5",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload file"}),(0,l.jsxs)("div",{onClick:()=>{var e;return null==(e=x.current)?void 0:e.click()},role:"button",className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"#bdbdbd",viewBox:"0 0 24 24",className:"mx-auto mb-2",children:(0,l.jsx)("path",{d:"M12 16a1 1 0 0 1-1-1v-4.586l-1.293 1.293a1 1 0 1 1-1.414-1.414l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.414L13 10.414V15a1 1 0 0 1-1 1Zm7-1a5 5 0 0 0-4.546-4.978A7 7 0 0 0 5.062 9.2 5 5 0 0 0 6 19h13a4 4 0 0 0 0-8Z"})}),(0,l.jsx)("div",{className:"text-sm font-medium",children:"Choose a file"})]}),(0,l.jsx)("input",{ref:x,type:"file",className:"hidden",onChange:k})]}),y&&(0,l.jsx)("div",{className:"mt-3 text-sm text-gray-500",children:"Loading documents…"}),w&&(0,l.jsxs)("div",{className:"mt-3 text-sm text-red-600",children:["Error: ",w]}),(0,l.jsx)("div",{className:"mt-6 space-y-4",children:0===h.length?(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"No documents uploaded yet."}):(0,l.jsx)("div",{className:"grid grid-cols-6 gap-4",children:h.map(e=>{var t,a,s;return(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"bg-gray-50 w-full h-20 rounded overflow-hidden flex items-center justify-center border",children:e.fileUrl?(null==(a=e.mimeType)||null==(t=a.startsWith)?void 0:t.call(a,"image/"))?(0,l.jsx)(J.default,{src:e.fileUrl,alt:null!=(s=e.name)?s:"document",fill:!0,sizes:"160px",style:{objectFit:"cover"},unoptimized:!0}):(0,l.jsx)("div",{className:"text-gray-400 text-xs",children:"File"}):(0,l.jsx)("div",{className:"text-gray-400 text-xs",children:"No Preview"})}),(0,l.jsxs)("div",{className:"absolute top-1 right-1",children:[(0,l.jsx)("button",{onClick:()=>v(j===e.id?null:e.id),className:"p-1 rounded hover:bg-white/60","aria-label":"Open actions",children:(0,l.jsx)(N.MoreHorizontal,{size:16})}),j===e.id&&(0,l.jsxs)("div",{className:"absolute right-0 mt-8 w-36 bg-white border rounded shadow-lg z-30",children:[(0,l.jsx)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-50 text-sm",onClick:()=>{if(v(null),i&&i(e,"download"),e.fileUrl){var l;let t=document.createElement("a");t.href=e.fileUrl,t.download=null!=(l=e.name)?l:"file",t.target="_blank",document.body.appendChild(t),t.click(),t.remove()}},children:"Download"}),(0,l.jsx)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-50 text-sm",onClick:()=>{v(null);if(i&&i(e,"view"),e.fileUrl){let l=document.createElement("a");l.href=e.fileUrl,l.target="_blank",document.body.appendChild(l),l.click(),l.remove()}},children:"View"}),(0,l.jsx)("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-50 text-sm text-red-600",onClick:()=>{v(null),A(e.id)},children:"Delete"})]})]})]}),(0,l.jsxs)("div",{className:"mt-2 text-sm",children:[(0,l.jsxs)("div",{className:"text-sm font-medium flex items-center gap-2",children:[e.name||"Untitled",f[String(e.id)]&&(0,l.jsx)("span",{className:"text-xs text-gray-400",children:" · uploading…"})]}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():""})]})]},String(e.id))})})})]})})}var K=e.i(248256),Z=e.i(270756),Q=e.i(688511);let ee="".concat("https://6jnqmj85-80.inc1.devtunnels.ms"),el="".concat("https://6jnqmj85-80.inc1.devtunnels.ms"),et="".concat("https://6jnqmj85-80.inc1.devtunnels.ms");function ea(e){if("number"==typeof e)return e;let l=String(null!=e?e:"").trim();if(/^\d+$/.test(l))return parseInt(l,10);let t=l.replace(/\D+/g,"");return t.length>0?parseInt(t,10):null}function es(e){var a,s,n;let{clientId:r,authToken:i,extraHeaders:c,includeCredentials:d=!1,onView:o,onEdit:u,onDelete:m}=e,[x,h]=(0,t.useState)([]),[p,j]=(0,t.useState)(!1),[v,y]=(0,t.useState)(null),[N,f]=(0,t.useState)(null),[b,w]=(0,t.useState)(!1),[C,S]=(0,t.useState)(""),[A,D]=(0,t.useState)(""),[I,T]=(0,t.useState)("PUBLIC"),[E,U]=(0,t.useState)(!1),[B,O]=(0,t.useState)(!1),[L,F]=(0,t.useState)(null),[R,M]=(0,t.useState)(!1),[V,_]=(0,t.useState)(null),[J,G]=(0,t.useState)(""),[q,W]=(0,t.useState)(""),[X,$]=(0,t.useState)("PUBLIC"),[Y,es]=(0,t.useState)(!1),en=e=>{var l,t;let a={Accept:"application/json","Content-Type":"application/json",...c||{},...e.headers||{}};return i&&(a.Authorization="Bearer ".concat(i)),{method:null!=(l=e.method)?l:"GET",headers:a,body:null!=(t=e.body)?t:void 0,credentials:d?"include":"same-origin"}};(0,t.useEffect)(()=>{let e=!0;return async function(){j(!0),y(null);let l=ea(r);if(null===l){j(!1),y('Invalid clientId: "'.concat(String(r),'". Cannot convert to numeric ID.'));return}try{let t=await fetch("".concat(ee,"/clients/").concat(l,"/notes"),en({method:"GET"}));if(!t.ok){let e=await t.text();throw Error("Failed to load notes: ".concat(t.status," ").concat(e))}let a=await t.json(),s=Array.isArray(a)?a.map(e=>{var l,t,a;return{id:e.id,clientId:e.clientId,title:null!=(l=e.title)?l:"Untitled",content:null!=(t=e.detail)?t:null,type:null!=(a=e.type)?a:"PRIVATE",createdBy:e.createdBy,createdAt:e.createdAt}}):[];e&&h(s)}catch(l){var t;console.error(l),e&&y(null!=(t=null==l?void 0:l.message)?t:"Unable to load notes")}finally{e&&j(!1)}}(),()=>{e=!1}},[r]);let er=async e=>{h(l=>l.filter(l=>l.id!==e.id)),m&&m(e);let l=ea(r);if(null===l)return void y("Invalid clientId while deleting note.");try{let t=await fetch("".concat(et,"/clients/").concat(l,"/notes/").concat(e.id),en({method:"DELETE"}));if(!t.ok){let e=await t.text();throw Error("Delete failed: ".concat(t.status," ").concat(e))}}catch(e){console.error(e),y("Failed to delete note")}},ei=()=>{w(!1),U(!1)},ec=async()=>{var e,l,t,a,s,n,i,c;if(!C.trim())return void y("Please enter a note title.");y(null),U(!0);let d=ea(r);if(null===d){y("Invalid clientId while saving note."),U(!1);return}try{let r={title:C,detail:A,type:I},c=await fetch("".concat(el,"/clients/").concat(d,"/notes"),en({method:"POST",body:JSON.stringify(r)}));if(!c.ok){let e=await c.text();throw Error("Failed to save note: ".concat(c.status," ").concat(e))}let o=await c.json(),u={id:null!=(e=null==o?void 0:o.id)?e:Date.now(),clientId:null!=(l=null==o?void 0:o.clientId)?l:d,title:null!=(t=null==o?void 0:o.title)?t:r.title,content:null!=(a=null==o?void 0:o.detail)?a:r.detail,type:null!=(s=null==o?void 0:o.type)?s:r.type,createdBy:null!=(n=null==o?void 0:o.createdBy)?n:void 0,createdAt:null!=(i=null==o?void 0:o.createdAt)?i:new Date().toISOString()};h(e=>[u,...e]),ei()}catch(e){console.error(e),y(null!=(c=null==e?void 0:e.message)?c:"Failed to save note"),U(!1)}},ed=()=>{O(!1),F(null)},eo=()=>{M(!1),es(!1),_(null)},eu=async()=>{var e,l,t,a,s,n,i,c;if(!J.trim())return void y("Please enter a note title.");y(null),es(!0);let d=ea(r);if(null===d||null===V){y("Invalid clientId or note id while updating."),es(!1);return}try{let r={title:J,detail:q,type:X},c=await fetch("".concat(el,"/clients/").concat(d,"/notes/").concat(V),en({method:"PUT",body:JSON.stringify(r)}));if(!c.ok){let e=await c.text();throw Error("Failed to update note: ".concat(c.status," ").concat(e))}let o=await c.json(),u={id:null!=(e=null==o?void 0:o.id)?e:V,clientId:null!=(l=null==o?void 0:o.clientId)?l:d,title:null!=(t=null==o?void 0:o.title)?t:r.title,content:null!=(a=null==o?void 0:o.detail)?a:r.detail,type:null!=(s=null==o?void 0:o.type)?s:r.type,createdBy:null!=(n=null==o?void 0:o.createdBy)?n:void 0,createdAt:null!=(i=null==o?void 0:o.createdAt)?i:void 0};h(e=>e.map(e=>e.id===u.id?u:e)),eo()}catch(e){console.error(e),y(null!=(c=null==e?void 0:e.message)?c:"Failed to update note"),es(!1)}};return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsxs)("div",{className:"bg-white rounded shadow-sm border",children:[(0,l.jsx)("div",{className:"p-4 flex items-center justify-between border-b",children:(0,l.jsxs)("button",{type:"button",className:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white text-sm px-3 py-2 rounded",onClick:()=>{S(""),D(""),T("PUBLIC"),w(!0),null==u||u({id:0,title:"",type:"PRIVATE",content:""})},children:[(0,l.jsx)(g.Plus,{size:16})," Add Note"]})}),(0,l.jsxs)("div",{className:"p-4",children:[p&&(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Loading notes…"}),v&&(0,l.jsxs)("div",{className:"text-sm text-red-600 mb-2",children:["Error: ",v]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-blue-50 text-left rounded-t-md",children:[(0,l.jsx)("th",{className:"px-4 py-3 w-1/2 rounded-tl-md",children:"Note Title"}),(0,l.jsx)("th",{className:"px-4 py-3 w-1/4",children:"Note Type"}),(0,l.jsx)("th",{className:"px-4 py-3 w-1/6 text-right rounded-tr-md",children:"Action"})]})}),(0,l.jsx)("tbody",{children:0!==x.length||p?x.map(e=>(0,l.jsxs)("tr",{className:"border-t",children:[(0,l.jsx)("td",{className:"px-4 py-4",children:e.title}),(0,l.jsx)("td",{className:"px-4 py-4",children:(0,l.jsx)("div",{className:"flex items-center gap-2 text-gray-600",children:"PUBLIC"===e.type?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(K.Globe,{size:14})," ",(0,l.jsx)("span",{className:"text-xs",children:"Public"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.Lock,{size:14})," ",(0,l.jsx)("span",{className:"text-xs",children:"Private"})]})})}),(0,l.jsxs)("td",{className:"px-4 py-4 text-right relative",children:[(0,l.jsx)("button",{onClick:()=>f(N===e.id?null:e.id),className:"p-1 rounded hover:bg-gray-100",children:(0,l.jsx)(z.MoreVertical,{size:18})}),N===e.id&&(0,l.jsxs)("div",{className:"absolute right-2 mt-2 w-44 bg-white border rounded shadow-lg z-30",children:[(0,l.jsxs)("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>{f(null),F(e),O(!0),null==o||o(e)},children:[(0,l.jsx)(k.Eye,{size:14})," View"]}),(0,l.jsxs)("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>{var l,t;f(null),_(e.id),G(null!=(l=e.title)?l:""),W(null!=(t=e.content)?t:""),$("PUBLIC"===e.type?"PUBLIC":"PRIVATE"),M(!0),null==u||u(e)},children:[(0,l.jsx)(Q.Edit,{size:14})," Edit"]}),(0,l.jsxs)("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-gray-50",onClick:()=>{f(null),er(e)},children:[(0,l.jsx)(H.Trash2,{size:14})," Delete"]})]})]})]},e.id)):(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-500",children:"No notes found."})})})]})})]})]}),b&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:()=>!E&&ei()}),(0,l.jsxs)("div",{className:"relative z-10 w-[900px] max-w-[95%] bg-white rounded-lg shadow-xl border",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h4",{className:"text-lg font-medium",children:"Add Project Note"}),(0,l.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>!E&&ei(),children:(0,l.jsx)(P.X,{size:18})})]}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,l.jsx)("h5",{className:"text-sm font-medium mb-4",children:"Client Note Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,l.jsxs)("div",{className:"col-span-12 md:col-span-6",children:[(0,l.jsxs)("label",{className:"block text-xs text-gray-600 mb-2",children:["Note Title ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{value:C,onChange:e=>S(e.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"--"})]}),(0,l.jsxs)("div",{className:"col-span-12 md:col-span-6 flex items-center gap-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{id:"note-public",type:"radio",name:"noteType",checked:"PUBLIC"===I,onChange:()=>T("PUBLIC")}),(0,l.jsx)("label",{htmlFor:"note-public",className:"text-sm text-gray-700",children:"Public"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{id:"note-private",type:"radio",name:"noteType",checked:"PRIVATE"===I,onChange:()=>T("PRIVATE")}),(0,l.jsx)("label",{htmlFor:"note-private",className:"text-sm text-gray-700",children:"Private"})]})]}),(0,l.jsxs)("div",{className:"col-span-12",children:[(0,l.jsx)("label",{className:"block text-xs text-gray-600 mb-2",children:"Note Detail"}),(0,l.jsx)("textarea",{value:A,onChange:e=>D(e.target.value),className:"w-full border rounded px-3 py-3 text-sm min-h-[120px]",placeholder:"--"})]})]})]})}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-4 p-6 border-t",children:[(0,l.jsx)("button",{className:"px-6 py-2 text-sm border rounded hover:bg-gray-50",onClick:()=>!E&&ei(),children:"Cancel"}),(0,l.jsx)("button",{className:"px-6 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",onClick:ec,disabled:E,children:E?"Saving…":"Save"})]})]})]}),B&&L&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:()=>ed()}),(0,l.jsxs)("div",{className:"relative z-10 w-[900px] max-w-[95%] bg-white rounded-lg shadow-xl border",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h4",{className:"text-lg font-medium",children:null!=(a=L.title)?a:"My Note"}),(0,l.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>ed(),children:(0,l.jsx)(P.X,{size:18})})]}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,l.jsx)("h5",{className:"text-sm font-medium mb-4",children:"Project Note Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-6 text-sm text-gray-700",children:[(0,l.jsxs)("div",{className:"col-span-12 md:col-span-4",children:[(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Note Title"}),(0,l.jsx)("div",{className:"mt-2",children:null!=(s=L.title)?s:"---"})]}),(0,l.jsxs)("div",{className:"col-span-12 md:col-span-4",children:[(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Note Type"}),(0,l.jsx)("div",{className:"mt-2",children:"PUBLIC"===L.type?"Public":"Private"})]}),(0,l.jsxs)("div",{className:"col-span-12 md:col-span-4",children:[(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Note Detail"}),(0,l.jsx)("div",{className:"mt-2 whitespace-pre-wrap",children:null!=(n=L.content)?n:"---"})]})]})]})}),(0,l.jsx)("div",{className:"flex items-center justify-center gap-4 p-6 border-t",children:(0,l.jsx)("button",{className:"px-6 py-2 text-sm border rounded hover:bg-gray-50",onClick:()=>ed(),children:"Close"})})]})]}),R&&null!==V&&(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:()=>!Y&&eo()}),(0,l.jsxs)("div",{className:"relative z-10 w-[900px] max-w-[95%] bg-white rounded-lg shadow-xl border",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h4",{className:"text-lg font-medium",children:"Update Project Note"}),(0,l.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>!Y&&eo(),children:(0,l.jsx)(P.X,{size:18})})]}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,l.jsx)("h5",{className:"text-sm font-medium mb-4",children:"Project Note Details"}),(0,l.jsxs)("div",{className:"grid grid-row-12 gap-4",children:[(0,l.jsxs)("div",{className:"col-span-12 md:row-span-6",children:[(0,l.jsxs)("label",{className:"block text-xs text-gray-600 mb-2",children:["Note Title ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{value:J,onChange:e=>G(e.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"--"})]}),(0,l.jsxs)("div",{className:"col-span-12 md:col-span-6 flex items-center gap-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{id:"edit-note-public",type:"radio",name:"editNoteType",checked:"PUBLIC"===X,onChange:()=>$("PUBLIC")}),(0,l.jsx)("label",{htmlFor:"edit-note-public",className:"text-sm text-gray-700",children:"Public"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{id:"edit-note-private",type:"radio",name:"editNoteType",checked:"PRIVATE"===X,onChange:()=>$("PRIVATE")}),(0,l.jsx)("label",{htmlFor:"edit-note-private",className:"text-sm text-gray-700",children:"Private"})]})]}),(0,l.jsxs)("div",{className:"col-span-12",children:[(0,l.jsx)("label",{className:"block text-xs text-gray-600 mb-2",children:"Note Detail"}),(0,l.jsx)("textarea",{value:q,onChange:e=>W(e.target.value),className:"w-full border rounded px-3 py-3 text-sm min-h-[120px]",placeholder:"--"})]})]})]})}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-4 p-6 border-t",children:[(0,l.jsx)("button",{className:"px-6 py-2 text-sm border rounded hover:bg-gray-50",onClick:()=>!Y&&eo(),children:"Cancel"}),(0,l.jsx)("button",{className:"px-6 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",onClick:eu,disabled:Y,children:Y?"Updating…":"Update"})]})]})]})]})}let en="".concat("https://6jnqmj85-80.inc1.devtunnels.ms"),er=e=>{if(!e)return null;try{return JSON.parse(e)}catch(l){try{let l=e.trim();if(l.startsWith('"')&&l.endsWith('"')||l.startsWith("'")&&l.endsWith("'"))return JSON.parse(l.slice(1,-1))}catch(e){}return null}},ei=["IN_PROGRESS","NOT_STARTED","ON_HOLD","CANCELLED","FINISHED"];function ec(){let{id:e}=(0,a.useParams)(),s=(0,a.useRouter)(),[r,i]=(0,t.useState)(null),[c,d]=(0,t.useState)(!0),[o,m]=(0,t.useState)(null),[x,p]=(0,t.useState)(null),[v,N]=(0,t.useState)(null),[g,f]=(0,t.useState)(null),[b,w]=(0,t.useState)(null),[C,A]=(0,t.useState)([]),[D,I]=(0,t.useState)(!1),[T,E]=(0,t.useState)(null),[U,B]=(0,t.useState)([]),[J,G]=(0,t.useState)(!1),[W,$]=(0,t.useState)(null),[K,Z]=(0,t.useState)([]),[Q,ee]=(0,t.useState)(!1),[el,et]=(0,t.useState)([]),[ea,ec]=(0,t.useState)(!1),[ed,eo]=(0,t.useState)([]),[eu,em]=(0,t.useState)(!1),[ex,eh]=(0,t.useState)("profile"),ep=localStorage.getItem("accessToken"),ej=(0,t.useCallback)(async()=>{d(!0),m(null);try{let l=await fetch("".concat(en,"/clients/").concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")||"")}});if(!l.ok)throw Error("Failed to fetch client (".concat(l.status,")"));let t=await l.json();i(function(e){if(!e)return e;let l=e.company,t="";if(l)if("string"==typeof l)t=l;else if("object"==typeof l){var a,s,n;t=null!=(n=null!=(s=null!=(a=l.companyName)?a:l.name)?s:l.company)?n:JSON.stringify(l)}else t=String(l);else t="";return{...e,company:t}}(t))}catch(e){var l;m(null!=(l=null==e?void 0:e.message)?l:"An error occurred"),i(null)}finally{d(!1)}},[e]),ev=(0,t.useCallback)(async()=>{ee(!0);try{let e=await fetch("".concat(en,"/api/projects/category"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")||"")}});if(!e.ok){Z([]),ee(!1);return}let l=await e.json();Array.isArray(l)?l.length>0&&"string"==typeof l[0]?Z(l.map((e,l)=>({id:l+1,name:String(e)}))):Z(l.map(e=>{var l,t,a;return{id:null!=(t=null!=(l=e.id)?l:e.name)?t:Math.random(),name:null!=(a=e.name)?a:String(e)}})):Z([])}catch(e){console.error("loadCategories",e),Z([])}finally{ee(!1)}},[]),ey=(0,t.useCallback)(async()=>{ec(!0);try{let e=await fetch("".concat(en,"/clients"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")||"")}});if(!e.ok){et([]),ec(!1);return}let l=await e.json();Array.isArray(l)?et(l):Array.isArray(l.items)?et(l.items):et([])}catch(e){console.error("loadClients",e),et([])}finally{ec(!1)}},[]),eN=(0,t.useCallback)(async()=>{em(!0);try{let e=await fetch("".concat(en,"/admin/departments"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")||"")}});if(!e.ok){eo([]),em(!1);return}let l=await e.json();Array.isArray(l)?eo(l):Array.isArray(l.items)?eo(l.items):eo([])}catch(e){console.error("loadDepartments",e),eo([])}finally{em(!1)}},[]);async function eg(e){var l,t,a,s,n,r;let i={Authorization:"Bearer ".concat(localStorage.getItem("accessToken")||"")};try{let s=await fetch("".concat(en,"/api/projects/client/").concat(e,"/stats"),{headers:i}),n=await s.text(),r=null!=(l=er(n))?l:s.ok?JSON.parse(n||"{}"):null,c=r&&"object"==typeof r&&(void 0!==r.projectCount||void 0!==r.totalEarning)?r:r&&"object"==typeof r&&r["Response Body"]?er(r["Response Body"]):r;p(Number(null!=(t=null==c?void 0:c.projectCount)?t:0)),N(Number(null!=(a=null==c?void 0:c.totalEarning)?a:0))}catch(e){p(0),N(0)}try{let l=await fetch("".concat(en,"/api/invoices/client/").concat(e,"/stats/unpaid"),{headers:i}),t=await l.text(),a=null!=(s=er(t))?s:l.ok?JSON.parse(t||"{}"):null,c=a&&"object"==typeof a&&(void 0!==a.unpaidInvoiceCount||void 0!==a.totalUnpaidAmount)?a:a&&"object"==typeof a&&a["Response Body"]?er(a["Response Body"]):a;f(Number(null!=(n=null==c?void 0:c.unpaidInvoiceCount)?n:0)),w(Number(null!=(r=null==c?void 0:c.totalUnpaidAmount)?r:0))}catch(e){f(0),w(0)}}async function ef(e){var l,t;I(!0),E(null);try{let t=await fetch("".concat(en,"/api/projects/client/").concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")||"")}}),a=await t.text(),s=null!=(l=er(a))?l:t.ok?JSON.parse(a||"[]"):null,n=[];if(Array.isArray(s))n=s;else if(s&&Array.isArray(s.projects))n=s.projects;else if(s&&Array.isArray(s.data))n=s.data;else if(s&&s.ResponseBody){let e=er(s.ResponseBody);Array.isArray(e)&&(n=e)}let i=n.map(e=>{var l,t,a,s,n,i,c,d,o,u,m,x,h,p,j,v,y,N,g,f,b;return{id:null!=(a=null!=(t=null!=(l=e.id)?l:e.projectId)?t:e._id)?a:String(Math.random()),shortCode:null!=(c=null!=(i=null!=(n=null!=(s=e.shortCode)?s:e.code)?n:e.projectCode)?i:e.project_code)?c:e.id,name:null!=(u=null!=(o=null!=(d=e.name)?d:e.projectName)?o:e.title)?u:"Project Name",members:Array.isArray(e.assignedEmployees)&&e.assignedEmployees.length?e.assignedEmployees.map(e=>{var l,t,a;return{id:null!=(l=e.employeeId)?l:e.id,name:null!=(t=e.name)?t:e.fullName,avatarUrl:null!=(a=e.profileUrl)?a:e.profilePictureUrl}}):Array.isArray(e.members)?e.members:[],startDate:null!=(x=null!=(m=e.startDate)?m:e.start_date)?x:e.start,deadline:null!=(p=null!=(h=e.deadline)?h:e.endDate)?p:e.end_date,client:null!=(j=e.client)?j:e.clientId?{clientId:e.clientId,name:null==r?void 0:r.name,profilePictureUrl:null==r?void 0:r.profilePictureUrl}:void 0,progressPercent:"number"==typeof e.progressPercent?e.progressPercent:"number"==typeof e.progress?e.progress:null!=(v=e.progress)?v:0,projectStatus:null!=(N=null!=(y=e.projectStatus)?y:e.status)?N:"NOT_STARTED",pinned:!!(null!=(g=e.pinned)?g:e.isPinned),archived:!!(null!=(f=e.archived)?f:e.isArchived),noDeadline:!!(null!=(b=e.noDeadline)&&b)}});A(i)}catch(e){E(null!=(t=null==e?void 0:e.message)?t:"Failed to fetch projects"),A([])}finally{I(!1)}}async function eb(e){var l,t;G(!0),$(null);try{let t=await fetch("".concat(en,"/api/invoices/client/").concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")||"")}}),a=await t.text(),s=null!=(l=er(a))?l:t.ok?JSON.parse(a||"[]"):null,n=[];if(Array.isArray(s))n=s;else if(s&&Array.isArray(s.invoices))n=s.invoices;else if(s&&Array.isArray(s.data))n=s.data;else if(s&&s.ResponseBody){let e=er(s.ResponseBody);Array.isArray(e)&&(n=e)}let r=n.map(e=>{var l,t,a,s;return{id:null!=(l=e.id)?l:e.invoiceId,invoiceNumber:e.invoiceNumber,invoiceDate:e.invoiceDate,currency:e.currency,project:null!=(t=e.project)?t:{projectName:e.projectName,projectCode:e.projectCode},total:"number"==typeof e.total?e.total:Number(null!=(a=e.total)?a:0),unpaidAmount:"number"==typeof e.unpaidAmount?e.unpaidAmount:Number(null!=(s=e.unpaidAmount)?s:0),status:e.status,createdAt:e.createdAt}});B(r)}catch(e){$(null!=(t=null==e?void 0:e.message)?t:"Failed to fetch invoices"),B([])}finally{G(!1)}}let ew=()=>localStorage.getItem("accessToken")||"";async function eC(e,l){let t=C.slice();A(t=>t.map(t=>t.id===e?{...t,projectStatus:l}:t));try{let t=new FormData;t.append("status",l);let a=await fetch("".concat(en,"/api/projects/").concat(e,"/status"),{method:"PATCH",body:t,headers:{Authorization:"Bearer ".concat(ew())}});if(!a.ok)throw Error("Status patch failed");try{let e=await a.json();e&&e.id?A(l=>l.map(l=>l.id===e.id?{...l,...e}:l)):(null==r?void 0:r.clientId)&&await ef(r.clientId)}catch(e){(null==r?void 0:r.clientId)&&await ef(r.clientId)}}catch(e){console.error("Status update failed",e),A(t),alert("Failed to update project status")}}async function eS(e,l){let t=Math.max(0,Math.min(100,Math.round(l))),a=C.slice();A(l=>l.map(l=>l.id===e?{...l,progressPercent:t}:l));try{let l=new FormData;l.append("percent",String(t));let s=await fetch("".concat(en,"/api/projects/").concat(e,"/progress"),{method:"PATCH",body:l,headers:{Authorization:"Bearer ".concat(ew())}});if(401===s.status){A(a),localStorage.removeItem("accessToken"),alert("Session expired. Please login again.");return}if(!s.ok){let e=await s.text().catch(()=>"");console.error("patchProgress failed:",s.status,e),A(a),alert("Failed to update progress on server");return}try{if(204!==s.status){let e=await s.json();e&&e.id?A(l=>l.map(l=>l.id===e.id?{...l,...e}:l)):(null==r?void 0:r.clientId)&&await ef(r.clientId)}}catch(e){(null==r?void 0:r.clientId)&&await ef(r.clientId)}}catch(e){console.error("Progress update failed:",e),A(a),alert("Failed to update progress on server")}}async function ek(e){let l=C.slice(),t=C.findIndex(l=>l.id===e);if(-1===t)return;let a=!C[t].pinned;A(l=>l.map(l=>l.id===e?{...l,pinned:a}:l));try{let l=await fetch("".concat(en,"/projects/").concat(e,"/pin"),{method:"POST",headers:{Authorization:"Bearer ".concat(ew()),"Content-Type":"application/json"},body:JSON.stringify({pinned:a})});if(!l.ok)throw Error("Pin failed");try{let e=await l.json();e&&e.id?A(l=>l.map(l=>l.id===e.id?{...l,...e}:l)):(null==r?void 0:r.clientId)&&await ef(r.clientId)}catch(e){(null==r?void 0:r.clientId)&&await ef(r.clientId)}}catch(e){console.error("Pin toggle error",e),A(l),alert("Failed to toggle pin")}}async function eA(e){let l=C.slice(),t=C.findIndex(l=>l.id===e);if(-1===t)return;let a=!C[t].archived;A(l=>l.map(l=>l.id===e?{...l,archived:a}:l));try{let l=await fetch("".concat(en,"/projects/").concat(e,"/archive"),{method:"POST",headers:{Authorization:"Bearer ".concat(ew()),"Content-Type":"application/json"},body:JSON.stringify({archived:a})});if(!l.ok)throw Error("Archive toggle failed");try{let e=await l.json();e&&e.id?A(l=>l.map(l=>l.id===e.id?{...l,...e}:l)):(null==r?void 0:r.clientId)&&await ef(r.clientId)}catch(e){(null==r?void 0:r.clientId)&&await ef(r.clientId)}}catch(e){console.error("Archive toggle error",e),A(l),alert("Failed to toggle archive state on server")}}let eD=async e=>{if(!confirm("Delete this project?"))return;let l=C.slice();A(l=>l.filter(l=>l.id!==e));try{if(!(await fetch("".concat(en,"/api/projects/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(ew())}})).ok)throw Error("Delete failed")}catch(e){console.error(e),A(l),alert("Failed to delete project")}},[eI,eT]=(0,t.useState)(!1),[eP,eE]=(0,t.useState)(""),[eU,eB]=(0,t.useState)(""),[eO,eL]=(0,t.useState)(""),[eF,eR]=(0,t.useState)(""),[ez,eM]=(0,t.useState)(!1),[eV,eH]=(0,t.useState)("none"),[e_,eJ]=(0,t.useState)("none"),[eG,eq]=(0,t.useState)("none"),[eW,eX]=(0,t.useState)(""),[e$,eY]=(0,t.useState)(!0),[eK,eZ]=(0,t.useState)(""),[eQ,e0]=(0,t.useState)(null),e1=(0,t.useRef)(null),[e2,e4]=(0,t.useState)("USD"),[e3,e6]=(0,t.useState)(""),[e5,e8]=(0,t.useState)(""),[e7,e9]=(0,t.useState)(!1),[le,ll]=(0,t.useState)("you"),[lt,la]=(0,t.useState)(!1),ls=null==r?void 0:r.clientId,ln=null==r?void 0:r.id,lr=()=>{eE(""),eB(""),eL(""),eR(""),eM(!1),eH("none"),eJ("none"),eq((null==r?void 0:r.clientId)?String(r.clientId):"none"),eX(""),eY(!0),eZ(""),e0(null),e4("USD"),e6(""),e8(""),e9(!1),ll("you"),la(!1)},li=async()=>{if(!eU.trim())return alert("Project Name is required");la(!0);try{var e;let l=eP.trim();if(!l){let e=eU.toString().normalize("NFKD").replace(/[\u0300-\u036F]/g,"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"");l=e?e.toUpperCase().replace(/-/g,"").slice(0,10):"PRJ".concat(Date.now().toString().slice(-6))}let t=new FormData;t.append("shortCode",l),t.append("name",eU),t.append("projectName",eU),t.append("startDate",eO||""),ez?t.append("deadline",""):t.append("deadline",eF||""),t.append("noDeadline",String(!!ez)),t.append("category","none"===eV?"":String(eV)),t.append("department","none"===e_?"":String(e_)),t.append("clientId","none"===eG?null!=(e=null==r?void 0:r.clientId)?e:"":String(eG)),t.append("summary",eW||""),t.append("tasksNeedAdminApproval",String(!!e$));let a=Array.isArray(eK)?eK:String(eK||"").split(",").map(e=>e.trim()).filter(Boolean);t.append("assignedEmployeeIds",JSON.stringify(a)),eQ&&t.append("companyFile",eQ),t.append("currency",e2||""),t.append("budget",""!==e3?String(e3):"0"),t.append("hoursEstimate",""!==e5?String(e5):"0"),t.append("allowManualTimeLogs",String(!!e7)),t.append("addedBy",String(le||""));let s=await fetch("".concat(en,"/api/projects"),{method:"POST",body:t,headers:{Authorization:"Bearer ".concat(ew())}});if(!s.ok){let e=await s.text().catch(()=>"");console.error("Create project failed",s.status,e);let l="Failed to create project (status ".concat(s.status,")");try{let t=JSON.parse(e||"{}");t&&t.message&&(l=t.message)}catch(e){}alert(l),la(!1);return}try{await s.json()}catch(e){}(null==r?void 0:r.clientId)&&await ef(r.clientId),eT(!1),lr()}catch(e){console.error("Create project error",e),alert("Failed to create project")}finally{la(!1)}};if((0,t.useEffect)(()=>{e&&ej(),ev(),ey(),eN()},[e]),(0,t.useEffect)(()=>{(null==r?void 0:r.clientId)&&eg(r.clientId)},[r]),(0,t.useEffect)(()=>{(null==r?void 0:r.clientId)&&ef(r.clientId)},[r]),(0,t.useEffect)(()=>{"invoices"===ex&&(null==r?void 0:r.clientId)&&eb(r.clientId)},[ex,r]),c)return(0,l.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Loading client details..."})]})});if(o||!r)return(0,l.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,l.jsxs)("div",{className:"w-full max-w-md p-6 border rounded",children:[(0,l.jsx)("h3",{className:"text-destructive text-xl mb-2",children:"Error"}),(0,l.jsx)("p",{className:"mb-4",children:o||"Client not found"}),(0,l.jsx)("div",{children:(0,l.jsx)("button",{className:"px-3 py-2 border rounded",onClick:()=>s.push("/clients"),children:"Back to Clients"})})]})});function lc(e){var t,a,i,c,d,o,u,m,x,h,p,j;let{p:v}=e,N=v.startDate?new Date(v.startDate).toLocaleDateString():"-",g=v.noDeadline?"No Deadline":v.deadline?new Date(v.deadline).toLocaleDateString():"-",f=Math.max(0,Math.min(100,Number(null!=(o=v.progressPercent)?o:0)));return(0,l.jsxs)(F.TableRow,{className:"bg-white hover:bg-gray-50",children:[(0,l.jsx)(F.TableCell,{className:"py-4 px-4 align-top w-28",children:(0,l.jsx)("div",{className:"text-sm font-medium",children:null!=(u=v.shortCode)?u:v.id})}),(0,l.jsx)(F.TableCell,{className:"py-4 px-4 align-top",children:(0,l.jsx)("div",{className:"font-medium",children:v.name})}),(0,l.jsx)(F.TableCell,{className:"py-4 px-4 align-top",children:(0,l.jsx)("div",{className:"text-sm",children:Array.isArray(v.members)&&v.members.length?v.members.map(e=>{var l;return null!=(l=e.name)?l:e}).slice(0,3).join(", "):"-"})}),(0,l.jsx)(F.TableCell,{className:"py-4 px-4 align-top text-sm",children:N}),(0,l.jsx)(F.TableCell,{className:"py-4 px-4 align-top text-sm",children:g}),(0,l.jsx)(F.TableCell,{className:"py-4 px-4 align-top",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center",children:(null==(t=v.client)?void 0:t.profilePictureUrl)?(0,l.jsx)("img",{src:v.client.profilePictureUrl,alt:null==(a=v.client)?void 0:a.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"text-xs text-gray-500",children:((null==(i=v.client)?void 0:i.name)||"C").charAt(0)})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-medium",children:null!=(m=null==(c=v.client)?void 0:c.name)?m:"Client"}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:null!=(x=null==(d=v.client)?void 0:d.company)?x:""})]})]})}),(0,l.jsx)(F.TableCell,{className:"py-4 px-4 align-top",children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("div",{className:"w-44 cursor-pointer",title:"Click to filter by this progress bucket",children:(0,l.jsxs)("div",{className:"relative bg-gray-200 h-4 rounded-full overflow-hidden",children:[(0,l.jsx)("div",{className:"h-4 rounded-full ".concat(null==f?"bg-gray-300":f<33?"bg-red-500":f<66?"bg-yellow-400":"bg-green-500"),style:{width:"".concat(f,"%")}}),(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,l.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow-sm",children:[f,"%"]})})]})}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,l.jsxs)("button",{className:"inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs ".concat((e=>{switch(e){case"IN_PROGRESS":return"bg-green-600 text-white";case"NOT_STARTED":default:return"bg-gray-400 text-white";case"ON_HOLD":return"bg-yellow-500 text-white";case"CANCELLED":return"bg-red-600 text-white";case"FINISHED":return"bg-blue-600 text-white"}})(v.projectStatus)),title:"Status",children:[(0,l.jsx)("span",{className:"w-2 h-2 rounded-full",style:{background:(e=>{switch(e){case"IN_PROGRESS":return"#10B981";case"NOT_STARTED":default:return"#9CA3AF";case"ON_HOLD":return"#F59E0B";case"CANCELLED":return"#EF4444";case"FINISHED":return"#3B82F6"}})(v.projectStatus)}}),(0,l.jsx)("span",{children:null!=(h=v.projectStatus)?h:"N/A"})]}),(0,l.jsxs)(y.DropdownMenu,{children:[(0,l.jsx)(y.DropdownMenuTrigger,{asChild:!0,children:(0,l.jsx)("button",{className:"inline-flex items-center gap-1 px-2 py-1 border rounded text-sm bg-white hover:bg-gray-50",children:(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"▾"})})}),(0,l.jsxs)(y.DropdownMenuContent,{align:"start",className:"w-64 p-2",children:[(0,l.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Change status"}),(0,l.jsx)("div",{className:"space-y-1",children:ei.map(e=>(0,l.jsx)("button",{onClick:()=>eC(v.id,e),className:"w-full text-left px-3 py-2 rounded text-sm hover:bg-gray-50 ".concat(e===v.projectStatus?"font-medium":""),children:e},e))}),(0,l.jsx)(y.DropdownMenuSeparator,{}),(0,l.jsx)("div",{className:"text-xs text-gray-500 mt-2 mb-1",children:"Adjust progress"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("input",{type:"range",min:0,max:100,value:null!=(p=v.progressPercent)?p:0,onChange:e=>{let l=Number(e.target.value);A(e=>e.map(e=>e.id===v.id?{...e,progressPercent:l}:e))},onMouseUp:async e=>{let l=Number(e.target.value);await eS(v.id,l)},onTouchEnd:async e=>{let l=Number(e.target.value);await eS(v.id,l)},className:"w-full"}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,l.jsx)("span",{children:"0%"}),(0,l.jsxs)("span",{children:[null!=(j=v.progressPercent)?j:0,"%"]}),(0,l.jsx)("span",{children:"100%"})]})]}),(0,l.jsx)("div",{className:"flex justify-end mt-2",children:(0,l.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>(null==r?void 0:r.clientId)&&ef(r.clientId),children:"Refresh"})})]})]})]})]})}),(0,l.jsx)(F.TableCell,{className:"py-4 px-4 align-top text-right",children:(0,l.jsxs)(y.DropdownMenu,{children:[(0,l.jsx)(y.DropdownMenuTrigger,{asChild:!0,children:(0,l.jsx)(n.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,l.jsx)(z.MoreVertical,{className:"h-4 w-4"})})}),(0,l.jsxs)(y.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,l.jsxs)(y.DropdownMenuItem,{onClick:()=>s.push("/work/project/".concat(v.id)),children:[(0,l.jsx)(k.Eye,{className:"h-4 w-4 mr-2"})," View"]}),(0,l.jsxs)(y.DropdownMenuItem,{onClick:()=>s.push("/work/project/".concat(v.id,"/edit")),children:[(0,l.jsx)(S.Edit2,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,l.jsxs)(y.DropdownMenuItem,{onClick:()=>ek(v.id),children:[(0,l.jsx)(M.Pin,{className:"h-4 w-4 mr-2"})," ",v.pinned?"Unpin":"Pin"," ","Project"]}),(0,l.jsxs)(y.DropdownMenuItem,{onClick:()=>eA(v.id),children:[(0,l.jsx)(V.Archive,{className:"h-4 w-4 mr-2"})," ",v.archived?"Unarchive":"Archive"]}),(0,l.jsx)(y.DropdownMenuSeparator,{}),(0,l.jsxs)(y.DropdownMenuItem,{onClick:()=>eD(v.id),className:"text-red-600",children:[(0,l.jsx)(H.Trash2,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})})]},v.id)}return(0,l.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,l.jsx)(u,{clientName:r.name,clientId:r.clientId,onBack:()=>s.push("/clients"),onOpenTab:e=>eh(e),activeTab:ex}),"profile"===ex&&(0,l.jsx)(h,{projectCount:x,totalEarning:v,unpaidInvoiceCount:g,totalUnpaidAmount:b}),"creditnotes"===ex&&(0,l.jsx)(q,{clientId:r.clientId}),"profile"===ex&&(0,l.jsx)(j,{client:r,projects:C}),"projects"===ex&&(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold",children:["Projects for ",r.name]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 border rounded px-2 py-1 bg-white",children:[(0,l.jsx)(_.Search,{className:"w-4 h-4 text-gray-400"}),(0,l.jsx)(L.Input,{placeholder:"Search projects",onChange:()=>{},className:"border-0 bg-transparent focus-visible:ring-0"})]}),(0,l.jsx)(n.Button,{className:"bg-blue-600 text-white",onClick:()=>{eT(!0),eq((null==r?void 0:r.clientId)?String(r.clientId):"none")},children:"+ Add Project"})]})]}),(0,l.jsx)("div",{className:"bg-white rounded-lg border overflow-hidden",children:(0,l.jsx)("div",{className:"overflow-auto p-4",children:D?(0,l.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Loading projects..."}):0===C.length?(0,l.jsx)("div",{className:"p-8 text-center text-gray-500",children:"No projects found"}):(0,l.jsxs)(F.Table,{children:[(0,l.jsx)(F.TableHeader,{children:(0,l.jsxs)(F.TableRow,{className:"bg-blue-50",children:[(0,l.jsx)(F.TableHead,{className:"px-4 py-3",children:"Code"}),(0,l.jsx)(F.TableHead,{className:"px-4 py-3",children:"Project Name"}),(0,l.jsx)(F.TableHead,{className:"px-4 py-3",children:"Member"}),(0,l.jsx)(F.TableHead,{className:"px-4 py-3",children:"Start Date"}),(0,l.jsx)(F.TableHead,{className:"px-4 py-3",children:"Deadline"}),(0,l.jsx)(F.TableHead,{className:"px-4 py-3",children:"Client"}),(0,l.jsx)(F.TableHead,{className:"px-4 py-3",children:"Status"}),(0,l.jsx)(F.TableHead,{className:"px-4 py-3 text-right",children:"Action"})]})}),(0,l.jsx)(F.TableBody,{children:C.map(e=>(0,l.jsx)(lc,{p:e},e.id))})]})})})]}),"invoices"===ex&&(0,l.jsx)(O,{clientId:"".concat(ls)}),("payments"===ex||"Payments"===ex)&&(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)(X,{clientId:r.clientId,onAdd:()=>{},onSearch:e=>{},onAction:e=>{}})}),"notes"===ex&&(0,l.jsx)(es,{clientId:ln,authToken:ep,onView:e=>{},onEdit:e=>{},onDelete:e=>{}}),"documents"===ex&&(0,l.jsx)(Y,{clientId:r,authToken:ep}),eI&&(0,l.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-start justify-center pt-12 px-4 overflow-y-auto",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>{eT(!1),lr()}}),(0,l.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-y-auto z-10",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Add Project"}),(0,l.jsx)("button",{onClick:()=>{eT(!1),lr()},className:"p-2 rounded hover:bg-gray-100",children:(0,l.jsx)(P.X,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Project Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Short Code *"}),(0,l.jsx)(L.Input,{value:eP,onChange:e=>eE(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Project Name *"}),(0,l.jsx)(L.Input,{value:eU,onChange:e=>eB(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date *"}),(0,l.jsx)(L.Input,{type:"date",value:eO,onChange:e=>eL(e.target.value)})]}),(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Deadline *"}),(0,l.jsx)(L.Input,{type:"date",value:eF,onChange:e=>eR(e.target.value),disabled:ez})]}),(0,l.jsx)("div",{className:"pt-6",children:(0,l.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[(0,l.jsx)("input",{type:"checkbox",checked:ez,onChange:e=>eM(e.target.checked)}),(0,l.jsx)("span",{className:"text-xs",children:"There is no project deadline"})]})})]})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Project Category *"}),(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsxs)(R.Select,{value:eV,onValueChange:e=>eH(e),children:[(0,l.jsx)(R.SelectTrigger,{className:"w-full",children:(0,l.jsx)(R.SelectValue,{placeholder:"--"})}),(0,l.jsxs)(R.SelectContent,{children:[(0,l.jsx)(R.SelectItem,{value:"none",children:"--"}),K.map(e=>(0,l.jsx)(R.SelectItem,{value:String(e.id),children:e.name},e.id))]})]})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Department *"}),(0,l.jsxs)(R.Select,{value:e_,onValueChange:e=>eJ(e),children:[(0,l.jsx)(R.SelectTrigger,{className:"w-full",children:(0,l.jsx)(R.SelectValue,{placeholder:"--"})}),(0,l.jsxs)(R.SelectContent,{children:[(0,l.jsx)(R.SelectItem,{value:"none",children:"--"}),ed.map(e=>(0,l.jsx)(R.SelectItem,{value:String(e.id),children:e.departmentName},e.id))]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Client *"}),(0,l.jsxs)(R.Select,{value:eG,onValueChange:e=>eq(e),children:[(0,l.jsx)(R.SelectTrigger,{className:"w-full",children:(0,l.jsx)(R.SelectValue,{placeholder:"--"})}),(0,l.jsxs)(R.SelectContent,{children:[(0,l.jsx)(R.SelectItem,{value:"none",children:"--"}),el.map(e=>{var t;return(0,l.jsx)(R.SelectItem,{value:String(null!=(t=e.clientId)?t:e.id),children:e.name},e.id)})]})]})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Project Summary"}),(0,l.jsx)("textarea",{rows:4,value:eW,onChange:e=>eX(e.target.value),className:"w-full p-2 border rounded"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Tasks needs approval by Admin"}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)("input",{type:"radio",name:"approval",checked:!0===e$,onChange:()=>eY(!0)}),(0,l.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,l.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)("input",{type:"radio",name:"approval",checked:!1===e$,onChange:()=>eY(!1)}),(0,l.jsx)("span",{className:"text-sm",children:"No"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Add Project Members *"}),(0,l.jsx)(L.Input,{placeholder:"Comma separated names",value:Array.isArray(eK)?eK.join(","):eK,onChange:e=>eZ(e.target.value)})]})]})]}),(0,l.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Company Details"}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 mb-2 block",children:"Add File"}),(0,l.jsxs)("div",{onClick:()=>{var e;return null==(e=e1.current)?void 0:e.click()},className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-500",children:[eQ?(0,l.jsx)("div",{children:eQ.name}):(0,l.jsx)("div",{children:"Choose File"}),(0,l.jsx)("input",{ref:e1,type:"file",className:"hidden",onChange:e=>{var l,t;return e0(null!=(t=null==(l=e.target.files)?void 0:l[0])?t:null)}})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Currency"}),(0,l.jsxs)(R.Select,{value:e2,onValueChange:e=>e4(e),children:[(0,l.jsx)(R.SelectTrigger,{className:"w-full",children:(0,l.jsx)(R.SelectValue,{placeholder:"USD"})}),(0,l.jsxs)(R.SelectContent,{children:[(0,l.jsx)(R.SelectItem,{value:"USD",children:"USD $"}),(0,l.jsx)(R.SelectItem,{value:"USD",children:"USD ₹"}),(0,l.jsx)(R.SelectItem,{value:"EUR",children:"EUR €"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Project Budget"}),(0,l.jsx)(L.Input,{value:e3,onChange:e=>e6(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Hours Estimate (In Hours)"}),(0,l.jsx)(L.Input,{value:e5,onChange:e=>e8(e.target.value)})]})]}),(0,l.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,l.jsx)("div",{className:"flex items-center gap-4",children:(0,l.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:e7,onChange:e=>e9(e.target.checked)}),(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"Allow manual time logs"})]})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600 mr-2",children:"Added by*"}),(0,l.jsxs)(R.Select,{value:le,onValueChange:e=>ll(e),children:[(0,l.jsx)(R.SelectTrigger,{className:"w-44",children:(0,l.jsx)(R.SelectValue,{placeholder:"You"})}),(0,l.jsx)(R.SelectContent,{children:(0,l.jsx)(R.SelectItem,{value:"you",children:"You"})})]})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,l.jsx)(n.Button,{variant:"outline",onClick:()=>{eT(!1),lr()},children:"Cancel"}),(0,l.jsx)(n.Button,{className:"bg-blue-600 text-white",onClick:li,disabled:lt,children:lt?"Saving...":"Save"})]})]})]})]})]})}}]);