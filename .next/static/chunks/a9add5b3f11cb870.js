(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,386297,e=>{"use strict";e.s(["default",()=>ei],386297);var t,a=e.i(247167),s=e.i(843476),l=e.i(271645),n=e.i(515288),r=e.i(531278),i=e.i(87316),c=e.i(649582),d=e.i(519455),o=e.i(337822),x=e.i(967489),h=e.i(793479);let u=e=>{var t,a;let{status:l,onStatusChange:n,dateRange:r,onDateRangeChange:u}=e;return(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,s.jsxs)(o.Popover,{children:[(0,s.jsx)(o.PopoverTrigger,{asChild:!0,children:(0,s.jsxs)(d.Button,{variant:"outline",className:"flex h-10 items-center gap-2 rounded-xl border-slate-300 bg-white px-4 text-sm font-normal text-slate-700 shadow-sm",children:[(0,s.jsx)(i.Calendar,{size:16}),r.start&&r.end?"".concat(r.start," â†’ ").concat(r.end):"Duration  Start Date to End Date"]})}),(0,s.jsxs)(o.PopoverContent,{className:"w-80 rounded-xl border bg-white p-4 shadow",children:[(0,s.jsx)("h2",{className:"mb-3 text-sm font-medium text-slate-700",children:"Select Duration"}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-slate-500",children:"Start Date"}),(0,s.jsx)(h.Input,{type:"date",value:null!=(t=r.start)?t:"",onChange:e=>u({...r,start:e.target.value}),className:"mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-slate-500",children:"End Date"}),(0,s.jsx)(h.Input,{type:"date",value:null!=(a=r.end)?a:"",onChange:e=>u({...r,end:e.target.value}),className:"mt-1"})]}),(0,s.jsx)("div",{className:"flex justify-end gap-2 pt-2",children:(0,s.jsx)(d.Button,{variant:"outline",className:"rounded-lg",onClick:()=>u({start:null,end:null}),children:"Reset"})})]})]})]}),(0,s.jsxs)(x.Select,{value:l,onValueChange:e=>n(e),children:[(0,s.jsx)(x.SelectTrigger,{className:"w-40 rounded-xl border-slate-300 bg-white shadow-sm h-10",children:(0,s.jsx)(x.SelectValue,{placeholder:"Status"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"All",children:"All"}),(0,s.jsx)(x.SelectItem,{value:"Waiting",children:"Waiting"}),(0,s.jsx)(x.SelectItem,{value:"Doing",children:"Doing"}),(0,s.jsx)(x.SelectItem,{value:"Completed",children:"Completed"}),(0,s.jsx)(x.SelectItem,{value:"Approval",children:"Approval"})]})]}),(0,s.jsxs)(d.Button,{variant:"outline",className:"ml-auto flex h-10 items-center gap-2 rounded-xl border-slate-300 bg-white px-4 shadow-sm",children:[(0,s.jsx)(c.SlidersHorizontal,{size:16}),"Filters"]})]})};var m=e.i(107233),p=e.i(373264),j=e.i(370956),g=e.i(489853),f=e.i(595468),v=e.i(840433),S=e.i(555436),b=e.i(975157);let N=e=>{let{taskSource:t,onTaskSourceChange:a,viewMode:l,onViewModeChange:n,onAddTask:r,onOpenCalendar:i,onSearchChange:c,onOpenStages:o}=e;return(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,s.jsxs)(d.Button,{onClick:r,className:"flex h-10 items-center gap-2 rounded-xl bg-indigo-500 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-600",children:[(0,s.jsx)(m.Plus,{size:16}),"Add Task"]})}),(0,s.jsxs)("div",{className:"ml-auto flex flex-wrap items-center gap-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(S.Search,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,s.jsx)(h.Input,{placeholder:"Search...",className:"h-10 w-52 rounded-xl border-slate-300 bg-white pl-9 pr-3 text-sm shadow-sm",onChange:e=>null==c?void 0:c(e.target.value)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y,{active:"kanban"===l,onClick:()=>{n("kanban")},icon:(0,s.jsx)(p.LayoutGrid,{size:16})}),(0,s.jsx)(y,{active:"list"===l,onClick:()=>{n("list")},icon:(0,s.jsx)(j.List,{size:16})}),(0,s.jsx)(y,{active:"calendar"===l,onClick:()=>{n("calendar"),i()},icon:(0,s.jsx)(g.CalendarDays,{size:16})}),(0,s.jsx)(y,{active:"approval"===t,onClick:()=>a("approval"),icon:(0,s.jsx)(f.CheckCircle2,{size:16})}),(0,s.jsx)(y,{active:"pinned"===t,onClick:()=>a("pinned"),icon:(0,s.jsx)(v.Pin,{size:16})})]})]})]})},y=e=>{let{active:t,onClick:a,icon:l}=e;return(0,s.jsx)(d.Button,{variant:"outline",size:"icon",onClick:a,className:(0,b.cn)("flex h-9 w-9 items-center justify-center rounded-xl border-slate-300 bg-white shadow-sm",t&&"border-indigo-500 bg-indigo-50 text-indigo-600"),children:l})};var w=e.i(657688),k=e.i(784774),C=e.i(286536),T=e.i(323585),I=e.i(755146);let D=e=>{let{task:t,onView:a,onEdit:l,onDuplicate:n,onTogglePin:r,onDelete:i}=e;return(0,s.jsxs)(I.DropdownMenu,{children:[(0,s.jsx)(I.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(d.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full hover:bg-slate-100",children:(0,s.jsx)(T.MoreVertical,{size:18,className:"text-slate-600"})})}),(0,s.jsxs)(I.DropdownMenuContent,{align:"end",className:"w-40 rounded-xl border border-slate-200 bg-white shadow-lg",children:[(0,s.jsxs)(I.DropdownMenuItem,{className:"flex cursor-pointer items-center gap-2 text-slate-700",onClick:()=>null==a?void 0:a(t),children:[(0,s.jsx)(C.Eye,{size:16}),"View"]}),(0,s.jsx)(I.DropdownMenuSeparator,{}),(0,s.jsxs)(I.DropdownMenuItem,{className:"flex cursor-pointer items-center gap-2 text-slate-700",onClick:()=>null==r?void 0:r(t),children:[(0,s.jsx)(v.Pin,{size:16}),t.pinned?"Unpin Task":"Pin Task"]}),(0,s.jsx)(I.DropdownMenuSeparator,{})]})]})};function E(e){let{task:t}=e,a="https://6jnqmj85-80.inc1.devtunnels.ms",n=window.localStorage.getItem("accessToken"),[r,i]=(0,l.useState)([]),[c,d]=(0,l.useState)(t.taskStage),[o,x]=(0,l.useState)(!1),h=async()=>{try{let e=await fetch("".concat(a,"/status"),{headers:{Authorization:"Bearer ".concat(n)}}),t=await e.json();i(t)}catch(e){console.error("Stage fetch error:",e)}};(0,l.useEffect)(()=>{h()},[]);let u=async e=>{try{x(!0);let s="".concat(a,"/api/projects/tasks/").concat(t.id,"/status?statusId=").concat(e),l=await fetch(s,{method:"PATCH",headers:{Authorization:"Bearer ".concat(n),"Content-Length":"0"}});if(!l.ok){let e=await l.text();throw console.error("Backend says:",e),Error("Failed to update stage")}await l.json();let i=r.find(t=>String(t.id)===e);d(i)}catch(e){console.error("Update error:",e),alert("Failed to update status")}finally{x(!1)}};return(0,s.jsxs)(I.DropdownMenu,{children:[(0,s.jsx)(I.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)("button",{className:"flex w-fit items-center gap-2 rounded-full border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600 hover:bg-slate-100",disabled:o,children:[(0,s.jsx)("span",{className:"h-2 w-2 rounded-full",style:{background:null==c?void 0:c.labelColor}}),o?"Updating...":null==c?void 0:c.name]})}),(0,s.jsx)(I.DropdownMenuContent,{className:"w-40",children:r.map(e=>(0,s.jsxs)(I.DropdownMenuItem,{onClick:()=>u(String(e.id)),className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("span",{className:"h-2 w-2 rounded-full",style:{background:e.labelColor}}),e.name,e.id]},e.id))})]})}let A=e=>{let{tasks:t,onView:a,onEdit:l,onDelete:n,onDuplicate:r,onTogglePin:i}=e;return(0,s.jsx)("div",{className:"w-full overflow-hidden rounded-xl bg-white",children:(0,s.jsxs)(k.Table,{children:[(0,s.jsx)(k.TableHeader,{className:"bg-slate-100",children:(0,s.jsxs)(k.TableRow,{children:[(0,s.jsx)(k.TableHead,{className:"w-[120px] text-slate-600",children:"Code"}),(0,s.jsx)(k.TableHead,{className:"min-w-[260px] text-slate-600",children:"Task Name"}),(0,s.jsx)(k.TableHead,{className:"text-slate-600",children:"Completed On"}),(0,s.jsx)(k.TableHead,{className:"text-slate-600",children:"Start Date"}),(0,s.jsx)(k.TableHead,{className:"text-slate-600",children:"Due Date"}),(0,s.jsx)(k.TableHead,{className:"text-slate-600",children:"Estimated Time"}),(0,s.jsx)(k.TableHead,{className:"text-slate-600",children:"Hours Logged"}),(0,s.jsx)(k.TableHead,{className:"text-slate-600",children:"Assigned To"}),(0,s.jsx)(k.TableHead,{className:"text-slate-600",children:"Status"}),(0,s.jsx)(k.TableHead,{className:"text-right text-slate-600",children:"Action"})]})}),(0,s.jsx)(k.TableBody,{children:t.map(e=>{var t,c,d,o,x,h,u;let m=e.hoursLogged?"".concat(e.hoursLogged,"h"):"--";return(0,s.jsxs)(k.TableRow,{className:"hover:bg-slate-50",children:[(0,s.jsx)(k.TableCell,{className:"font-medium text-slate-800",children:e.projectShortCode?"".concat(e.projectShortCode,"-").concat(e.id):"TASK-".concat(e.id)}),(0,s.jsx)(k.TableCell,{children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium text-slate-900",children:e.title}),(0,s.jsx)("div",{className:"mt-1 flex flex-wrap gap-2",children:null==(t=e.labels)?void 0:t.map(e=>(0,s.jsx)("span",{className:(0,b.cn)("rounded-full px-2 py-0.5 text-xs font-medium","text-white"),style:{backgroundColor:e.colorCode},children:e.name},e.id))}),(0,s.jsx)("span",{className:"text-xs text-slate-500",children:null!=(o=null==(c=e.categoryId)?void 0:c.name)?o:"Project name"}),e.pinned&&(0,s.jsx)("span",{className:"mt-1 w-fit rounded-md bg-yellow-100 px-2 py-0.5 text-[10px] font-medium text-yellow-700",children:"Pinned"})]})}),(0,s.jsx)(k.TableCell,{className:"text-slate-600",children:null!=(x=e.completedOn)?x:"--"}),(0,s.jsx)(k.TableCell,{className:"text-slate-600",children:null!=(h=e.startDate)?h:"--"}),(0,s.jsx)(k.TableCell,{className:"text-slate-600",children:null!=(u=e.dueDate)?u:"--"}),(0,s.jsx)(k.TableCell,{className:"text-slate-600",children:e.timeEstimate?"".concat(e.timeEstimateMinutes,"m"):"--"}),(0,s.jsx)(k.TableCell,{className:"font-medium text-slate-700",children:m}),(0,s.jsx)(k.TableCell,{children:(0,s.jsx)("div",{className:"flex -space-x-2",children:null==(d=e.assignedEmployees)?void 0:d.map(e=>{var t;return(0,s.jsx)("div",{className:"h-8 w-8 rounded-full border-2 border-white shadow-sm overflow-hidden bg-slate-200",children:e.profileUrl?(0,s.jsx)(w.default,{src:e.profileUrl,alt:e.name,width:32,height:32,className:"h-full w-full object-cover"}):(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center text-xs text-slate-600",children:null==(t=e.name)?void 0:t.charAt(0)})},e.employeeId)})})}),(0,s.jsx)(k.TableCell,{children:(0,s.jsx)(E,{task:e})}),(0,s.jsx)(k.TableCell,{className:"text-right",children:(0,s.jsx)(D,{task:e,onView:a,onEdit:l,onDelete:n,onDuplicate:r,onTogglePin:i})})]},e.id)})})]})})};var L=e.i(776639);let z=e=>{let{open:t,onOpenChange:a,tasks:l}=e;return(0,s.jsx)(L.Dialog,{open:t,onOpenChange:a,children:(0,s.jsxs)(L.DialogContent,{className:"max-h-[90vh] w-[600px] overflow-y-auto rounded-2xl border border-slate-200 p-0",children:[(0,s.jsx)(L.DialogHeader,{className:"border-b border-slate-200 px-6 py-4",children:(0,s.jsxs)(L.DialogTitle,{className:"flex items-center gap-2 text-lg font-semibold text-slate-800",children:[(0,s.jsx)(g.CalendarDays,{size:20}),"Task Date Overview"]})}),(0,s.jsx)("div",{className:"space-y-4 px-6 py-4",children:0===l.length?(0,s.jsx)("p",{className:"py-10 text-center text-sm text-slate-500",children:"No tasks available for selected filters."}):(0,s.jsx)("div",{className:"space-y-4",children:l.map(e=>{var t,a,l,n,r;return(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm",children:[(0,s.jsxs)("div",{className:"mb-1 flex justify-between",children:[(0,s.jsx)("h3",{className:"font-medium text-slate-800",children:e.title}),(0,s.jsxs)("span",{className:"rounded-md bg-slate-200 px-2 py-1 text-xs font-medium text-slate-700",children:[null!=(l=e.projectShortCode)?l:"TASK","-",e.id]})]}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Start Date"}),(0,s.jsx)("p",{className:"text-sm font-medium text-slate-700",children:null!=(n=e.startDate)?n:"--"})]}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Due Date"}),(0,s.jsx)("p",{className:"text-sm font-medium text-slate-700",children:null!=(r=e.dueDate)?r:"--"})]}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsxs)("span",{className:"flex w-fit items-center gap-2 rounded-full border border-slate-300 px-3 py-1 text-xs font-medium text-slate-700",children:[(0,s.jsx)("span",{className:"h-2 w-2 rounded-full",style:{background:null==(t=e.taskStage)?void 0:t.labelColor}}),null==(a=e.taskStage)?void 0:a.name]})})]},e.id)})})})]})})};var B=e.i(110204),P=e.i(257428),M=e.i(624687);let V=e=>{let{open:t,onOpenChange:a,onCreated:n}=e,i="https://6jnqmj85-80.inc1.devtunnels.ms",[c,o]=(0,l.useState)(""),[u,m]=(0,l.useState)(""),[p,j]=(0,l.useState)(""),[g,f]=(0,l.useState)(""),[v,S]=(0,l.useState)(""),[b,N]=(0,l.useState)(""),[y,w]=(0,l.useState)([]),[k,C]=(0,l.useState)(""),[T,I]=(0,l.useState)([]),[D,E]=(0,l.useState)(""),[A,z]=(0,l.useState)(!1),[V,O]=(0,l.useState)(!1),[H,U]=(0,l.useState)(""),[F,G]=(0,l.useState)(!1),[q,W]=(0,l.useState)(""),[R,_]=(0,l.useState)(null),[J,K]=(0,l.useState)(!1),[X,Y]=(0,l.useState)([]),[Q,Z]=(0,l.useState)([]),[$,ee]=(0,l.useState)([]),[et,ea]=(0,l.useState)([]),[es,el]=(0,l.useState)([]),[en,er]=(0,l.useState)([]),ei=window.localStorage.getItem("accessToken"),ec=async()=>{let e=localStorage.getItem("accessToken"),t=await fetch("".concat(i,"/task/task-categories"),{headers:{Authorization:"Bearer ".concat(e)}});Y(await t.json())},ed=async()=>{let e=await fetch("".concat(i,"/api/projects"),{headers:{Authorization:"Bearer ".concat(ei)}});Z(await e.json())},eo=async()=>{let e=await fetch("".concat(i,"/status"),{headers:{Authorization:"Bearer ".concat(ei)}});ee(await e.json())},ex=async()=>{let e=await fetch("".concat(i,"/employee/all"),{headers:{Authorization:"Bearer ".concat(ei)}});ea(await e.json())},eh=async e=>{if(!e)return;let t=await fetch("".concat(i,"/api/projects/").concat(e,"/milestones"),{headers:{Authorization:"Bearer ".concat(ei)}});el(await t.json())},eu=async e=>{if(!e)return;let t=await fetch("".concat(i,"/projects/").concat(e,"/labels"),{headers:{Authorization:"Bearer ".concat(ei)}});er(await t.json())};(0,l.useEffect)(()=>{t&&(ec(),ed(),eo(),ex())},[t]),(0,l.useEffect)(()=>{p&&(eh(p),eu(p))},[p]);let em=(e,t)=>e.includes(t)?e.filter(e=>e!==t):[...e,t],ep=async()=>{try{K(!0);let e=new FormData;if(e.append("title",c),e.append("category",u),e.append("projectId",p),e.append("startDate",g),e.append("dueDate",v),e.append("taskStageId",b),e.append("description",k),e.append("priority",D),e.append("isPrivate",String(A)),e.append("timeEstimate",String(V)),e.append("timeEstimateMinutes",H),e.append("isDependent",String(F)),e.append("milestoneId",q),y.forEach(t=>e.append("assignedEmployeeIds",t)),T.forEach(t=>e.append("labelIds",t)),R&&e.append("taskFile",R),!(await fetch("".concat(i,"/projects/tasks"),{method:"POST",body:e,headers:{Authorization:"Bearer ".concat(ei)}})).ok)throw Error("Failed");n(),a(!1)}catch(e){alert("Failed to create task")}finally{K(!1)}};return(0,s.jsx)(L.Dialog,{open:t,onOpenChange:a,children:(0,s.jsxs)(L.DialogContent,{className:"max-h-[95vh] w-[900px] overflow-y-auto rounded-xl",children:[(0,s.jsx)(L.DialogHeader,{children:(0,s.jsx)(L.DialogTitle,{children:"Add New Task"})}),(0,s.jsxs)("div",{className:"grid gap-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Title *"}),(0,s.jsx)(h.Input,{value:c,onChange:e=>o(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Category *"}),(0,s.jsxs)(x.Select,{onValueChange:m,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select category"})}),(0,s.jsx)(x.SelectContent,{children:X.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Project *"}),(0,s.jsxs)(x.Select,{onValueChange:j,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select project"})}),(0,s.jsx)(x.SelectContent,{children:null==Q?void 0:Q.map(e=>(0,s.jsxs)(x.SelectItem,{value:String(e.id),children:[e.shortCode," - ",e.name]},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Milestone *"}),(0,s.jsxs)(x.Select,{onValueChange:W,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select milestone"})}),(0,s.jsx)(x.SelectContent,{children:es.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.title},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Task Stage *"}),(0,s.jsxs)(x.Select,{onValueChange:N,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select stage"})}),(0,s.jsx)(x.SelectContent,{children:$.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Assign To *"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:et.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:y.includes(e.employeeId),onCheckedChange:()=>w(em(y,e.employeeId))}),(0,s.jsx)("span",{className:"text-sm",children:e.name})]},e.employeeId))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Labels *"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:en.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:T.includes(String(e.id)),onCheckedChange:()=>I(em(T,String(e.id)))}),(0,s.jsx)("span",{children:e.name})]},e.id))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Start Date *"}),(0,s.jsx)(h.Input,{type:"date",value:g,onChange:e=>f(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Due Date *"}),(0,s.jsx)(h.Input,{type:"date",value:v,onChange:e=>S(e.target.value)})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Description *"}),(0,s.jsx)(M.Textarea,{value:k,onChange:e=>C(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Priority *"}),(0,s.jsxs)(x.Select,{onValueChange:E,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select priority"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"LOW",children:"Low"}),(0,s.jsx)(x.SelectItem,{value:"MEDIUM",children:"Medium"}),(0,s.jsx)(x.SelectItem,{value:"HIGH",children:"High"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(P.Checkbox,{checked:A,onCheckedChange:e=>z(!!e)}),(0,s.jsx)("span",{children:"Private Task"})]}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(P.Checkbox,{checked:F,onCheckedChange:e=>G(!!e)}),(0,s.jsx)("span",{children:"Dependent Task"})]}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(P.Checkbox,{checked:V,onCheckedChange:e=>O(!!e)}),(0,s.jsx)("span",{children:"Time Estimate"})]}),V&&(0,s.jsx)(h.Input,{placeholder:"Minutes",value:H,onChange:e=>U(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Attachment *"}),(0,s.jsx)(h.Input,{type:"file",onChange:e=>{var t,a;return _(null!=(a=null==(t=e.target.files)?void 0:t[0])?a:null)}})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,s.jsx)(d.Button,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(d.Button,{onClick:ep,disabled:J,children:J?(0,s.jsx)(r.Loader2,{className:"h-4 w-4 animate-spin"}):"Save Task"})]})]})})},O=e=>{var t;let{task:a}=e;return(0,s.jsxs)("div",{className:"rounded-xl bg-white p-4 shadow hover:shadow-md transition cursor-pointer border border-slate-200",children:[(0,s.jsx)("div",{className:"flex justify-between",children:(0,s.jsx)("h3",{className:"font-medium text-slate-800 text-sm",children:a.title})}),(0,s.jsx)("div",{className:"mt-3 text-xs text-slate-500",children:null==a?void 0:a.projectName}),a.labels&&(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:a.labels.map(e=>(0,s.jsx)("span",{className:"rounded-full px-2 py-0.5 text-xs text-white",style:{background:e.colorCode},children:e.name},e.id))}),(0,s.jsxs)("div",{className:"mt-3 text-xs text-slate-500",children:[a.projectShortCode,"-",a.id]}),(0,s.jsx)("div",{className:"mt-3 flex -space-x-2",children:null==(t=a.assignedEmployees)?void 0:t.map(e=>{var t;return(0,s.jsx)("img",{src:null!=(t=e.profileUrl)?t:"https://avatar.iran.liara.run/public/boy?57",className:"h-7 w-7 rounded-full border-2 border-white object-cover"},e.employeeId)})})]})},H=e=>{let{title:t,color:a,tasks:l}=e;return(0,s.jsxs)("div",{className:"min-w-[280px] w-[280px] rounded-xl bg-slate-100 p-4 shadow-sm",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,s.jsx)("span",{className:"h-3 w-3 rounded-full",style:{background:a||"#d1d5db"}}),(0,s.jsx)("h2",{className:"font-semibold text-slate-700",children:t}),(0,s.jsx)("span",{className:"ml-auto rounded-md bg-white px-2 py-1 text-xs text-slate-500 shadow",children:l.length})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[l.map(e=>(0,s.jsx)(O,{task:e},e.id)),0===l.length&&(0,s.jsx)("p",{className:"text-xs text-slate-400 text-center py-4",children:"No tasks"})]})]})},U=e=>{let{tasks:t}=e,a=(0,l.useMemo)(()=>{let e={};return t.forEach(t=>{var a;let s=(null==(a=t.taskStage)?void 0:a.name)||"Uncategorized";e[s]||(e[s]=[]),e[s].push(t)}),e},[t]),n=["Waiting","Doing","Approval","Completed"];return(0,s.jsxs)("div",{className:"flex w-full gap-4 overflow-x-auto pb-4",children:[n.map(e=>{var l,n,r;return(0,s.jsx)(H,{title:e,color:null==(n=t.find(t=>{var a;return(null==(a=t.taskStage)?void 0:a.name)===e}))||null==(l=n.taskStage)?void 0:l.labelColor,tasks:null!=(r=a[e])?r:[]},e)}),Object.keys(a).filter(e=>!n.includes(e)).map(e=>{var t,l;return(0,s.jsx)(H,{title:e,color:null==(l=a[e][0])||null==(t=l.taskStage)?void 0:t.labelColor,tasks:a[e]},e)})]})};var F=e.i(788699),G=e.i(727612);let q=e=>{let{open:t,onOpenChange:a}=e,n="https://6jnqmj85-80.inc1.devtunnels.ms",[i,c]=(0,l.useState)(!1),[o,x]=(0,l.useState)([]),[u,p]=(0,l.useState)(null),[j,g]=(0,l.useState)(""),[f,v]=(0,l.useState)(""),[S,b]=(0,l.useState)("#000000"),N=async()=>{try{let e=window.localStorage.getItem("accessToken"),t=await fetch("".concat(n,"/status"),{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();x(a)}catch(e){console.error("Failed to load stages",e)}};(0,l.useEffect)(()=>{t&&N()},[t]);let y=async()=>{try{let e=window.localStorage.getItem("accessToken");c(!0);let t={name:j,position:Number(f),labelColor:S},a=u?"PUT":"POST",s=u?"".concat(n,"/status/").concat(u):"".concat(n,"/status");if(!(await fetch(s,{method:a,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed");p(null),g(""),v(""),b("#000000"),N()}catch(e){alert("Operation failed"),console.error(e)}finally{c(!1)}},w=async e=>{if(confirm("Are you sure you want to delete this stage?"))try{c(!0);let t=window.localStorage.getItem("accessToken");if(!(await fetch("".concat(n,"/status/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok)throw Error("Failed");N()}catch(e){alert("Delete failed")}finally{c(!1)}};return(0,s.jsx)(L.Dialog,{open:t,onOpenChange:a,children:(0,s.jsxs)(L.DialogContent,{className:"max-w-xl rounded-xl",children:[(0,s.jsx)(L.DialogHeader,{children:(0,s.jsx)(L.DialogTitle,{className:"text-lg font-semibold",children:"Task Stages"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Name"}),(0,s.jsx)(h.Input,{placeholder:"Stage Name",value:j,onChange:e=>g(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Position"}),(0,s.jsx)(h.Input,{placeholder:"Position",type:"number",value:f,onChange:e=>v(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Label Color"}),(0,s.jsx)(h.Input,{type:"color",className:"h-10 w-20 p-1",value:S,onChange:e=>b(e.target.value)})]}),(0,s.jsx)(d.Button,{onClick:y,disabled:i||!j||!f,className:"flex items-center gap-2 rounded-lg bg-indigo-600 text-white",children:i?(0,s.jsx)(r.Loader2,{className:"h-4 w-4 animate-spin"}):u?"Update Stage":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Plus,{size:16})," Add Stage"]})}),(0,s.jsx)("hr",{className:"my-3"}),(0,s.jsx)("div",{className:"space-y-3",children:o.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"h-4 w-4 rounded-full",style:{background:e.labelColor}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-slate-500",children:["Position: ",e.position]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>(e=>{p(e.id),g(e.name),v(String(e.position)),b(e.labelColor||"#000000")})(e),className:"text-blue-600 hover:text-blue-800",children:(0,s.jsx)(F.Pencil,{size:18})}),(0,s.jsx)("button",{onClick:()=>w(e.id),className:"text-red-500 hover:text-red-700",children:(0,s.jsx)(G.Trash2,{size:18})})]})]},e.id))})]})]})})};var W=e.i(37727);function R(e){var t,a,l,r,i,c,d;let{task:o}=e;if(!o)return null;let x=(null==o||null==(t=o.assignedEmployees)?void 0:t.map(e=>e.name).join(", "))||"--",h=(null==o||null==(a=o.labels)?void 0:a.map(e=>e.name).join(", "))||"--";return(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 p-6 border-b",children:[(0,s.jsxs)(n.Card,{className:"p-6 rounded-2xl border-slate-200 shadow-sm",children:[(0,s.jsx)("button",{className:"px-4 py-2 mb-6 bg-indigo-500 text-white rounded-xl text-sm",children:"Mark As Complete"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-y-4 text-sm",children:[(0,s.jsx)("p",{className:"text-slate-500",children:"Project"}),(0,s.jsx)("p",{className:"text-slate-700",children:o.projectName||"--"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Priority"}),(0,s.jsxs)("p",{className:"flex items-center gap-2 text-slate-700",children:[(0,s.jsx)("span",{className:(0,b.cn)("h-2 w-2 rounded-full inline-block","LOW"===o.priority&&"bg-green-500","MEDIUM"===o.priority&&"bg-yellow-500","HIGH"===o.priority&&"bg-red-500")}),o.priority||"--"]}),(0,s.jsx)("p",{className:"text-slate-500",children:"Assigned To"}),(0,s.jsx)("p",{className:"text-slate-700",children:x}),(0,s.jsx)("p",{className:"text-slate-500",children:"Project Code"}),(0,s.jsxs)("p",{className:"text-slate-700",children:[o.projectShortCode,"-",o.id]}),(0,s.jsx)("p",{className:"text-slate-500",children:"Milestones"}),(0,s.jsx)("p",{className:"text-slate-700",children:(null==(l=o.milestone)?void 0:l.title)||"--"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Label"}),(0,s.jsx)("p",{className:"text-slate-700",children:h}),(0,s.jsx)("p",{className:"text-slate-500",children:"Task Category"}),(0,s.jsx)("p",{className:"text-slate-700",children:(null==(r=o.categoryId)?void 0:r.name)||"--"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Description"}),(0,s.jsx)("p",{className:"text-slate-700",children:o.description||"--"})]})]}),(0,s.jsxs)(n.Card,{className:"p-6 rounded-2xl border-slate-200 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:(null==o||null==(i=o.taskStage)?void 0:i.labelColor)||"#3b82f6"}}),(0,s.jsx)("p",{className:"font-medium text-slate-700",children:(null==o||null==(c=o.taskStage)?void 0:c.name)||"--"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-y-4 text-sm",children:[(0,s.jsx)("p",{className:"text-slate-500",children:"Created On"}),(0,s.jsx)("p",{className:"text-slate-700",children:(d=o.createdAt)?new Date(d).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"--"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Start Date"}),(0,s.jsx)("p",{className:"text-slate-700",children:_(o.startDate)||"--"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Due Date"}),(0,s.jsx)("p",{className:"text-slate-700",children:_(o.dueDate)||"--"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Hours Logged"}),(0,s.jsxs)("p",{className:"text-slate-700",children:[o.hoursLogged||0,"h"]})]})]})]})}function _(e){return e?new Date(e).toLocaleDateString("en-GB"):"--"}var J=e.i(569074);let K="https://6jnqmj85-80.inc1.devtunnels.ms";function X(e){let{taskId:t}=e,[a,i]=(0,l.useState)([]),[c,d]=(0,l.useState)(!1),[o,x]=(0,l.useState)(!1);async function h(){try{d(!0);let e=localStorage.getItem("accessToken"),a=await fetch("".concat(K,"/files/tasks/").concat(t),{headers:{Authorization:"Bearer ".concat(e)}}),s=await a.json();i(s||[])}catch(e){console.error("Error fetching files:",e)}finally{d(!1)}}async function u(e){var a;let s=null==(a=e.target.files)?void 0:a[0];if(!s)return;let l=new FormData;l.append("file",s);try{x(!0);let e=localStorage.getItem("accessToken");if(!(await fetch("".concat(K,"/files/tasks/").concat(t),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:l})).ok)throw Error("Upload failed");h()}catch(e){console.error("File upload error:",e)}finally{x(!1)}}async function m(e){if(confirm("Delete this file?"))try{let t=localStorage.getItem("accessToken");await fetch("".concat(K,"/files/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),i(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Delete error:",e)}}return(0,l.useEffect)(()=>{h()},[t]),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 text-indigo-600 cursor-pointer",children:[(0,s.jsx)(J.Upload,{size:18}),(0,s.jsx)("span",{className:"text-sm",children:"Upload File"}),(0,s.jsx)("input",{type:"file",className:"hidden",onChange:u})]}),o&&(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Uploading..."}),c?(0,s.jsx)("div",{className:"flex justify-center py-10",children:(0,s.jsx)(r.Loader2,{className:"h-6 w-6 animate-spin text-slate-400"})}):0===a.length?(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"No files uploaded."}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(e=>(0,s.jsxs)(n.Card,{className:"p-4 flex items-center justify-between border border-slate-200 rounded-xl",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-700 text-sm",children:e.filename}),(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 text-xs underline",children:"View / Download"})]}),(0,s.jsx)("button",{onClick:()=>m(e.id),className:"p-2 rounded-full hover:bg-red-50",children:(0,s.jsx)(G.Trash2,{size:16,className:"text-red-500"})})]},e.id))})]})}let Y="https://6jnqmj85-80.inc1.devtunnels.ms";function Q(e){let{taskId:t}=e,[a,i]=(0,l.useState)([]),[c,o]=(0,l.useState)(!1),[x,u]=(0,l.useState)(""),[m,p]=(0,l.useState)(""),[j,g]=(0,l.useState)(null);async function f(){try{o(!0);let e=localStorage.getItem("accessToken"),a=await fetch("".concat(Y,"/tasks/").concat(t,"/subtasks"),{headers:{Authorization:"Bearer ".concat(e)}}),s=await a.json();i(s||[])}catch(e){console.error("Subtask fetch error:",e)}finally{o(!1)}}async function v(){if(!x.trim())return alert("Title is required");try{let e=localStorage.getItem("accessToken");if(!(await fetch("".concat(Y,"/tasks/").concat(t,"/subtasks"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({title:x,description:m})})).ok)throw Error("Failed to add subtask");u(""),p(""),f()}catch(e){console.error("Create error:",e)}}async function S(e){try{let a=localStorage.getItem("accessToken");if(!(await fetch("".concat(Y,"/tasks/").concat(t,"/subtasks/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({title:x,description:m})})).ok)throw Error("Update failed");g(null),u(""),p(""),f()}catch(e){console.error("Update error:",e)}}async function b(e){if(confirm("Delete this subtask?"))try{let a=localStorage.getItem("accessToken");await fetch("".concat(Y,"/tasks/").concat(t,"/subtasks/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}}),i(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Delete error:",e)}}return(0,l.useEffect)(()=>{f()},[t]),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(n.Card,{className:"p-4 rounded-xl border-slate-200",children:[(0,s.jsx)("h3",{className:"font-semibold text-sm mb-3",children:j?"Edit Sub Task":"Add Sub Task"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(h.Input,{placeholder:"Title",value:x,onChange:e=>u(e.target.value)}),(0,s.jsx)(M.Textarea,{placeholder:"Description",value:m,onChange:e=>p(e.target.value)}),j?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.Button,{className:"bg-indigo-500 text-white",onClick:()=>S(j),children:"Update"}),(0,s.jsx)(d.Button,{variant:"outline",onClick:()=>{g(null),u(""),p("")},children:"Cancel"})]}):(0,s.jsx)(d.Button,{className:"bg-indigo-500 text-white",onClick:v,children:"Add Sub Task"})]})]}),c?(0,s.jsx)("div",{className:"flex justify-center py-10",children:(0,s.jsx)(r.Loader2,{className:"animate-spin text-slate-400",size:26})}):0===a.length?(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"No sub tasks found."}):(0,s.jsx)("div",{className:"space-y-3",children:a.map(e=>(0,s.jsxs)(n.Card,{className:"p-4 rounded-xl border-slate-200 flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-700",children:e.title}),(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:e.description})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>{g(e.id),u(e.title),p(e.description)},className:"p-2 hover:bg-slate-100 rounded-full",children:(0,s.jsx)(F.Pencil,{size:18,className:"text-slate-600"})}),(0,s.jsx)("button",{onClick:()=>b(e.id),className:"p-2 hover:bg-red-50 rounded-full",children:(0,s.jsx)(G.Trash2,{size:18,className:"text-red-500"})})]})]},e.id))})]})}function Z(e){let{taskId:t}=e,[a,i]=(0,l.useState)([]),[c,d]=(0,l.useState)(!1);async function o(){try{d(!0);let e=localStorage.getItem("accessToken"),a=await fetch("".concat("https://6jnqmj85-80.inc1.devtunnels.ms","/timesheets/task/").concat(t),{headers:{Authorization:"Bearer ".concat(e)}}),s=await a.json();i(s||[])}catch(e){console.error("Timesheet fetch error:",e)}finally{d(!1)}}return(0,l.useEffect)(()=>{o()},[t]),(0,s.jsx)("div",{className:"space-y-6",children:c?(0,s.jsx)("div",{className:"flex justify-center py-10",children:(0,s.jsx)(r.Loader2,{className:"animate-spin text-slate-400",size:26})}):0===a.length?(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"No timesheet entries found."}):(0,s.jsx)(n.Card,{className:"rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-slate-100 text-slate-600",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left px-4 py-3",children:"Employee"}),(0,s.jsx)("th",{className:"text-left px-4 py-3",children:"Start"}),(0,s.jsx)("th",{className:"text-left px-4 py-3",children:"End"}),(0,s.jsx)("th",{className:"text-left px-4 py-3",children:"Duration"}),(0,s.jsx)("th",{className:"text-left px-4 py-3",children:"Memo"})]})}),(0,s.jsx)("tbody",{children:a.map(e=>{var t,a,l,n,r,i;return(0,s.jsxs)("tr",{className:"border-t border-slate-200 hover:bg-slate-50",children:[(0,s.jsxs)("td",{className:"px-4 py-3 flex items-center gap-3",children:[(null==(a=e.employees)||null==(t=a[0])?void 0:t.profileUrl)?(0,s.jsx)("img",{src:e.employees[0].profileUrl,alt:"avatar",className:"h-8 w-8 rounded-full object-cover"}):(0,s.jsx)("div",{className:"h-8 w-8 rounded-full bg-slate-300"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-700",children:(null==(n=e.employees)||null==(l=n[0])?void 0:l.name)||"Unknown"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:(null==(i=e.employees)||null==(r=i[0])?void 0:r.designation)||""})]})]}),(0,s.jsxs)("td",{className:"px-4 py-3",children:[(0,s.jsx)("p",{className:"text-slate-700",children:e.startDate}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:e.startTime})]}),(0,s.jsxs)("td",{className:"px-4 py-3",children:[(0,s.jsx)("p",{className:"text-slate-700",children:e.endDate}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:e.endTime})]}),(0,s.jsxs)("td",{className:"px-4 py-3 text-slate-700",children:[e.durationHours,"h"]}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-500",children:e.memo||"--"})]},e.id)})})]})})})}let $="https://6jnqmj85-80.inc1.devtunnels.ms";function ee(e){let{taskId:t}=e,[a,i]=(0,l.useState)([]),[c,o]=(0,l.useState)(!1),[x,u]=(0,l.useState)(""),[m,p]=(0,l.useState)(""),[j,g]=(0,l.useState)(!0);async function f(){try{o(!0);let e=localStorage.getItem("accessToken"),a=await fetch("".concat($,"/tasks/").concat(t,"/notes"),{headers:{Authorization:"Bearer ".concat(e)}}),s=await a.json();i(s||[])}catch(e){console.error("Notes fetch error:",e)}finally{o(!1)}}async function v(){if(!x.trim()||!m.trim())return alert("Title and content are required");try{let e=localStorage.getItem("accessToken"),a=await fetch("".concat($,"/tasks/").concat(t,"/notes"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({title:x,content:m,isPublic:j})});if(!a.ok)throw Error("Failed to create note");let s=await a.json();i(e=>[s,...e]),u(""),p("")}catch(e){console.error("Create note error:",e)}}async function S(e){if(confirm("Delete this note?"))try{let t=localStorage.getItem("accessToken");await fetch("".concat($,"/notes/task/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),i(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Delete error:",e)}}return(0,l.useEffect)(()=>{f()},[t]),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(n.Card,{className:"p-4 rounded-xl border-slate-200",children:[(0,s.jsx)("h3",{className:"font-semibold text-sm mb-3",children:"Add Note"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(h.Input,{placeholder:"Note Title",value:x,onChange:e=>u(e.target.value)}),(0,s.jsx)(M.Textarea,{placeholder:"Write your note here...",value:m,onChange:e=>p(e.target.value)}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:j,onChange:e=>g(e.target.checked)}),(0,s.jsx)("span",{className:"text-sm text-slate-600",children:"Public Note"})]}),(0,s.jsx)(d.Button,{className:"bg-indigo-500 text-white",onClick:v,children:"Add Note"})]})]}),c?(0,s.jsx)("div",{className:"flex justify-center py-10",children:(0,s.jsx)(r.Loader2,{className:"animate-spin text-slate-400",size:26})}):0===a.length?(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"No notes found."}):(0,s.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,s.jsxs)(n.Card,{className:"p-4 rounded-xl border-slate-200",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-800",children:e.title}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:e.isPublic?"Public":"Private"})]}),(0,s.jsx)("button",{onClick:()=>S(e.id),className:"p-2 hover:bg-red-50 rounded-full",children:(0,s.jsx)(G.Trash2,{size:18,className:"text-red-600"})})]}),(0,s.jsx)("p",{className:"mt-3 text-sm text-slate-700",children:e.content}),(0,s.jsxs)("p",{className:"mt-2 text-xs text-slate-400",children:["Created by ",e.ownerEmployeeId]})]},e.id))})]})}function et(e){var t,a;let{open:n,onOpenChange:r,taskId:i}=e,[c,d]=(0,l.useState)(null),[o,x]=(0,l.useState)(!0),[h,u]=(0,l.useState)("files");async function m(){try{x(!0);let e=localStorage.getItem("accessToken"),t=await fetch("".concat("https://6jnqmj85-80.inc1.devtunnels.ms","/projects/tasks/").concat(i),{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();d(a)}catch(e){console.error(e)}finally{x(!1)}}return(0,l.useEffect)(()=>{n&&i&&m()},[n,i]),(0,s.jsx)("div",{className:"fixed inset-0 z-[999] bg-black/30 transition-opacity duration-300 \n                ".concat(n?"opacity-100 visible":"opacity-0 invisible"),children:(0,s.jsxs)("div",{className:"\n                    fixed right-0 top-0 h-full w-[83vw] max-w-[83vw] \n                    bg-white shadow-xl border-l \n                    transform transition-transform duration-300\n                    flex flex-col\n                    ".concat(n?"translate-x-0":"translate-x-full","\n                "),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-white",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["Task #",null==c?void 0:c.projectShortCode,"-",null==c?void 0:c.id]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full",style:{background:null==c||null==(t=c.taskStage)?void 0:t.labelColor}}),(0,s.jsx)("div",{className:"text-lg font-semibold",children:null!=(a=null==c?void 0:c.title)?a:"Task Name"})]})]}),(0,s.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>r(!1),children:(0,s.jsx)(W.X,{className:"w-5 h-5 text-gray-600"})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto",children:o?(0,s.jsx)("div",{className:"flex items-center justify-center h-96",children:"Loading..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R,{task:c}),(0,s.jsx)("div",{className:"px-6 mt-4 border-b flex gap-8 text-sm",children:["files","subtasks","timesheet","notes"].map(e=>(0,s.jsxs)("button",{className:"pb-3 ".concat(h===e?"border-b-2 border-blue-600 text-blue-600 font-medium":"text-gray-500"),onClick:()=>u(e),children:["files"===e&&"Files","subtasks"===e&&"Sub Task","timesheet"===e&&"Timesheet","notes"===e&&"Notes"]},e))}),(0,s.jsxs)("div",{className:"p-6 min-h-[350px]",children:["files"===h&&(0,s.jsx)(X,{taskId:i}),"subtasks"===h&&(0,s.jsx)(Q,{taskId:i}),"timesheet"===h&&(0,s.jsx)(Z,{taskId:i}),"notes"===h&&(0,s.jsx)(ee,{taskId:i})]})]})})]})})}let ea="https://6jnqmj85-80.inc1.devtunnels.ms";function es(e){let{open:t,onOpenChange:a,taskId:n,onUpdated:i}=e,[c,d]=(0,l.useState)(""),[o,u]=(0,l.useState)(""),[m,p]=(0,l.useState)(""),[j,g]=(0,l.useState)(""),[f,v]=(0,l.useState)(""),[S,b]=(0,l.useState)(""),[N,y]=(0,l.useState)([]),[w,k]=(0,l.useState)(""),[C,T]=(0,l.useState)([]),[I,D]=(0,l.useState)(""),[E,A]=(0,l.useState)(!1),[L,z]=(0,l.useState)(!1),[V,O]=(0,l.useState)(""),[H,U]=(0,l.useState)(!1),[F,G]=(0,l.useState)(""),[q,R]=(0,l.useState)(!1),[_,J]=(0,l.useState)([]),[K,X]=(0,l.useState)([]),[Y,Q]=(0,l.useState)([]),[Z,$]=(0,l.useState)([]),[ee,et]=(0,l.useState)([]),[es,el]=(0,l.useState)([]),en=localStorage.getItem("accessToken");async function er(){R(!0);try{var e,t,a,s,l,r,i,c,o,x,h,m,j,f,S;let N=await fetch("".concat(ea,"/projects/tasks/").concat(n),{method:"GET",headers:{Authorization:"Bearer ".concat(en)}}),w=await N.json();d(w.title||""),u(String(null!=(t=null==(e=w.categoryId)?void 0:e.id)?t:"")),p(String(null!=(a=w.projectId)?a:"")),g(null!=(s=w.startDate)?s:""),v(null!=(l=w.dueDate)?l:""),b(String(null!=(r=w.taskStageId)?r:"")),k(null!=(i=w.description)?i:""),D(null!=(c=w.priority)?c:""),A(null!=(o=w.isPrivate)&&o),z(null!=(x=w.timeEstimate)&&x),O(String(null!=(h=w.timeEstimateMinutes)?h:"")),U(null!=(m=w.isDependent)&&m),G(String(null!=(j=w.milestoneId)?j:"")),y(null!=(f=w.assignedEmployeeIds)?f:[]),T((null!=(S=w.labels)?S:[]).map(e=>String(e.id))),ex(String(w.projectId)),eh(String(w.projectId))}finally{R(!1)}}(0,l.useEffect)(()=>{t&&n&&er()},[t,n]),(0,l.useEffect)(()=>{t&&(ei(),ec(),ed(),eo())},[t]);let ei=async()=>{let e=await fetch("".concat(ea,"/task/task-categories"),{method:"GET",headers:{Authorization:"Bearer ".concat(en)}});J(await e.json())},ec=async()=>{let e=await fetch("".concat(ea,"/api/projects"),{method:"GET",headers:{Authorization:"Bearer ".concat(en)}});X(await e.json())},ed=async()=>{let e=await fetch("".concat(ea,"/status"),{method:"GET",headers:{Authorization:"Bearer ".concat(en)}});Q(await e.json())},eo=async()=>{let e=await fetch("".concat(ea,"/employee/all"),{method:"GET",headers:{Authorization:"Bearer ".concat(en)}});$(await e.json())},ex=async e=>{if(!e)return;let t=await fetch("".concat(ea,"/api/projects/").concat(e,"/milestones"),{method:"GET",headers:{Authorization:"Bearer ".concat(en)}});et(await t.json())},eh=async e=>{if(!e)return;let t=await fetch("".concat(ea,"/projects/").concat(e,"/labels"),{method:"GET",headers:{Authorization:"Bearer ".concat(en)}});el(await t.json())},eu=(e,t)=>e.includes(t)?e.filter(e=>e!==t):[...e,t],em=async()=>{R(!0);try{let e=new FormData;if(e.append("title",c),e.append("category",o),e.append("projectId",m),e.append("startDate",j),e.append("dueDate",f),e.append("taskStageId",S),e.append("description",w),e.append("priority",I),e.append("isPrivate",String(E)),e.append("timeEstimate",String(L)),e.append("timeEstimateMinutes",V),e.append("isDependent",String(H)),e.append("milestoneId",F),N.forEach(t=>e.append("assignedEmployeeIds",t)),C.forEach(t=>e.append("labelIds",t)),!(await fetch("".concat(ea,"/api/projects/tasks/").concat(n),{method:"PUT",headers:{Authorization:"Bearer ".concat(en)},body:e})).ok)throw Error("Update failed");i(),a(!1)}catch(e){alert("Failed to update task")}finally{R(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 z-[999] bg-black/30 transition-opacity duration-300\n                ".concat(t?"opacity-100 visible":"opacity-0 invisible"),children:(0,s.jsxs)("div",{className:"\n                    fixed right-0 top-0 h-full w-[83vw] max-w-[83vw] bg-white \n                    shadow-xl border-l overflow-y-auto\n                    transform transition-transform duration-300\n                    ".concat(t?"translate-x-0":"translate-x-full","\n                "),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-white",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Edit Task"}),(0,s.jsx)("button",{onClick:()=>a(!1),className:"p-2 rounded hover:bg-gray-100",children:(0,s.jsx)(W.X,{className:"w-5 h-5 text-gray-600"})})]}),(0,s.jsx)("div",{className:"p-6 space-y-6",children:q?(0,s.jsx)("div",{className:"flex justify-center py-20",children:(0,s.jsx)(r.Loader2,{className:"w-8 h-8 animate-spin text-gray-500"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Title *"}),(0,s.jsx)(h.Input,{value:c,onChange:e=>d(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Category *"}),(0,s.jsxs)(x.Select,{value:o,onValueChange:u,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select"})}),(0,s.jsx)(x.SelectContent,{children:_.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Project *"}),(0,s.jsxs)(x.Select,{value:m,onValueChange:e=>{p(e),ex(e),eh(e)},children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select project"})}),(0,s.jsx)(x.SelectContent,{children:K.map(e=>(0,s.jsxs)(x.SelectItem,{value:String(e.id),children:[e.shortCode," - ",e.name]},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Milestone *"}),(0,s.jsxs)(x.Select,{value:F,onValueChange:G,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select milestone"})}),(0,s.jsx)(x.SelectContent,{children:ee.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.title},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Task Stage *"}),(0,s.jsxs)(x.Select,{value:S,onValueChange:b,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select stage"})}),(0,s.jsx)(x.SelectContent,{children:Y.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Assign To"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:Z.map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:N.includes(e.employeeId),onCheckedChange:()=>y(eu(N,e.employeeId))}),e.name]},e.employeeId))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Labels"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:es.map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:C.includes(String(e.id)),onCheckedChange:()=>T(eu(C,String(e.id)))}),e.name]},e.id))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Start Date *"}),(0,s.jsx)(h.Input,{type:"date",value:j,onChange:e=>g(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Due Date *"}),(0,s.jsx)(h.Input,{type:"date",value:f,onChange:e=>v(e.target.value)})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Description"}),(0,s.jsx)(M.Textarea,{value:w,onChange:e=>k(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Priority *"}),(0,s.jsxs)(x.Select,{value:I,onValueChange:D,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select priority"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"LOW",children:"Low"}),(0,s.jsx)(x.SelectItem,{value:"MEDIUM",children:"Medium"}),(0,s.jsx)(x.SelectItem,{value:"HIGH",children:"High"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:E,onCheckedChange:e=>A(!!e)}),"Private Task"]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:H,onCheckedChange:e=>U(!!e)}),"Dependent Task"]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:L,onCheckedChange:e=>z(!!e)}),"Time Estimate"]}),L&&(0,s.jsx)(h.Input,{placeholder:"Minutes",value:V,onChange:e=>O(e.target.value)})]})]})}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 p-6 border-t bg-white",children:[(0,s.jsx)("button",{onClick:()=>a(!1),className:"px-5 py-2 rounded-md border",children:"Cancel"}),(0,s.jsx)("button",{onClick:em,disabled:q,className:"px-5 py-2 bg-indigo-600 text-white rounded-md",children:q?(0,s.jsx)(r.Loader2,{className:"w-4 h-4 animate-spin"}):"Update Task"})]})]})})}let el=e=>{let{open:t,onOpenChange:a,onCreated:n,task:i}=e,c="https://6jnqmj85-80.inc1.devtunnels.ms",o=window.localStorage.getItem("accessToken"),[u,m]=(0,l.useState)(""),[p,j]=(0,l.useState)(""),[g,f]=(0,l.useState)(""),[v,S]=(0,l.useState)(""),[b,N]=(0,l.useState)(""),[y,w]=(0,l.useState)(""),[k,C]=(0,l.useState)([]),[T,I]=(0,l.useState)(""),[D,E]=(0,l.useState)([]),[A,z]=(0,l.useState)(""),[V,O]=(0,l.useState)(!1),[H,U]=(0,l.useState)(!1),[F,G]=(0,l.useState)(""),[q,W]=(0,l.useState)(!1),[R,_]=(0,l.useState)(""),[J,K]=(0,l.useState)(null),[X,Y]=(0,l.useState)(!1),[Q,Z]=(0,l.useState)([]),[$,ee]=(0,l.useState)([]),[et,ea]=(0,l.useState)([]),[es,el]=(0,l.useState)([]),[en,er]=(0,l.useState)([]),[ei,ec]=(0,l.useState)([]),ed=async()=>{let e=await fetch("".concat(c,"/task/task-categories"),{headers:{Authorization:"Bearer ".concat(o)}});Z(await e.json())},eo=async()=>{let e=await fetch("".concat(c,"/api/projects"),{headers:{Authorization:"Bearer ".concat(o)}});ee(await e.json())},ex=async()=>{let e=await fetch("".concat(c,"/status"),{headers:{Authorization:"Bearer ".concat(o)}});ea(await e.json())},eh=async()=>{let e=await fetch("".concat(c,"/employee/all"),{headers:{Authorization:"Bearer ".concat(o)}});el(await e.json())},eu=async e=>{if(!e)return;let t=await fetch("".concat(c,"/api/projects/").concat(e,"/milestones"),{headers:{Authorization:"Bearer ".concat(o)}});er(await t.json())},em=async e=>{if(!e)return;let t=await fetch("".concat(c,"/projects/").concat(e,"/labels"),{headers:{Authorization:"Bearer ".concat(o)}});ec(await t.json())};(0,l.useEffect)(()=>{t&&(ed(),eo(),ex(),eh())},[t]),(0,l.useEffect)(()=>{var e,a;t&&i&&(m(i.title||""),j(String(i.categoryId||"")),f(String(i.projectId||"")),S(i.startDate||""),N(i.dueDate||""),w(String(i.taskStageId||"")),I(i.description||""),z(i.priority||""),O(!!i.isPrivate),U(!!i.timeEstimate),G(i.timeEstimateMinutes?String(i.timeEstimateMinutes):""),W(!!i.isDependent),_(String(i.milestoneId||"")),C((null==(e=i.assignedEmployees)?void 0:e.map(e=>e.employeeId))||[]),E((null==(a=i.labels)?void 0:a.map(e=>String(e.id)))||[]))},[t,i]),(0,l.useEffect)(()=>{g&&(eu(g),em(g))},[g]);let ep=(e,t)=>e.includes(t)?e.filter(e=>e!==t):[...e,t],ej=async()=>{try{Y(!0);let e=new FormData;if(e.append("title",u),e.append("category",p),e.append("projectId",g),e.append("startDate",v),e.append("dueDate",b),e.append("taskStageId",y),e.append("description",T),e.append("priority",A),e.append("isPrivate",String(V)),e.append("timeEstimate",String(H)),e.append("timeEstimateMinutes",F),e.append("isDependent",String(q)),e.append("milestoneId",R),k.forEach(t=>e.append("assignedEmployeeIds",t)),D.forEach(t=>e.append("labelIds",t)),J&&e.append("taskFile",J),!(await fetch("".concat(c,"/api/projects/tasks"),{method:"POST",body:e,headers:{Authorization:"Bearer ".concat(o)}})).ok)throw Error("Failed");n(),a(!1)}catch(e){console.error(e),alert("Failed to duplicate task")}finally{Y(!1)}};return(0,s.jsx)(L.Dialog,{open:t,onOpenChange:a,children:(0,s.jsxs)(L.DialogContent,{className:"max-h-[95vh] w-[900px] overflow-y-auto rounded-xl",children:[(0,s.jsx)(L.DialogHeader,{children:(0,s.jsx)(L.DialogTitle,{children:"Duplicate Task"})}),(0,s.jsxs)("div",{className:"grid gap-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Title *"}),(0,s.jsx)(h.Input,{value:u,onChange:e=>m(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Category *"}),(0,s.jsxs)(x.Select,{onValueChange:j,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select category"})}),(0,s.jsx)(x.SelectContent,{children:Q.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Project *"}),(0,s.jsxs)(x.Select,{onValueChange:f,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select project"})}),(0,s.jsx)(x.SelectContent,{children:$.map(e=>(0,s.jsxs)(x.SelectItem,{value:String(e.id),children:[e.shortCode," - ",e.name]},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Milestone *"}),(0,s.jsxs)(x.Select,{onValueChange:_,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select milestone"})}),(0,s.jsx)(x.SelectContent,{children:en.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.title},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Task Stage *"}),(0,s.jsxs)(x.Select,{onValueChange:w,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select stage"})}),(0,s.jsx)(x.SelectContent,{children:et.map(e=>(0,s.jsx)(x.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Assign To *"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:es.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:k.includes(e.employeeId),onCheckedChange:()=>C(ep(k,e.employeeId))}),(0,s.jsx)("span",{className:"text-sm",children:e.name})]},e.employeeId))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Labels *"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 pt-2",children:ei.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.Checkbox,{checked:D.includes(String(e.id)),onCheckedChange:()=>E(ep(D,String(e.id)))}),(0,s.jsx)("span",{children:e.name})]},e.id))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Start Date *"}),(0,s.jsx)(h.Input,{type:"date",value:v,onChange:e=>S(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Due Date *"}),(0,s.jsx)(h.Input,{type:"date",value:b,onChange:e=>N(e.target.value)})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Description *"}),(0,s.jsx)(M.Textarea,{value:T,onChange:e=>I(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Priority *"}),(0,s.jsxs)(x.Select,{onValueChange:z,children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select priority"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"LOW",children:"Low"}),(0,s.jsx)(x.SelectItem,{value:"MEDIUM",children:"Medium"}),(0,s.jsx)(x.SelectItem,{value:"HIGH",children:"High"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(P.Checkbox,{checked:V,onCheckedChange:e=>O(!!e)}),(0,s.jsx)("span",{children:"Private Task"})]}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(P.Checkbox,{checked:q,onCheckedChange:e=>W(!!e)}),(0,s.jsx)("span",{children:"Dependent Task"})]}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(P.Checkbox,{checked:H,onCheckedChange:e=>U(!!e)}),(0,s.jsx)("span",{children:"Time Estimate"})]}),H&&(0,s.jsx)(h.Input,{placeholder:"Minutes",value:F,onChange:e=>G(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(B.Label,{children:"Attachment *"}),(0,s.jsx)(h.Input,{type:"file",onChange:e=>{var t,a;return K(null!=(a=null==(t=e.target.files)?void 0:t[0])?a:null)}})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,s.jsx)(d.Button,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(d.Button,{onClick:ej,disabled:X,children:X?(0,s.jsx)(r.Loader2,{className:"h-4 w-4 animate-spin"}):"Save Task"})]})]})})},en="https://6jnqmj85-80.inc1.devtunnels.ms",er=null!=(t=a.default.env.NEXT_PUBLIC_GATEWAY)?t:en,ei=()=>{let[e,t]=(0,l.useState)([]),[a,i]=(0,l.useState)([]),[c,d]=(0,l.useState)(!1),[o,x]=(0,l.useState)(!1),[h,m]=(0,l.useState)(null),[p,j]=(0,l.useState)("All"),[g,f]=(0,l.useState)({}),[v,S]=(0,l.useState)("all"),[b,y]=(0,l.useState)("list"),[w,k]=(0,l.useState)(!1),[C,T]=(0,l.useState)(!1),[I,D]=(0,l.useState)(!1),[E,L]=(0,l.useState)(null),[B,P]=(0,l.useState)(!1),[M,O]=(0,l.useState)(!1),[H,F]=(0,l.useState)(null),[G,W]=(0,l.useState)(!1),[R,_]=(0,l.useState)(null),J=async()=>{try{d(!0),m(null);let e=window.localStorage.getItem("accessToken"),a=await fetch("".concat(en,"/me/tasks"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch all tasks");let s=await a.json();t(s)}catch(e){console.error(e),m(e.message||"Failed to fetch all tasks")}finally{d(!1),x(!0)}},K=async()=>{if(!er)return void console.error("NEXT_PUBLIC_GATEWAY (or MAIN) is not defined");try{let e=localStorage.getItem("accessToken"),t=await fetch("".concat(er,"/me/tasks"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Failed to fetch my tasks");let a=await t.json();i(a)}catch(e){console.error(e)}};(0,l.useEffect)(()=>{J(),K()},[]);let X=(0,l.useMemo)(()=>{let t=[];switch(v){case"all":default:t=e;break;case"me":t=a.length?a:e;break;case"approval":t=e.filter(e=>{var t;return(null==(t=e.taskStage)?void 0:t.name)==="Waiting"});break;case"pinned":t=e.filter(e=>e.pinned)}return"All"!==p&&(t=t.filter(e=>{var t;return(null==(t=e.taskStage)?void 0:t.name)===p})),(g.start||g.end)&&(t=t.filter(e=>{let t=e.startDate?new Date(e.startDate):null,a=e.dueDate?new Date(e.dueDate):null;if(!t&&!a)return!1;let s=g.start?new Date(g.start):null,l=g.end?new Date(g.end):null;return(!s||!a||!(a<s))&&(!l||!t||!(t>l))})),t},[e,a,v,p,g]),Y=async e=>{if(!confirm("Are you sure you want to delete this task?"))return;let t=localStorage.getItem("accessToken");(await fetch("".concat(en,"/api/projects/tasks/").concat(e,"/delete"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?(J(),K()):alert("Failed to delete")},Q=async e=>{let t=localStorage.getItem("accessToken");(await fetch("".concat(en,"/projects/tasks/").concat(e,"/pin"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)}})).ok?(J(),K()):alert("Unable to toggle pin")};return(0,s.jsx)("main",{className:"container mx-auto max-w-6xl px-4 py-8",children:(0,s.jsxs)("div",{className:"flex min-h-screen flex-col bg-slate-50",children:[(0,s.jsxs)("header",{className:"flex items-center justify-between px-8 py-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"My Task "}),(0,s.jsx)("div",{className:"flex items-center gap-4 text-sm text-slate-500",children:(0,s.jsx)("div",{className:"hidden text-xs md:block"})})]}),(0,s.jsxs)("main",{className:"flex-1 space-y-4 px-4 pb-6 md:px-8",children:[(0,s.jsx)(n.Card,{className:"border-none bg-white shadow-sm",children:(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(u,{status:p,onStatusChange:j,dateRange:g,onDateRangeChange:f})})}),(0,s.jsx)(n.Card,{className:"border-none bg-white shadow-sm",children:(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(N,{taskSource:v,onTaskSourceChange:S,viewMode:b,onViewModeChange:y,onAddTask:()=>k(!0),onOpenCalendar:()=>{T(!0),y("calendar")},onOpenStages:()=>D(!0)})})}),(0,s.jsx)(n.Card,{className:"border-none bg-white shadow-sm",children:(0,s.jsx)("div",{className:"p-0",children:c&&!o?(0,s.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,s.jsx)(r.Loader2,{className:"h-6 w-6 animate-spin text-slate-400"})}):h?(0,s.jsxs)("div",{className:"flex h-64 flex-col items-center justify-center gap-2 text-sm text-red-500",children:[(0,s.jsx)("p",{children:h}),(0,s.jsx)("button",{onClick:J,className:"rounded-full border border-slate-200 px-3 py-1 text-xs text-slate-700 hover:bg-slate-50",children:"Retry"})]}):0===X.length?(0,s.jsx)("div",{className:"flex h-64 flex-col items-center justify-center gap-2 text-sm text-slate-500",children:(0,s.jsx)("p",{children:"No tasks found for selected filters."})}):"list"===b?(0,s.jsx)(A,{tasks:X,onView:e=>{L(e.id),P(!0)},onEdit:e=>{_(e.id),W(!0)},onDelete:e=>Y(e.id),onDuplicate:e=>{F(e),O(!0)},onTogglePin:e=>Q(e.id)}):"kanban"===b?(0,s.jsx)(U,{tasks:X}):(0,s.jsx)("div",{className:"flex h-64 items-center justify-center text-sm text-slate-500",children:"Calendar data is available in the calendar modal."})})})]}),(0,s.jsx)(V,{open:w,onOpenChange:k,onCreated:()=>{J(),K()}}),(0,s.jsx)(z,{open:C,onOpenChange:T,tasks:X}),(0,s.jsx)(q,{open:I,onOpenChange:D}),(0,s.jsx)(et,{open:B,onOpenChange:P,taskId:E}),(0,s.jsx)(es,{open:G,onOpenChange:W,taskId:R,onUpdated:()=>{J(),K()}}),H&&(0,s.jsx)(el,{open:M,onOpenChange:O,task:H,onCreated:()=>{O(!1),F(null),J(),K()}})]})})}}]);