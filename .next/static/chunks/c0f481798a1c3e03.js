(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,822245,e=>{"use strict";e.s(["AddLeadModal",()=>x,"default",()=>h]);var t=e.i(843476),l=e.i(283599),a=e.i(271645),s=e.i(618566),r=e.i(515288),d=e.i(793479),n=e.i(519455),o=e.i(784774);let c="".concat("https://6jnqmj85-80.inc1.devtunnels.ms"),i=async e=>{let t=localStorage.getItem("accessToken");if(!t)throw Error("No access token found. Please log in.");let l=await fetch("".concat(c,"/leads/my-leads"),{cache:"no-store",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"}});if(!l.ok){let e="Failed to load.";try{e=(await l.json()).message||e}catch(t){e=await l.text()||e}throw Error(e)}return l.json()};function m(e){let{meta:l,fallback:a}=e,s=(null==l?void 0:l.profileUrl)||"/placeholder.svg?height=32&width=32&query=profile-avatar";return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("img",{src:s,alt:(null==l?void 0:l.name)?"Profile photo of ".concat(l.name):"Profile avatar",className:"h-8 w-8 rounded-full object-cover border",crossOrigin:"anonymous"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:(null==l?void 0:l.name)||a||"â€”"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:(null==l?void 0:l.designation)||"â€”"})]})]})}function x(e){let{onClose:l,onCreated:s,employees:r}=e,d=["Default Pipeline","Sales Pipeline","Enterprise Pipeline"],n=["Generated","Qualification","Proposal","Win","Lost"],[o,i]=(0,a.useState)([]),[m,x]=(0,a.useState)([]),[u,h]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=localStorage.getItem("accessToken");e&&(async()=>{try{let t=await fetch("".concat(c,"/deals/dealCategory"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();Array.isArray(e)&&(i(e),h(e))}let l=await fetch("".concat(c,"/deals/dealCategory/LeadSource"),{headers:{Authorization:"Bearer ".concat(e)}});if(l.ok){let e=await l.json();Array.isArray(e)&&x(e)}}catch(e){}})()},[]);let p={title:"",pipeline:d[0],dealStage:n[0],dealCategory:"",value:"",expectedCloseDate:"",dealAgent:"",dealWatchers:[]},[f,g]=(0,a.useState)({name:"",email:"",mobileNumber:"",clientCategory:"",leadSource:"",addedBy:"",leadOwner:"",createDeal:!0,autoConvertToClient:!0,deal:p,companyName:"",officialWebsite:"",officePhone:"",city:"",state:"",postalCode:"",country:"",companyAddress:""}),[j,b]=(0,a.useState)(null),[v,y]=(0,a.useState)(""),[N,C]=(0,a.useState)(!1),[w,k]=(0,a.useState)([]),[S,A]=(0,a.useState)(null),[D,T]=(0,a.useState)(!1),[L,B]=(0,a.useState)(!1),[E,O]=(0,a.useState)(""),I=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=e=>{let t=e.target;L&&I.current&&!I.current.contains(t)&&B(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[L]);let[W,P]=(0,a.useState)(!1),M=(0,a.useRef)(null);(0,a.useEffect)(()=>{requestAnimationFrame(()=>P(!0));let e=setTimeout(()=>{var e;return null==(e=M.current)?void 0:e.focus()},120),t=document.body.style.overflow;document.body.style.overflow="hidden";let a=e=>{"Escape"===e.key&&l()};return document.addEventListener("keydown",a),()=>{clearTimeout(e),document.body.style.overflow=t,document.removeEventListener("keydown",a)}},[l]);let z=(e,t)=>g(l=>({...l,[e]:t})),F=(e,t)=>g(l=>({...l,deal:{...l.deal,[e]:t}})),R=async e=>{null==e||e.preventDefault();let t=(()=>{var e,t,l,a;if(!(null==(e=f.name)?void 0:e.trim())||!(null==(t=f.email)?void 0:t.trim())||!(null==(l=f.companyName)?void 0:l.trim()))return"Name, Email and Company Name are required.";if(f.createDeal||f.autoConvertToClient){let e=f.deal;if(!(null==(a=e.title)?void 0:a.trim())||!e.value||!e.expectedCloseDate||!e.dealAgent)return"Deal title, value, expected close date and deal agent are required when creating a deal."}return null})();if(t)return void A(t);A(null),T(!0);try{let e=localStorage.getItem("accessToken");if(!e)throw Error("No access token found.");let t={name:f.name,email:f.email,mobileNumber:f.mobileNumber||void 0,clientCategory:f.clientCategory||void 0,leadSource:f.leadSource||void 0,addedBy:f.addedBy||void 0,leadOwner:f.leadOwner||void 0,createDeal:!!f.createDeal,autoConvertToClient:!!f.autoConvertToClient,deal:f.createDeal||f.autoConvertToClient?{title:f.deal.title,pipeline:f.deal.pipeline,dealStage:f.deal.dealStage,dealCategory:f.deal.dealCategory,value:Number(f.deal.value),expectedCloseDate:f.deal.expectedCloseDate,dealAgent:f.deal.dealAgent,dealWatchers:f.deal.dealWatchers||[]}:void 0,companyName:f.companyName,officialWebsite:f.officialWebsite||void 0,officePhone:f.officePhone||void 0,city:f.city||void 0,state:f.state||void 0,postalCode:f.postalCode||void 0,country:f.country||void 0,companyAddress:f.companyAddress||void 0},l=await fetch("".concat(c,"/leads"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)});if(!l.ok){let e=await l.text().catch(()=>"");throw Error(e||"Failed to create lead")}s(),alert("Lead created successfully.")}catch(e){A((null==e?void 0:e.message)||"Failed to create lead.")}finally{T(!1)}},H=async e=>{b(e),y(""),C(!0),k([]);try{let t=localStorage.getItem("accessToken");if(!t)throw Error("No token");if("leadSource"===e){let e=await fetch("".concat(c,"/deals/dealCategory/LeadSource"),{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let t=await e.json();Array.isArray(t)&&k(t)}}else{let e=await fetch("".concat(c,"/deals/dealCategory"),{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let t=await e.json();Array.isArray(t)&&k(t)}}}catch(e){}finally{C(!1)}},q=async e=>{if(!v.trim())return alert("Please enter a name.");C(!0);try{let t=localStorage.getItem("accessToken");if(!t)throw Error("No token");let l="",a={};"leadSource"===e?(l="".concat(c,"/deals/dealCategory/LeadSource"),a={name:v.trim()}):(l="".concat(c,"/deals/dealCategory"),a={categoryName:v.trim()});let s=await fetch(l,{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){let e=await s.text().catch(()=>"");throw Error(e||"Failed to add")}let r=await s.json();"leadSource"===e?(x(e=>[{id:r.id,name:r.name||v.trim()},...e]),g(e=>({...e,leadSource:r.name||v.trim()}))):(i(e=>[{id:r.id,categoryName:r.categoryName||v.trim()},...e]),h(e=>[{id:r.id,categoryName:r.categoryName||v.trim()},...e]),g(e=>({...e,deal:{...e.deal,dealCategory:r.categoryName||v.trim()},clientCategory:r.categoryName||v.trim()}))),y(""),b(null),alert("Added successfully.")}catch(e){alert("Error: "+((null==e?void 0:e.message)||e))}finally{C(!1)}},U=async(e,t)=>{if(confirm("Are you sure you want to delete this item?"))try{let l=localStorage.getItem("accessToken");if(!l)throw Error("No token");let a="";a="leadSource"===e?"".concat(c,"/deals/dealCategory/LeadSource/").concat(t):"".concat(c,"/deals/dealCategory/").concat(t);let s=await fetch(a,{method:"DELETE",headers:{Authorization:"Bearer ".concat(l)}});if(!s.ok){let e=await s.text().catch(()=>"");throw Error(e||"Delete failed")}"leadSource"===e?x(e=>e.filter(e=>e.id!==t)):(i(e=>e.filter(e=>e.id!==t)),h(e=>e.filter(e=>e.id!==t))),alert("Deleted successfully.")}catch(e){alert("Error deleting: "+((null==e?void 0:e.message)||e))}},J=(0,t.jsxs)("form",{onSubmit:R,className:"space-y-6",children:[S&&(0,t.jsx)("div",{className:"text-destructive text-sm",children:S}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-6 shadow-sm flex flex-col",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-4 text-left order-first",children:"Lead Contact Detail"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Name *"}),(0,t.jsx)("input",{ref:M,className:"w-full border rounded-md px-3 py-2 text-sm",value:f.name,onChange:e=>z("name",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Email *"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.email,type:"email",onChange:e=>z("email",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Client Category"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("select",{className:"flex-1 border rounded-md px-3 py-2 text-sm",value:f.clientCategory,onChange:e=>z("clientCategory",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"--"}),u.map(e=>(0,t.jsx)("option",{value:e.categoryName,children:e.categoryName},e.id))]}),(0,t.jsx)("button",{type:"button",onClick:()=>H("clientCategory"),className:"px-3 py-2 rounded border text-sm",children:"Add"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Lead Source"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("select",{className:"flex-1 border  rounded-md px-3 py-2 text-sm",value:f.leadSource,onChange:e=>z("leadSource",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"--"}),m.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,t.jsx)("button",{type:"button",onClick:()=>H("leadSource"),className:"px-3 py-2 rounded border text-sm",children:"Add"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Added By"}),(0,t.jsxs)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.addedBy,onChange:e=>z("addedBy",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"--"}),r.map(e=>(0,t.jsxs)("option",{value:e.employeeId,children:[e.name," (",e.employeeId,")"]},e.employeeId))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Lead Owner"}),(0,t.jsxs)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.leadOwner,onChange:e=>z("leadOwner",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"--"}),r.map(e=>(0,t.jsxs)("option",{value:e.employeeId,children:[e.name," (",e.employeeId,")"]},e.employeeId))]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("input",{id:"createDeal",type:"checkbox",checked:!!f.createDeal,onChange:e=>z("createDeal",e.target.checked)}),(0,t.jsx)("label",{htmlFor:"createDeal",className:"text-sm",children:"Create Deal"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("input",{id:"autoConvert",type:"checkbox",checked:!!f.autoConvertToClient,onChange:e=>z("autoConvertToClient",e.target.checked)}),(0,t.jsx)("label",{htmlFor:"autoConvert",className:"text-sm",children:"Auto convert on WIN"})]})]})]}),(f.createDeal||f.autoConvertToClient)&&(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-5 shadow-sm flex flex-col",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-4 text-left order-first",children:"Deal Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Name *"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.deal.title,onChange:e=>F("title",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Pipeline *"}),(0,t.jsx)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.deal.pipeline,onChange:e=>F("pipeline",e.target.value),children:d.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Stage *"}),(0,t.jsx)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.deal.dealStage,onChange:e=>F("dealStage",e.target.value),children:n.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Value *"}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"px-3 py-2 bg-gray-100 rounded-l text-sm",children:"USD $"}),(0,t.jsx)("input",{className:"flex-1 border rounded-r px-3 py-2 text-sm",type:"number",value:f.deal.value,onChange:e=>F("value",e.target.value)})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Close Date *"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",type:"date",value:f.deal.expectedCloseDate,onChange:e=>F("expectedCloseDate",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Category"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("select",{className:"flex-1 border rounded-md px-3 py-2 text-sm",value:f.deal.dealCategory,onChange:e=>F("dealCategory",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"--"}),o.map(e=>(0,t.jsx)("option",{value:e.categoryName,children:e.categoryName},e.id))]}),(0,t.jsx)("button",{type:"button",onClick:()=>H("dealCategory"),className:"px-3 py-2 rounded border text-sm",children:"Add"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Agent *"}),(0,t.jsxs)("select",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.deal.dealAgent,onChange:e=>F("dealAgent",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"--"}),r.map(e=>(0,t.jsxs)("option",{value:e.employeeId,children:[e.name," (",e.employeeId,")"]},e.employeeId))]})]}),(0,t.jsxs)("div",{className:"md:col-span-3",children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Deal Watcher(s)"}),(0,t.jsxs)("div",{ref:I,className:"relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>B(e=>!e),className:"w-full flex items-center justify-between border rounded-md px-3 py-2 text-sm bg-white",children:[(0,t.jsx)("div",{className:"truncate",children:0===f.deal.dealWatchers.length?"-- select --":f.deal.dealWatchers.map(e=>{var t,l;return null!=(l=null==(t=r.find(t=>t.employeeId===e))?void 0:t.name)?l:e}).join(", ")}),(0,t.jsx)("div",{className:"ml-2",children:f.deal.dealWatchers.length>0&&(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),g(e=>({...e,deal:{...e.deal,dealWatchers:[]}}))},className:"text-xs px-2 py-1 rounded hover:bg-slate-100",children:"Clear"})})]}),L&&(0,t.jsxs)("div",{className:"absolute left-0 right-0 mt-2 z-40 rounded-md bg-white border shadow-lg max-h-60 overflow-auto",children:[(0,t.jsx)("div",{className:"p-2 border-b",children:(0,t.jsx)("input",{className:"w-full border rounded-md p-2 text-sm",placeholder:"Search employees...",value:E,onChange:e=>O(e.target.value)})}),(0,t.jsxs)("ul",{className:"p-2 space-y-1",children:[r.filter(e=>e.name.toLowerCase().includes(E.trim().toLowerCase())||e.employeeId.toLowerCase().includes(E.trim().toLowerCase())).map(e=>{let l=f.deal.dealWatchers.includes(e.employeeId);return(0,t.jsx)("li",{children:(0,t.jsxs)("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-slate-50 cursor-pointer text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:l,onChange:()=>{var t;return t=e.employeeId,void g(e=>{let l=new Set(e.deal.dealWatchers||[]);return l.has(t)?l.delete(t):l.add(t),{...e,deal:{...e.deal,dealWatchers:Array.from(l)}}})}}),(0,t.jsxs)("span",{children:[e.name," ",(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.employeeId,")"]})]})]})},e.employeeId)}),0===r.length&&(0,t.jsx)("li",{className:"p-2 text-sm text-muted-foreground",children:"No employees"})]}),(0,t.jsx)("div",{className:"p-2 border-t flex justify-end gap-2",children:(0,t.jsx)("button",{type:"button",onClick:()=>B(!1),className:"rounded-md px-3 py-1 border text-sm",children:"Done"})})]})]}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-muted-foreground",children:["Selected: ",0===f.deal.dealWatchers.length?"â€”":f.deal.dealWatchers.map(e=>{var t,l;return null!=(l=null==(t=r.find(t=>t.employeeId===e))?void 0:t.name)?l:e}).join(", ")]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-5 shadow-sm flex flex-col",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-4 text-left order-first",children:"Company Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Company Name *"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.companyName,onChange:e=>z("companyName",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Official Website"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.officialWebsite,onChange:e=>z("officialWebsite",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Mobile Number"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.mobileNumber,onChange:e=>z("mobileNumber",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Office Phone No."}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.officePhone,onChange:e=>z("officePhone",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"City"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.city,onChange:e=>z("city",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"State"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.state,onChange:e=>z("state",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Postal Code"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.postalCode,onChange:e=>z("postalCode",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Country"}),(0,t.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-sm",value:f.country,onChange:e=>z("country",e.target.value)})]}),(0,t.jsxs)("div",{className:"md:col-span-3",children:[(0,t.jsx)("label",{className:"block text-xs text-left text-muted-foreground mb-1",children:"Company Address"}),(0,t.jsx)("textarea",{className:"w-full border rounded-md p-3 text-sm h-28",value:f.companyAddress,onChange:e=>z("companyAddress",e.target.value)})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 rounded-md border text-sm",disabled:D,children:"Cancel"}),(0,t.jsx)("button",{type:"button",onClick:R,className:"px-4 py-2 rounded-md bg-sky-600 text-white text-sm",disabled:D,children:D?"Saving...":"Save"})]})]}),K=j?(0,t.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/20",onClick:()=>b(null)}),(0,t.jsx)("div",{className:"fixed inset-0 flex items-start justify-center px-4 pt-20",children:(0,t.jsxs)("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-lg border overflow-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"clientCategory"===j?"Client Category":"leadSource"===j?"Lead Source":"Deal Category"}),(0,t.jsx)("button",{onClick:()=>b(null),className:"text-muted-foreground p-1 rounded hover:bg-slate-100",children:"âœ•"})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-blue-50",children:[(0,t.jsx)("th",{className:"p-2 text-left",children:"#"}),(0,t.jsx)("th",{className:"p-2 text-left",children:"Name"}),(0,t.jsx)("th",{className:"p-2 text-left",children:"Action"})]})}),(0,t.jsxs)("tbody",{children:[(w.length?w:"clientCategory"===j?u:"leadSource"===j?m:o).map((e,l)=>(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"p-2",children:l+1}),(0,t.jsx)("td",{className:"p-2",children:e.categoryName||e.name}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)("button",{onClick:()=>U("leadSource"===j?"leadSource":"clientCategory"===j?"clientCategory":"dealCategory",e.id),className:"text-destructive",children:"ðŸ—‘"})})]},l)),!w.length&&!("clientCategory"===j?u.length:"leadSource"===j?m.length:o.length)&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:3,className:"p-4 text-sm text-muted-foreground",children:"No items found."})})]})]})})}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Name *"}),(0,t.jsx)("input",{value:v,onChange:e=>y(e.target.value),className:"w-full border rounded-md p-2",placeholder:"Enter name"})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>b(null),className:"rounded-md px-4 py-2 border",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>q(j),disabled:N,className:"rounded-md bg-sky-600 text-white px-4 py-2",children:N?"Saving...":"Save"})]})]})]})})]}):null;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"fixed inset-0 z-50","aria-modal":"true",role:"dialog",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:l}),(0,t.jsxs)("aside",{className:["absolute right-0 top-0 h-full bg-gray-50 flex flex-col w-full sm:w-[80vw] max-w-full transform transition-transform duration-300 ease-out",W?"translate-x-0":"translate-x-full"].join(" "),style:{willChange:"transform"},children:[(0,t.jsxs)("div",{className:"flex items-start justify-between p-4 border-b bg-white sticky top-0 z-10",children:[(0,t.jsx)("div",{children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-left",children:"Add Lead Contact Information "})}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("button",{onClick:l,className:"p-2 rounded hover:bg-slate-100",children:"âœ•"})})]}),(0,t.jsx)("div",{className:"p-6 overflow-auto flex-1",children:J})]})]}),K]})}function u(e){let{lead:l,idx:s,mutate:r,onEdit:d,onView:n,onChangeToClient:c}=e,[i,x]=(0,a.useState)(!1),u=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(!i)return;let e=e=>{let t=e.target;u.current&&!u.current.contains(t)&&x(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[i]),(0,t.jsxs)(o.TableRow,{ref:u,children:[(0,t.jsx)(o.TableCell,{children:s+1}),(0,t.jsx)(o.TableCell,{children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium",children:l.name}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:l.companyName||"â€”"})]})}),(0,t.jsx)(o.TableCell,{children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm",children:l.email||"â€”"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:l.mobileNumber||"â€”"})]})}),(0,t.jsx)(o.TableCell,{children:(0,t.jsx)(m,{meta:l.leadOwnerMeta,fallback:l.leadOwner})}),(0,t.jsx)(o.TableCell,{children:(0,t.jsx)(m,{meta:l.addedByMeta,fallback:l.addedBy})}),(0,t.jsx)(o.TableCell,{children:(0,t.jsx)("span",{className:"text-sm",children:l.createdAt?new Date(l.createdAt).toLocaleDateString():"â€”"})}),(0,t.jsxs)(o.TableCell,{className:"relative text-right",children:[(0,t.jsx)("button",{onClick:()=>{x(!1),n(l.id)},className:"w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-slate-50",children:(0,t.jsxs)("svg",{className:"w-5 h-5 text-muted-foreground",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,t.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M2 12s4-7 10-7 10 7 10 7-4 7-10 7S2 12 2 12z"}),(0,t.jsx)("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.5"})]})}),i&&(0,t.jsx)("div",{className:"absolute right-0 z-30 mt-2 w-56 rounded-md bg-white shadow-lg border",children:(0,t.jsxs)("ul",{className:"py-1",children:[(0,t.jsx)("li",{}),(0,t.jsx)("li",{})]})})]})]})}function h(){let e=(0,s.useRouter)(),{data:m,error:h,isLoading:p,mutate:f}=(0,l.default)("/api/leads/admin/get",i,{refreshInterval:3e4,revalidateOnFocus:!0}),{data:g}=(0,l.default)("".concat(c,"/employee/all?page=0&size=20"),i,{revalidateOnFocus:!1}),j=g&&g.content?g.content:g||[],[b,v]=(0,a.useState)(""),[y,N]=(0,a.useState)(!1),[C,w]=(0,a.useState)("created"),[k,S]=(0,a.useState)(""),[A,D]=(0,a.useState)(""),[T,L]=(0,a.useState)("All"),[B,E]=(0,a.useState)("All"),[O,I]=(0,a.useState)(!1),[W,P]=(0,a.useState)(null),[M,z]=(0,a.useState)(null),F=m||[],R=(0,a.useMemo)(()=>{let e=new Set;return F.forEach(t=>{var l;t.leadOwner&&e.add(t.leadOwner),(null==(l=t.leadOwnerMeta)?void 0:l.name)&&e.add(t.leadOwnerMeta.name)}),["All",...Array.from(e).sort()]},[F]),H=(0,a.useMemo)(()=>{let e=new Set;return F.forEach(t=>{var l;t.addedBy&&e.add(t.addedBy),(null==(l=t.addedByMeta)?void 0:l.name)&&e.add(t.addedByMeta.name)}),["All",...Array.from(e).sort()]},[F]),q=e=>{if(!e)return null;let t=new Date(e);return isNaN(t.getTime())?null:t},U=(0,a.useMemo)(()=>{let e=b.trim().toLowerCase();return(F||[]).filter(t=>{var l,a;if(e&&![t.name,t.email,t.companyName,t.city,t.country,t.status,t.leadOwner,t.addedBy,t.mobileNumber].some(t=>!!t&&t.toLowerCase().includes(e))||"All"!==T&&((null==(l=t.leadOwnerMeta)?void 0:l.name)||t.leadOwner||"")!==T||"All"!==B&&((null==(a=t.addedByMeta)?void 0:a.name)||t.addedBy||"")!==B)return!1;if(k||A){let e=q("created"===C?t.createdAt:t.updatedAt);if(!e)return!1;if(k){let t=q(k);if(!t||e<t)return!1}if(A){let t=q(A);if(!t||(t.setHours(23,59,59,999),e>t))return!1}}return!0})},[F,b,T,B,k,A,C]),J=e=>{};return(0,t.jsxs)("main",{className:"container mx-auto max-w-6xl px-4 py-8",children:[(0,t.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Duration"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground underline",children:"Start Date to End Date "})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("button",{onClick:()=>N(!0),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-slate-700",children:[(0,t.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,t.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M6 12h12M10 18h4"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Filters"})]}),(0,t.jsx)("div",{className:"w-9 h-9 rounded-full bg-gray-200"})]})]})}),(0,t.jsxs)(r.Card,{className:"p-4 md:p-6",children:[(0,t.jsxs)("div",{className:"flex items-start md:items-center justify-between mb-4 gap-3",children:[(0,t.jsx)("div",{className:"flex items-center gap-3",children:(0,t.jsx)("button",{onClick:()=>I(!0),className:"inline-flex items-center gap-2 rounded-md bg-sky-600 px-4 py-2 text-white text-sm font-medium shadow-sm hover:bg-sky-700",children:"+ Add Lead"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 rounded-md border bg-white px-3 py-2",children:(0,t.jsx)(d.Input,{value:b,onChange:e=>v(e.target.value),placeholder:"Search","aria-label":"Search leads",className:"border-0 p-0 focus:ring-0"})}),(0,t.jsx)(n.Button,{variant:"secondary",onClick:()=>f(),children:"Refresh"})]})]}),p?(0,t.jsx)("div",{className:"py-10 text-center text-muted-foreground",children:"Loading leadsâ€¦"}):h?(0,t.jsxs)("div",{className:"py-10 text-center",children:[(0,t.jsx)("p",{className:"text-destructive",children:"Failed to load leads."}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:h.message}),(0,t.jsx)(n.Button,{className:"mt-4",onClick:()=>f(),children:"Retry"})]}):0===U.length?(0,t.jsx)("div",{className:"py-10 text-center text-muted-foreground",children:"No leads found."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-4 overflow-x-auto",children:(0,t.jsxs)(o.Table,{children:[(0,t.jsx)(o.TableHeader,{children:(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableHead,{className:"w-16",children:"S.No."}),(0,t.jsx)(o.TableHead,{className:"min-w-[220px]",children:"Lead Name"}),(0,t.jsx)(o.TableHead,{children:"Contact Details"}),(0,t.jsx)(o.TableHead,{children:"Lead Owner"}),(0,t.jsx)(o.TableHead,{children:"Added By"}),(0,t.jsx)(o.TableHead,{children:"Created On"}),(0,t.jsx)(o.TableHead,{className:"text-right",children:"Action"})]})}),(0,t.jsx)(o.TableBody,{children:U.map((l,a)=>(0,t.jsx)(u,{lead:l,idx:a,mutate:()=>f(),onEdit:e=>{P(e)},onView:t=>{e.push("/employees/leads/admin/get/".concat(t))},onChangeToClient:J},l.id))})]})}),(0,t.jsxs)("div",{className:"mt-6 flex items-center justify-between text-sm text-muted-foreground",children:[(0,t.jsx)("div",{children:"Result per page-8"}),(0,t.jsx)("div",{children:"Page 1 of 1 "}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{className:"p-2 rounded hover:bg-slate-100",children:(0,t.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,t.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),(0,t.jsx)("button",{className:"p-2 rounded hover:bg-slate-100",children:(0,t.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,t.jsx)("path",{strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]})]})]})]}),y&&(0,t.jsxs)("div",{className:"fixed inset-0 z-40",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/20"}),(0,t.jsxs)("aside",{className:"absolute right-0 top-0 h-full w-80 bg-white border-l shadow-lg p-6 overflow-auto",role:"dialog","aria-label":"Filters",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Filters"}),(0,t.jsx)("button",{onClick:()=>N(!1),"aria-label":"Close filters",className:"p-1 rounded hover:bg-slate-100",children:"âœ•"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Date Filter On"}),(0,t.jsxs)("select",{value:C,onChange:e=>w(e.target.value),className:"block w-full rounded-md border px-3 py-2",children:[(0,t.jsx)("option",{value:"created",children:"Created"}),(0,t.jsx)("option",{value:"updated",children:"Updated"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Start Date"}),(0,t.jsx)("input",{type:"date",value:k,onChange:e=>S(e.target.value),className:"block w-full rounded-md border px-3 py-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"End Date"}),(0,t.jsx)("input",{type:"date",value:A,onChange:e=>D(e.target.value),className:"block w-full rounded-md border px-3 py-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Lead Owner"}),(0,t.jsx)("select",{value:T,onChange:e=>L(e.target.value),className:"block w-full rounded-md border px-3 py-2",children:R.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-muted-foreground mb-1",children:"Added by"}),(0,t.jsx)("select",{value:B,onChange:e=>E(e.target.value),className:"block w-full rounded-md border px-3 py-2",children:H.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,t.jsx)("button",{onClick:()=>{w("created"),S(""),D(""),L("All"),E("All")},className:"rounded-md px-4 py-2 border",children:"Clear"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.Button,{variant:"secondary",onClick:()=>N(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:()=>N(!1),children:"Apply"})]})]})]})]})]}),O&&(0,t.jsx)(x,{onClose:()=>I(!1),onCreated:async()=>{I(!1),await f()},employees:j})]})}}]);