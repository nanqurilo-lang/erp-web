(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,386532,55453,513942,540508,737785,38453,339917,158649,257456,101882,910704,811681,299116,e=>{"use strict";e.s(["default",()=>i],386532);var a=e.i(843476),l=e.i(555436),s=e.i(649582),t=e.i(967489),n=e.i(793479),r=e.i(519455);function i(e){let{filters:i,setFilters:c,invoices:o}=e,d=["All",...new Set(o.map(e=>{var a;return null==(a=e.project)?void 0:a.projectName}).filter(Boolean))],m=["All",...new Set(o.map(e=>{var a;return null==(a=e.client)?void 0:a.name}).filter(Boolean))],u=["All",...new Set(o.map(e=>e.status).filter(Boolean))];return(0,a.jsxs)("div",{className:"border rounded-md bg-white px-3 py-3 mb-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center border rounded px-2 py-2 bg-white",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,a.jsx)("input",{type:"date",className:"text-xs border rounded px-2 py-1",value:i.startDate,onChange:e=>c(a=>({...a,startDate:e.target.value}))}),(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"to"}),(0,a.jsx)("input",{type:"date",className:"text-xs border rounded px-2 py-1",value:i.endDate,onChange:e=>c(a=>({...a,endDate:e.target.value}))})]}),(0,a.jsxs)(t.Select,{value:i.client,onValueChange:e=>c(a=>({...a,client:e})),children:[(0,a.jsx)(t.SelectTrigger,{className:"w-[160px]",children:(0,a.jsx)(t.SelectValue,{placeholder:"Client"})}),(0,a.jsx)(t.SelectContent,{children:m.map(e=>(0,a.jsx)(t.SelectItem,{value:e,children:e},e))})]}),(0,a.jsxs)(t.Select,{value:i.project,onValueChange:e=>c(a=>({...a,project:e})),children:[(0,a.jsx)(t.SelectTrigger,{className:"w-[160px]",children:(0,a.jsx)(t.SelectValue,{placeholder:"Project"})}),(0,a.jsx)(t.SelectContent,{children:d.map(e=>(0,a.jsx)(t.SelectItem,{value:e,children:e},e))})]}),(0,a.jsxs)(t.Select,{value:i.status,onValueChange:e=>c(a=>({...a,status:e})),children:[(0,a.jsx)(t.SelectTrigger,{className:"w-[160px]",children:(0,a.jsx)(t.SelectValue,{placeholder:"Status"})}),(0,a.jsx)(t.SelectContent,{children:u.map(e=>(0,a.jsx)(t.SelectItem,{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l.Search,{className:"w-4 h-4 absolute left-2 top-2 text-gray-400"}),(0,a.jsx)(n.Input,{placeholder:"Search invoice / project / client",className:"pl-8 w-[250px]",value:i.search,onChange:e=>c(a=>({...a,search:e.target.value}))})]})]}),(0,a.jsxs)(r.Button,{variant:"outline",className:"flex items-center gap-2",children:[(0,a.jsx)(s.SlidersHorizontal,{className:"h-4 w-4"})," Filters"]})]})}e.s(["default",()=>w],55453),e.i(247167);var c=e.i(657688),o=e.i(784774),d=e.i(541071),m=e.i(286536),u=e.i(592930),x=e.i(569074),h=e.i(116019),j=e.i(269638),p=e.i(212426),v=e.i(178583),N=e.i(245423),b=e.i(174886),g=e.i(755146),y=e.i(487486);let f="https://6jnqmj85-80.inc1.devtunnels.ms";function w(e){let{invoices:l,loading:s,filters:t,setActiveInvoice:n,setModal:i}=e,w=l.filter(e=>{var a,l,s,n,r,i,c;if(t.search){let a=t.search.toLowerCase();if(!((null==(s=e.invoiceNumber)?void 0:s.toLowerCase().includes(a))||(null==(r=e.project)||null==(n=r.projectName)?void 0:n.toLowerCase().includes(a))||(null==(c=e.client)||null==(i=c.name)?void 0:i.toLowerCase().includes(a))))return!1}if("All"!==t.project&&(null==(a=e.project)?void 0:a.projectName)!==t.project||"All"!==t.client&&(null==(l=e.client)?void 0:l.name)!==t.client||"All"!==t.status&&e.status!==t.status)return!1;if(t.startDate&&t.endDate){let a=new Date(e.invoiceDate),l=new Date(t.startDate),s=new Date(t.endDate);if(s.setHours(23,59,59),a<l||a>s)return!1}return!0}),C=async e=>{if((null==e?void 0:e.id)&&confirm("Mark invoice ".concat(e.invoiceNumber," as PAID?")))try{let a=await fetch("".concat(f,"/api/invoices/").concat(e.invoiceNumber,"/mark-paid"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"Content-Type":"application/json"}});if(!a.ok){let e=await a.text();throw Error(e||"Failed to mark invoice as paid")}alert("Invoice marked as PAID successfully âœ…"),window.location.reload()}catch(e){console.error(e),alert("Failed to mark invoice as paid")}},D=async e=>{if((null==e?void 0:e.invoiceNumber)&&confirm("Send payment reminder for invoice ".concat(e.invoiceNumber,"?")))try{let a=await fetch("".concat(f,"/api/invoices/").concat(e.invoiceNumber,"/actions/send-reminder-email"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}});if(!a.ok){let e=await a.text();throw Error(e||"Failed to send reminder")}alert("Payment reminder sent successfully ðŸ“§")}catch(e){console.error(e),alert("Failed to send payment reminder")}},S=async e=>{try{let a=await fetch("".concat(f,"/api/invoices/").concat(e.invoiceNumber),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}});if(!a.ok){let e=await a.text();throw Error(e||"Failed to delete invoice")}alert("Invoice deleted successfully ðŸ—‘ï¸"),window.location.reload()}catch(e){console.error("Delete invoice error:",e),alert("Failed to delete invoice")}};return s?(0,a.jsx)("p",{className:"text-center py-10",children:"Loadingâ€¦"}):(0,a.jsx)("div",{className:"border rounded-lg bg-white shadow-sm",children:(0,a.jsxs)(o.Table,{children:[(0,a.jsx)(o.TableHeader,{children:(0,a.jsxs)(o.TableRow,{children:[(0,a.jsx)(o.TableHead,{children:"Invoice"}),(0,a.jsx)(o.TableHead,{children:"Project"}),(0,a.jsx)(o.TableHead,{children:"Client"}),(0,a.jsx)(o.TableHead,{children:"Total"}),(0,a.jsx)(o.TableHead,{children:"Date"}),(0,a.jsx)(o.TableHead,{children:"Status"}),(0,a.jsx)(o.TableHead,{className:"text-right",children:"Action"})]})}),(0,a.jsx)(o.TableBody,{children:0===w.length?(0,a.jsx)(o.TableRow,{children:(0,a.jsx)(o.TableCell,{colSpan:8,className:"text-center py-10 text-gray-500",children:"No invoices found"})}):w.map(e=>{var l,s,t,f,w,k,I,T;return(0,a.jsxs)(o.TableRow,{className:"hover:bg-gray-50",children:[(0,a.jsx)(o.TableCell,{children:e.invoiceNumber}),(0,a.jsx)(o.TableCell,{children:null==(l=e.project)?void 0:l.projectName}),(0,a.jsx)(o.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(null==(t=e.client)||null==(s=t.company)?void 0:s.companyLogoUrl)?(0,a.jsx)(c.default,{src:e.client.company.companyLogoUrl,alt:"logo",width:28,height:28,className:"rounded-full"}):(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:null==(w=e.client)||null==(f=w.name)?void 0:f.charAt(0)}),(0,a.jsx)("span",{children:null==(k=e.client)?void 0:k.name})]})}),(0,a.jsxs)(o.TableCell,{children:[e.currency," ",Number(e.total).toFixed(2)]}),(0,a.jsx)(o.TableCell,{children:(I=e.invoiceDate)?new Date(I).toLocaleDateString("en-GB"):"--"}),(0,a.jsx)(o.TableCell,{children:"paid"===(T=null==(T=e.status)?void 0:T.toLowerCase())?(0,a.jsx)(y.Badge,{className:"bg-green-100 text-green-700",children:"Paid"}):"unpaid"===T?(0,a.jsx)(y.Badge,{className:"bg-red-100 text-red-700",children:"Unpaid"}):(null==T?void 0:T.includes("credit"))?(0,a.jsx)(y.Badge,{className:"bg-yellow-100 text-yellow-700",children:"Credit"}):(0,a.jsx)(y.Badge,{children:T})}),(0,a.jsx)(o.TableCell,{className:"text-right",children:(0,a.jsxs)(g.DropdownMenu,{children:[(0,a.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(r.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(d.MoreHorizontal,{className:"h-4 w-4"})})}),(0,a.jsxs)(g.DropdownMenuContent,{align:"end",className:"w-52",children:[(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,view:!0}))},children:[(0,a.jsx)(m.Eye,{className:"h-4 w-4 mr-2"})," View"]}),"UNPAID"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,edit:!0}))},children:[(0,a.jsx)(u.Edit2,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{confirm("Mark invoice as paid?")&&C(e)},children:[(0,a.jsx)(j.CheckCircle,{className:"h-4 w-4 mr-2"})," Mark as Paid"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,payment:!0}))},children:[(0,a.jsx)(p.DollarSign,{className:"h-4 w-4 mr-2"})," Add Payment"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,viewPayment:!0}))},children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 mr-2"})," View Payments"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,upload:!0}))},children:[(0,a.jsx)(x.Upload,{className:"h-4 w-4 mr-2"})," Upload File"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{D(e)},children:[(0,a.jsx)(N.Bell,{className:"h-4 w-4 mr-2"})," Send Reminder"]})]}),"PAID"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,receipt:!0}))},children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 mr-2"})," Add Receipt"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,viewReceipt:!0}))},children:[(0,a.jsx)(m.Eye,{className:"h-4 w-4 mr-2"})," View Receipt"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,upload:!0}))},children:[(0,a.jsx)(x.Upload,{className:"h-4 w-4 mr-2"})," Upload File"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,viewPayment:!0}))},children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 mr-2"})," View Payments"]}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,createCredit:!0}))},children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 mr-2"}),"Create Credit Note"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,viewCredit:!0}))},children:[(0,a.jsx)(m.Eye,{className:"h-4 w-4 mr-2"}),"View Credit Notes"]})]})]}),"CREDIT_NOTES"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,payment:!0}))},children:[(0,a.jsx)(p.DollarSign,{className:"h-4 w-4 mr-2"})," Add Payment"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,viewPayment:!0}))},children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 mr-2"})," View Payments"]})]}),(0,a.jsx)(g.DropdownMenuSeparator,{}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{n(e),i(e=>({...e,create:!0}))},children:[(0,a.jsx)(b.Copy,{className:"h-4 w-4 mr-2"})," Create Duplicate"]}),(0,a.jsxs)(g.DropdownMenuItem,{className:"text-red-600",onClick:()=>S(e),children:[(0,a.jsx)(h.Trash,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})})]},e.id)})})]})})}e.s(["default",()=>A],513942);var C=e.i(271645),D=e.i(37727),S=e.i(975157);function k(e){let{open:l,onClose:s,title:t,children:n,className:r}=e;return l?(0,a.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:s}),(0,a.jsxs)("div",{className:(0,S.cn)("absolute right-0 top-0 h-full w-full bg-white shadow-xl","animate-slide-in-right",r),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:t}),(0,a.jsx)("button",{onClick:s,children:(0,a.jsx)(D.X,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"p-6 overflow-auto h-[calc(100%-64px)]",children:n})]})]}):null}function I(e){let{children:l}=e;return(0,a.jsx)("div",{className:"border rounded-lg bg-white p-4 shadow-sm",children:l})}let T="".concat("https://6jnqmj85-80.inc1.devtunnels.ms");function A(e){let{open:l,onClose:s,invoices:t=[],refresh:n}=e,[i,c]=(0,C.useState)(!1),[o,d]=(0,C.useState)({invoiceNumber:"",invoiceDate:"",currency:"USD",projectName:"",projectId:"",clientId:"",amount:0,tax:10,discount:0,amountInWords:"",notes:""}),m=(0,C.useMemo)(()=>{let e=new Set;return t.forEach(a=>{var l;return(null==(l=a.project)?void 0:l.projectName)&&e.add(a.project.projectName)}),["Select Project",...Array.from(e)]},[t]),u=(0,C.useMemo)(()=>{let e=new Set;return t.forEach(a=>{var l;return(null==(l=a.client)?void 0:l.name)&&e.add(a.client.name)}),["Select Client",...Array.from(e)]},[t]),x=Number(o.amount||0),h=o.discount>1?o.discount:x*Number(o.discount||0)/100,j=(x-h)*Number(o.tax||0)/100,p=x-h+j,v=async()=>{c(!0);try{let e={...o,amount:Number(o.amount||0),tax:Number(o.tax||0),discount:Number(o.discount||0)};if(!(await fetch("".concat(T,"/api/invoices"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:JSON.stringify(e)})).ok)throw Error("Create failed");s(),n()}catch(e){alert(e.message)}finally{c(!1)}};return(0,a.jsx)(k,{open:l,title:"Create Invoice",onClose:s,children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(I,{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-4",children:"Invoice Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Number *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute left-0 inset-y-0 pl-3 flex items-center text-gray-400",children:"INV#"}),(0,a.jsx)("input",{className:"pl-14 border rounded w-full h-10",placeholder:"INV0001",value:o.invoiceNumber,onChange:e=>d(a=>({...a,invoiceNumber:e.target.value}))})]})]}),(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Date *"}),(0,a.jsx)("input",{type:"date",className:"border rounded w-full h-10 px-2",value:o.invoiceDate,onChange:e=>d(a=>({...a,invoiceDate:e.target.value}))})]}),(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Currency *"}),(0,a.jsxs)("select",{className:"border rounded w-full h-10 px-2",value:o.currency,onChange:e=>d(a=>({...a,currency:e.target.value})),children:[(0,a.jsx)("option",{value:"USD",children:"USD - US Dollar"}),(0,a.jsx)("option",{value:"EUR",children:"EUR - Euro"}),(0,a.jsx)("option",{value:"GBP",children:"GBP - British Pound"}),(0,a.jsx)("option",{value:"AUD",children:"AUD - Australian Dollar"}),(0,a.jsx)("option",{value:"CAD",children:"CAD - Canadian Dollar"}),(0,a.jsx)("option",{value:"JPY",children:"JPY - Japanese Yen"}),(0,a.jsx)("option",{value:"CHF",children:"CHF - Swiss Franc"}),(0,a.jsx)("option",{value:"SGD",children:"SGD - Singapore Dollar"}),(0,a.jsx)("option",{value:"NZD",children:"NZD - New Zealand Dollar"})]})]})]})]}),(0,a.jsxs)(I,{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-4",children:"Project Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project *"}),(0,a.jsx)("select",{className:"border rounded w-full h-10 px-2",value:o.projectName,onChange:e=>{let a=e.target.value,l=t.find(e=>{var l;return(null==(l=e.project)?void 0:l.projectName)===a});d(e=>{var s;return{...e,projectName:a,projectId:(null==l||null==(s=l.project)?void 0:s.projectId)||""}})},children:m.map(e=>(0,a.jsx)("option",{children:e},e))})]}),(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Client *"}),(0,a.jsx)("select",{className:"border rounded w-full h-10 px-2",value:o.clientId,onChange:e=>d(a=>({...a,clientId:e.target.value})),children:u.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project Budget *"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"px-3 py-2 bg-gray-100 border rounded-l",children:"USD"===o.currency?"â‚¹":"$"}),(0,a.jsx)("input",{readOnly:!0,className:"border rounded-r w-full h-10 px-3",value:(e=>{var a;let l=t.find(a=>{var l;return(null==(l=a.project)?void 0:l.projectName)===e});return(null==l||null==(a=l.project)?void 0:a.budget)||0})(o.projectName).toLocaleString()})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 border rounded flex overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex-1 p-3",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount"}),(0,a.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,a.jsx)("div",{className:"px-3 py-2 bg-gray-50 border rounded",children:"$"}),(0,a.jsx)("input",{type:"number",className:"border rounded h-10 w-40 px-2",value:o.amount,onChange:e=>d(a=>({...a,amount:Number(e.target.value)}))})]})]}),(0,a.jsxs)("div",{className:"w-56 p-3 border-l",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Tax (%)"}),(0,a.jsx)("input",{type:"number",className:"border rounded h-10 w-full px-2",value:o.tax,onChange:e=>d(a=>({...a,tax:Number(e.target.value)}))})]}),(0,a.jsxs)("div",{className:"w-40 bg-gray-100 p-3 flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Total"}),(0,a.jsx)("div",{className:"font-bold text-lg",children:p.toFixed(2)})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsxs)("div",{className:"w-80 border rounded",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 p-2 border-b",children:[(0,a.jsx)("div",{}),(0,a.jsx)("div",{className:"text-sm text-gray-500 text-right",children:"Subtotal"}),(0,a.jsx)("div",{className:"text-right font-medium",children:x.toFixed(2)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 p-2 border-b items-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Discount"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"number",className:"border rounded px-2 w-full h-8",value:o.discount,onChange:e=>d(a=>({...a,discount:Number(e.target.value)}))})}),(0,a.jsx)("div",{className:"text-right",children:h.toFixed(2)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 p-2 border-b items-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Tax"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[o.tax,"%"]}),(0,a.jsx)("div",{className:"text-right",children:j.toFixed(2)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 p-2 bg-gray-100",children:[(0,a.jsx)("div",{}),(0,a.jsx)("div",{className:"text-right font-medium",children:"Total"}),(0,a.jsx)("div",{className:"text-right font-bold",children:p.toFixed(2)})]})]})})]}),(0,a.jsx)(I,{children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-6",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount in words"}),(0,a.jsx)("input",{className:"border rounded w-full h-10 px-3",value:o.amountInWords,onChange:e=>d(a=>({...a,amountInWords:e.target.value}))})]}),(0,a.jsxs)("div",{className:"col-span-6",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Notes"}),(0,a.jsx)("textarea",{className:"border rounded w-full h-28 p-3",value:o.notes,onChange:e=>d(a=>({...a,notes:e.target.value}))})]})]})}),(0,a.jsxs)("div",{className:"flex justify-center gap-4 mt-2",children:[(0,a.jsx)(r.Button,{variant:"outline",onClick:s,children:"Cancel"}),(0,a.jsx)(r.Button,{onClick:v,disabled:i,children:i?"Saving...":"Save"})]})]})})}function P(e){var l,s,t,n,i,c,o,d,m,h,p,N,b,g;let{open:y,onClose:f,invoice:w,setModal:C,refresh:D}=e;if(!w)return null;let S=e=>e?new Date(e).toLocaleDateString("en-GB"):"--";return(0,a.jsx)(k,{open:y,onClose:f,title:"Invoice ".concat(w.invoiceNumber),children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(I,{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Client Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsx)("div",{className:"text-gray-600",children:"Name"}),(0,a.jsx)("div",{children:null==(l=w.client)?void 0:l.name}),(0,a.jsx)("div",{className:"text-gray-600",children:"Email"}),(0,a.jsx)("div",{children:null==(s=w.client)?void 0:s.email}),(0,a.jsx)("div",{className:"text-gray-600",children:"Company"}),(0,a.jsx)("div",{children:null==(n=w.client)||null==(t=n.company)?void 0:t.companyName}),(0,a.jsx)("div",{className:"text-gray-600",children:"Mobile"}),(0,a.jsx)("div",{children:null==(i=w.client)?void 0:i.mobile}),(0,a.jsx)("div",{className:"text-gray-600",children:"Address"}),(0,a.jsx)("div",{children:null==(c=w.client)?void 0:c.address}),(0,a.jsx)("div",{className:"text-gray-600",children:"Country"}),(0,a.jsx)("div",{children:null==(o=w.client)?void 0:o.country})]})]}),(0,a.jsxs)(I,{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Project Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsx)("div",{className:"text-gray-600",children:"Project"}),(0,a.jsx)("div",{children:null==(d=w.project)?void 0:d.projectName}),(0,a.jsx)("div",{className:"text-gray-600",children:"Code"}),(0,a.jsx)("div",{children:null==(m=w.project)?void 0:m.projectCode}),(0,a.jsx)("div",{className:"text-gray-600",children:"Start"}),(0,a.jsx)("div",{children:S(null==(h=w.project)?void 0:h.startDate)}),(0,a.jsx)("div",{className:"text-gray-600",children:"Deadline"}),(0,a.jsx)("div",{children:S(null==(p=w.project)?void 0:p.deadline)}),(0,a.jsx)("div",{className:"text-gray-600",children:"Budget"}),(0,a.jsxs)("div",{children:[w.currency," ",null==(b=w.project)||null==(N=b.budget)?void 0:N.toLocaleString()]})]})]})]}),(0,a.jsxs)(I,{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Invoice Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"space-y-2 text-gray-600",children:[(0,a.jsx)("div",{children:"Invoice No"}),(0,a.jsx)("div",{children:"Invoice Date"}),(0,a.jsx)("div",{children:"Currency"}),(0,a.jsx)("div",{children:"Amount"}),(0,a.jsx)("div",{children:"Tax"}),(0,a.jsx)("div",{children:"Total"}),(0,a.jsx)("div",{children:"Status"})]}),(0,a.jsxs)("div",{className:"space-y-2 md:col-span-2 font-medium",children:[(0,a.jsx)("div",{children:w.invoiceNumber}),(0,a.jsx)("div",{children:S(w.invoiceDate)}),(0,a.jsx)("div",{children:w.currency}),(0,a.jsxs)("div",{children:[w.currency," ",w.amount]}),(0,a.jsxs)("div",{children:[w.tax,"%"]}),(0,a.jsxs)("div",{children:[w.currency," ",w.total]}),(0,a.jsx)("div",{children:(e=>{let l=(e||"").toLowerCase();return"paid"===l?(0,a.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded",children:"Paid"}):"unpaid"===l?(0,a.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded",children:"Unpaid"}):(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded",children:e})})(w.status)})]})]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",children:"Files"}),(0,a.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[0===(w.fileUrls||[]).length&&(0,a.jsx)("span",{className:"text-gray-500 text-sm",children:"No files uploaded"}),(w.fileUrls||[]).map((e,l)=>(0,a.jsxs)("div",{className:"border rounded p-2 w-40",children:[(0,a.jsx)("div",{className:"truncate text-sm",children:e}),(0,a.jsxs)(r.Button,{className:"mt-2 w-full",size:"sm",variant:"outline",onClick:()=>window.open(e,"_blank"),children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 mr-2"})," Open"]})]},l))]})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(null==(g=w.status)?void 0:g.toLowerCase())==="unpaid"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.Button,{variant:"ghost",onClick:()=>C(e=>({...e,edit:!0})),children:[(0,a.jsx)(u.Edit2,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,a.jsxs)(r.Button,{onClick:()=>alert("Mark paid API pending"),children:[(0,a.jsx)(j.CheckCircle,{className:"h-4 w-4 mr-2"})," Mark As Paid"]})]}),(0,a.jsxs)(r.Button,{variant:"ghost",onClick:()=>C(e=>({...e,upload:!0})),children:[(0,a.jsx)(x.Upload,{className:"h-4 w-4 mr-2"})," Upload File"]}),(0,a.jsxs)(r.Button,{onClick:()=>C(e=>({...e,payment:!0})),children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 mr-2"})," View Payments"]})]})]})]})})}e.s(["default",()=>P],540508),e.s(["default",()=>U],737785);let B="".concat("https://6jnqmj85-80.inc1.devtunnels.ms");function U(e){let{open:l,onClose:s,invoice:t,invoices:n=[],refresh:i}=e;if(!t)return null;let[c,o]=(0,C.useState)(!1),[d,m]=(0,C.useState)({invoiceNumber:"",invoiceDate:"",currency:"USD",projectName:"",projectId:"",clientId:"",amount:0,tax:0,discount:0,amountInWords:"",notes:""});(0,C.useEffect)(()=>{var e,a,l;t&&m({invoiceNumber:t.invoiceNumber||"",invoiceDate:t.invoiceDate||"",currency:t.currency||"USD",projectName:(null==(e=t.project)?void 0:e.projectName)||"",projectId:(null==(a=t.project)?void 0:a.projectId)||"",clientId:(null==(l=t.client)?void 0:l.name)||"",amount:Number(t.amount||0),tax:Number(t.tax||0),discount:Number(t.discount||0),amountInWords:t.amountInWords||"",notes:t.notes||""})},[t]);let u=(0,C.useMemo)(()=>{let e=new Set;return n.forEach(a=>{var l;return(null==(l=a.project)?void 0:l.projectName)&&e.add(a.project.projectName)}),["Select Project",...Array.from(e)]},[n]),x=(0,C.useMemo)(()=>{let e=new Set;return n.forEach(a=>{var l;return(null==(l=a.client)?void 0:l.name)&&e.add(a.client.name)}),["Select Client",...Array.from(e)]},[n]),h=Number(d.amount||0),j=d.discount>1?d.discount:h*Number(d.discount||0)/100,p=(h-j)*Number(d.tax||0)/100,v=async()=>{o(!0);try{let e={...d,amount:Number(d.amount||0),tax:Number(d.tax||0),discount:Number(d.discount||0)};if(!(await fetch("".concat(B,"/api/invoices/").concat(t.invoiceNumber),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:JSON.stringify(e)})).ok)throw Error("Update failed");s(),i()}catch(e){alert(e.message)}finally{o(!1)}};return(0,a.jsx)(k,{open:l,title:"Edit Invoice â€“ ".concat(t.invoiceNumber),onClose:s,children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(I,{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-4",children:"Invoice Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Number"}),(0,a.jsx)("input",{readOnly:!0,className:"border rounded w-full h-10 px-3 bg-gray-100",value:d.invoiceNumber})]}),(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Invoice Date *"}),(0,a.jsx)("input",{type:"date",className:"border rounded w-full h-10 px-2",value:d.invoiceDate,onChange:e=>m(a=>({...a,invoiceDate:e.target.value}))})]}),(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Currency *"}),(0,a.jsxs)("select",{className:"border rounded w-full h-10 px-2",value:d.currency,onChange:e=>m(a=>({...a,currency:e.target.value})),children:[(0,a.jsx)("option",{value:"USD",children:"USD - US Dollar"}),(0,a.jsx)("option",{value:"EUR",children:"EUR - Euro"}),(0,a.jsx)("option",{value:"GBP",children:"GBP - British Pound"}),(0,a.jsx)("option",{value:"AUD",children:"AUD - Australian Dollar"}),(0,a.jsx)("option",{value:"CAD",children:"CAD - Canadian Dollar"}),(0,a.jsx)("option",{value:"JPY",children:"JPY - Japanese Yen"}),(0,a.jsx)("option",{value:"CHF",children:"CHF - Swiss Franc"}),(0,a.jsx)("option",{value:"SGD",children:"SGD - Singapore Dollar"}),(0,a.jsx)("option",{value:"NZD",children:"NZD - New Zealand Dollar"})]})]})]})]}),(0,a.jsxs)(I,{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-4",children:"Project Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project *"}),(0,a.jsx)("select",{className:"border rounded w-full h-10 px-2",value:d.projectName,onChange:e=>{let a=e.target.value,l=n.find(e=>{var l;return(null==(l=e.project)?void 0:l.projectName)===a});m(e=>{var s;return{...e,projectName:a,projectId:(null==l||null==(s=l.project)?void 0:s.projectId)||""}})},children:u.map(e=>(0,a.jsx)("option",{children:e},e))})]}),(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Client *"}),(0,a.jsx)("select",{className:"border rounded w-full h-10 px-2",value:d.clientId,onChange:e=>m(a=>({...a,clientId:e.target.value})),children:x.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Project Budget"}),(0,a.jsx)("input",{readOnly:!0,className:"border rounded w-full h-10 px-3 bg-gray-100",value:(e=>{var a;let l=n.find(a=>{var l;return(null==(l=a.project)?void 0:l.projectName)===e});return(null==l||null==(a=l.project)?void 0:a.budget)||0})(d.projectName).toLocaleString()})]})]}),(0,a.jsxs)("div",{className:"mt-4 border rounded flex overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex-1 p-3",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount"}),(0,a.jsx)("input",{type:"number",className:"border rounded h-10 w-40 px-2",value:d.amount,onChange:e=>m(a=>({...a,amount:Number(e.target.value)}))})]}),(0,a.jsxs)("div",{className:"w-56 p-3 border-l",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Tax (%)"}),(0,a.jsx)("input",{type:"number",className:"border rounded h-10 w-full px-2",value:d.tax,onChange:e=>m(a=>({...a,tax:Number(e.target.value)}))})]}),(0,a.jsxs)("div",{className:"w-40 bg-gray-100 p-3 flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Total"}),(0,a.jsx)("div",{className:"font-bold text-lg",children:(h-j+p).toFixed(2)})]})]})]}),(0,a.jsx)(I,{children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-6",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Amount in words"}),(0,a.jsx)("input",{className:"border rounded w-full h-10 px-3",value:d.amountInWords,onChange:e=>m(a=>({...a,amountInWords:e.target.value}))})]}),(0,a.jsxs)("div",{className:"col-span-6",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Notes"}),(0,a.jsx)("textarea",{className:"border rounded w-full h-28 p-3",value:d.notes,onChange:e=>m(a=>({...a,notes:e.target.value}))})]})]})}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsx)(r.Button,{variant:"outline",onClick:s,children:"Cancel"}),(0,a.jsx)(r.Button,{onClick:v,disabled:c,children:c?"Updating...":"Update"})]})]})})}function E(e){let{open:l,onClose:s,invoice:t,refresh:n}=e,[i,c]=(0,C.useState)(null),[o,d]=(0,C.useState)(!1);if(!t)return null;let m=async()=>{if(!i)return alert("Choose a file");d(!0);try{let e=new FormData;e.append("file",i),await fetch("/api/invoices/".concat(t.invoiceNumber,"/files"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:e}),s(),n()}catch(e){alert("Upload failed")}finally{d(!1)}};return(0,a.jsxs)(k,{open:l,onClose:s,title:"Upload file for ".concat(t.invoiceNumber),children:[(0,a.jsx)("input",{type:"file",className:"border p-2 rounded w-full",onChange:e=>{var a;return c((null==(a=e.target.files)?void 0:a[0])||null)}}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,a.jsx)(r.Button,{variant:"ghost",onClick:s,children:"Cancel"}),(0,a.jsx)(r.Button,{onClick:m,disabled:o,children:o?"Uploading...":"Upload"})]})]})}function F(e){let{open:l,onClose:s,invoice:t}=e,[n,i]=(0,C.useState)({amount:(null==t?void 0:t.unpaidAmount)||(null==t?void 0:t.total)||"",currency:(null==t?void 0:t.currency)||"",transactionId:"",notes:""}),[c,o]=(0,C.useState)(null);if(!t)return null;let d=async()=>{let e=new FormData;e.append("payment",JSON.stringify({...n,invoiceId:t.invoiceNumber})),c&&e.append("file",c),await fetch("".concat("https://6jnqmj85-80.inc1.devtunnels.ms","/api/payments"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:e}),s()};return(0,a.jsx)(k,{open:l,onClose:s,title:"Add Payment - ".concat(t.invoiceNumber),children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{className:"border rounded w-full px-2 py-1",placeholder:"Amount",value:n.amount,onChange:e=>i(a=>({...a,amount:e.target.value}))}),(0,a.jsx)("input",{className:"border rounded w-full px-2 py-1",placeholder:"Transaction ID",value:n.transactionId,onChange:e=>i(a=>({...a,transactionId:e.target.value}))}),(0,a.jsx)("input",{className:"border rounded w-full px-2 py-1",placeholder:"Currency",value:n.currency,onChange:e=>i(a=>({...a,currency:e.target.value}))}),(0,a.jsx)("textarea",{className:"border rounded w-full px-2 py-1",placeholder:"Notes",value:n.notes,onChange:e=>i(a=>({...a,notes:e.target.value}))}),(0,a.jsx)("input",{type:"file",onChange:e=>{var a;return o((null==(a=e.target.files)?void 0:a[0])||null)}}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,a.jsx)(r.Button,{variant:"ghost",onClick:s,children:"Cancel"}),(0,a.jsx)(r.Button,{onClick:d,children:"Save"})]})]})})}e.s(["default",()=>E],38453),e.s(["default",()=>F],339917),e.s(["default",()=>L],158649);var M=e.i(624687);let z="".concat("https://6jnqmj85-80.inc1.devtunnels.ms");function L(e){let{open:l,onClose:s,invoice:i}=e;if(!i)return null;let[c,o]=(0,C.useState)(!1),[d,m]=(0,C.useState)({invoiceId:i.invoiceNumber||"",issueDate:"",currency:"USD",sellerCompanyName:"",sellerCompanyAddress:"",sellerCompanyCode:"",sellerCompanyTaxNumber:"",sellerCompanyEmail:"",sellerCompanyPhoneNumber:"",sellerCompanyBankName:"",sellerCompanyBankAccountNumber:"",buyerCompanyName:"",buyerCompanyAddress:"",buyerCompanyCode:"",buyerCompanyTaxNumber:"",buyerCleintName:"",buyerCompanyEmail:"",buyerCompanyPhoneNumber:"",buyerCompanyBankName:"",buyerCompanyBankAccountNumber:"",productName:"",quantity:1,priceWithOutTax:0,tax:0,description:""});function u(e,a){m(l=>({...l,[e]:a}))}async function x(){try{o(!0);let e=await fetch("".concat(z,"/api/invoice"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:JSON.stringify(d)});if(!e.ok)throw Error("Failed to create invoice");await e.json(),s()}catch(e){console.error(e),alert("Something went wrong while saving invoice")}finally{o(!1)}}return(0,a.jsx)(k,{open:l,onClose:s,title:"Create Receipt",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("section",{className:"rounded-lg border p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-4",children:"Invoice Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium",children:["Invoice Number ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("div",{className:"flex mt-1",children:[(0,a.jsx)("span",{className:"px-3 flex items-center border border-r-0 rounded-l-md bg-muted text-sm",children:"INV#"}),(0,a.jsx)(n.Input,{className:"rounded-l-none",value:d.invoiceId,onChange:e=>u("invoiceId",e.target.value)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium",children:["Issue Date ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(n.Input,{type:"date",className:"mt-1",value:d.issueDate,onChange:e=>u("issueDate",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium",children:["Currency ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)(t.Select,{value:d.currency,onValueChange:e=>u("currency",e),children:[(0,a.jsx)(t.SelectTrigger,{className:"mt-1",children:(0,a.jsx)(t.SelectValue,{})}),(0,a.jsxs)(t.SelectContent,{children:[(0,a.jsx)(t.SelectItem,{value:"USD",children:"USD $"}),(0,a.jsx)(t.SelectItem,{value:"USD",children:"USD â‚¹"})]})]})]})]})]}),(0,a.jsxs)("section",{className:"rounded-lg border p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-4",children:"Seller Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(O,{label:"Company Name",onChange:e=>u("sellerCompanyName",e)}),(0,a.jsx)(O,{label:"Email Id",onChange:e=>u("sellerCompanyEmail",e)}),(0,a.jsx)(O,{label:"Contact No.",onChange:e=>u("sellerCompanyPhoneNumber",e)}),(0,a.jsx)(O,{label:"Company Code",onChange:e=>u("sellerCompanyCode",e)}),(0,a.jsx)(O,{label:"Tax No.",onChange:e=>u("sellerCompanyTaxNumber",e)}),(0,a.jsx)(R,{label:"Company Address",onChange:e=>u("sellerCompanyAddress",e)}),(0,a.jsx)(O,{label:"Bank Account No.",onChange:e=>u("sellerCompanyBankAccountNumber",e)}),(0,a.jsx)(O,{label:"Name of the Bank",onChange:e=>u("sellerCompanyBankName",e)})]})]}),(0,a.jsxs)("section",{className:"rounded-lg border p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-4",children:"Buyer Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(O,{label:"Client Name",onChange:e=>u("buyerCleintName",e)}),(0,a.jsx)(O,{label:"Company Name",onChange:e=>u("buyerCompanyName",e)}),(0,a.jsx)(O,{label:"Email Id",onChange:e=>u("buyerCompanyEmail",e)}),(0,a.jsx)(O,{label:"Contact No.",onChange:e=>u("buyerCompanyPhoneNumber",e)}),(0,a.jsx)(O,{label:"Company Code",onChange:e=>u("buyerCompanyCode",e)}),(0,a.jsx)(O,{label:"Tax No.",onChange:e=>u("buyerCompanyTaxNumber",e)}),(0,a.jsx)(R,{label:"Company Address",colSpan:3,onChange:e=>u("buyerCompanyAddress",e)}),(0,a.jsx)(O,{label:"Bank Account No.",onChange:e=>u("buyerCompanyBankAccountNumber",e)}),(0,a.jsx)(O,{label:"Name of the Bank",onChange:e=>u("buyerCompanyBankName",e)})]})]}),(0,a.jsxs)("section",{className:"rounded-lg border p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-4",children:"Project Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)(O,{label:"Product Name",onChange:e=>u("productName",e)}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium mb-1",children:["Quantity",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(n.Input,{type:"number",defaultValue:1,onChange:e=>u("quantity",Number(e.target.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium mb-1",children:["Price Without Tax",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(n.Input,{type:"number",defaultValue:1,onChange:e=>u("quantity",Number(e.target.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium mb-1",children:["Tax",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(n.Input,{type:"number",onChange:e=>u("tax",Number(e.target.value))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"mt-4",children:"Note / Description for the recipient"}),(0,a.jsx)(M.Textarea,{className:"mt-4",placeholder:"Note / Description for the recipient",onChange:e=>u("description",e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,a.jsx)(r.Button,{variant:"outline",onClick:s,children:"Cancel"}),(0,a.jsx)(r.Button,{onClick:x,disabled:c,children:c?"Saving...":"Save"})]})]})})}function O(e){let{label:l,onChange:s}=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium",children:[l," ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(n.Input,{className:"mt-1",onChange:e=>s(e.target.value)})]})}function R(e){let{label:l,onChange:s,colSpan:t=2}=e;return(0,a.jsxs)("div",{className:"md:col-span-".concat(t),children:[(0,a.jsxs)("label",{className:"text-sm font-medium",children:[l," ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(M.Textarea,{className:"mt-1",onChange:e=>s(e.target.value)})]})}e.s(["default",()=>J],257456);var V=e.i(323585),G=e.i(107233),H=e.i(440160);let q="".concat("https://6jnqmj85-80.inc1.devtunnels.ms");function J(e){let{open:l,onClose:s,invoice:t}=e,[n,i]=(0,C.useState)([]),[c,d]=(0,C.useState)(!1),[u,x]=(0,C.useState)(!1),[j,p]=(0,C.useState)(null);async function v(){let e=(null==t?void 0:t.invoiceNumber)||(null==t?void 0:t.invoiceNo);if(!e)return void i([]);try{d(!0);let a=await fetch("".concat(q,"/api/invoice/receipt/").concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}),l=await a.text();if(!l)return void i([]);let s=JSON.parse(l);i(Array.isArray(s)?s:[])}catch(e){console.error("âŒ Failed to load receipts",e),i([])}finally{d(!1)}}async function N(e){confirm("Are you sure you want to delete this receipt?")&&(await fetch("".concat(q,"/api/invoice/receipt/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}),v())}async function b(e){let a=(null==e?void 0:e.createdIdUSD)||(null==e?void 0:e.id);if(!a)return void alert("PDF ID not found");try{let e=await fetch("".concat(q,"/api/invoice/").concat(a,"/pdf?disposition=attachment"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}});if(!e.ok)throw Error("Failed to download PDF");let l=await e.blob(),s=window.URL.createObjectURL(l),t=document.createElement("a");t.href=s,t.download="".concat(a,".pdf"),document.body.appendChild(t),t.click(),t.remove(),window.URL.revokeObjectURL(s)}catch(e){console.error("âŒ PDF Download Error",e),alert("Failed to download PDF")}}return((0,C.useEffect)(()=>{l&&v()},[l,t]),t)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(k,{open:l,onClose:s,title:"Receipts",className:"max-w-6xl",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)(r.Button,{onClick:()=>x(!0),children:[(0,a.jsx)(G.Plus,{className:"w-4 h-4 mr-2"}),"Add a Receipt"]})}),(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsxs)(o.Table,{children:[(0,a.jsx)(o.TableHeader,{className:"bg-blue-50",children:(0,a.jsxs)(o.TableRow,{children:[(0,a.jsx)(o.TableHead,{children:"Invoice No."}),(0,a.jsx)(o.TableHead,{children:"Product"}),(0,a.jsx)(o.TableHead,{children:"Client"}),(0,a.jsx)(o.TableHead,{children:"Amount"}),(0,a.jsx)(o.TableHead,{children:"Issue Date"}),(0,a.jsx)(o.TableHead,{className:"text-right",children:"Action"})]})}),(0,a.jsxs)(o.TableBody,{children:[c&&(0,a.jsx)(o.TableRow,{children:(0,a.jsx)(o.TableCell,{colSpan:6,className:"text-center text-sm text-gray-500",children:"Loading receipts..."})}),!c&&0===n.length&&(0,a.jsx)(o.TableRow,{children:(0,a.jsx)(o.TableCell,{colSpan:6,className:"text-center text-sm text-gray-500",children:"No receipts available"})}),!c&&n.map(e=>(0,a.jsxs)(o.TableRow,{children:[(0,a.jsx)(o.TableCell,{children:e.invoiceId}),(0,a.jsx)(o.TableCell,{children:e.productName}),(0,a.jsx)(o.TableCell,{children:e.buyerCleintName}),(0,a.jsxs)(o.TableCell,{children:[e.currency," ",e.totalAmount]}),(0,a.jsx)(o.TableCell,{children:new Date(e.issueDate).toLocaleDateString()}),(0,a.jsx)(o.TableCell,{className:"text-right",children:(0,a.jsxs)(g.DropdownMenu,{children:[(0,a.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(r.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(V.MoreVertical,{className:"w-4 h-4"})})}),(0,a.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>p(e),children:[(0,a.jsx)(m.Eye,{className:"w-4 h-4 mr-2"}),"View"]}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>b(e),children:[(0,a.jsx)(H.Download,{className:"w-4 h-4 mr-2"}),"Download as PDF"]}),(0,a.jsxs)(g.DropdownMenuItem,{className:"text-red-600",onClick:()=>N(e.id),children:[(0,a.jsx)(h.Trash,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]},e.id))]})]})})]}),j&&(0,a.jsx)(k,{open:!0,onClose:()=>p(null),title:j.invoiceId,className:"max-w-4xl",children:(0,a.jsxs)("div",{className:"border p-6 bg-white text-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Proforma Invoice"}),(0,a.jsxs)("p",{children:["Invoice No.: ",j.invoiceId]}),(0,a.jsxs)("p",{children:["Issue Date: ",new Date(j.issueDate).toDateString()]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mt-4 border p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-1",children:"Seller"}),(0,a.jsx)("p",{children:j.sellerCompanyName}),(0,a.jsx)("p",{children:j.sellerCompanyAddress}),(0,a.jsxs)("p",{children:["Bank: ",j.sellerCompanyBankName]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-1",children:"Buyer"}),(0,a.jsx)("p",{children:j.buyerCompanyName}),(0,a.jsx)("p",{children:j.buyerCompanyAddress}),(0,a.jsxs)("p",{children:["Client: ",j.buyerCleintName]})]})]}),(0,a.jsxs)("div",{className:"mt-4 text-right font-semibold",children:["Total: ",j.currency," ",j.totalAmount]})]})}),(0,a.jsx)(L,{open:u,invoice:t,onClose:()=>{x(!1),v()}})]}):null}e.s(["default",()=>Y],101882);var W=e.i(727612);let X="https://6jnqmj85-80.inc1.devtunnels.ms";function Y(e){let{open:l,onClose:s,clientId:t,onSaved:n}=e,[r,i]=(0,C.useState)("pre filled"),[c,o]=(0,C.useState)(t?String(t):"pre filled"),[d,m]=(0,C.useState)("pre filled"),[u,x]=(0,C.useState)(""),[h,j]=(0,C.useState)("USD"),[p,v]=(0,C.useState)(""),[N,b]=(0,C.useState)("Net Banking"),[g,y]=(0,C.useState)(""),f=(0,C.useRef)(null),[w,S]=(0,C.useState)(null),[k,I]=(0,C.useState)(!1),[T,A]=(0,C.useState)([]),[P,B]=(0,C.useState)("");if((0,C.useEffect)(()=>{l&&o(t?String(t):"pre filled")},[l,t]),!l)return null;let U=async()=>{try{let e=localStorage.getItem("accessToken")||"",a=await fetch("".concat(X,"/api/payment-gateways"),{headers:{Authorization:"Bearer ".concat(e)}}),l=await a.json();Array.isArray(l)&&A(l.map(e=>({id:e.id,name:e.name})))}catch(e){}},E=async()=>{if(!P.trim())return alert("Enter gateway name");try{let e=localStorage.getItem("accessToken")||"",a=await fetch("".concat(X,"/api/payment-gateways"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({name:P})}),l=await a.json();A(e=>[...e,l]),b(l.name),I(!1)}catch(e){alert("Failed to save gateway")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"fixed inset-0 z-[20000] flex items-center justify-center px-4 py-6",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:s}),(0,a.jsxs)("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Add Payment Details"}),(0,a.jsx)("button",{onClick:s,className:"p-2 rounded hover:bg-gray-100",children:(0,a.jsx)(D.X,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,a.jsx)("h4",{className:"font-medium mb-3",children:"Payment Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)(Z,{label:"Project *",value:r,setValue:i}),(0,a.jsx)(Z,{label:"Client *",value:c,setValue:o}),(0,a.jsx)(Z,{label:"Invoice *",value:d,setValue:m}),(0,a.jsx)(Z,{label:"Amount *",value:u,setValue:x}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Currency *"}),(0,a.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:h,onChange:e=>j(e.target.value),children:[(0,a.jsx)("option",{value:"USD",children:"USD $"}),(0,a.jsx)("option",{value:"USD",children:"USD â‚¹"}),(0,a.jsx)("option",{value:"EUR",children:"EUR â‚¬"})]})]}),(0,a.jsx)(Z,{label:"Transaction ID",value:p,setValue:v}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Payment Gateway"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("select",{className:"w-full border rounded px-3 py-2",value:N,onChange:e=>b(e.target.value),children:T.length>0?T.map(e=>(0,a.jsx)("option",{children:e.name},e.id)):["Net Banking","Credit Card","PayPal"].map(e=>(0,a.jsx)("option",{children:e},e))}),(0,a.jsx)("button",{className:"px-3 py-2 bg-gray-100 rounded",onClick:()=>{I(!0),U()},children:"Add"})]})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Receipt"}),(0,a.jsx)("div",{className:"border-2 border-dashed rounded-lg h-28 flex items-center justify-center cursor-pointer text-gray-600",onClick:()=>{var e;return null==(e=f.current)?void 0:e.click()},children:w?w.name:"Click or drag file"}),(0,a.jsx)("input",{type:"file",ref:f,className:"hidden",onChange:e=>{var a,l;return S(null!=(l=null==(a=e.target.files)?void 0:a[0])?l:null)}})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Remark"}),(0,a.jsx)("textarea",{rows:4,className:"border rounded w-full p-3",value:g,onChange:e=>y(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{className:"px-4 py-2 border rounded",onClick:s,children:"Cancel"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>{null==n||n(),s()},children:"Save"})]})]})]})]}),k&&(0,a.jsxs)("div",{className:"fixed inset-0 z-[30000] flex items-center justify-center px-4 py-6",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>I(!1)}),(0,a.jsxs)("div",{className:"relative bg-white w-full max-w-3xl rounded-xl shadow-xl max-h-[90vh] overflow-y-auto p-6",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Add Payment Gateway"}),(0,a.jsx)("button",{onClick:()=>I(!1),children:(0,a.jsx)(D.X,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"rounded border overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-blue-50 px-4 py-2 flex text-sm font-medium",children:[(0,a.jsx)("div",{className:"w-1/12",children:"#"}),(0,a.jsx)("div",{className:"w-10/12",children:"Gateway"}),(0,a.jsx)("div",{className:"w-1/12 text-center",children:"Action"})]}),(0,a.jsx)("div",{className:"px-4 py-2",children:0===T.length?(0,a.jsx)("p",{className:"text-gray-500 p-2",children:"No gateways"}):T.map((e,l)=>(0,a.jsxs)("div",{className:"flex items-center py-2 border-b last:border-none",children:[(0,a.jsx)("div",{className:"w-1/12",children:l+1}),(0,a.jsx)("div",{className:"w-10/12",children:e.name}),(0,a.jsx)("div",{className:"w-1/12 text-center",children:(0,a.jsx)(W.Trash2,{className:"text-red-600 cursor-pointer",size:16})})]},e.id))})]}),(0,a.jsx)("label",{className:"text-sm text-gray-600 block mt-4",children:"Gateway Name *"}),(0,a.jsx)("input",{value:P,onChange:e=>B(e.target.value),className:"border rounded w-full px-3 py-2 mt-1"}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,a.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>I(!1),children:"Cancel"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:E,children:"Save"})]})]})]})]})}function Z(e){let{label:l,value:s,setValue:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:l}),(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",value:s,onChange:e=>t(e.target.value)})]})}function $(e){var l,s;let{open:t,onClose:n,payment:r}=e;return t&&r?(0,a.jsxs)("div",{className:"fixed inset-0 z-[30000]",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:n}),(0,a.jsxs)("div",{className:"absolute top-0 right-0 h-full bg-white shadow-2xl",style:{width:"83vw"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"View Payment"}),(0,a.jsx)("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded",children:(0,a.jsx)(D.X,{})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4 text-sm",children:[(0,a.jsx)(K,{label:"Amount",value:"".concat(r.currency," ").concat(r.amount)}),(0,a.jsx)(K,{label:"Transaction ID",value:r.transactionId}),(0,a.jsx)(K,{label:"Gateway",value:null==(l=r.paymentGateway)?void 0:l.name}),(0,a.jsx)(K,{label:"Status",value:r.status}),(0,a.jsx)(K,{label:"Payment Date",value:new Date(r.paymentDate).toLocaleDateString("en-GB")}),(0,a.jsx)(K,{label:"Notes",value:null!=(s=r.note)?s:"--"})]})]})]}):null}e.s(["default",()=>ea],910704);let K=e=>{let{label:l,value:s}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-500",children:l}),(0,a.jsx)("div",{className:"font-medium",children:null!=s?s:"--"})]})};function _(e){var l,s,t,n,r,i,c;let{open:o,onClose:d,payment:m,onUpdated:u}=e,[x,h]=(0,C.useState)({amount:null!=(s=null==m?void 0:m.amount)?s:"",currency:null!=(t=null==m?void 0:m.currency)?t:"USD",transactionId:null!=(n=null==m?void 0:m.transactionId)?n:"",paymentGatewayId:null!=(r=null==m||null==(l=m.paymentGateway)?void 0:l.id)?r:"",status:null!=(i=null==m?void 0:m.status)?i:"COMPLETED",notes:null!=(c=null==m?void 0:m.note)?c:""});if(!o||!m)return null;let j=async()=>{await fetch("".concat("https://6jnqmj85-80.inc1.devtunnels.ms","/api/payments/").concat(m.id),{method:"PUT",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"Content-Type":"application/json"},body:JSON.stringify(x)}),u(),d()};return(0,a.jsxs)("div",{className:"fixed inset-0 z-[30000]",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:d}),(0,a.jsxs)("div",{className:"absolute top-0 right-0 h-full bg-white shadow-2xl",style:{width:"83vw"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Edit Payment"}),(0,a.jsx)("button",{onClick:d,className:"p-2 hover:bg-gray-100 rounded",children:(0,a.jsx)(D.X,{})})]}),(0,a.jsxs)("div",{className:"p-6 grid grid-cols-2 gap-4",children:[(0,a.jsx)(Q,{label:"Amount",value:x.amount,onChange:e=>h({...x,amount:e})}),(0,a.jsx)(Q,{label:"Transaction ID",value:x.transactionId,onChange:e=>h({...x,transactionId:e})}),(0,a.jsx)(Q,{label:"Gateway ID",value:x.paymentGatewayId,onChange:e=>h({...x,paymentGatewayId:e})}),(0,a.jsxs)("select",{className:"border rounded px-3 py-2",value:x.status,onChange:e=>h({...x,status:e.target.value}),children:[(0,a.jsx)("option",{value:"COMPLETED",children:"COMPLETED"}),(0,a.jsx)("option",{value:"PENDING",children:"PENDING"})]}),(0,a.jsx)("textarea",{className:"col-span-2 border rounded px-3 py-2",placeholder:"Notes",value:x.notes,onChange:e=>h({...x,notes:e.target.value})}),(0,a.jsx)("div",{className:"col-span-2 text-right",children:(0,a.jsx)("button",{onClick:j,className:"px-6 py-2 bg-blue-600 text-white rounded",children:"Save Changes"})})]})]})]})}let Q=e=>{let{label:l,value:s,onChange:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-gray-500",children:l}),(0,a.jsx)("input",{value:s,onChange:e=>t(e.target.value),className:"w-full border rounded px-3 py-2"})]})},ee="".concat("https://6jnqmj85-80.inc1.devtunnels.ms");function ea(e){let{open:l,onClose:s,invoiceNumber:t}=e,[n,r]=(0,C.useState)([]),[i,o]=(0,C.useState)(!1),[m,u]=(0,C.useState)(null),[x,h]=(0,C.useState)(null);if((0,C.useEffect)(()=>{l&&t&&(async()=>{o(!0);try{let e=await fetch("".concat(ee,"/api/payments/invoice/").concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}),a=await e.json();r(Array.isArray(a)?a:[])}catch(e){console.error(e),r([])}finally{o(!1)}})()},[l,t]),!l)return null;let j=async()=>{o(!0);try{let e=await fetch("".concat(ee,"/api/payments/invoice/").concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}),a=await e.json();r(Array.isArray(a)?a:[])}catch(e){console.error(e)}finally{o(!1)}};return(0,a.jsxs)("div",{className:"fixed inset-0 z-[20000]",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:s}),(0,a.jsxs)("div",{className:" absolute top-0 right-0 h-full bg-white shadow-2xl transition-transform duration-300 translate-x-0 ",style:{width:"83vw"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold",children:["Payments â€” ",t]}),(0,a.jsx)("button",{onClick:s,className:"p-2 rounded hover:bg-gray-100",children:(0,a.jsx)(D.X,{size:20})})]}),(0,a.jsx)("div",{className:"p-6 overflow-y-auto h-[calc(100vh-64px)]",children:i?(0,a.jsx)("div",{className:"text-center py-10 text-gray-500",children:"Loading paymentsâ€¦"}):0===n.length?(0,a.jsx)("div",{className:"text-center py-10 text-gray-500",children:"No payments found"}):(0,a.jsxs)("div",{className:"rounded-lg border overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-[#e8f3ff] px-4 py-3 flex text-sm font-medium",children:[(0,a.jsx)("div",{className:"w-2/12",children:"Project"}),(0,a.jsx)("div",{className:"w-2/12",children:"Client"}),(0,a.jsx)("div",{className:"w-2/12",children:"Amount"}),(0,a.jsx)("div",{className:"w-2/12",children:"Gateway"}),(0,a.jsx)("div",{className:"w-2/12",children:"Paid On"}),(0,a.jsx)("div",{className:"w-1/12",children:"Status"}),(0,a.jsx)("div",{className:"w-10 text-center",children:"Action"})]}),n.map(e=>{var l,s,t,n,i,o,m,x,j,p;return(0,a.jsxs)("div",{className:"flex items-center px-4 py-3 border-t text-sm",children:[(0,a.jsx)("div",{className:"w-2/12",children:null!=(x=null==(l=e.project)?void 0:l.projectName)?x:"--"}),(0,a.jsxs)("div",{className:"w-2/12 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-7 w-7 rounded-full overflow-hidden bg-gray-100 relative",children:(null==(s=e.client)?void 0:s.profilePictureUrl)?(0,a.jsx)(c.default,{src:e.client.profilePictureUrl,alt:"client",fill:!0,sizes:"28px",className:"object-cover",unoptimized:!0}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-xs",children:null!=(j=null==(n=e.client)||null==(t=n.name)?void 0:t.charAt(0))?j:"U"})}),(0,a.jsx)("span",{children:null==(i=e.client)?void 0:i.name})]}),(0,a.jsxs)("div",{className:"w-2/12",children:[e.currency," ",null==(o=e.amount)?void 0:o.toFixed(2)]}),(0,a.jsx)("div",{className:"w-2/12",children:null!=(p=null==(m=e.paymentGateway)?void 0:m.name)?p:"--"}),(0,a.jsx)("div",{className:"w-2/12",children:new Date(e.paymentDate).toLocaleDateString("en-GB")}),(0,a.jsx)("div",{className:"w-1/12",children:"COMPLETED"===e.status?(0,a.jsx)("span",{className:"text-green-600",children:"â— Paid"}):(0,a.jsx)("span",{className:"text-yellow-600",children:e.status})}),(0,a.jsx)("div",{className:"w-10 text-center",children:(0,a.jsxs)(g.DropdownMenu,{modal:!1,children:[(0,a.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)("button",{className:"p-2 rounded hover:bg-gray-100",children:(0,a.jsx)(d.MoreHorizontal,{size:16})})}),(0,a.jsxs)(g.DropdownMenuContent,{align:"end",sideOffset:6,className:"z-[30000]",children:[(0,a.jsx)(g.DropdownMenuItem,{onClick:()=>u(e),children:"View"}),(0,a.jsx)(g.DropdownMenuItem,{onClick:()=>h(e),children:"Edit"}),(0,a.jsxs)(g.DropdownMenuItem,{className:"text-red-600",onClick:()=>{confirm("Delete this payment?")&&fetch("".concat(ee,"/api/payments/").concat(e.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}).then(()=>r(a=>a.filter(a=>a.id!==e.id)))},children:[(0,a.jsx)(W.Trash2,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},e.id)})]})}),(0,a.jsx)($,{open:!!m,payment:m,onClose:()=>u(null)}),(0,a.jsx)(_,{open:!!x,payment:x,onClose:()=>h(null),onUpdated:j})]})]})}function el(e){let{open:l,onClose:s,invoiceNumber:t,onCreated:n}=e,[r,i]=(0,C.useState)({creditNoteNumber:"",creditNoteDate:"",currency:"USD",adjustment:"",adjustmentPositive:!1,tax:"",amount:"",notes:""}),[c,o]=(0,C.useState)(null),[d,m]=(0,C.useState)(!1);if(!l)return null;let u=async()=>{if(!t)return;let e=new FormData;e.append("creditNote",JSON.stringify({...r,adjustment:Number(r.adjustment),tax:Number(r.tax),amount:Number(r.amount)})),c&&e.append("file",c),m(!0);try{await fetch("".concat("https://6jnqmj85-80.inc1.devtunnels.ms","/api/invoices/").concat(t,"/credit-notes"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))},body:e}),n(),s()}catch(e){alert("Failed to create credit note")}finally{m(!1)}};return(0,a.jsxs)("div",{className:"fixed inset-0 z-[30000]",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:s}),(0,a.jsxs)("div",{className:"absolute right-0 top-0 h-full w-[83vw] bg-white shadow-xl transition-all",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:["Create Credit Note â€” ",t]}),(0,a.jsx)("button",{onClick:s,children:(0,a.jsx)(D.X,{})})]}),(0,a.jsxs)("div",{className:"p-6 grid grid-cols-3 gap-4",children:[[["Credit Note No","creditNoteNumber"],["Date","creditNoteDate","date"],["Currency","currency"],["Adjustment","adjustment"],["Tax","tax"],["Amount","amount"]].map(e=>{let[l,s,t]=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",children:l}),(0,a.jsx)("input",{type:t||"text",className:"w-full border px-3 py-2 rounded",value:r[s],onChange:e=>i(a=>({...a,[s]:e.target.value}))})]},s)}),(0,a.jsxs)("div",{className:"col-span-3",children:[(0,a.jsx)("label",{className:"text-sm",children:"Notes"}),(0,a.jsx)("textarea",{className:"w-full border rounded p-3",rows:3,onChange:e=>i(a=>({...a,notes:e.target.value}))})]}),(0,a.jsxs)("div",{className:"col-span-3",children:[(0,a.jsx)("label",{className:"text-sm",children:"Upload File"}),(0,a.jsx)("input",{type:"file",onChange:e=>{var a;return o((null==(a=e.target.files)?void 0:a[0])||null)}})]})]}),(0,a.jsxs)("div",{className:"p-4 border-t flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:s,className:"border px-4 py-2 rounded",children:"Cancel"}),(0,a.jsx)("button",{disabled:d,onClick:u,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Create"})]})]})]})}function es(e){let{open:l,onClose:s,invoiceNumber:t}=e,[n,r]=(0,C.useState)([]),[i,c]=(0,C.useState)(!1);return((0,C.useEffect)(()=>{l&&t&&(async()=>{c(!0);let e=await fetch("".concat("https://6jnqmj85-80.inc1.devtunnels.ms","/api/invoices/").concat(t,"/credit-notes"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}});r(await e.json()),c(!1)})()},[l,t]),l)?(0,a.jsxs)("div",{className:"fixed inset-0 z-[30000]",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:s}),(0,a.jsxs)("div",{className:"absolute right-0 top-0 h-full w-[83vw] bg-white shadow-xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:["Credit Notes â€” ",t]}),(0,a.jsx)("button",{onClick:s,children:(0,a.jsx)(D.X,{})})]}),(0,a.jsx)("div",{className:"p-6",children:i?"Loading...":(0,a.jsxs)("table",{className:"w-full border",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-2",children:"CN No"}),(0,a.jsx)("th",{children:"Amount"}),(0,a.jsx)("th",{children:"Date"}),(0,a.jsx)("th",{children:"Notes"}),(0,a.jsx)("th",{children:"File"})]})}),(0,a.jsx)("tbody",{children:n.map(e=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"p-2",children:e.creditNoteNumber}),(0,a.jsxs)("td",{children:[e.currency," ",e.amount]}),(0,a.jsx)("td",{children:e.creditNoteDate}),(0,a.jsx)("td",{children:e.notes}),(0,a.jsx)("td",{children:e.fileUrl&&(0,a.jsx)("button",{onClick:()=>window.open(e.fileUrl),children:(0,a.jsx)(v.FileText,{size:16})})})]},e.id))})]})})]})]}):null}e.s(["default",()=>el],811681),e.s(["default",()=>es],299116)}]);